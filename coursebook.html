<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script id="versionArea" type="text/javascript">
//<![CDATA[
var version = {title: "TiddlyWiki", major: 2, minor: 6, revision: 0, date: new Date("Mar 18, 2010"), extensions: {}};
//]]>
</script>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="copyright" content="
TiddlyWiki created by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)

Copyright (c) UnaMesa Association 2004-2009

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.

Neither the name of the UnaMesa Association nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
" />
<!--PRE-HEAD-START-->
<!--{{{-->
<link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml' />
<!--}}}-->

<!--PRE-HEAD-END-->
<title> TiddlyWiki Coursebook - a textbook, notebook, quiz and presentation tool for a class </title>
<style id="styleArea" type="text/css">
#saveTest {display:none;}
#messageArea {display:none;}
#copyright {display:none;}
#storeArea {display:none;}
#storeArea div {padding:0.5em; margin:1em 0em 0em 0em; border-color:#fff #666 #444 #ddd; border-style:solid; border-width:2px; overflow:auto;}
#shadowArea {display:none;}
#javascriptWarning {width:100%; text-align:center; font-weight:bold; background-color:#dd1100; color:#fff; padding:1em 0em;}
</style>
<!--POST-HEAD-START-->

<!--POST-HEAD-END-->
</head>
<body onload="main();" onunload="if(window.unload) unload();">
<!--PRE-BODY-START-->

<!--PRE-BODY-END-->
<div id="copyright">
Welcome to TiddlyWiki created by Jeremy Ruston, Copyright &copy; 2007 UnaMesa Association
</div>
<noscript>
<div id="javascriptWarning">
This page requires JavaScript to function properly.<br /><br />If you are using Microsoft Internet Explorer you may need to click on the yellow bar above and select 'Allow Blocked Content'. You must then click 'Yes' on the following security warning.
</div>
</noscript>
<div id="saveTest"></div>
<div id="backstageCloak"></div>
<div id="backstageButton"></div>
<div id="backstageArea"><div id="backstageToolbar"></div></div>
<div id="backstage">
	<div id="backstagePanel"></div>
</div>
<div id="contentWrapper"></div>
<div id="contentStash"></div>
<div id="shadowArea">
<div title="MarkupPreHead">
<pre>&lt;!--{{{--&gt;
&lt;link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml' /&gt;
&lt;!--}}}--&gt;
</pre>
</div>
<div title="ColorPalette">
<pre>Background: #fff
Foreground: #000
PrimaryPale: #8cf
PrimaryLight: #18f
PrimaryMid: #04b
PrimaryDark: #014
SecondaryPale: #ffc
SecondaryLight: #fe8
SecondaryMid: #db4
SecondaryDark: #841
TertiaryPale: #eee
TertiaryLight: #ccc
TertiaryMid: #999
TertiaryDark: #666
Error: #f88
</pre>
</div>
<div title="StyleSheetColors">
<pre>/*{{{*/
body {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}

a {color:[[ColorPalette::PrimaryMid]];}
a:hover {background-color:[[ColorPalette::PrimaryMid]]; color:[[ColorPalette::Background]];}
a img {border:0;}

h1,h2,h3,h4,h5,h6 {color:[[ColorPalette::SecondaryDark]]; background:transparent;}
h1 {border-bottom:2px solid [[ColorPalette::TertiaryLight]];}
h2,h3 {border-bottom:1px solid [[ColorPalette::TertiaryLight]];}

.button {color:[[ColorPalette::PrimaryDark]]; border:1px solid [[ColorPalette::Background]];}
.button:hover {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::SecondaryLight]]; border-color:[[ColorPalette::SecondaryMid]];}
.button:active {color:[[ColorPalette::Background]]; background:[[ColorPalette::SecondaryMid]]; border:1px solid [[ColorPalette::SecondaryDark]];}

.header {background:[[ColorPalette::PrimaryMid]];}
.headerShadow {color:[[ColorPalette::Foreground]];}
.headerShadow a {font-weight:normal; color:[[ColorPalette::Foreground]];}
.headerForeground {color:[[ColorPalette::Background]];}
.headerForeground a {font-weight:normal; color:[[ColorPalette::PrimaryPale]];}

.tabSelected{color:[[ColorPalette::PrimaryDark]];
	background:[[ColorPalette::TertiaryPale]];
	border-left:1px solid [[ColorPalette::TertiaryLight]];
	border-top:1px solid [[ColorPalette::TertiaryLight]];
	border-right:1px solid [[ColorPalette::TertiaryLight]];
}
.tabUnselected {color:[[ColorPalette::Background]]; background:[[ColorPalette::TertiaryMid]];}
.tabContents {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::TertiaryPale]]; border:1px solid [[ColorPalette::TertiaryLight]];}
.tabContents .button {border:0;}

#sidebar {}
#sidebarOptions input {border:1px solid [[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel {background:[[ColorPalette::PrimaryPale]];}
#sidebarOptions .sliderPanel a {border:none;color:[[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel a:hover {color:[[ColorPalette::Background]]; background:[[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel a:active {color:[[ColorPalette::PrimaryMid]]; background:[[ColorPalette::Background]];}

.wizard {background:[[ColorPalette::PrimaryPale]]; border:1px solid [[ColorPalette::PrimaryMid]];}
.wizard h1 {color:[[ColorPalette::PrimaryDark]]; border:none;}
.wizard h2 {color:[[ColorPalette::Foreground]]; border:none;}
.wizardStep {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];
	border:1px solid [[ColorPalette::PrimaryMid]];}
.wizardStep.wizardStepDone {background:[[ColorPalette::TertiaryLight]];}
.wizardFooter {background:[[ColorPalette::PrimaryPale]];}
.wizardFooter .status {background:[[ColorPalette::PrimaryDark]]; color:[[ColorPalette::Background]];}
.wizard .button {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::SecondaryLight]]; border: 1px solid;
	border-color:[[ColorPalette::SecondaryPale]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryPale]];}
.wizard .button:hover {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::Background]];}
.wizard .button:active {color:[[ColorPalette::Background]]; background:[[ColorPalette::Foreground]]; border: 1px solid;
	border-color:[[ColorPalette::PrimaryDark]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryDark]];}

.wizard .notChanged {background:transparent;}
.wizard .changedLocally {background:#80ff80;}
.wizard .changedServer {background:#8080ff;}
.wizard .changedBoth {background:#ff8080;}
.wizard .notFound {background:#ffff80;}
.wizard .putToServer {background:#ff80ff;}
.wizard .gotFromServer {background:#80ffff;}

#messageArea {border:1px solid [[ColorPalette::SecondaryMid]]; background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]];}
#messageArea .button {color:[[ColorPalette::PrimaryMid]]; background:[[ColorPalette::SecondaryPale]]; border:none;}

.popupTiddler {background:[[ColorPalette::TertiaryPale]]; border:2px solid [[ColorPalette::TertiaryMid]];}

.popup {background:[[ColorPalette::TertiaryPale]]; color:[[ColorPalette::TertiaryDark]]; border-left:1px solid [[ColorPalette::TertiaryMid]]; border-top:1px solid [[ColorPalette::TertiaryMid]]; border-right:2px solid [[ColorPalette::TertiaryDark]]; border-bottom:2px solid [[ColorPalette::TertiaryDark]];}
.popup hr {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::PrimaryDark]]; border-bottom:1px;}
.popup li.disabled {color:[[ColorPalette::TertiaryMid]];}
.popup li a, .popup li a:visited {color:[[ColorPalette::Foreground]]; border: none;}
.popup li a:hover {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; border: none;}
.popup li a:active {background:[[ColorPalette::SecondaryPale]]; color:[[ColorPalette::Foreground]]; border: none;}
.popupHighlight {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}
.listBreak div {border-bottom:1px solid [[ColorPalette::TertiaryDark]];}

.tiddler .defaultCommand {font-weight:bold;}

.shadow .title {color:[[ColorPalette::TertiaryDark]];}

.title {color:[[ColorPalette::SecondaryDark]];}
.subtitle {color:[[ColorPalette::TertiaryDark]];}

.toolbar {color:[[ColorPalette::PrimaryMid]];}
.toolbar a {color:[[ColorPalette::TertiaryLight]];}
.selected .toolbar a {color:[[ColorPalette::TertiaryMid]];}
.selected .toolbar a:hover {color:[[ColorPalette::Foreground]];}

.tagging, .tagged {border:1px solid [[ColorPalette::TertiaryPale]]; background-color:[[ColorPalette::TertiaryPale]];}
.selected .tagging, .selected .tagged {background-color:[[ColorPalette::TertiaryLight]]; border:1px solid [[ColorPalette::TertiaryMid]];}
.tagging .listTitle, .tagged .listTitle {color:[[ColorPalette::PrimaryDark]];}
.tagging .button, .tagged .button {border:none;}

.footer {color:[[ColorPalette::TertiaryLight]];}
.selected .footer {color:[[ColorPalette::TertiaryMid]];}

.sparkline {background:[[ColorPalette::PrimaryPale]]; border:0;}
.sparktick {background:[[ColorPalette::PrimaryDark]];}

.error, .errorButton {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::Error]];}
.warning {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::SecondaryPale]];}
.lowlight {background:[[ColorPalette::TertiaryLight]];}

.zoomer {background:none; color:[[ColorPalette::TertiaryMid]]; border:3px solid [[ColorPalette::TertiaryMid]];}

.imageLink, #displayArea .imageLink {background:transparent;}

.annotation {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; border:2px solid [[ColorPalette::SecondaryMid]];}

.viewer .listTitle {list-style-type:none; margin-left:-2em;}
.viewer .button {border:1px solid [[ColorPalette::SecondaryMid]];}
.viewer blockquote {border-left:3px solid [[ColorPalette::TertiaryDark]];}

.viewer table, table.twtable {border:2px solid [[ColorPalette::TertiaryDark]];}
.viewer th, .viewer thead td, .twtable th, .twtable thead td {background:[[ColorPalette::SecondaryMid]]; border:1px solid [[ColorPalette::TertiaryDark]]; color:[[ColorPalette::Background]];}
.viewer td, .viewer tr, .twtable td, .twtable tr {border:1px solid [[ColorPalette::TertiaryDark]];}

.viewer pre {border:1px solid [[ColorPalette::SecondaryLight]]; background:[[ColorPalette::SecondaryPale]];}
.viewer code {color:[[ColorPalette::SecondaryDark]];}
.viewer hr {border:0; border-top:dashed 1px [[ColorPalette::TertiaryDark]]; color:[[ColorPalette::TertiaryDark]];}

.highlight, .marked {background:[[ColorPalette::SecondaryLight]];}

.editor input {border:1px solid [[ColorPalette::PrimaryMid]];}
.editor textarea {border:1px solid [[ColorPalette::PrimaryMid]]; width:100%;}
.editorFooter {color:[[ColorPalette::TertiaryMid]];}
.readOnly {background:[[ColorPalette::TertiaryPale]];}

#backstageArea {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::TertiaryMid]];}
#backstageArea a {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::Background]]; border:none;}
#backstageArea a:hover {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; }
#backstageArea a.backstageSelTab {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}
#backstageButton a {background:none; color:[[ColorPalette::Background]]; border:none;}
#backstageButton a:hover {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::Background]]; border:none;}
#backstagePanel {background:[[ColorPalette::Background]]; border-color: [[ColorPalette::Background]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]];}
.backstagePanelFooter .button {border:none; color:[[ColorPalette::Background]];}
.backstagePanelFooter .button:hover {color:[[ColorPalette::Foreground]];}
#backstageCloak {background:[[ColorPalette::Foreground]]; opacity:0.6; filter:'alpha(opacity=60)';}
/*}}}*/</pre>
</div>
<div title="StyleSheetLayout">
<pre>/*{{{*/
* html .tiddler {height:1%;}

body {font-size:.75em; font-family:arial,helvetica; margin:0; padding:0;}

h1,h2,h3,h4,h5,h6 {font-weight:bold; text-decoration:none;}
h1,h2,h3 {padding-bottom:1px; margin-top:1.2em;margin-bottom:0.3em;}
h4,h5,h6 {margin-top:1em;}
h1 {font-size:1.35em;}
h2 {font-size:1.25em;}
h3 {font-size:1.1em;}
h4 {font-size:1em;}
h5 {font-size:.9em;}

hr {height:1px;}

a {text-decoration:none;}

dt {font-weight:bold;}

ol {list-style-type:decimal;}
ol ol {list-style-type:lower-alpha;}
ol ol ol {list-style-type:lower-roman;}
ol ol ol ol {list-style-type:decimal;}
ol ol ol ol ol {list-style-type:lower-alpha;}
ol ol ol ol ol ol {list-style-type:lower-roman;}
ol ol ol ol ol ol ol {list-style-type:decimal;}

.txtOptionInput {width:11em;}

#contentWrapper .chkOptionInput {border:0;}

.externalLink {text-decoration:underline;}

.indent {margin-left:3em;}
.outdent {margin-left:3em; text-indent:-3em;}
code.escaped {white-space:nowrap;}

.tiddlyLinkExisting {font-weight:bold;}
.tiddlyLinkNonExisting {font-style:italic;}

/* the 'a' is required for IE, otherwise it renders the whole tiddler in bold */
a.tiddlyLinkNonExisting.shadow {font-weight:bold;}

#mainMenu .tiddlyLinkExisting,
	#mainMenu .tiddlyLinkNonExisting,
	#sidebarTabs .tiddlyLinkNonExisting {font-weight:normal; font-style:normal;}
#sidebarTabs .tiddlyLinkExisting {font-weight:bold; font-style:normal;}

.header {position:relative;}
.header a:hover {background:transparent;}
.headerShadow {position:relative; padding:4.5em 0 1em 1em; left:-1px; top:-1px;}
.headerForeground {position:absolute; padding:4.5em 0 1em 1em; left:0px; top:0px;}

.siteTitle {font-size:3em;}
.siteSubtitle {font-size:1.2em;}

#mainMenu {position:absolute; left:0; width:10em; text-align:right; line-height:1.6em; padding:1.5em 0.5em 0.5em 0.5em; font-size:1.1em;}

#sidebar {position:absolute; right:3px; width:16em; font-size:.9em;}
#sidebarOptions {padding-top:0.3em;}
#sidebarOptions a {margin:0 0.2em; padding:0.2em 0.3em; display:block;}
#sidebarOptions input {margin:0.4em 0.5em;}
#sidebarOptions .sliderPanel {margin-left:1em; padding:0.5em; font-size:.85em;}
#sidebarOptions .sliderPanel a {font-weight:bold; display:inline; padding:0;}
#sidebarOptions .sliderPanel input {margin:0 0 0.3em 0;}
#sidebarTabs .tabContents {width:15em; overflow:hidden;}

.wizard {padding:0.1em 1em 0 2em;}
.wizard h1 {font-size:2em; font-weight:bold; background:none; padding:0; margin:0.4em 0 0.2em;}
.wizard h2 {font-size:1.2em; font-weight:bold; background:none; padding:0; margin:0.4em 0 0.2em;}
.wizardStep {padding:1em 1em 1em 1em;}
.wizard .button {margin:0.5em 0 0; font-size:1.2em;}
.wizardFooter {padding:0.8em 0.4em 0.8em 0;}
.wizardFooter .status {padding:0 0.4em; margin-left:1em;}
.wizard .button {padding:0.1em 0.2em;}

#messageArea {position:fixed; top:2em; right:0; margin:0.5em; padding:0.5em; z-index:2000; _position:absolute;}
.messageToolbar {display:block; text-align:right; padding:0.2em;}
#messageArea a {text-decoration:underline;}

.tiddlerPopupButton {padding:0.2em;}
.popupTiddler {position: absolute; z-index:300; padding:1em; margin:0;}

.popup {position:absolute; z-index:300; font-size:.9em; padding:0; list-style:none; margin:0;}
.popup .popupMessage {padding:0.4em;}
.popup hr {display:block; height:1px; width:auto; padding:0; margin:0.2em 0;}
.popup li.disabled {padding:0.4em;}
.popup li a {display:block; padding:0.4em; font-weight:normal; cursor:pointer;}
.listBreak {font-size:1px; line-height:1px;}
.listBreak div {margin:2px 0;}

.tabset {padding:1em 0 0 0.5em;}
.tab {margin:0 0 0 0.25em; padding:2px;}
.tabContents {padding:0.5em;}
.tabContents ul, .tabContents ol {margin:0; padding:0;}
.txtMainTab .tabContents li {list-style:none;}
.tabContents li.listLink { margin-left:.75em;}

#contentWrapper {display:block;}
#splashScreen {display:none;}

#displayArea {margin:1em 17em 0 14em;}

.toolbar {text-align:right; font-size:.9em;}

.tiddler {padding:1em 1em 0;}

.missing .viewer,.missing .title {font-style:italic;}

.title {font-size:1.6em; font-weight:bold;}

.missing .subtitle {display:none;}
.subtitle {font-size:1.1em;}

.tiddler .button {padding:0.2em 0.4em;}

.tagging {margin:0.5em 0.5em 0.5em 0; float:left; display:none;}
.isTag .tagging {display:block;}
.tagged {margin:0.5em; float:right;}
.tagging, .tagged {font-size:0.9em; padding:0.25em;}
.tagging ul, .tagged ul {list-style:none; margin:0.25em; padding:0;}
.tagClear {clear:both;}

.footer {font-size:.9em;}
.footer li {display:inline;}

.annotation {padding:0.5em; margin:0.5em;}

* html .viewer pre {width:99%; padding:0 0 1em 0;}
.viewer {line-height:1.4em; padding-top:0.5em;}
.viewer .button {margin:0 0.25em; padding:0 0.25em;}
.viewer blockquote {line-height:1.5em; padding-left:0.8em;margin-left:2.5em;}
.viewer ul, .viewer ol {margin-left:0.5em; padding-left:1.5em;}

.viewer table, table.twtable {border-collapse:collapse; margin:0.8em 1.0em;}
.viewer th, .viewer td, .viewer tr,.viewer caption,.twtable th, .twtable td, .twtable tr,.twtable caption {padding:3px;}
table.listView {font-size:0.85em; margin:0.8em 1.0em;}
table.listView th, table.listView td, table.listView tr {padding:0px 3px 0px 3px;}

.viewer pre {padding:0.5em; margin-left:0.5em; font-size:1.2em; line-height:1.4em; overflow:auto;}
.viewer code {font-size:1.2em; line-height:1.4em;}

.editor {font-size:1.1em;}
.editor input, .editor textarea {display:block; width:100%; font:inherit;}
.editorFooter {padding:0.25em 0; font-size:.9em;}
.editorFooter .button {padding-top:0px; padding-bottom:0px;}

.fieldsetFix {border:0; padding:0; margin:1px 0px;}

.sparkline {line-height:1em;}
.sparktick {outline:0;}

.zoomer {font-size:1.1em; position:absolute; overflow:hidden;}
.zoomer div {padding:1em;}

* html #backstage {width:99%;}
* html #backstageArea {width:99%;}
#backstageArea {display:none; position:relative; overflow: hidden; z-index:150; padding:0.3em 0.5em;}
#backstageToolbar {position:relative;}
#backstageArea a {font-weight:bold; margin-left:0.5em; padding:0.3em 0.5em;}
#backstageButton {display:none; position:absolute; z-index:175; top:0; right:0;}
#backstageButton a {padding:0.1em 0.4em; margin:0.1em;}
#backstage {position:relative; width:100%; z-index:50;}
#backstagePanel {display:none; z-index:100; position:absolute; width:90%; margin-left:3em; padding:1em;}
.backstagePanelFooter {padding-top:0.2em; float:right;}
.backstagePanelFooter a {padding:0.2em 0.4em;}
#backstageCloak {display:none; z-index:20; position:absolute; width:100%; height:100px;}

.whenBackstage {display:none;}
.backstageVisible .whenBackstage {display:block;}
/*}}}*/
</pre>
</div>
<div title="StyleSheetLocale">
<pre>/***
StyleSheet for use when a translation requires any css style changes.
This StyleSheet can be used directly by languages such as Chinese, Japanese and Korean which need larger font sizes.
***/
/*{{{*/
body {font-size:0.8em;}
#sidebarOptions {font-size:1.05em;}
#sidebarOptions a {font-style:normal;}
#sidebarOptions .sliderPanel {font-size:0.95em;}
.subtitle {font-size:0.8em;}
.viewer table.listView {font-size:0.95em;}
/*}}}*/</pre>
</div>
<div title="StyleSheetPrint">
<pre>/*{{{*/
@media print {
#mainMenu, #sidebar, #messageArea, .toolbar, #backstageButton, #backstageArea {display: none !important;}
#displayArea {margin: 1em 1em 0em;}
noscript {display:none;} /* Fixes a feature in Firefox 1.5.0.2 where print preview displays the noscript content */
}
/*}}}*/</pre>
</div>
<div title="PageTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='header' macro='gradient vert [[ColorPalette::PrimaryLight]] [[ColorPalette::PrimaryMid]]'&gt;
&lt;div class='headerShadow'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;div class='headerForeground'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id='mainMenu' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;
&lt;div id='sidebar'&gt;
&lt;div id='sidebarOptions' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;
&lt;div id='sidebarTabs' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id='displayArea'&gt;
&lt;div id='messageArea'&gt;&lt;/div&gt;
&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="ViewTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::ViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='view modified date'&gt;&lt;/span&gt; (&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="EditTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::EditToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit title'&gt;&lt;/div&gt;
&lt;div macro='annotations'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit text'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit tags'&gt;&lt;/div&gt;&lt;div class='editorFooter'&gt;&lt;span macro='message views.editor.tagPrompt'&gt;&lt;/span&gt;&lt;span macro='tagChooser excludeLists'&gt;&lt;/span&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="GettingStarted">
<pre>To get started with this blank [[TiddlyWiki]], you'll need to modify the following tiddlers:
* [[SiteTitle]] &amp; [[SiteSubtitle]]: The title and subtitle of the site, as shown above (after saving, they will also appear in the browser title bar)
* [[MainMenu]]: The menu (usually on the left)
* [[DefaultTiddlers]]: Contains the names of the tiddlers that you want to appear when the TiddlyWiki is opened
You'll also need to enter your username for signing your edits: &lt;&lt;option txtUserName&gt;&gt;</pre>
</div>
<div title="OptionsPanel">
<pre>These [[InterfaceOptions]] for customising [[TiddlyWiki]] are saved in your browser

Your username for signing your edits. Write it as a [[WikiWord]] (eg [[JoeBloggs]])

&lt;&lt;option txtUserName&gt;&gt;
&lt;&lt;option chkSaveBackups&gt;&gt; [[SaveBackups]]
&lt;&lt;option chkAutoSave&gt;&gt; [[AutoSave]]
&lt;&lt;option chkRegExpSearch&gt;&gt; [[RegExpSearch]]
&lt;&lt;option chkCaseSensitiveSearch&gt;&gt; [[CaseSensitiveSearch]]
&lt;&lt;option chkAnimate&gt;&gt; [[EnableAnimations]]

----
Also see [[AdvancedOptions]]</pre>
</div>
<div title="ImportTiddlers">
<pre>&lt;&lt;importTiddlers&gt;&gt;</pre>
</div>
</div>
<!--POST-SHADOWAREA-->

<!--TIDDLYSPOT_INJECT-->
<div style="display:none"><img src="http://tiddlyspot.com/_ts/stats/coursebook"/></div>
<!--TCEJNI_TOPSYLDDIT-->

<!--TIDDLYSPOT_INJECT-->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">_uacct="UA-96965-3";urchinTracker();</script>

<!--TCEJNI_TOPSYLDDIT-->
<div id="storeArea">
<div title="(default) http://tiddlywiki.abego-software.de" modifier="JohnRouillard" created="200903151906" modified="200903292300" tags="systemServer InstructorOnly excludeLists">
<pre>|''Type:''|file|
|''URL:''|http://tiddlywiki.abego-software.de|
|''Workspace:''|(default)|

This tiddler was automatically created to record the details of this server</pre>
</div>
<div title="(default) http://visualtw.ouvaton.org/VisualTW.html" modifier="JohnRouillard" created="200903151906" modified="200903222303" tags="systemServer InstructorOnly excludeLists">
<pre>|''Type:''|file|
|''URL:''|http://visualtw.ouvaton.org/VisualTW.html|
|''Workspace:''|(default)|

This tiddler was automatically created to record the details of this server</pre>
</div>
<div title="(default) http://www.cs.umb.edu/~rouilj/courses/SEC_intermediate/SEC_tw.html" modifier="JohnRouillard" created="200903152120" modified="200908090115" tags="systemServer InstructorOnly excludeLists">
<pre>|''Type:''|file|
|''URL:''|http://www.cs.umb.edu/~rouilj/courses/SEC_intermediate/SEC_tw.html|
|''Workspace:''|(default)|

This tiddler was automatically created to record the details of this server</pre>
</div>
<div title="(default) http://www.math.ist.utl.pt/~psoares/addons.html" modifier="JohnRouillard" created="200903230151" tags="systemServer InstructorOnly excludeLists">
<pre>|''Type:''|file|
|''URL:''|http://www.math.ist.utl.pt/~psoares/addons.html|
|''Workspace:''|(default)|

This tiddler was automatically created to record the details of this server</pre>
</div>
<div title="(default) on http://www.tiddlytools.com" modifier="JohnRouillard" created="200903151848" modified="200903222302" tags="systemServer InstructorOnly excludeLists">
<pre>|''Type:''|file|
|''URL:''|http://www.tiddlytools.com|
|''Workspace:''|(default)|

This tiddler was automatically created to record the details of this server</pre>
</div>
<div title="AddTiddlerToBookmarks" modifier="JohnRouillard" created="201007170410" modified="201007170456" tags="structure">
<pre>&lt;script label=&quot;bookmark&quot; title=&quot;Add this tiddler to the Bookmarks list&quot;&gt;
// Copied in part from Eric Schulman's MessageLogPlugin

var log = &quot;BookmarkList&quot;;

var tid=store.getTiddler(log);
if (tid) { // update BookmarkList
      var out=store.getTiddlerText(log,&quot;&quot;)+'\n[['+story.findContainingTiddler(place).getAttribute(&quot;tiddler&quot;)+']]';
      var who=config.options.chkForceMinorUpdate?tid.modifier:config.options.txtUserName;
      var when=config.options.chkForceMinorUpdate?tid.modified:new Date();

      store.saveTiddler(log,log,out,who,when,tid.tags,tid.fields);
}
if (!story.isDirty(log)) story.refreshTiddler(log,null,true); // only if log is not being edited
&lt;/script&gt;
</pre>
</div>
<div title="AliasPlugin" modifier="ELSDesignStudios" created="200509280700" modified="200909091131" tags="systemConfig">
<pre>/***
|Name|AliasPlugin|
|Source|http://www.TiddlyTools.com/#AliasPlugin|
|Documentation|http://www.TiddlyTools.com/#AliasPluginInfo|
|Version|1.1.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides||
|Description|Create text-substitution macros|
Define macros for abbreviations and other &quot;aliases&quot;, and then embed them in the rest of your tiddler content to quickly insert common terms, phrases and links without a lot of repetitive typing.
!!!!!Documentation
&gt; see [[AliasPluginInfo]]
!!!!!Revisions
&lt;&lt;&lt;
2009.09.09 [1.1.1] 'tiddler' arg passed to wikify() so aliases containing macros render with correct context
| Please see [[AliasPluginInfo]] for previous revision details |
2005.08.12 [1.0.0] initial release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.AliasPlugin= {major: 1, minor: 1, revision: 1, date: new Date(2009,9,9)};
config.macros.alias= { };
config.macros.alias.handler = function(place,macroName,params,wikifier,paramString,tiddler) {
	var alias=params.shift(); if (!alias) return; alias=alias.replace(/ /g,&quot;_&quot;); // don't allow spaces in alias
	if (config.macros[alias]==undefined) { // create new macro (as needed)
		config.macros[alias] = { };
		config.macros[alias].handler =
			function (place,macroName,params,wikifier,paramString,tiddler)
				{ wikify(config.macros[macroName].text.format(params),place,null,tiddler); }
	}
	config.macros[alias].text = params[0]?params.join(' '):alias;	// set alias text
}
//}}}</pre>
</div>
<div title="AllUrls" modifier="JohnRouillard" created="200909050613" modified="200909052346" tags="InstructorOnly">
<pre>http://url1
----
http://url2
----
https://url3
----
http://url4
----
&lt;&lt;tiddler &quot;GettingStarted::courseHomeContent&quot;&gt;&gt;</pre>
</div>
<div title="AnnotationsPlugin" modifier="JohnRouillard" created="200710181503" modified="200908082015" tags="lewcidExtension systemConfig excludeMissing PatchedPlugin">
<pre>/***
|''Name:''|AnnotationsPlugin|
|''Description:''|Inline annotations for tiddler text.|
|''Author:''|Saq Imtiaz ( lewcid@gmail.com )|
|''Source:''|http://tw.lewcid.org/#AnnotationsPlugin|
|''Code Repository:''|http://tw.lewcid.org/svn/plugins|
|''Version:''|2.0|
|''Date:''||
|''License:''|[[Creative Commons Attribution-ShareAlike 3.0 License|http://creativecommons.org/licenses/by-sa/3.0/]]|
|''~CoreVersion:''|2.2.3|

!!Usage:
*{{{((text to annotate(annotation goes here)))}}}
* To include the text being annotated, in the popup as a title, put {{{^}}} as the first letter of the annotation text.
** {{{((text to annotate(^annotation goes here)))}}}

!!Examples:
Mouse over, the text below:
* ((banana(the best fruit in the world)))
* ((banana(^ the best fruit in the world)))

***/
// /%
config.formatters.unshift({name:&quot;annotations&quot;,match:&quot;\\(\\(&quot;,lookaheadRegExp:/\(\((.*?)\((\^?)((?:.|\n)*?)\)\)\)/g,handler:function(w){
this.lookaheadRegExp.lastIndex=w.matchStart;
var _2=this.lookaheadRegExp.exec(w.source);
if(_2&amp;&amp;_2.index==w.matchStart){
var _3=createTiddlyElement(w.output,&quot;span&quot;,null,&quot;annosub&quot;,_2[1]);
_3.anno=_2[3];
if(_2[2]){
_3.subject=_2[1];
}
_3.onmouseover=this.onmouseover;
_3.onmouseout=this.onmouseout;
_3.ondblclick=this.onmouseout;
w.nextMatch=_2.index+_2[0].length;
}
},onmouseover:function(e){
popup=createTiddlyElement(document.body,&quot;div&quot;,null,&quot;anno&quot;);
this.popup=popup;
if(this.subject){
wikify(&quot;!&quot;+this.subject+&quot;\n&quot;,popup);
}
wikify(this.anno,popup);
addClass(this,&quot;annosubover&quot;);
Popup.place(this,popup,{x:25,y:7});
},onmouseout:function(e){
removeNode(this.popup);
this.popup=null;
removeClass(this,&quot;annosubover&quot;);
}});
setStylesheet(&quot;.anno{position:absolute;border:2px solid #000;background-color:#DFDFFF; color:#000;padding:0.5em;max-width:15em;width:expression(document.body.clientWidth &gt; (255/12) *parseInt(document.body.currentStyle.fontSize)?'15em':'auto' );}\n&quot;+&quot;.anno h1, .anno h2{margin-top:0;color:#000;}\n&quot;+&quot;.annosub{background:#ccc;}\n&quot;+&quot;.annosubover{z-index:25; background-color:#DFDFFF;cursor:help;}\n&quot;,&quot;AnnotationStyles&quot;);


// %/</pre>
</div>
<div title="Any Questions?" modifier="YourName" created="201007252123" modified="201007252303" tags="slide content">
<pre>&lt;&lt;tiddler SlideSubstyle##levelTwo&gt;&gt;
!Any 
*quips
*comments
*evasions
*questions
*answers</pre>
</div>
<div title="Areas for Improvement" modifier="YourName" created="201007252044" modified="201007260351" tags="slide content">
<pre>&lt;&lt;tiddler SlideSubstyle##levelOne with: 'url(&quot;textbooks.gif&quot;)'&gt;&gt;
! There are a number of areas that can use some improvement:
* {{overlay1{tags underused}}}
* {{overlay2{more flexibility with themes}}}
* {{overlay3{discovering relations between tiddlers}}}
* {{overlay4{edit cycle with multiple users}}}
</pre>
</div>
<div title="AttachFileMIMETypes" modifier="ELSDesignStudios" created="200605131756" modified="200605150121" tags="AttachFilePackage settings InstructorOnly">
<pre>text/plain
.txt .text .js .vbs .asp .cgi .pl
----
text/html
.htm .html .hta .htx .mht
----
text/comma-separated-values
.csv
----
text/javascript
.js
----
text/css
.css
----
text/xml
.xml .xsl .xslt
----
image/gif
.gif
----
image/jpeg
.jpg .jpe .jpeg
----
image/png
.png
----
image/bmp
.bmp
----
image/tiff
.tif .tiff
----
audio/basic
.au .snd
----
audio/wav
.wav
----
audio/x-pn-realaudio
.ra .rm .ram
----
audio/x-midi
.mid .midi
----
audio/mp3
.mp3
----
audio/m3u
.m3u
----
video/x-ms-asf
.asf
----
video/avi
.avi
----
video/mpeg
.mpg .mpeg
----
video/quicktime
.qt .mov .qtvr
----
application/pdf
.pdf
----
application/rtf
.rtf
----
application/postscript
.ai .eps .ps
----
application/wordperfect
.wpd
----
application/mswrite
.wri
----
application/msexcel
.xls .xls3 .xls4 .xls5 .xlw
----
application/msword
.doc
----
application/mspowerpoint
.ppt .pps
----
application/x-director
.swa
----
application/x-shockwave-flash
.swf
----
application/x-zip-compressed
.zip
----
application/x-gzip
.gz
----
application/x-rar-compressed
.rar
----
application/octet-stream
.com .exe .dll .ocx
----
application/java-archive
.jar</pre>
</div>
<div title="AttachFilePlugin" modifier="ELSDesignStudios" created="200512271908" modified="200906041834" tags="AttachFilePackage IconPackage systemConfig excludeMissing InstructorOnly">
<pre>/***
|Name|AttachFilePlugin|
|Source|http://www.TiddlyTools.com/#AttachFilePlugin|
|Documentation|http://www.TiddlyTools.com/#AttachFilePluginInfo|
|Version|4.0.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.1|
|Type|plugin|
|Requires|AttachFilePluginFormatters, AttachFileMIMETypes|
|Overrides||
|Description|Store binary files as base64-encoded tiddlers with fallback links for separate local and/or remote file storage|
Store or link binary files (such as jpg, gif, pdf or even mp3) within your TiddlyWiki document and then use them as images or links from within your tiddler content.
&gt; Important note: As of version 3.6.0, in order to //render// images and other binary attachments created with this plugin, you must also install [[AttachFilePluginFormatters]], which extends the behavior of the TiddlyWiki core formatters for embedded images ({{{[img[tooltip|image]]}}}), linked embedded images ({{{[img[tooltip|image][link]]}}}), and external/&quot;pretty&quot; links ({{{[[label|link]]}}}), so that these formatter will process references to attachment tiddlers as if a normal file reference had been provided. |
!!!!!Documentation
&gt;see [[AttachFilePluginInfo]]
!!!!!Inline interface (live)
&gt;see [[AttachFile]] (shadow tiddler)
&gt;&lt;&lt;tiddler AttachFile&gt;&gt;
!!!!!Revisions
&lt;&lt;&lt;
2009.06.04 [4.0.0] changed attachment storage format to use //sections// instead of embedded substring markers.
|please see [[AttachFilePluginInfo]] for additional revision details|
2005.07.20 [1.0.0] Initial Release
&lt;&lt;&lt;
!!!!!Code
***/
// // version
//{{{
version.extensions.AttachFilePlugin= {major: 4, minor: 0, revision: 0, date: new Date(2009,6,4)};

// shadow tiddler
config.shadowTiddlers.AttachFile=&quot;&lt;&lt;attach inline&gt;&gt;&quot;;

// add 'attach' backstage task (insert before built-in 'importTask')
if (config.tasks) { // for TW2.2b or above
	config.tasks.attachTask = {
		text: &quot;attach&quot;,
		tooltip: &quot;Attach a binary file as a tiddler&quot;,
		content: &quot;&lt;&lt;attach inline&gt;&gt;&quot;
	}
	config.backstageTasks.splice(config.backstageTasks.indexOf(&quot;importTask&quot;),0,&quot;attachTask&quot;);
}

config.macros.attach = {
// // lingo
//{{{
	label: &quot;attach file&quot;,
	tooltip: &quot;Attach a file to this document&quot;,
	linkTooltip: &quot;Attachment: &quot;,

	typeList: &quot;AttachFileMIMETypes&quot;,

	titlePrompt: &quot; enter tiddler title...&quot;,
	MIMEPrompt: &quot;&lt;option value=''&gt;select MIME type...&lt;/option&gt;&lt;option value='editlist'&gt;[edit list...]&lt;/option&gt;&quot;,
	localPrompt: &quot; enter local path/filename...&quot;,
	URLPrompt: &quot; enter remote URL...&quot;,

	tiddlerErr: &quot;Please enter a tiddler title&quot;,
	sourceErr: &quot;Please enter a source path/filename&quot;,
	storageErr: &quot;Please select a storage method: embedded, local or remote&quot;,
	MIMEErr: &quot;Unrecognized file format.  Please select a MIME type&quot;,
	localErr: &quot;Please enter a local path/filename&quot;,
	URLErr: &quot;Please enter a remote URL&quot;,
	fileErr: &quot;Invalid path/file or file not found&quot;,

	tiddlerFormat: '!usage\n{{{%0}}}\n%0\n!notes\n%1\n!type\n%2\n!file\n%3\n!url\n%4\n!data\n%5\n',

//}}}
// // macro definition
//{{{
	handler:
	function(place,macroName,params) {
		if (params &amp;&amp; !params[0])
			{ createTiddlyButton(place,this.label,this.tooltip,this.toggleAttachPanel); return; }
		var id=params.shift();
		this.createAttachPanel(place,id+&quot;_attachPanel&quot;,params);
		document.getElementById(id+&quot;_attachPanel&quot;).style.position=&quot;static&quot;;
		document.getElementById(id+&quot;_attachPanel&quot;).style.display=&quot;block&quot;;
	},
//}}}
//{{{
	createAttachPanel:
	function(place,panel_id,params) {
		if (!panel_id || !panel_id.length) var panel_id=&quot;_attachPanel&quot;;
		// remove existing panel (if any)
		var panel=document.getElementById(panel_id); if (panel) panel.parentNode.removeChild(panel);
		// set styles for this panel
		setStylesheet(this.css,&quot;attachPanel&quot;);
		// create new panel
		var title=&quot;&quot;; if (params &amp;&amp; params[0]) title=params.shift();
		var types=this.MIMEPrompt+this.formatListOptions(store.getTiddlerText(this.typeList)); // get MIME types
		panel=createTiddlyElement(place,&quot;span&quot;,panel_id,&quot;attachPanel&quot;,null);
		var html=this.html.replace(/%id%/g,panel_id);
		html=html.replace(/%title%/g,title);
		html=html.replace(/%disabled%/g,title.length?&quot;disabled&quot;:&quot;&quot;);
		html=html.replace(/%IEdisabled%/g,config.browser.isIE?&quot;disabled&quot;:&quot;&quot;);
		html=html.replace(/%types%/g,types);
		panel.innerHTML=html;
		if (config.browser.isGecko) { // FF3 FIXUP
			document.getElementById(&quot;attachSource&quot;).style.display=&quot;none&quot;;
			document.getElementById(&quot;attachFixPanel&quot;).style.display=&quot;block&quot;;
		}
		return panel;
	},
//}}}
//{{{
	toggleAttachPanel:
	function (e) {
		if (!e) var e = window.event;
		var parent=resolveTarget(e).parentNode;
		var panel = document.getElementById(&quot;_attachPanel&quot;);
		if (panel==undefined || panel.parentNode!=parent)
			panel=config.macros.attach.createAttachPanel(parent,&quot;_attachPanel&quot;);
		var isOpen = panel.style.display==&quot;block&quot;;
		if(config.options.chkAnimate)
			anim.startAnimating(new Slider(panel,!isOpen,e.shiftKey || e.altKey,&quot;none&quot;));
		else
			panel.style.display = isOpen ? &quot;none&quot; : &quot;block&quot; ;
		e.cancelBubble = true;
		if (e.stopPropagation) e.stopPropagation();
		return(false);
	},
//}}}
//{{{
	formatListOptions:
	function(text) {
		if (!text || !text.trim().length) return &quot;&quot;;
		// get MIME list content from text
		var parts=text.split(&quot;\n----\n&quot;);
		var out=&quot;&quot;;
		for (var p=0; p&lt;parts.length; p++) {
			var lines=parts[p].split(&quot;\n&quot;);
			var label=lines.shift(); // 1st line=display text
			var value=lines.shift(); // 2nd line=item value
			out +='&lt;option value=&quot;%1&quot;&gt;%0&lt;/option&gt;'.format([label,value]);
		}
		return out;
	},
//}}}
// // interface definition
//{{{
	css:
	&quot;.attachPanel { display: none; position:absolute; z-index:10; width:35em; right:105%; top:0em;\
		background-color: #eee; color:#000; font-size: 8pt; line-height:110%;\
		border:1px solid black; border-bottom-width: 3px; border-right-width: 3px;\
		padding: 0.5em; margin:0em; -moz-border-radius:1em;-webkit-border-radius:1em; text-align:left }\
	.attachPanel form { display:inline;border:0;padding:0;margin:0; }\
	.attachPanel select { width:99%;margin:0px;font-size:8pt;line-height:110%;}\
	.attachPanel input  { width:98%;padding:0px;margin:0px;font-size:8pt;line-height:110%}\
	.attachPanel textarea { width:98%;margin:0px;height:2em;font-size:8pt;line-height:110%}\
	.attachPanel table { width:100%;border:0;margin:0;padding:0;color:inherit; }\
	.attachPanel tbody, .attachPanel tr, .attachPanel td { border:0;margin:0;padding:0;color:#000; }\
	.attachPanel .box { border:1px solid black; padding:.3em; margin:.3em 0px; background:#f8f8f8; \
		-moz-border-radius:5px;-webkit-border-radius:5px; }\
	.attachPanel .chk { width:auto;border:0; }\
	.attachPanel .btn { width:auto; }\
	.attachPanel .btn2 { width:49%; }\
	&quot;,
//}}}
//{{{
	html:
	'&lt;form&gt;\
		attach from source file\
		&lt;input type=&quot;file&quot; id=&quot;attachSource&quot; name=&quot;source&quot; size=&quot;56&quot;\
			onChange=&quot;config.macros.attach.onChangeSource(this)&quot;&gt;\
		&lt;div id=&quot;attachFixPanel&quot; style=&quot;display:none&quot;&gt;&lt;!-- FF3 FIXUP --&gt;\
			&lt;input type=&quot;text&quot; id=&quot;attachFixSource&quot; style=&quot;width:90%&quot;\
				title=&quot;Enter a path/file to attach&quot;\
				onChange=&quot;config.macros.attach.onChangeSource(this);&quot;&gt;\
			&lt;input type=&quot;button&quot; style=&quot;width:7%&quot; value=&quot;...&quot;\
				title=&quot;Enter a path/file to attach&quot;\
				onClick=&quot;config.macros.attach.askForFilename(document.getElementById(\'attachFixSource\'));&quot;&gt;\
		&lt;/div&gt;&lt;!--end FF3 FIXUP--&gt;\
		&lt;div class=&quot;box&quot;&gt;\
		&lt;table style=&quot;border:0&quot;&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;width:1%;white-space:nowrap&quot;&gt;\
			embed data &lt;input type=checkbox class=chk name=&quot;useData&quot; %IEdisabled% \
				onclick=&quot;if (!this.form.MIMEType.value.length)\
					this.form.MIMEType.selectedIndex=this.checked?1:0; &quot;&gt;&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot;&gt;\
			&lt;select size=1 name=&quot;MIMEType&quot; \
				onchange=&quot;this.title=this.value; if (this.value==\'editlist\')\
					{ this.selectedIndex=this.form.useData.checked?1:0; story.displayTiddler(null,config.macros.attach.typeList,2); return; }&quot;&gt;\
				&lt;option value=&quot;&quot;&gt;&lt;/option&gt;\
				%types%\
			&lt;/select&gt;\
		&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;width:1%;white-space:nowrap&quot;&gt;\
			local link &lt;input type=checkbox class=chk name=&quot;useLocal&quot;\
				onclick=&quot;this.form.local.value=this.form.local.defaultValue=this.checked?config.macros.attach.localPrompt:\'\';&quot;&gt;&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot;&gt;\
			&lt;input type=text name=&quot;local&quot; size=15 autocomplete=off value=&quot;&quot;\
				onchange=&quot;this.form.useLocal.checked=this.value.length&quot; \
				onkeyup=&quot;this.form.useLocal.checked=this.value.length&quot; \
				onfocus=&quot;if (!this.value.length) this.value=config.macros.attach.localPrompt; this.select()&quot;&gt;\
		&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;width:1%;white-space:nowrap&quot;&gt;\
			remote link &lt;input type=checkbox class=chk name=&quot;useURL&quot;\
				onclick=&quot;this.form.URL.value=this.form.URL.defaultValue=this.checked?config.macros.attach.URLPrompt:\'\';\&quot;&gt;&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot;&gt;\
			&lt;input type=text name=&quot;URL&quot; size=15 autocomplete=off value=&quot;&quot;\
				onfocus=&quot;if (!this.value.length) this.value=config.macros.attach.URLPrompt; this.select()&quot;\
				onchange=&quot;this.form.useURL.checked=this.value.length;&quot;\
				onkeyup=&quot;this.form.useURL.checked=this.value.length;&quot;&gt;\
		&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\
		&lt;/div&gt;\
		&lt;table style=&quot;border:0&quot;&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;vertical-align:top;width:1%;white-space:nowrap&quot;&gt;\
			notes&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot; colspan=2&gt;\
			&lt;textarea name=&quot;notes&quot; style=&quot;width:98%;height:3.5em;margin-bottom:2px&quot;&gt;&lt;/textarea&gt;\
		&lt;/td&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;width:1%;white-space:nowrap&quot;&gt;\
			attach as&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot; colspan=2&gt;\
			&lt;input type=text name=&quot;tiddlertitle&quot; size=15 autocomplete=off value=&quot;%title%&quot;\
				onkeyup=&quot;if (!this.value.length) { this.value=config.macros.attach.titlePrompt; this.select(); }&quot;\
				onfocus=&quot;if (!this.value.length) this.value=config.macros.attach.titlePrompt; this.select()&quot; %disabled%&gt;\
		&lt;/td&gt;&lt;/tr&gt;&lt;/tr&gt;&lt;tr style=&quot;border:0&quot;&gt;&lt;td style=&quot;border:0;text-align:right;width:1%;white-space:nowrap&quot;&gt;\
			add tags&amp;nbsp;\
		&lt;/td&gt;&lt;td style=&quot;border:0&quot;&gt;\
			&lt;input type=text name=&quot;tags&quot; size=15 autocomplete=off value=&quot;&quot; onfocus=&quot;this.select()&quot;&gt;\
		&lt;/td&gt;&lt;td style=&quot;width:40%;text-align:right;border:0&quot;&gt;\
			&lt;input type=button class=btn2 value=&quot;attach&quot;\
				onclick=&quot;config.macros.attach.onClickAttach(this)&quot;&gt;&lt;!--\
			--&gt;&lt;input type=button class=btn2 value=&quot;close&quot;\
				onclick=&quot;var panel=document.getElementById(\'%id%\'); if (panel) panel.parentNode.removeChild(panel);&quot;&gt;\
		&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\
	&lt;/form&gt;',
//}}}
// // control processing
//{{{
	onChangeSource:
	function(here) {
		var form=here.form;
		var list=form.MIMEType;
		var theFilename  = here.value;
		var theExtension = theFilename.substr(theFilename.lastIndexOf('.')).toLowerCase();
		// if theFilename is in current document folder, remove path prefix and use relative reference
		var h=document.location.href; folder=getLocalPath(decodeURIComponent(h.substr(0,h.lastIndexOf(&quot;/&quot;)+1)));
		if (theFilename.substr(0,folder.length)==folder) theFilename='./'+theFilename.substr(folder.length);
		else theFilename='file:///'+theFilename; // otherwise, use absolute reference
		theFilename=theFilename.replace(/\\/g,&quot;/&quot;); // fixup: change \ to /
		form.useLocal.checked = true;
		form.local.value = theFilename;
		form.useData.checked = !form.useData.disabled;
		list.selectedIndex=1;
		for (var i=0; i&lt;list.options.length; i++) // find matching MIME type
			if (list.options[i].value.indexOf(theExtension)!=-1) { list.selectedIndex = i; break; }
		if (!form.tiddlertitle.disabled)
			form.tiddlertitle.value=theFilename.substr(theFilename.lastIndexOf('/')+1); // get tiddlername from filename
	},
//}}}
//{{{
	onClickAttach:
	function (here) {
		clearMessage();
		// get input values
		var form=here.form;
		var src=form.source; if (config.browser.isGecko) src=document.getElementById(&quot;attachFixSource&quot;);
		src=src.value!=src.defaultValue?src.value:&quot;&quot;;
		var when=(new Date()).formatString(config.macros.timeline.dateFormat);
		var title=form.tiddlertitle.value;
		var local = form.local.value!=form.local.defaultValue?form.local.value:&quot;&quot;;
		var url = form.URL.value!=form.URL.defaultValue?form.URL.value:&quot;&quot;;
		var notes = form.notes.value;
		var tags = &quot;attachment excludeMissing &quot;+form.tags.value;
		var useData=form.useData.checked;
		var useLocal=form.useLocal.checked;
		var useURL=form.useURL.checked;
		var mimetype = form.MIMEType.value.length?form.MIMEType.options[form.MIMEType.selectedIndex].text:&quot;&quot;;
		// validate checkboxes and get filename
		if (useData) {
			if (src.length) { if (!theLocation) var theLocation=src; }
			else { alert(this.sourceErr); src.focus(); return false; }
		}
		if (useLocal) {
			if (local.length) { if (!theLocation) var theLocation = local; }
			else { alert(this.localErr); form.local.focus(); return false; }
		}
		if (useURL) {
			if (url.length) { if (!theLocation) var theLocation = url; }
			else { alert(this.URLErr); form.URL.focus(); return false; }
		}
		if (!(useData||useLocal||useURL))
			{ form.useData.focus(); alert(this.storageErr); return false; }
		if (!theLocation)
			{ src.focus(); alert(this.sourceErr); return false; }
		if (!title || !title.trim().length || title==this.titlePrompt)
			{ form.tiddlertitle.focus(); alert(this.tiddlerErr); return false; }
		// if not already selected, determine MIME type based on filename extension (if any)
		if (useData &amp;&amp; !mimetype.length &amp;&amp; theLocation.lastIndexOf('.')!=-1) {
			var theExt = theLocation.substr(theLocation.lastIndexOf('.')).toLowerCase();
			var theList=form.MIMEType;
			for (var i=0; i&lt;theList.options.length; i++)
				if (theList.options[i].value.indexOf(theExt)!=-1)
					{ var mimetype=theList.options[i].text; theList.selectedIndex=i; break; }
		}
		// attach the file
		return this.createAttachmentTiddler(src, when, notes, tags, title,
			useData, useLocal, useURL, local, url, mimetype);
	},
	getMIMEType:
	function(src,def) {
		var ext = src.substr(src.lastIndexOf('.')).toLowerCase();
		var list=store.getTiddlerText(this.typeList);
		if (!list || !list.trim().length) return def;
		// get MIME list content from tiddler
		var parts=list.split(&quot;\n----\n&quot;);
		for (var p=0; p&lt;parts.length; p++) {
			var lines=parts[p].split(&quot;\n&quot;);
			var mime=lines.shift(); // 1st line=MIME type
			var match=lines.shift(); // 2nd line=matching extensions
			if (match.indexOf(ext)!=-1) return mime;
		}
		return def;
	},
	createAttachmentTiddler:
	function (src, when, notes, tags, title, useData, useLocal, useURL, local, url, mimetype, noshow) {
		if (useData) { // encode the data
			if (!mimetype.length) {
				alert(this.MIMEErr);
				form.MIMEType.selectedIndex=1; form.MIMEType.focus();
				return false;
			}
			var d = this.readFile(src); if (!d) { return false; }
			displayMessage('encoding '+src);
			var encoded = this.encodeBase64(d);
			displayMessage('file size='+d.length+' bytes, encoded size='+encoded.length+' bytes');
		}
		var usage=(mimetype.substr(0,5)==&quot;image&quot;?'[img[%0]]':'[[%0|%0]]').format([title]);
		var theText=this.tiddlerFormat.format([
			usage, notes.length?notes:'//none//', mimetype,
			useLocal?local.replace(/\\/g,'/'):'', useURL?url:'',
			useData?('data:'+mimetype+';base64,'+encoded):'' ]);
		store.saveTiddler(title,title,theText,config.options.txtUserName,new Date(),tags);
		var panel=document.getElementById(&quot;attachPanel&quot;); if (panel) panel.style.display=&quot;none&quot;;
		if (!noshow) { story.displayTiddler(null,title); story.refreshTiddler(title,null,true); }
		displayMessage('attached &quot;'+title+'&quot;');
		return true;
	},
//}}}
// // base64 conversion
//{{{
	encodeBase64:
	function (d) {
		if (!d) return null;
		// encode as base64
		var keyStr = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;;
		var out=&quot;&quot;;
		var chr1,chr2,chr3=&quot;&quot;;
		var enc1,enc2,enc3,enc4=&quot;&quot;;
		for (var count=0,i=0; i&lt;d.length; ) {
			chr1=d.charCodeAt(i++);
			chr2=d.charCodeAt(i++);
			chr3=d.charCodeAt(i++);
			enc1=chr1 &gt;&gt; 2;
			enc2=((chr1 &amp; 3) &lt;&lt; 4) | (chr2 &gt;&gt; 4);
			enc3=((chr2 &amp; 15) &lt;&lt; 2) | (chr3 &gt;&gt; 6);
			enc4=chr3 &amp; 63;
			if (isNaN(chr2)) enc3=enc4=64;
			else if (isNaN(chr3)) enc4=64;
			out+=keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4);
			chr1=chr2=chr3=enc1=enc2=enc3=enc4=&quot;&quot;;
		}
		return out;
	},
	decodeBase64: function(input) {
		var out=&quot;&quot;;
		var chr1,chr2,chr3;
		var enc1,enc2,enc3,enc4;
		var i = 0;
		// remove all characters that are not A-Z, a-z, 0-9, +, /, or =
		input=input.replace(/[^A-Za-z0-9\+\/\=]/g, &quot;&quot;);
		do {
			enc1=keyStr.indexOf(input.charAt(i++));
			enc2=keyStr.indexOf(input.charAt(i++));
			enc3=keyStr.indexOf(input.charAt(i++));
			enc4=keyStr.indexOf(input.charAt(i++));
			chr1=(enc1 &lt;&lt; 2) | (enc2 &gt;&gt; 4);
			chr2=((enc2 &amp; 15) &lt;&lt; 4) | (enc3 &gt;&gt; 2);
			chr3=((enc3 &amp; 3) &lt;&lt; 6) | enc4;
			out=out+String.fromCharCode(chr1);
			if (enc3!=64) out=out+String.fromCharCode(chr2);
			if (enc4!=64) out=out+String.fromCharCode(chr3);
		} while (i&lt;input.length);
		return out;
	},
//}}}
// // I/O functions
//{{{
	readFile: // read local BINARY file data
	function(filePath) {
		if(!window.Components) { return null; }
		try { netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalXPConnect&quot;); }
		catch(e) { alert(&quot;access denied: &quot;+filePath); return null; }
		var file = Components.classes[&quot;@mozilla.org/file/local;1&quot;].createInstance(Components.interfaces.nsILocalFile);
		try { file.initWithPath(filePath); } catch(e) { alert(&quot;cannot read file - invalid path: &quot;+filePath); return null; }
		if (!file.exists()) { alert(&quot;cannot read file - not found: &quot;+filePath); return null; }
		var inputStream = Components.classes[&quot;@mozilla.org/network/file-input-stream;1&quot;].createInstance(Components.interfaces.nsIFileInputStream);
		inputStream.init(file, 0x01, 00004, null);
		var bInputStream = Components.classes[&quot;@mozilla.org/binaryinputstream;1&quot;].createInstance(Components.interfaces.nsIBinaryInputStream);
		bInputStream.setInputStream(inputStream);
		return(bInputStream.readBytes(inputStream.available()));
	},
//}}}
//{{{
	writeFile:
	function(filepath,data) {
		// TBD: decode base64 and write BINARY data to specified local path/filename
		return(false);
	},
//}}}
//{{{
	askForFilename: // for FF3 fixup
	function(target) {
		var msg=config.messages.selectFile;
		if (target &amp;&amp; target.title) msg=target.title; // use target field tooltip (if any) as dialog prompt text
		// get local path for current document
		var path=getLocalPath(document.location.href);
		var p=path.lastIndexOf(&quot;/&quot;); if (p==-1) p=path.lastIndexOf(&quot;\\&quot;); // Unix or Windows
		if (p!=-1) path=path.substr(0,p+1); // remove filename, leave trailing slash
		var file=&quot;&quot;
		var result=window.mozAskForFilename(msg,path,file,true); // FF3 FIXUP ONLY
		if (target &amp;&amp; result.length) // set target field and trigger handling
			{ target.value=result; target.onchange(); }
		return result; 
	}
};
//}}}
//{{{
if (window.mozAskForFilename===undefined) { // also defined by CoreTweaks (for ticket #604)
	window.mozAskForFilename=function(msg,path,file,mustExist) {
		if(!window.Components) return false;
		try {
			netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
			var nsIFilePicker = window.Components.interfaces.nsIFilePicker;
			var picker = Components.classes['@mozilla.org/filepicker;1'].createInstance(nsIFilePicker);
			picker.init(window, msg, mustExist?nsIFilePicker.modeOpen:nsIFilePicker.modeSave);
			var thispath = Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);
			thispath.initWithPath(path);
			picker.displayDirectory=thispath;
			picker.defaultExtension='';
			picker.defaultString=file;
			picker.appendFilters(nsIFilePicker.filterAll|nsIFilePicker.filterText|nsIFilePicker.filterHTML);
			if (picker.show()!=nsIFilePicker.returnCancel)
				var result=picker.file.persistentDescriptor;
		}
		catch(ex) { displayMessage(ex.toString()); }
		return result;
	}
}
//}}}</pre>
</div>
<div title="AttachFilePluginFormatters" modifier="ELSDesignStudios" created="200605150128" modified="200910101044" tags="AttachFilePackage IconPackage ThemePackage WoodshopPackage systemConfig excludeMissing">
<pre>/***
|Name|AttachFilePluginFormatters|
|Source|http://www.TiddlyTools.com/#AttachFilePluginFormatters|
|Version|4.0.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1.3|
|Type|plugin|
|Description|run-time library for displaying attachment tiddlers|
Runtime processing for //rendering// attachment tiddlers created by [[AttachFilePlugin]].   Attachment tiddlers are tagged with&lt;&lt;tag attachment&gt;&gt;and contain binary file content (e.g., jpg, gif, pdf, mp3, etc.) that has been stored directly as base64 text-encoded data or can be loaded from external files stored on a local filesystem or remote web server.  Note: after creating new attachment tiddlers, you can remove [[AttachFilePlugin]], as long as you retain //this// tiddler (so that images can be rendered later on).
!!!!!Formatters
&lt;&lt;&lt;
This plugin extends the behavior of the following TiddlyWiki core &quot;wikify()&quot; formatters:
* embedded images: {{{[img[tooltip|image]]}}}
* linked embedded images: {{{[img[tooltip|image][link]]}}}
* external/&quot;pretty&quot; links: {{{[[label|link]]}}}
''Please refer to AttachFilePlugin (source: http://www.TiddlyTools.com/#AttachFilePlugin) for additional information.''
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.10.10 [4.0.1] in fileExists(), check for IE to avoid hanging Chrome during startup
2009.06.04 [4.0.0] changed attachment storage format to use //sections// instead of embedded substring markers.
2008.01.08 [*.*.*] plugin size reduction: documentation moved to ...Info
2007.12.04 [*.*.*] update for TW2.3.0: replaced deprecated core functions, regexps, and macros
2007.10.29 [3.7.0] more code reduction: removed upload handling from AttachFilePlugin (saves ~7K!)
2007.10.28 [3.6.0] removed duplicate formatter code from AttachFilePlugin (saves ~10K!) and updated documentation accordingly.  This plugin ([[AttachFilePluginFormatters]]) is now //''required''// in order to display attached images/binary files within tiddler content.
2006.05.20 [3.4.0] through 2007.03.01 [3.5.3] sync with AttachFilePlugin
2006.05.13 [3.2.0] created from AttachFilePlugin v3.2.0
&lt;&lt;&lt;
!!!!!Code
***/
// // version
//{{{
version.extensions.AttachFilePluginFormatters= {major: 4, minor: 0, revision: 1, date: new Date(2009,10,10)};
//}}}

//{{{
if (config.macros.attach==undefined) config.macros.attach= { };
//}}}
//{{{
if (config.macros.attach.isAttachment==undefined) config.macros.attach.isAttachment=function (title) {
	var tiddler = store.getTiddler(title);
	if (tiddler==undefined || tiddler.tags==undefined) return false;
	return (tiddler.tags.indexOf(&quot;attachment&quot;)!=-1);
}
//}}}

//{{{
// test for local file existence - returns true/false without visible error display
if (config.macros.attach.fileExists==undefined) config.macros.attach.fileExists=function(f) {
	if(window.Components) { // MOZ
		try { netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalXPConnect&quot;); }
		catch(e) { return false; } // security access denied
		var file = Components.classes[&quot;@mozilla.org/file/local;1&quot;].createInstance(Components.interfaces.nsILocalFile);
		try { file.initWithPath(f); }
		catch(e) { return false; } // invalid directory
		return file.exists();
	}
	else if (config.browser.isIE) { // IE
		var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);
		return fso.FileExists(f);
	}
	else return true; // other browsers: assume file exists
}
//}}}

//{{{
if (config.macros.attach.getAttachment==undefined) config.macros.attach.getAttachment=function(title) {

	// extract embedded data, local and remote links (if any)
	var text=store.getTiddlerText(title,'');
	var embedded=store.getTiddlerText(title+'##data','').trim();
	var locallink=store.getTiddlerText(title+'##file','').trim();
	var remotelink=store.getTiddlerText(title+'##url','').trim();

	// backward-compatibility for older attachments (pre 4.0.0)
	var startmarker=&quot;---BEGIN_DATA---\n&quot;;
	var endmarker=&quot;\n---END_DATA---&quot;;
	var pos=0; var endpos=0;
	if ((pos=text.indexOf(startmarker))!=-1 &amp;&amp; (endpos=text.indexOf(endmarker))!=-1)
		embedded=&quot;data:&quot;+(text.substring(pos+startmarker.length,endpos)).replace(/\n/g,'');
	if ((pos=text.indexOf(&quot;/%LOCAL_LINK%/&quot;))!=-1)
		locallink=text.substring(text.indexOf(&quot;|&quot;,pos)+1,text.indexOf(&quot;]]&quot;,pos));
	if ((pos=text.indexOf(&quot;/%REMOTE_LINK%/&quot;))!=-1)
		remotelink=text.substring(text.indexOf(&quot;|&quot;,pos)+1,text.indexOf(&quot;]]&quot;,pos));

	// if there is a data: URI defined (not supported by IE)
	if (embedded.length &amp;&amp; !config.browser.isIE) return embedded;

	// document is being served remotely... use remote URL (if any)  (avoids security alert)
	if (remotelink.length &amp;&amp; document.location.protocol!=&quot;file:&quot;)
		return remotelink;  

	// local link only... return link without checking file existence (avoids security alert)
	if (locallink.length &amp;&amp; !remotelink.length) 
		return locallink; 

	// local link, check for file exist... use local link if found
	if (locallink.length) { 
		locallink=locallink.replace(/^\.[\/\\]/,''); // strip leading './' or '.\' (if any)
		if (this.fileExists(getLocalPath(locallink))) return locallink;
		// maybe local link is relative... add path from current document and try again
		var pathPrefix=document.location.href;  // get current document path and trim off filename
		var slashpos=pathPrefix.lastIndexOf(&quot;/&quot;); if (slashpos==-1) slashpos=pathPrefix.lastIndexOf(&quot;\\&quot;); 
		if (slashpos!=-1 &amp;&amp; slashpos!=pathPrefix.length-1) pathPrefix=pathPrefix.substr(0,slashpos+1);
		if (this.fileExists(getLocalPath(pathPrefix+locallink))) return locallink;
	}

	// no embedded data, no local (or not found), fallback to remote URL (if any)
	if (remotelink.length) return remotelink;

	// attachment URL doesn't resolve, just return input as is
	return title;
}
//}}}
//{{{
if (config.macros.attach.init_formatters==undefined) config.macros.attach.init_formatters=function() {
	if (this.initialized) return;

	// find the formatter for &quot;image&quot; and replace the handler
	for (var i=0; i&lt;config.formatters.length &amp;&amp; config.formatters[i].name!=&quot;image&quot;; i++);
	if (i&lt;config.formatters.length)	config.formatters[i].handler=function(w) {
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source)
		if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) // Simple bracketted link
			{
			var e = w.output;
			if(lookaheadMatch[5])
				{
				var link = lookaheadMatch[5];
				// ELS -------------
				var external=config.formatterHelpers.isExternalLink(link);
				if (external)
					{
					if (config.macros.attach.isAttachment(link))
						{
						e = createExternalLink(w.output,link);
						e.href=config.macros.attach.getAttachment(link);
						e.title = config.macros.attach.linkTooltip + link;
						}
					else
						e = createExternalLink(w.output,link);
					}
				else 
					e = createTiddlyLink(w.output,link,false,null,w.isStatic);
				// ELS -------------
				addClass(e,&quot;imageLink&quot;);
				}
			var img = createTiddlyElement(e,&quot;img&quot;);
			if(lookaheadMatch[1])
				img.align = &quot;left&quot;;
			else if(lookaheadMatch[2])
				img.align = &quot;right&quot;;
			if(lookaheadMatch[3])
				img.title = lookaheadMatch[3];
			img.src = lookaheadMatch[4];
			// ELS -------------
			if (config.macros.attach.isAttachment(lookaheadMatch[4]))
				img.src=config.macros.attach.getAttachment(lookaheadMatch[4]);
			// ELS -------------
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
//}}}
//{{{
	// find the formatter for &quot;prettyLink&quot; and replace the handler
	for (var i=0; i&lt;config.formatters.length &amp;&amp; config.formatters[i].name!=&quot;prettyLink&quot;; i++);
	if (i&lt;config.formatters.length)	{
		config.formatters[i].handler=function(w) {
			this.lookaheadRegExp.lastIndex = w.matchStart;
			var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
			if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) {
				var e;
				var text = lookaheadMatch[1];
				if(lookaheadMatch[3]) {
					// Pretty bracketted link
					var link = lookaheadMatch[3];
					if (config.macros.attach.isAttachment(link)) {
						e = createExternalLink(w.output,link);
						e.href=config.macros.attach.getAttachment(link);
						e.title=config.macros.attach.linkTooltip+link;
					}
					else e = (!lookaheadMatch[2] &amp;&amp; config.formatterHelpers.isExternalLink(link))
						? createExternalLink(w.output,link)
						: createTiddlyLink(w.output,link,false,null,w.isStatic);
				} else {
					e = createTiddlyLink(w.output,text,false,null,w.isStatic);
				}
				createTiddlyText(e,text);
				w.nextMatch = this.lookaheadRegExp.lastIndex;
			}
		}
	} // if &quot;prettyLink&quot; formatter found
	this.initialized=true;
}
//}}}
//{{{
config.macros.attach.init_formatters(); // load time init
//}}}
//{{{
if (TiddlyWiki.prototype.coreGetRecursiveTiddlerText==undefined) {
	TiddlyWiki.prototype.coreGetRecursiveTiddlerText = TiddlyWiki.prototype.getRecursiveTiddlerText;
	TiddlyWiki.prototype.getRecursiveTiddlerText = function(title,defaultText,depth) {
		return config.macros.attach.isAttachment(title)?
			config.macros.attach.getAttachment(title):this.coreGetRecursiveTiddlerText.apply(this,arguments);
	}
}
//}}}</pre>
</div>
<div title="AttachFilePluginInfo" modifier="ELSDesignStudios" created="200801081347" modified="200906041718" tags="pluginInfo excludeMissing InstructorOnly">
<pre>/***
|Name|AttachFilePluginInfo|
|Source|http://www.TiddlyTools.com/#AttachFilePlugin|
|Documentation|http://www.TiddlyTools.com/#AttachFilePluginInfo|
|Version|4.0.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides||
|Description|Documentation for AttachFilePlugin|
Store or link binary files (such as jpg, gif, pdf or even mp3) within your TiddlyWiki document and then use them as images or links from within your tiddler content.
!!!!!Inline interface (live)
&gt;see [[AttachFile]] (shadow tiddler)
&gt;&lt;&lt;tiddler AttachFile&gt;&gt;
!!!!!Syntax
&lt;&lt;&lt;
''To display the attach file control panel, simply view the [[AttachFile]] shadow tiddler that is automatically created by the plugin, and contains an instance of the inline control panel.''.  Or, you can write:
{{{
&lt;&lt;attach inline&gt;&gt;
}}}
in any tiddler to display the control panel embedded within that tiddler.  Note: you can actually use any unique identifier in place of the &quot;inline&quot; keyword.  Each unique id creates a separate instance of the controls.  If the same ID is used in more than one tiddler, then the control panel is automatically moved to the most recently rendered location.  Or, you can write:
{{{
&lt;&lt;attach&gt;&gt;
}}}
(with no ID parameter) in SidebarOptions.  This adds a command link that opens the controls as a floating panel, positioned directly to the left of the sidebar.
&lt;&lt;&lt;
!!!!!Usage
&lt;&lt;&lt;
Binary file content can be stored in three different locations:
#embedded in the attachment tiddler (encoded as base64)
#on your filesystem (a 'local link' path/filename)
#on a web server (a 'remote link' URL)
The plugin creates an &quot;attachment tiddler&quot; for each file you attach.  Regardless of where you store the binary content, your document can refer to the attachment tiddler rather than using a direct file or URL reference in your embedded image or external links, so that changing document locations will not require updating numerous tiddlers or copying files from one system to another.
&gt; Important note: As of version 3.6.0, in order to //render// images and other binary attachments created with this plugin, you must also install [[AttachFilePluginFormatters]], which extends the behavior of the TiddlyWiki core formatters for embedded images ({{{[img[tooltip|image]]}}}), linked embedded images ({{{[img[tooltip|image][link]]}}}), and external/&quot;pretty&quot; links ({{{[[label|link]]}}}), so that these formatter will process references to attachment tiddlers as if a normal file reference had been provided. |
When you attach a file, a tiddler (tagged with&lt;&lt;tag attachment&gt;&gt;) is generated (using the source filename as the tiddler's title).  The tiddler contains //''base64 text-encoded binary data''//, surrounded by {{{/%...%/}}} comment markers (so they are not visible when viewing the tiddler).  The tiddler also includes summary details about the file: when it was attached, by whom, etc. and, if the attachment is an image file (jpg, gif, or png), the image is automatically displayed below the summary information.
&gt;Note: although you can edit an attachment tiddler, ''don't change any of the encoded content below the attachment header'', as it has been prepared for use in the rest of your document, and even changing a single character can make the attachment unusable.  //If needed, you ''can'' edit the header information or even the MIME type declaration in the attachment data, but be very careful not to change any of the base64-encoded binary data.//
With embedded data, your TW document can be completely self-contained...unfortunately, embedding just a few moderately-sized binary files using base64 text-encoding can dramatically increase the size of your document.   To avoid this problem, you can create attachment tiddlers that define external local filesystem (file://) and/or remote web server (http://) 'reference' links, without embedding the binary data directly in the tiddler (i.e., uncheck &quot;embed data&quot; in the 'control panel').

These links provide an alternative source for the binary data: if embedded data is not found (or you are running on Internet Explorer, which does not currently support using embedded data), then the plugin tries the local filesystem reference.  If a local file is not found, then the remote reference (if any) is used.  This &quot;fallback&quot; approach also lets you 'virtualize' the external links in your document, so that you can access very large binary content such as PDFs, MP3's, and even *video* files, by using just a 'remote reference link' without embedding any data or downloading huge files to your hard disk.

Of course, when you //do// download an attached file, the local copy will be used instead of accessing a remote server each time, thereby saving bandwidth and allowing you to 'go mobile' without having to edit any tiddlers to alter the link locations...
&lt;&lt;&lt;
!!!!!Syntax / Examples
&lt;&lt;&lt;
To embed attached files as images or link to them from other tiddlers, use the standard ~TiddlyWiki image syntax ({{{[img[tooltip|filename]]}}}), linked image syntax ({{{[img[tooltip|filename][tiddlername]]}}}) , or &quot;external link&quot; syntax ({{{[[text|URL]]}}}), replacing the filename or URL that is normally entered with the title of an attachment tiddler.

embedded image data:
&gt;{{{[img[Meow|AttachFileSample]]}}}
&gt;[img[Meow|AttachFileSample]]
embedded image data with link to larger remote image:
&gt;{{{[img[click for larger view|AttachFileSample][AttachFileSample2]]}}}
&gt;[img[click for larger view|AttachFileSample][AttachFileSample2]]
'external' link to embedded image data:
&gt;{{{[[click to view attachment|AttachFileSample]]}}}
&gt;[[click to view attachment|AttachFileSample]]
'external' link to remote image:
&gt;{{{[[click to view attachment|AttachFileSample2]]}}}
&gt;[[click to view attachment|AttachFileSample2]]
regular ~TiddlyWiki links to attachment tiddlers:
&gt;{{{[[AttachFileSample]]}}} [[AttachFileSample]]
&gt;{{{[[AttachFileSample2]]}}} [[AttachFileSample2]]
&lt;&lt;&lt;
!!!!!Defining MIME types
&lt;&lt;&lt;
When you select a source file, a ''[[MIME|http://en.wikipedia.org/wiki/MIME]]'' file type is automatically suggested, based on filename extension.  The AttachFileMIMETypes tiddler defines the list of MIME types that will be recognized by the plugin.  Each MIME type definition consists of exactly two lines of text: the official MIME type designator (e.g., &quot;text/plain&quot;, &quot;image/gif&quot;, etc.), and a space-separated list of file extensions associated with that type.  List entries are separated by &quot;----&quot; (horizontal rules).
&lt;&lt;&lt;
!!!!!Known Limitations
&lt;&lt;&lt;
Internet Explorer does not support the data: URI scheme, and cannot use the //embedded// data to render images or links.  However, you can still use the local/remote link definitions to create file attachments that are stored externally.  In addition, while it is relatively easy to read local //text// files, reading binary files is not directly supported by IE's FileSystemObject (FSO) methods, and other file I/O techniques are subject to security barriers or require additional MS proprietary technologies (like ASP or VB) that make implementation more difficult.  As a result, you cannot //create// new attachment tiddlers using IE.
&lt;&lt;&lt;
!!!!!Installation
&lt;&lt;&lt;
Import (or copy/paste) the following tiddlers into your document:
* [[AttachFilePlugin]] (tagged with &lt;&lt;tag systemConfig&gt;&gt;)
* [[AttachFilePluginFormatters]] (&quot;runtime distribution library&quot;) (tagged with &lt;&lt;tag systemConfig&gt;&gt;)
* [[AttachFileSample]] and [[AttachFileSample2]] //(tagged with &lt;&lt;tag attachment&gt;&gt;)//
* [[AttachFileMIMETypes]] //(defines binary file types)//
&gt; Important note: As of version 3.6.0, in order to //render// images and other binary attachments created with this plugin, you must also install [[AttachFilePluginFormatters]], which extends the behavior of the TiddlyWiki core formatters for embedded images ({{{[img[tooltip|image]]}}}), linked embedded images ({{{[img[tooltip|image][link]]}}}), and external/&quot;pretty&quot; links ({{{[[label|link]]}}}), so that these formatter will process references to attachment tiddlers as if a normal file reference had been provided. |
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.06.04 [4.0.0] changed attachment storage format to use //sections// instead of embedded substring markers.
2008.07.21 [3.9.0] Fixup for FireFox 3: use HTML with separate text+button control instead of type='file' control
2008.05.12 [3.8.1] automatically add 'attach' task to backstage (moved from BackstageTweaks)
2008.04.09 [3.8.0] in onChangeSource(), if source matches current document folder, use relative reference for local link.  Also, disable 'embed' when using IE (which //still// doesn't support data: URI)
2008.04.07 [3.7.3] fixed typo in HTML for 'local file link' so that clicking in input field doesn't erase current path/file (if any)
2008.04.07 [3.7.2] auto-create AttachFile shadow tiddler for inline interface
2008.01.08 [*.*.*] plugin size reduction: documentation moved to ...Info
2007.12.04 [*.*.*] update for TW2.3.0: replaced deprecated core functions, regexps, and macros
2007.12.03 [3.7.1] in createAttachmentTiddler(), added optional &quot;noshow&quot; flag to suppress display of newly created tiddlers.
2007.10.29 [3.7.0] code reduction: removed support for built-in upload to server... on-line hosting of binary attachments is left to the document author, who can upload/host files using 3rd-party web-based services (e.g. www.flickr.com, ) or stand-alone applications (e.g., FTP).
2007.10.28 [3.6.0] code reduction: removed duplicate definition of image and prettyLink formatters.  Rendering of attachment tiddlers now //requires// installation of AttachFilePluginFormatters
2007.03.01 [3.5.3] use apply() to invoke hijacked function
2007.02.25 [3.5.2] in hijack of &quot;prettyLink&quot;, fix version check for TW2.2 compatibility (prevent incorrect use of fallback handler)
2007.01.09 [3.5.1] onClickAttach() refactored to create separate createAttachmentTiddler() API for use with FileDropPluginHandlers
2006.11.30 [3.5.0] in getAttachment(), for local references, add check for file existence and fallback to remote URL if local file not found.  Added fileExists() to encapsulate FF vs. IE local file test function (IE FSO object code is TBD).
2006.11.29 [3.4.8] in hijack for PrettyLink, 'simple bracketed link' opens tiddler instead of external link to attachment
2006.11.29 [3.4.7] in readFile(), added try..catch around initWithPath() to handle invalid/non-existent paths better.
2006.11.09 [3.4.6] REAL FIX for TWv2.1.3: incorporate new TW2.1.3 core &quot;prettyLink&quot; formatter regexp handling logic and check for version &lt; 2.1.3 with fallback to old plugin code.  Also, cleanup table layout in HTML (added &quot;border:0&quot; directly to table elements to override stylesheet)
2006.11.08 [3.4.5] TEMPORARY FIX for TWv2.1.3: disable hijack of wikiLink formatter due to changes in core wikiLink regexp definition.  //Links to attachments are broken, but you can still use {{{[img[TiddlerName]]}}} to render attachments as images, as well as {{{background:url('[[TiddlerName]]')}}} in CSS declarations for background images.//
2006.09.10 [3.4.4] update formatters for 2.1 compatibility (use this.lookaheadRegExp instead of temp variable)
2006.07.24 [3.4.3] in prettyLink formatter, added check for isShadowTiddler() to fix problem where shadow links became external links.
2006.07.13 [3.4.2] in getAttachment(), fixed stripping of newlines so data: used in CSS will work
2006.05.21 [3.4.1] in getAttachment(), fixed substring() to extract data: URI (was losing last character, which broken rendering of SOME images)
2006.05.20 [3.4.0] hijack core getRecursiveTiddlerText() to support rendering attachments in stylesheets (e.g. {{{url([[AttachFileSample]])}}})
2006.05.20 [3.3.6] add &quot;description&quot; feature to easily include notes in attachment tiddler (you can always edit to add them later... but...)
2006.05.19 [3.3.5] add &quot;attach as&quot; feature to change default name for attachment tiddlers.  Also, new optional param to specify tiddler name (disables editing)
2006.05.16 [3.3.0] completed XMLHttpRequest handling for GET or POST to configurable server scripts
2006.05.13 [3.2.0] added interface for upload feature.  Major rewrite of code for clean object definitions.  Major improvements in UI interaction and validation.
2006.05.09 [3.1.1] add wikifer support for using attachments in links from &quot;linked image&quot; syntax: {{{[img[tip|attachment1][attachment2]]}}}
2006.05.09 [3.1.0] lots of code changes: new options for attachments that use embedded data and/or links to external files (local or remote)
2006.05.03 [3.0.2] added {{{/%...%/}}} comments around attachment data to hide it when viewing attachment tiddler.
2006.02.05 [3.0.1] wrapped wikifier hijacks in initAttachmentFormatters() function to eliminate globals and avoid FireFox 1.5.0.1 crash bug when referencing globals
2005.12.27 [3.0.0] Update for TW2.0.  Automatically add 'excludeMissing' tag to attachments
2005.12.16 [2.2.0] Dynamically create/remove attachPanel as needed to ensure only one instance of interface elements exists, even if there are multiple instances of macro embedding.
2005.11.20 [2.1.0] added wikifier handler extensions for &quot;image&quot; and &quot;prettyLink&quot; to render tiddler attachments
2005.11.09 [2.0.0] begin port from old ELS Design adaptation based on ~TW1.2.33
2005.07.20 [1.0.0] Initial release (as adaptation)
&lt;&lt;&lt;</pre>
</div>
<div title="BetaUpgradePlugin" modifier="JohnRouillard" created="200807280335" modified="200908170059" tags="systemConfig InstructorOnly systemConfigDisable">
<pre>/***
|''Name''|BetaUpgradePlugin|
|''Description''|change the upgrade source to the beta location|
|''~CoreVersion''|2.4.0|
|''Source''|http://svn.tiddlywiki.org/Trunk/associations/plugins/|
|''CodeRepository''|http://svn.tiddlywiki.org|
***/
//{{{
config.macros.upgrade.source = &quot;http://www.tiddlywiki.com/beta/upgrade.html&quot;;
//}}}</pre>
</div>
<div title="BookmarkList" modifier="JohnRouillard" created="200910260223" modified="201008012215" tags="structure noReload">
<pre>Replace this text with links to tiddlers.
</pre>
</div>
<div title="Browser Issues" modifier="JohnRouillard" created="200909112223" modified="201007190238" tags="content">
<pre>This page describes some issues with particular browsers/configurations. In addition to these notes you can also goto
* http://tiddlywiki.com/#Installation%20ServicePack2Problems%20Browsers
* http://tiddlywiki.org/wiki/How_To/Configure_your_browser_to_allow_saves_to_disk

{{sectionTOC{}}}

! Firefox

This problem was observed on:

* Kubuntu/Ubuntu version 3.0.13 of Firefox
* Windows XP version 3.5.3 of Firefox

!! When the cookie's keep option is set to &quot;Ask me always&quot;

You will be prompted for every cookie change associated with options changes or changing/displaying the tab interface.

The only workaround at this point it to change the &quot;ask me always&quot; setting to some other level. You can also create a new profile for Firefox that you use specifically for the coursebook and other &quot;&quot;&quot;file://&quot;&quot;&quot; web applications with a compatible setting for the keep option.

Aspects of this bug are described in:

* https://bugzilla.mozilla.org/show_bug.cgi?id=440973
* https://bugzilla.mozilla.org/show_bug.cgi?id=430045
* https://bugzilla.mozilla.org/show_bug.cgi?id=452575

! Internet Explorer

These problems were observed on MS Windows XP version 8, 7, 6 of Internet Explorer.

!! Goto box requires scrolling to display full tiddler titles (IE)

Unlike Firefox, the list of tiddlers that match the text typed into the Goto box at the upper right of the page is totally off the screen in the compatibility mode of IE 8, IE 7 and IE 6. What you type in is being matched, and you can use the horizontal scroll bar to see the full tiddler titles.

In IE 8 standards display mode the tiddler list is [[partly off the screen as with Safari|here##Goto box requires scrolling to display full tiddler titles (safari)]].

!! Presentation and Chapters selection listbox truncates the titles

In Firefox the dropdown list that is displayed by the select box for presentations or chapters grows to display the entire name of the tiddlers. In IE however this doesn't happen, the size of the dropdown is the same as the size of the selector box.

Because of this, the links in the main menu for each presentation and chapter are provided as an index of what is covered in each presentation/chapter.

! Safari

These problems were observed on Windows XP version 4.0.3 of Safari.

!! Goto box requires scrolling to display full tiddler titles (safari)

Unlike Firefox, the list of tiddlers that match the text typed into the Goto box at the upper right of the page is partly off the screen. You need to use the horizontal scroll bar to see the full tiddler titles.

! Opera

These problems were observed on MS Windows XP version 10.0 of Opera.

!! Goto box requires scrolling to display full tiddler titles (Opera)

In opera tiddler list is [[partly off the screen as with Safari|here##Goto box requires scrolling to display full tiddler titles (safari)]]. Also it covers the input box so you can't see what you are typing.

!! Can't synchronize/load content from the internet
Similar to Chrome there is something preventing http requests from completing. The dragonfly debugger in Opera doesn't show any network activity when using the link on the [[sync]] page or when updating the rss feed in [[ContentChanges]]. Similar to Chrome, it appears the ~XmlHttpRequest is disabled for local files as desribed by http://operawiki.info./XMLHttpRequest and http://www.opera.com/docs/specs/presto211/security/ (look for {{{Local HTML accessing sites..}}}).

! Google Chrome

These problems were observed on MS Windows XP version 3.0.195.10 of Google Chrome.

!! Can't synchronize/load content from the internet (chrome)

Apparently something in chrome's support for ~XmlHttpRequest doesn't work correctly with tiddlywiki. This prevents the sync and rss feed reading mechanisms from working. However an already loaded coursebook does function under chrome.

It appears ~XMLHttpRequest is disabled for &quot;&quot;&quot;file://&quot;&quot;&quot; url's as a security measure. Some details can be found at: http://www.informationweek.com/news/internet/browsers/showArticle.jhtml?articleID=212202252, http://code.google.com/p/chromium/issues/detail?id=4951. 

!! Unable to store cookies for local files

Cookies for &quot;&quot;&quot;file://&quot;&quot;&quot; are disabled for security reasons.  Starting chrome with the {{{--enable-file-cookies}}} option will permit cookies to be used. Details are at: http://code.google.com/p/chromium/issues/detail?id=535.
This means that options can't be saved for the tiddlywiki including username.
</pre>
</div>
<div title="Bugs And Feature Requests" modifier="JohnRouillard" created="200907111846" modified="201008071959" tags="InstructorOnly excludeMissing">
<pre>Here are some Bugs or feature requests for the plugins.
{{sectionTOC{@@font-style: bold;List of Bugs/Features@@}}}

! Notebook plugin use with part tiddlers
When a part tiddler (e.g. [[Glossary/sync]]) is displayed there is a notebook also displayed. Which is expected, but the entries done there aren't included in the Glossary tiddler so when the student looks at the Glossary it looks like his notes have dissapeared. They haven't they are just not named properly to be dislayed in the Glossary tiddler context.

!! Possible solutions
Use jQuery to add links to the additional notes tiddlers by scanning for {{{&lt;part name&gt;&gt;}}} entries in the tiddler and creating a link to each existing subtiddler note. Could also include the content from these subtiddler notes, but then editing the note does not have the included content.

! SiteUrl and slices for external urls.

need to make sure they are all the same page. have some for bblisa and some for LISA itself.
need to reconcile.

! ToggleFullScreen

The entry in the main menu for this toggle displays &quot;Toggle Fullscreen&quot; until used. Then it is stuck on &quot;restore&quot; untill the tw is reloaded. When looking at MainMenu in the story column it does properly
toggle.  Maybe a missing refresh of the main menu column when going to multi column mode?

! FootnotePlugin

Breaks with tiddler is null error when using ExportTiddlers to save rss feed. Partial fix:

Place
{{{
 if (!story.findContainingTiddler(place)) return;
}}}

at top of handler so it returns. However another issue. If using the TiddlerNotes plugin, the footnotes are rendered below the notes. And the structure is wrong:

{{{
 div id=tiddler...
   ...
   div class=viewer
   div class=notes viewer
         div id=notesContainer.... class=TiddlerNotes
         div class=footnoteholder
              ol ...
}}}

The footnoteholder div should either be inside the viewer div or between the viewer div and the notes/viewer div.
Where it is now means that hiding the notes class (for printing) also hides the footnotes. Also the footnote
current location places it well away from the viewer tiddler that it is really a part of.

! SlideShowPlugin

!! alternate text

It can't handle:
{{{
[[Welcome to the Class|Slide Welcome]]
[[Slide 2]]
}}}
will skip first slide&quot;Slide Welcome&quot; and start withe &quot;Slide 2&quot;. Needs to resolve slide properly.

!! excluding wiki words from slide show

Following a wikiword with a : stops the slide show plugin from treating that page as a slide.
Is this intentional? If so needs to be documented. Allows slideshow template to be annotated
for reading through rather than just presenting.

!! slideshow macro doesn't take name of the tiddler to show

Makes it impossible to have a single page where clicking on a macro starts
that slide show. E.G. I want:

{{{
&lt;&lt;slideShow options tiddler:[[use me for list of tiddlers]]&gt;&gt;
&lt;&lt;slideShow options tiddler:SlideShow1&gt;&gt;
}}}

!! Way to change clock and other options setting according to style sheet

Can the stylesheet set default options for clock ...

!! slideshow macro can't be included via tiddler

I would like to include a single control tiddler with the slideshow macro's predefined. So I can have tiddlers with:

{{{
Instructor show with theme InstructorSlideShowTheme:
  &lt;&lt;slideShow  theme:InstructorSlideShowTheme toc:titles footer:&quot;copyright(c) John Rouillard 2009&quot; clock:+&gt;&gt;
}}}

and
{{{
Student show using  {{comment{SlideShowStyleSheet}}}:
  &lt;&lt;slideShow noClicks noKeyboard toc:titles &gt;&gt;

Print show with theme PrintingSlideShowTheme:
  &lt;&lt;slideShow showAll theme:PrintingSlideShowTheme &gt;&gt;
}}}

and then include these tiddlers at the end of a slide show presentation tiddler with:
{{{
&lt;&lt;tiddler InstructorShow&gt;&gt;
&lt;&lt;tiddler StudentShow&gt;&gt;
}}}

allowing a common look/set of instructions to all the slideshows to be changed without having to visit each show.

!! tiddlers being edited are not hidden when slideshow is started.

any tiddlers being edited are displayed below the slides in the slideshow.

While my claim is you shouldn't be editing any tiddlers during a preso...

Hiding tiddlers being edited should not prevent editing of the tiddler when in slideshow mode.
(e.g. if a TiddlerNotesPlugin note is displayed, it should be able to be edited).

!! Doc bug label and tooltip not documented

changes hover text and text of label in button.

!! slide show pulldown TOC menu needs numbered list

The slideshow pulldown menu needs to autogenerate a number for each slide listed so it can be used in the goto slide entry box.

!! Background of slideshow TOC pulldown isn't opaque

At least in one of my examples, not opaque. Maybe a missing stylesheet setting?? I can see rules on the slide behind it.

!! per slide delay in autoplay mode

Allow setting of a default and a per slide (e.g. for slides that have more/less material on them) advance value.
Can be an absolute setting or maybe multipler/percentage (2%-2000%) of the default value set on the slide show macro line.

Have an autoplay show for students when they enter. title and welcome message need little time on screen, directions
should take upmost of the time.

! GotoPlugin
On some browsers, notably IE, the suggestion list is displayed to the right of the entry box which places it off screen if the goto box is placed in SideBarOptions.
Firefox works better in this regard as the suggestion box is displayed below the entry box.

! StorySaverPlugin

!! Allow links in story tiddler that are not part of the story.

I have a couple of use cases for a story where it would be useful to be able to include a tiddler reference but not have it opened as part of a story. Is it possible to enclose test in a class like noStory to exclude the text in that section from being parsed for story tiddlers?

Use cases:

Using a tiddler as an annotated table of contents for a chapter. Sometimes the comments/annotations refer to other tiddlers/chapters.

Alternate way of showing a Slide Show using the SlideShow Plugin. The slideshow plugin doesn't load tiddlers that have a : at the end of the name, so I can reference style sheets etc quickly when I pull up the tiddler. Hmm, maybe I can use transclusion to hide this as well??

! AnnotationsPlugin

!! clicking on link in popup
How can you click on a link in the popup annotation? Maybe I need a different plugin? As soon as I move into the popup, it dissapears.
Firefox 3.

!! Forced links not displayed right

Also putting a forced link inside the annotation tiddler prevent the link from being properly displayed.
{{{
(( [[nice link]] (^&lt;&lt;tiddler glossary/nicelink&gt;&gt;)))
}}}
displays as {{{ [[nice link]] }}} on a grey background. Mousing over does display the popup nicely.

! PartTiddlerPlugin &lt;&lt;tiddler &quot;PartTiddlerPlugin::Version&quot;&gt;&gt;

nested parts seem to be displaying incorrectly.

{{{
You should have done the steps in [[Download and Setup SEC]] before starting this example.

! A simple Hello World example

&lt;part content&gt;

Open your editor and type:

&lt;part example1&gt;
{{  // really three braces
type = single
desc = my first rule
ptype = regexp
pattern = Hello
action = write - I saw %0
}}  // really three braces
&lt;/part&gt;

Save it to a file called {{{rules1.sr}}}.
[... omitted content]
Congratulations you just matched your first event with SEC.
&lt;/part&gt;
}}}

displays as:

{{{
 A simple Hello World example

&lt;part contents&gt;

Open your editor and type:
[...]
Congratulations you just matched your first event with SEC.
&lt;/part&gt;
}}}

If I remove the {{{&lt;part example1&gt;}}} then the outer parts dissapear, but I really want to use both as the content is imported into a larger chapter while the example is imported into a diferent chapter and discussion.

! Import Plugin

# How do I make a default of record source of imported tiddler so I can sync.
# How can I get it to add a new systemServer tiddler with the url's of the servers I import from.
# I can't get the list of default defined servers to work. Is that a known issue?

~FireBug reports:

{{{
 if(attribs){
78 for(var n in attribs){
79 e.setAttribute(n,attribs[n]);
80 }
}}}

that {{{e}}} is undefined.

! AttachFilePlugin

Unable to save the embedded link in IE. Is this a known issue? Other alternatives for storing a file in a tiddlywiki and
exporting it to a local file with formatting preserved (for scripts and data files needed for a class).

! Other Issues

!! How to delete old tiddlers w/ sync.
I am currently tagging deleted tiddlers with &quot;content deleted&quot; and removing the tiddler contents while keeping the title
to overwrite prior tiddlers however it is then up to the student to delete the tiddler. Can I:

# add a new systemConfig tiddler that deletes tiddlers marked with deleted?
# if I can what about the notes tiddlers, should they be moved/renamed to a new tiddler?
# maybe leave a link in the old tiddler pointing to tne new tiddler and use that to trigger deletion and rename of the notes tiddler?
# maybe just have the user delete as needed and renaming as the link shows?

!! Allow links to act as a jump to tiddler if the tiddler is already open in the story

Use case: Have a table of contents tiddler. Tag it as  story to open it an all it's component tiddlers. Use it as a toc
to jump right to a component tiddler. If the tiddler is not open in the story column, open the tidder and jump to it's location.

!! (solved) excludeOrphans tag to prevent chapters and other top level items from being presented as orphans
{{{
These are available as the result of embedded searches on tags, and I want them to show up in timeline etc, just not in
orphans list. They are all tagged with &quot;chapters&quot;, can I add an excludeOrphans to the tag tidder to prevent them from displaying
on the orphans list?
}}}
submitted July 19 http://groups.google.com/group/TiddlyWiki/t/39f7be322883586e

!! Support mailto links with anti-spam capability.

Be nice to allow students to submit issues by just clicking on a mailto link. But I don't want it to end up being harvestable by spambots.

! TiddlerNotes

Can't use more than 1 note in a tiddler. Should be able to have multiple notes.
While they can display multiples, can only edit one of them.

If a note exists, it should have an additional class. This way a media print style can print actual notes with contents while not printing empty notes blocks.

Also there is a bug: [[PatchedPlugin##TiddlerNotesPlugin]]

!Notes

{{{
(5:27:16 PM) ericshulman: rouilj: I know you won't be using this until the next revision (after your deadlines), but here's something I just cooked up and published on TiddlyTools: http://www.TiddlyTools.com/#ShowImage
(5:27:32 PM) ericshulman: it doesn't use any plugins or non-core syntax
(5:28:31 PM) ericshulman: it's a 'self-documenting tiddler transclusion'
(5:29:33 PM) ericshulman: (i.e., view the tiddler to read the docs, transclude the tiddler with params to render it's output)
(5:39:15 PM) rouilj: cool. Will it support functionality like: [img(75%,)[Fallen trees.|Tunguska_event_fallen_trees.jpg]]
(5:39:19 PM) rouilj: afk
(5:51:51 PM) ericshulman: the output format is determined by the content of the ShowImage##show section
(5:52:15 PM) ericshulman: you could add the &quot;(75%)&quot; literal there (to scale all images)
(5:52:50 PM) ericshulman: or, you could write &quot;($3,)&quot;
(5:53:56 PM) ericshulman: and then change the last line of the ShowImage tiddler to:
(5:54:19 PM) ericshulman: 	with: [[$1]] {{'$2'=='$'+'2'?'$1':'$2'}} {{'$2'=='$'+'2'?'auto':'$3'}}&gt;&gt;
(5:54:53 PM) ericshulman: Usage would then be: &lt;&lt;tiddler ShowImage with: AttachmentTitle &quot;tooltip&quot; &quot;width&quot;&gt;&gt;
(5:55:18 PM) ericshulman: errata: 	with: [[$1]] {{'$2'=='$'+'2'?'$1':'$2'}} {{'$3'=='$'+'3'?'auto':'$3'}}&gt;&gt;
}}}

!! ChapterStart

Sets an inline style to force a page break before the enclosing tiddler. This seems a little hacky. Would it be better to create a chapterStart style and add that to the enclosing tiddler. Then the StyleSheet in the @media section can have 
{{{
.chapterStart {page-break-before:always}
}}}
for the user to edit rather than editing a javascript tiddler.

&lt;&lt;sectionTOC&gt;&gt;</pre>
</div>
<div title="ChangeLog" modifier="YourName" created="200905310341" modified="201007120121" tags="content excludeMissing">
<pre>! ChangeLog for SEC coursebook

Each dated subsection has a description has a description of the changes done to the coursebook.

!! 2010-07-05

Core updated to 2.6.0. Multiple plugin updates including new SlideShowPlugin with ability to exclude tidders and reference another tiddler as the slide show source list.

!! 2009-09-02

Updated with HideWhenPlugin to allow conditional text. Used primarily for GettingStarted to:
# Display download link if user views tiddlywiki from somewhere other than local file
# guide user though 4 step preparation sequence
# provide positive feedback when load tiddlers is successfully completed (by checking for Welcome tiddler)

!! 2009-07-11

Finished presentation 1 first cut at coursebook orientation and use.

Changed slide show starting labels and popups for the buttons.

Changed StorySaverPlugin settings to reference section rather than story in popup menu.

!! 2009-07-09

Added auto cycle and auto advance slide show for display before start of class.

!! 2009-05-30

Added ChangeLog.</pre>
</div>
<div title="ChangeTitle" modifier="JohnRouillard" created="200908210515" modified="201007050400" tags="InstructorOnly excludeOrphans">
<pre>This tiddler implements javascript code that opens a popup to change the displayed page title. Enter a title of &quot;&quot;&quot;default&quot;&quot;&quot; to reset it to the tiddlywiki's embeded page title. Use cancel to leave title unchanged.

Use when printing a story column to [[ PDFCreator|http://www.pdfcreator.org]] to change the title of the document.

!Script
&lt;script label=&quot;change page title&quot;&gt;
 document.title=prompt('enter new document title, or default',document.title) || document.title; 
 if (document.title == &quot;default&quot; ) document.title = window.getPageTitle();
&lt;/script&gt;
!end</pre>
</div>
<div title="Changing the Style Sheet" modifier="JohnRouillard" created="201008071944" modified="201008072245" tags="content">
<pre>There are some simple changes that can be made to the style sheets whose CSS setting control the display and printing format for the coursebook.

{{sectionTOC{}}}

!! Changing Chapter Printing
If the first tiddler in every chapter starts with {{{&lt;&lt;tiddler ChapterStart&gt;&gt;}}}, then each chapter will start on a new page. Howeverr you may want chapters to start on an odd or even page, or disable a new page start entirely. To change this edit the ChapterStart tiddler and change:
{{{
if (here.previousSibling) here.style.pageBreakBefore='always';
}}}
Replacing {{{always}}} with [[some other suitable value|http://www.w3schools.com/css/pr_print_pageba.asp]] like auto or left will modify the page break policy for all chapters.

!! Changing Slide Printing
The style sheet controlling slide printing in SlideShowPlugin print mode is the PrintingSlideShowStyleSheet. There is an {{{@media}}} section that contains the changes specifically for printing to paper or other media.

By default every slide prints on a new page. If you want to change this, you need to edit the PrintingSlideShowStyleSheet and change the setting:
{{{
.tiddler{
 page-break-after: always;
  ...
}}}
from always to auto or [[other suitable setting|http://www.w3schools.com/css/pr_print_pageba.asp]].

If you want to hide the slide comments (notes to students) in the SlideShowPlugin print mode, you can add the line:
{{{
display: none;
}}}
inside the .comment block:
{{{
.comment{
 border: 1pt dashed;
 padding: 0.5em;
}
}}}
of the PrintingSlideShowStyleSheet tiddler.

If you want to change the base font size used when printing slide presentations (e.g. you want to increase the size to print 4-up or 8-up), change
{{{
#contentWrapper.slideShowMode #displayArea{
 font-size: 150%;
 margin: 1em 15.5em 0em 1em !important;
}
}}}
replacing {{{150%}}} with {{{200%}}} or [[some other suitable value|http://www.w3schools.com/CSS/pr_font_font-size.asp]].

!!! Slides printed in normal story column
However slide tiddlers printed as part of a story column (accessed by the drop down menu for the presentation) are also printed one per page. To change
this you edit the StyleSheet and modify the line:
{{{
*[template=&quot;slideViewTemplate&quot;] {page-break-after: always}
}}}
replacing always with [[some other option|http://www.w3schools.com/css/pr_print_pageba.asp]].

</pre>
</div>
<div title="Chapter  1 - Types of Presentations" modifier="JohnRouillard" created="201007181857" modified="201007312250" tags="content">
<pre>&lt;&lt;tiddler ChapterStart&gt;&gt;You can create two types of presentations:
# Single tiddler presentations
# Multi-tiddler presentations

!! Single Tiddler Presentations
As the name &quot;Single tiddler&quot; implies, the presentation tiddler is divided into multiple segments and each segment is displayed as a slide in the presentation. This method has a few advantages:
* editing is easier as only one tiddler need to be modified,
* useful for &quot;administrative presentations&quot;. For example:
** a looping slide show at the beginning of a class welcoming the students and displaying info they need to know about the class. 
** a looping slide show during a class break with a countdown timer till class resumes.
However it comes with some drawbacks:
* Slide titles are generic ~TempSlide1, ~TempSlide2 etc. So you have to use a style/theme that doesn't display the tiddler title.
* Students can't annotate a slide as there is no actual tiddler associated with each slide.
* You have to hide certain control elements when using a single tiddler, but these elements aren't hidden if exported to the student copy.

!! Multi-tiddler Presentations
As the name &quot;Multi-tiddler&quot; implies, a single tiddler links to multiple slide tiddlers and each slide tiddler is displayed as a slide in the presentation. This method has a few advantages:
* Student's can't annotate single tiddler shows as there is no actual tiddler associated with each slide.
* The tiddler title is used as a slide title to provide a useful description of the slide content.
* A single tiddler can be used in multiple presentations
However it comes with some drawbacks:
* Revising multiple slides requires editing multiple tiddlers. (If you are doing text substitution consider using the TiddlerTweakerPlugin to do batch editing of content.)
* More tiddlers makes tiddlywiki somewhat slower
* The addition of slide tiddlers can make it more difficult to find the specific tiddler you are interested in.
</pre>
</div>
<div title="Chapter  1 - Working with Presentations" modifier="JohnRouillard" created="201007181831" modified="201007312249" tags="chapter content story">
<pre>[[Chapter  1 - Types of Presentations]]
[[Creating a Presentation]]
[[Creating a Slide]]
[[Opening a Presentation]]
[[Display a Presentation]]
[[Presentation Tips]]
[[Slide Tips]]
[[Printing Slide Set]]
[[Tagging a Presentation]]
[[Creating Your Own Presentation Theme]]
</pre>
</div>
<div title="Chapter  2 - Chapters Defined" modifier="JohnRouillard" created="201007311823" modified="201007312251" tags="content">
<pre>&lt;&lt;tiddler ChapterStart&gt;&gt;Chapter operate a lot like a presentation. It provides a linear set of tiddlers for the student. Unlike the presentation, the tidders in a chapter are displayed all at once in the story column of the tiddlywiki. This facilitates printing, searching  (using the browsers search function) and reading the material.

As with presentations, [[tags define a chapter control tiddler|Tagging a Chapter]].
</pre>
</div>
<div title="Chapter  2 - Working with Chapters" modifier="JohnRouillard" created="201007311819" modified="201008072206" tags="chapter content story">
<pre>[[Chapter  2 - Chapters Defined]]
[[How to Create a Chapter]]
[[Creating Chapter Content]]
[[Creating Chapter Content as Separate Tiddlers]]
[[Creating Chapter Content as Single Tiddler and Split Into Multiple Tiddlers]]
[[Creating Chapter Content as Single Large Tiddler]]
[[Creating a New Chapter from an Existing Tiddler]]
[[How to Create Additional Content]]
[[Opening a Chapter]]
[[Printing Chapters]]
[[Creating Quizzes]]
[[Creating Reference Tiddlers]]
</pre>
</div>
<div title="Chapter  3 - Non-tiddlywiki publication options" modifier="JohnRouillard" created="201008071742" modified="201008072006" tags="chapter content story">
<pre>[[Chapter  3 - Other Publication Options]]

[[Creating PDF's]]
[[Creating visual html]]
[[Changing the Style Sheet]]
</pre>
</div>
<div title="Chapter  3 - Other Publication Options" modifier="JohnRouillard" created="201008071813" modified="201008072006" tags="content">
<pre>Although the Coursebook is meant to be used on a computer, sometimes you need to print out the material:
* students don't have a computer at the course
* students are not familiar with technology and using the Coursebook would be a distraction
* provide a fallback mechanism in case things go wrong (print slides as transparencies)
* annotate slides for use by presenter, and work from those notes during presentation

The tiddlers on:
* [[Printing]]
* [[Printing Chapters]]
* [[Printing Slide Set]]
describe how to set up to print directly to paper. Using [[CSS - Cascading Stle Sheets|http://www.w3.org/Style/CSS/learning]] you can modfiy the font, layout and other settings (e.g. page breaks).

Besides printing directly to paper, other options are to [[print to PDF in windows|Creating PDF's]] or produce html that visually replicates the information. While both of these options can be used on the computer, they do not easily support links or other interaction with the document, so they should be considers the equivalent of a paper document except viewable on the computer.
</pre>
</div>
<div title="Chapter creation" modifier="JohnRouillard" created="201007252012" modified="201008020307" tags="slide content">
<pre>! A chapter is:
* A linear sequence of tiddlers listed in the &quot;chapter control tiddler&quot;
* Indexed in the main menu
* Displayed as a single entitiy
* Is made up of parts (tiddlers) that stand alone which has some unique challenges

{{comment{
Because tiddlers are stand alone entities (and are the unit of notetaking for the students) flow of prose is somewhat tricky. References to other tiddler content is tricky because a tiddler can stand alone outside of a chapter context.
}}}</pre>
</div>
<div title="ChapterList" modifier="JohnRouillard" created="200903212255" modified="201007312143" tags="structure TOC">
<pre>&lt;&lt;matchTags inline {{&quot;* &lt;&lt;openStory [[%0]] '%0' 'Open %0'&gt;&quot; + &quot;&gt; @@font-size: smaller;([[open|%0]])@@&quot;}} &quot;\n&quot; sort:title chapter&gt;&gt;
!Reference
/% replace this entire line if you are manually listing reference tiddlers%/&lt;&lt;matchTags inline &quot;* [[%0]]&quot; &quot;\n&quot; sort:title reference&gt;&gt;
/%
If you replace the reference tiddler list with a manual list like:

* [[Glossary of terms|Glossary]]
* [[Other Resources|Resources]]

consider adding:
&lt;&lt;tiddler ShowPopup with: [[ChapterList##reference]] &quot;All References&quot; &quot;List of all tiddlers tagged with reference in alphabetic order.&quot; &gt;&gt; 

below the list. This was less used references are strill available, but you don't have them taking up space unless the user want's to see them.

Don't touch this needed for the popup to work.
!reference
&lt;&lt;matchTags inline &quot;[[%0]]&quot; &quot;\n&quot; sort:title reference&gt;&gt;
!end
%/</pre>
</div>
<div title="ChapterStart" modifier="JohnRouillard" created="200909072209" modified="201007050221" tags="structure InstructorOnly">
<pre>&lt;script&gt;
// set up page break when printing first tiddler of every chapter if it is not the first tiddler on page
// Start the first tiddler of every chapter with: &lt;&lt;tiddler ChapterStart&gt;&gt; Text of tiddler
var here=story.findContainingTiddler(place);
if (here.previousSibling) here.style.pageBreakBefore='always';
&lt;/script&gt;</pre>
</div>
<div title="CompareTiddlers" modifier="JohnRouillard" created="200907280426" modified="200908020119" tags="InstructorOnly excludeOrphans">
<pre>&lt;&lt;compareTiddlers &quot;not excludeLists or Revisions&quot;&gt;&gt;</pre>
</div>
<div title="CompareTiddlersPlugin" modifier="ELSDesignStudios" created="200710151510" modified="200907261534" tags="systemConfig InstructorOnly">
<pre>/***
|Name|CompareTiddlersPlugin|
|Source|http://www.TiddlyTools.com/#CompareTiddlersPlugin|
|Version|1.1.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides||
|Description|show color-coded differences between two selected tiddlers|
!!!!!Usage
&lt;&lt;&lt;
Display a form that lets you select and compare any two tiddlers:
{{{
&lt;&lt;compareTiddlers&gt;&gt;
}}}
To filter the lists of tiddlers by tags, include an optional tagvalue (or tag expression) parameter:
{{{
&lt;&lt;compareTiddlers &quot;tagValue&quot;&gt;&gt;
   OR
&lt;&lt;compareTiddlers &quot;boolean tag expression&quot;&gt;&gt; (requires MatchTagsPlugin)
}}}
&lt;&lt;&lt;
!!!!!Example
&lt;&lt;&lt;
{{{&lt;&lt;compareTiddlers&gt;&gt;}}}
{{smallform small{&lt;&lt;compareTiddlers&gt;&gt;}}}
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.07.25 [1.1.0] added optional tag filter param
2007.10.15 [1.0.0] converted from inline script to true plugin
2006.12.27 [0.0.0] inline script.  {{{diff()}}} and {{{diffString()}}} functions written by Bradley Meck.
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.CompareTiddlersPlugin= {major: 1, minor: 1, revision: 0, date: new Date(2009,7,25)};
//}}}
//{{{
config.shadowTiddlers.CompareTiddlers='&lt;&lt;compareTiddlers&gt;&gt;';
//}}}
/***
//{{{
!html
&lt;form&gt;&lt;!--
--&gt;&lt;input type=hidden name=filter value=''&gt;&lt;!--
--&gt;&lt;select name=list1 size=1 style='width:30%'
	onchange='config.macros.compareTiddlers.pick(this,this.form.view1,this.form.edit1,this.form.text1)'&gt;&lt;/select&gt;&lt;!--
--&gt;&lt;input type=button name=view1 style='width:10%' value='view' disabled
	onclick='if (this.form.list1.value.length)
		story.displayTiddler(story.findContainingTiddler(this),this.form.list1.value)'&gt;&lt;!--
--&gt;&lt;input type=button name=edit1 style='width:10%' value='edit' disabled
	onclick='if (this.form.list1.value.length)
		story.displayTiddler(story.findContainingTiddler(this),this.form.list1.value,DEFAULT_EDIT_TEMPLATE)'&gt;&lt;!--
--&gt;&lt;select name=list2 size=1 style='width:30%'
	onchange='config.macros.compareTiddlers.pick(this,this.form.view2,this.form.edit2,this.form.text2)'&gt;&lt;/select&gt;&lt;!--
--&gt;&lt;input type=button name=view2 style='width:10%' value='view' disabled
	onclick='if (this.form.list2.value.length)
		story.displayTiddler(story.findContainingTiddler(this),this.form.list2.value)'&gt;&lt;!--
--&gt;&lt;input type=button name=edit2 style='width:10%' value='edit' disabled
	onclick='if (this.form.list2.value.length)
		story.displayTiddler(story.findContainingTiddler(this),this.form.list2.value,DEFAULT_EDIT_TEMPLATE)'&gt;&lt;br&gt;&lt;!--
--&gt;&lt;nobr&gt;&lt;!--
--&gt;&lt;textarea name=text1 style='width:49.5%;display:none' rows='10' readonly&gt;&lt;/textarea&gt;&lt;!--
--&gt;&lt;textarea name=text2 style='width:49.5%;display:none' rows='10' readonly&gt;&lt;/textarea&gt;&lt;!--
--&gt;&lt;/nobr&gt;&lt;!--
--&gt;&lt;div style='float:left'&gt;&lt;!--
--&gt;Additions are shown in &lt;span style='color:green'&gt;GREEN&lt;/span&gt;, &lt;!--
--&gt;deletions are shown in &lt;span style='color:red'&gt;RED&lt;/span&gt;&lt;!--
--&gt;&lt;/div&gt;&lt;!--
--&gt;&lt;div style='text-align:right'&gt;&lt;!--
--&gt;&lt;input type=button name=compare style='width:10%' value='compare' disabled
	onclick='config.macros.compareTiddlers.compare(this.form,this.form.nextSibling)'&gt;&lt;!--
--&gt;&lt;input type=button name=done style='width:10%' value='done' disabled
	onclick='config.macros.compareTiddlers.reset(this.form,this.form.nextSibling)'&gt;&lt;!--
--&gt;&lt;/div&gt;&lt;!--
--&gt;&lt;/form&gt;&lt;div class='compareTiddlersResults'&gt;contents to be replaced by results of comparison&lt;/div&gt;
!end
//}}}
***/
//{{{
config.macros.compareTiddlers= {
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		setStylesheet(this.css,'CompareTiddlersStyles');
		var out=createTiddlyElement(place,'span');
		out.innerHTML=store.getTiddlerText('CompareTiddlersPlugin##html');
		var form=out.getElementsByTagName('form')[0];
		var target=form.nextSibling;
		this.reset(form,target,params[0]);
	},
	css: '.compareTiddlersResults \
		{ display:none;clear:both;margin-top:1em;border:1px solid;-moz-border-radius:1em;-webkit-border-radius:1em;padding:1em;white-space:normal; }',
	reset: function(f,target,filter) {
		if (f.filter.value.length) var filter=f.filter.value;
		if (filter) var tids=store.filterTiddlers('[tag['+filter+']]')
		else var tids=store.getTiddlers('title','excludeLists');
		f.text1.style.display='none'; f.text1.value='';
		while (f.list1.options[0]) f.list1.options[0]=null; 
		f.list1.options[0]=new Option('select a tiddler...','',false,false);
		for (i=0; i&lt;tids.length; i++)
			f.list1.options[f.list1.length]=new Option(tids[i].title,tids[i].title,false,false);
		f.text2.style.display='none'; f.text2.value='';
		while (f.list2.options[0]) f.list2.options[0]=null; 
		f.list2.options[0]=new Option('select a tiddler...','',false,false);
		for (i=0; i&lt;tids.length; i++)
			f.list2.options[f.list2.length]=new Option(tids[i].title,tids[i].title,false,false);
		f.view1.disabled=f.view2.disabled=f.edit1.disabled=f.edit2.disabled=f.compare.disabled=f.done.disabled=true;
		f.filter.value=filter;
		target.style.display='none';
		removeChildren(target);
	},
	pick: function(list,view,edit,text) {
		var f=list.form;
		view.disabled=edit.disabled=f.done.disabled=!list.value.length;
		f.compare.disabled=!f.list1.value.length||!f.list2.value.length;
		if (!list.value.length) return;
		f.text1.style.display=f.text2.style.display='inline';
		text.value=store.getTiddlerText(list.value);
	},
	compare: function(f,target) {
		if (!f.list1.value.length) { f.list1.focus(); return alert('select a tiddler'); }
		var t1=store.getTiddlerText(f.list1.value); if (!t1) { displayMessage(f.list1.value+' not found');return false; }
		if (!f.list2.value.length) { f.list2.focus(); return alert('select a tiddler'); }
		var t2=store.getTiddlerText(f.list2.value); if (!t2) { displayMessage(f.list2.value+' not found');return false; }
		var out=this.diffString(t1,t2); if (!out || !out.length) out='no differences';
		removeChildren(target);
		target.innerHTML=out;
		target.style.display='block';
		f.done.disabled=false;
	},
//}}}
//{{{
	diffString: function( o, n ) {
		// This function was written by Bradley Meck
		// returns difference between old and new text, color-formatted additions and deletions
		if (o==n) return &quot;&quot;; // simple check, saves time if true
		var error = 5;
		var reg = new RegExp( &quot;\\n|(?:.{0,&quot;+error+&quot;})&quot;, &quot;g&quot; );
		var oarr = o.match( reg ); // dices text into chunks
		var narr = n.match( reg );
		var out = this.diff(oarr,narr); // compare the word arrays
		var str = &quot;&quot;; // construct output
		for (i=0; i&lt;out.length; i++) {
			switch (out[i].change) {
				case &quot;ADDED&quot;:
					str+=&quot;&lt;span style='color:green'&gt;&quot;;
					str+=narr.slice(out[i].index,out[i].index+out[i].length).join(&quot;&quot;);
					str+=&quot;&lt;/span&gt; &quot;;
					break;
				case &quot;DELETED&quot;:
					str+=&quot;&lt;span style='color:red'&gt;&quot;;
					str+=oarr.slice(out[i].index,out[i].index+out[i].length).join(&quot;&quot;);
					str+=&quot;&lt;/span&gt; &quot;;
					break;
				default:
					str+=&quot;&lt;span&gt;&quot;;
					str+=oarr.slice(out[i].index,out[i].index+out[i].length).join(&quot;&quot;);
					str+=&quot;&lt;/span&gt; &quot;;
					break;
			}	
		}
		return str;
	},
	diff: function( oldArray, newArray ) {
		// This function was written by Bradley Meck
		// finds the differences between one set of objects and another.
		// The objects do not need to be Strings.  It outputs an array of objects with the properties value and change.
		// This function is pretty hefty but appears to be rather light for a diff and tops out at O(N^2) for absolute worst cast scenario.
		var newElementHash = { };
		for( var i = 0; i &lt; newArray.length; i++ ) {
			if( ! newElementHash [ newArray [ i ] ] ) {
				newElementHash [ newArray [ i ] ] = [ ];
			}
			newElementHash [ newArray [ i ] ].push( i );
		}
		var substringTable = [ ];
		for( var i = 0; i &lt; oldArray.length; i++ ) {
			if(newElementHash [ oldArray [ i ] ] ) {
				var locations = newElementHash [ oldArray [ i ] ] ;
				for( var j = 0; j &lt; locations.length; j++){
					var length = 1;
					while( i + length &lt; oldArray.length &amp;&amp; locations [ j ] + length &lt; newArray.length
						&amp;&amp; oldArray [ i + length ] == newArray [ locations [ j ] + length ] ){
						length++;
					}
					substringTable.push( {
						oldArrayIndex : i,
						newArrayIndex : locations [ j ],
						matchLength : length
					} );
				}
			}
		}
		substringTable.sort( function( a, b ) {
			if ( a.matchLength &gt; b.matchLength /* a is less than b by some ordering criterion */ ) {
				return -1;
			}
			if ( a.matchLength &lt; b.matchLength /* a is greater than b by the ordering criterion */ ) {
				return 1;
			}
			// a must be equal to b
			return 0
		} );
		//displayMessage( substringTable.toSource( ) );
		for( var i = 0; i &lt; substringTable.length; i++) {
			for( var j = 0; j &lt; i; j++) {
				var oldDelta = substringTable [ i ].oldArrayIndex + substringTable [ i ].matchLength - 1 - substringTable [ j ].oldArrayIndex;
				var newDelta = substringTable [ i ].newArrayIndex + substringTable [ i ].matchLength - 1 - substringTable [ j ].newArrayIndex;
				//displayMessage( &quot;oldDelta ::: &quot; + oldDelta );
				//displayMessage( &quot;newDelta ::: &quot; + newDelta );
				//displayMessage( &quot;matchLength ::: &quot; + substringTable [ j ].matchLength );
				if( ( oldDelta &gt;= 0 &amp;&amp; oldDelta &lt;= substringTable [ j ].matchLength )
				|| ( newDelta &gt;= 0 &amp;&amp; newDelta &lt;= substringTable [ j ].matchLength )
				|| ( oldDelta &lt; 0 &amp;&amp; newDelta &gt; 0 )
				|| ( oldDelta &gt; 0 &amp;&amp; newDelta &lt; 0 ) ) {
					substringTable.splice( i, 1 );
					i--;
					break;
				}
			}
		}
		//displayMessage( substringTable.toSource(  ) );
		substringTable.sort( function( a, b ) {
			if ( a.oldArrayIndex &lt; b.oldArrayIndex /* a is less than b by some ordering criterion */ ) {
				return -1;
			}
			if ( a.oldArrayIndex &gt; b.oldArrayIndex /* a is greater than b by the ordering criterion */ ) {
				return 1;
			}
			// a must be equal to b
			return 0
		} );
		//displayMessage( substringTable.toSource( ) );
		var oldArrayIndex = 0;
		var newArrayIndex = 0;
		var results = [ ];
		for( var i = 0; i &lt; substringTable.length; i++ ) {
			if( oldArrayIndex != substringTable [ i ].oldArrayIndex ) {
				results.push( {
					change : &quot;DELETED&quot;,
					length : substringTable [ i ].oldArrayIndex - oldArrayIndex,
					index : oldArrayIndex
				} );
			}
			if( newArrayIndex != substringTable [ i ].newArrayIndex ) {
				results.push( {
					change : &quot;ADDED&quot;,
					length : substringTable [ i ].newArrayIndex - newArrayIndex,
					index : newArrayIndex
				} );
			}
			results.push( {
				change : &quot;STAYED&quot;,
				length : substringTable [ i ].matchLength,
				index : substringTable [ i ].oldArrayIndex
			} );
			oldArrayIndex = substringTable [ i ].oldArrayIndex + substringTable [ i ].matchLength;
			newArrayIndex = substringTable [ i ].newArrayIndex + substringTable [ i ].matchLength;
		}
		if( oldArrayIndex != oldArray.length ) {
			results.push( {
				change : &quot;DELETED&quot;,
				length : oldArray.length - oldArrayIndex,
				index : oldArrayIndex
			} );
		}
		if( newArrayIndex != newArray.length ) {
			results.push( {
				change : &quot;ADDED&quot;,
				length : newArray.length - newArrayIndex,
				index : newArrayIndex
			} );
		}
		return results;
	}
}
//}}}</pre>
</div>
<div title="Content Bugs" modifier="YourName" created="200907182120" modified="201007251933" tags="InstructorOnly">
<pre>{{sectionTOC{}}}
! Chapter tiddler structure

Chapter the chapter tiddler is a tiddler that self reference so it opens at the top of the story group.
Thus it acts as a toc. Now if there was some way to have the links in the TOC tiddler jump to the open tiddler
in the story rather than reopen that would work well. Idea from chapter 4 of:
http://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-719.html

! Possible tag taxonomy for content

Again from http://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-719.html

;Summary
:Brief, and assumes that the reader has some familiarity with the  topic.
;Introduction
: Longer, and assumes that the reader has not encountered the topic before.
;Example
:A page describing a worked example.
;Exercise
:A live exercise within the Book that the student can try.
;Exercise advice 
:A piece of advice about an issue that might come up in an exercise.
;Search
:Executes a search using a Web search engine.
;Chapter
:Takes the reader through the topic in an ordered manner. Chapters are made up of subtopics and are described in Section 4.3.

&lt;&lt;tiddler [[Dynamic Content]]&gt;&gt;

&lt;&lt;sectionTOC&gt;&gt;</pre>
</div>
<div title="ContentChanges" modifier="JohnRouillard" created="200903152004" modified="200909052349" tags="structure">
<pre>This is the rss feed for new content changes from &lt;&lt;tiddler &quot;GettingStarted::courseHomeRss&quot;&gt;&gt;.

&lt;&lt;rssReader noDesc {{store.getTiddlerSlice('GettingStarted', 'courseHomeRss');}} &gt;&gt;</pre>
</div>
<div title="CopyTiddlerPlugin" modifier="ELSDesignStudios" created="200601061656" modified="200906080834" tags="systemConfig excludeMissing">
<pre>/***
|Name|CopyTiddlerPlugin|
|Source|http://www.TiddlyTools.com/#CopyTiddlerPlugin|
|Version|3.2.5|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.3|
|Type|plugin|
|Requires||
|Overrides||
|Description|Quickly create a copy of any existing tiddler|
!!!Usage
&lt;&lt;&lt;
The plugin automatically updates the default (shadow) ToolbarCommands definitions to insert the ''copyTiddler'' command, which will appear as ''copy'' when a tiddler is rendered.  If you are already using customized toolbar definitions, you will need to manually add the ''copyTiddler'' toolbar command to your existing ToolbarCommands tiddler, e.g.:
{{{
|EditToolbar|... copyTiddler ... |
}}}
When the ''copy'' command is selected, a new tiddler is created containing an exact copy of the current text/tags/fields, using a title of &quot;{{{TiddlerName (n)}}}&quot;, where ''(n)'' is the next available number (starting with 1, of course).  If you copy while //editing// a tiddler, the current values displayed in the editor are used (including any changes you may have already made to those values), and the new tiddler is immediately opened for editing.

The plugin also provides a macro that allows you to embed a ''copy'' command directly in specific tiddler content:
{{{
&lt;&lt;copyTiddler TidderName label:&quot;...&quot; prompt:&quot;...&quot;&gt;&gt;
}}}
where
* ''TiddlerName'' (optional)&lt;br&gt;specifies the //source// tiddler to be copied.  If omitted, the current containing tiddler (if any) will be copied.
* ''label:&quot;...&quot;'' (optional)&lt;br&gt;specifies text to use for the embedded link (default=&quot;copy TiddlerName&quot;)
* ''prompt:&quot;...&quot;'' (optional)&lt;br&gt;specifies mouseover 'tooltip' help text for link
//Note: to use non-default label/prompt values with the current containing tiddler, use &quot;&quot; for the TiddlerName//
&lt;&lt;&lt;
!!!Configuration
&lt;&lt;&lt;
&lt;&lt;option chkCopyTiddlerDate&gt;&gt; use date/time from existing tiddler (otherwise, use current date/time)
{{{&lt;&lt;option chkCopyTiddlerDate&gt;&gt;}}}
&lt;&lt;&lt;
!!!Revisions
&lt;&lt;&lt;
2009.06.08 [3.2.5] added option to use timestamp from source tiddler
2009.03.09 [3.2.4] fixed IE-specific syntax error
2009.03.02 [3.2.3] refactored code (again) to restore use of config.commands.copyTiddler.* custom settings
2009.02.13 [3.2.2] in click(), fix calls to displayTiddler() to use current tiddlerElem and use getTiddlerText() to permit copying of shadow tiddler content
2009.01.30 [3.2.1] fixed handling for copying field values when in edit mode
2009.01.23 [3.2.0] refactored code and added {{{&lt;&lt;copyTiddler TiddlerName&gt;&gt;}}} macro
2008.12.18 [3.1.4] corrected code for finding next (n) value when 'sparse' handling is in effect (thanks to RussThomas for identifying and diagnosing the problem)
2008.11.14 [3.1.3] added optional 'sparse' setting (avoids 'filling in' missing numbers that may have been previously deleted)
2008.11.14 [3.1.2] added optional 'zeroPad' setting
2008.11.14 [3.1.1] moved hard-coded '(n)' regex into 'suffixPattern' object property so it can be customized
2008.09.26 [3.1.0] changed new title generation to use '(n)' suffix instead of 'Copy of' prefix
2008.05.20 [3.0.3] in handler, when copying from VIEW mode, create duplicate array from existing tags array before saving new tiddler.
2007.12.19 [3.0.2] in handler, when copying from VIEW mode, duplicate custom fields before saving new tiddler. Thanks to bug report from Ken Girard.
2007.09.26 [3.0.1] in handler, use findContainingTiddler(src) to get tiddlerElem (and title).  Allows 'copy' command to find correct tiddler when transcluded using {{{&lt;&lt;tiddler&gt;&gt;}}} macro or enhanced toolbar inclusion (see [[CoreTweaks]])
2007.06.28 [3.0.0] complete re-write to handle custom fields and alternative view/edit templates
2007.05.17 [2.1.2] use store.getTiddlerText() to retrieve tiddler content, so that SHADOW tiddlers can be copied correctly when in VIEW mode
2007.04.01 [2.1.1] in copyTiddler.handler(), fix check for editor fields by ensuring that found field actually has edit=='text' attribute
2007.02.05 [2.1.0] in copyTiddler.handler(), if editor fields (textfield and/or tagsfield) can't be found (i.e., tiddler is in VIEW mode, not EDIT mode), then get text/tags values from stored tiddler instead of active editor fields.  Allows use of COPY toolbar directly from VIEW mode (based on a request from LaurentCharles)
2006.12.12 [2.0.0] completely rewritten so plugin just creates a new tiddler EDITOR with a copy of the current tiddler EDITOR contents, instead of creating the new tiddler in the STORE by copying the current tiddler values from the STORE.
2005.xx.xx [1.0.0] original version by Tim Morgan
&lt;&lt;&lt;
!!!Code
***/
//{{{
version.extensions.CopyTiddlerPlugin= {major: 3, minor: 2, revision: 5, date: new Date(2009,6,8)};

// automatically tweak shadow EditTemplate to add 'copyTiddler' toolbar command (following 'cancelTiddler')
config.shadowTiddlers.ToolbarCommands=config.shadowTiddlers.ToolbarCommands.replace(/cancelTiddler/,'cancelTiddler copyTiddler');

if (config.options.chkCopyTiddlerDate===undefined) config.options.chkCopyTiddlerDate=false;

config.commands.copyTiddler = {
	text: 'copy',
	hideReadOnly: true,
	tooltip: 'Make a copy of this tiddler',
	notitle: 'this tiddler',
	prefix: '',
	suffixText: ' (%0)',
	suffixPattern: / \(([0-9]+)\)$/,
	zeroPad: 0,
	sparse: false,
	handler: function(event,src,title)
		{ return config.commands.copyTiddler.click(src,event); },
	click: function(here,ev) {
		var tiddlerElem=story.findContainingTiddler(here);
		var template=tiddlerElem?tiddlerElem.getAttribute('template'):null;
		var title=here.getAttribute('from');
		if (!title || !title.length) {
			if (!tiddlerElem) return false;
			else title=tiddlerElem.getAttribute('tiddler');
		}
		var root=title.replace(this.suffixPattern,''); // title without suffix
		// find last matching title
		var last=title;
		if (this.sparse) { // don't fill-in holes... really find LAST matching title
			var tids=store.getTiddlers('title','excludeLists');
			for (var t=0; t&lt;tids.length; t++) if (tids[t].title.startsWith(root)) last=tids[t].title;
		}
		// get next number (increment from last matching title)
		var n=1; var match=this.suffixPattern.exec(last); if (match) n=parseInt(match[1])+1;
		var newTitle=this.prefix+root+this.suffixText.format([String.zeroPad(n,this.zeroPad)]);
		// if not sparse mode, find the next hole to fill in...
		while (store.tiddlerExists(newTitle)||document.getElementById(story.idPrefix+newTitle))
			{ n++; newTitle=this.prefix+root+this.suffixText.format([String.zeroPad(n,this.zeroPad)]); }
		if (!story.isDirty(title)) { // if tiddler is not being EDITED
			// duplicate stored tiddler (if any)
			var text=store.getTiddlerText(title,'');
			var who=config.options.txtUserName;
			var when=new Date();
			var newtags=[]; var newfields={};
			var tid=store.getTiddler(title); if (tid) {
				if (config.options.chkCopyTiddlerDate) var when=tid.modified;
				for (var t=0; t&lt;tid.tags.length; t++) newtags.push(tid.tags[t]);
				store.forEachField(tid,function(t,f,v){newfields[f]=v;},true);
			}
	                store.saveTiddler(newTitle,newTitle,text,who,when,newtags,newfields,true);
			story.displayTiddler(tiddlerElem,newTitle,template);
		} else {
			story.displayTiddler(tiddlerElem,newTitle,template);
			var fields=config.commands.copyTiddler.gatherFields(tiddlerElem); // get current editor fields
			var newTiddlerElem=document.getElementById(story.idPrefix+newTitle);
			for (var f=0; f&lt;fields.length; f++) {  // set fields in new editor
				if (fields[f].name=='title') fields[f].value=newTitle; // rename title in new tiddler
				var fieldElem=config.commands.copyTiddler.findField(newTiddlerElem,fields[f].name);
				if (fieldElem) {
					if (fieldElem.getAttribute('type')=='checkbox')
						fieldElem.checked=fields[f].value;
					else 
						fieldElem.value=fields[f].value;
				}
			}
		}
		story.focusTiddler(newTitle,'title');
		return false;
	},
	findField: function(tiddlerElem,field) {
		var inputs=tiddlerElem.getElementsByTagName('input');
		for (var i=0; i&lt;inputs.length; i++) {
			if (inputs[i].getAttribute('type')=='checkbox' &amp;&amp; inputs[i].field == field) return inputs[i];
			if (inputs[i].getAttribute('type')=='text' &amp;&amp; inputs[i].getAttribute('edit') == field) return inputs[i];
		}
		var tas=tiddlerElem.getElementsByTagName('textarea');
		for (var i=0; i&lt;tas.length; i++) if (tas[i].getAttribute('edit') == field) return tas[i];
		var sels=tiddlerElem.getElementsByTagName('select');
		for (var i=0; i&lt;sels.length; i++) if (sels[i].getAttribute('edit') == field) return sels[i];
		return null;
	},
	gatherFields: function(tiddlerElem) { // get field names and values from current tiddler editor
		var fields=[];
		// get checkboxes and edit fields
		var inputs=tiddlerElem.getElementsByTagName('input');
		for (var i=0; i&lt;inputs.length; i++) {
			if (inputs[i].getAttribute('type')=='checkbox')
				if (inputs[i].field) fields.push({name:inputs[i].field,value:inputs[i].checked});
			if (inputs[i].getAttribute('type')=='text')
				if (inputs[i].getAttribute('edit')) fields.push({name:inputs[i].getAttribute('edit'),value:inputs[i].value});
		}
		// get textareas (multi-line edit fields)
		var tas=tiddlerElem.getElementsByTagName('textarea');
		for (var i=0; i&lt;tas.length; i++)
			if (tas[i].getAttribute('edit')) fields.push({name:tas[i].getAttribute('edit'),value:tas[i].value});
		// get selection lists (droplist or listbox)
		var sels=tiddlerElem.getElementsByTagName('select');
		for (var i=0; i&lt;sels.length; i++)
			if (sels[i].getAttribute('edit')) fields.push({name:sels[i].getAttribute('edit'),value:sels[i].value});
		return fields;
	}
};
//}}}
// // MACRO DEFINITION
//{{{
config.macros.copyTiddler = {
	label: 'copy',
	prompt: 'Make a copy of %0',
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		var title=params.shift();
		params=paramString.parseParams('anon',null,true,false,false);
		var label	=getParam(params,'label',this.label+(title?' '+title:''));
		var prompt	=getParam(params,'prompt',this.prompt).format([title||this.notitle]);
		var b=createTiddlyButton(place,label,prompt,
			function(ev){return config.commands.copyTiddler.click(this,ev)});
		b.setAttribute('from',title||'');
	}
};
//}}}</pre>
</div>
<div title="Copyright and Legal Stuff" modifier="YourName" created="200908011750" modified="201007120011" tags="content">
<pre>! Copyright

All tiddlers marked with the structure or content tags are copyright&amp;copy; 2010 by John P. Rouillard.

! Additional licenses
Parts of this coursebook use components that are licensed separately from the content. This section contains the license information under which they are made available, or permission from the author to use the component.

!! ~TiddlyWiki license
From: http://tiddlywiki.org/wiki/TiddlyWiki_License

{{{
TiddlyWiki created by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)

Copyright (c) UnaMesa Association 2004-2008

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.

Neither the name of the UnaMesa Association nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
}}}

!! ~TiddlySaver.jar License

From http://www.mail-archive.com/tiddlywiki@googlegroups.com/msg07643.html:

{{{
[tw] Re: Can TiddlyWiki and TiddlySaver.jar be redistributed? Licensing and copyright questions.

Jeremy Ruston
Sat, 01 Aug 2009 11:55:02 -0700

For licensing purposes TiddlySaver is intended to be considered to be
a component of TiddlyWiki, and available under the same terms.

Cheers

Jerm
}}}

!! Plugins from tiddlytools.com

All the plugins/scripts  from tiddlytools.com are covered by http://www.tiddlytools.com/#LegalStatements.

&lt;&lt;&lt;
This work is based upon TiddlyWiki &lt;&lt;version&gt;&gt;, written by Jeremy Ruston, &amp;copy; [[UnaMesa Association|http://www.unamesa.org/]] 2004-2008.

Modifications and additions to this work, including (but not limited to) original programmatic components (&quot;plugins&quot;, &quot;macros&quot;, &quot;scripts&quot;, &quot;stylesheets&quot;) have been created by Eric L. Shulman and/or ELS Design Studios.  These components are currently distributed using an ''open source'' model; however, they are ''not in the public domain'', and the author ''retains all applicable rights''.  Nonetheless, you //are// permitted to ''use, copy, and/or modify'' individual components of this work, subject to the licensing ''terms and conditions'' specifically included within or referenced by those individual components, as well as other terms, conditions, instructions, and guidelines included herein or by reference to the [[Creative Commons Attribution-ShareAlike 3.0 License|http://creativecommons.org/licenses/by-sa/3.0/]].

This work may contain portions of copyrighted materials from other sources.  In accordance with &quot;fair use&quot; principles (see [[United States Copyright Law, Title 17, Section 107|http://www.copyright.gov/title17/92chap1.html#107]]), such materials have been reproduced without profit for purposes of criticism, comment, news reporting, instruction, scholarship, and/or research.  ''All other original content, including (but not limited to) writings, illustrations, photographic images, sound recordings, and videos, are the property of Eric L. Shulman and/or ELS Design Studios, or are used under license or agreement with third parties'' and, except as required for normative operation and viewing of this work, may not be stored, displayed or re-transmitted in any form, nor used for any commercial purposes, without the specific prior permission of the respective rights holders.

This work includes or makes reference to icons that are part of the [[&quot;Silk&quot; icon set|http://www.famfamfam.com/lab/icons/silk/ ]] containing 1000 16-by-16 pixel icons in PNG format, created by Mark James, and is licensed under a Creative Commons Attribution 2.5 License. Please visit http://www.famfamfam.com/ for further information and licensing details regarding this icon set.

''Terms of use:''

This work contains ''individual components that are intended to be selectively copied and installed'' into your own TiddlyWiki files in order to enhance and customize those documents.  You may not re-distribute this document in it's entirety, nor re-use it's overall design without specific prior permission.  You may, however, ''download and save this work for use only as a //local// resource'' to assist you in developing your //own// TiddlyWiki document designs.

Because people can import plugins from anyone's TiddlyWiki document, as soon as you share your document with just ONE other person, you become a &quot;re-distributor&quot; of the components you have installed in that document.  As such, ''you should avoid modifying any ~TiddlyTools components you have installed in your own documents'' unless there is a compelling, //functional// reason to do so and, even then, ''the best approach is often to simply submit a feature request'' to the original author/publisher and leave it up to them to determine the best way to modify and re-publish their components.

Nonetheless, if you //do// modify and/or share components of this work, you should ''always retain the original published content within those those components'', including all documentation, credits, licensing information, and URL references to the official distribution source for the unaltered versions of those components.  In addition, ''all modified components must be clearly identifiable as derivative works'' that have been differentiated from the original versions by renaming those components, as well as adding inline comments and a &quot;revision history&quot; to document specific changes.

If you share a modified ~TiddlyTools component, you must be prepared to support it.  All ''problems that occur within a modified component should be reported first directly to the provider of that modified component'', and then only reported to ~TiddlyTools if it can be shown that the problem also occurs in ~TiddlyTools' officially-published version of the component.  Any ''problems that are reported for //undifferentiated// modifications won't receive help from ~TiddlyTools'' (once they are determined to be modified, of course!), other than to direct the inquiry to wherever they got the modified components from in the first place.

Except for officially-published links to specific components of this work, ''you must not create or share deep links'' to online components of this work (e.g., images, audio, video, etc.).  Instead, you should copy the desired components (subject to applicable licenses and copyrights) to your own system or online hosting service, and ensure that your document contains references to //those// copies.

''Trademarks/servicemarks:''

&quot;ELS Design Studios&quot;, &quot;~TiddlyTools&quot;, &quot;~TiddlyStudios&quot;, &quot;~TiddlyTech&quot;, &quot;~TiddlyLabs&quot;, &quot;Small Tools for Big Ideas!&quot;, &quot;Intuitive Interfaces for Intelligent Interactions&quot; and the &quot;i4&quot; logo (in graphical //and// text forms) are trademarks or servicemarks of ELS Design Studios and may not be used without permission.  Limited use of &quot;ELS Design Studios&quot; and &quot;~TiddlyTools&quot; marks in other works is granted for attribution purposes only.  Such use does not create or imply any endorsement, agency or partner relationship with Eric L. Shulman and/or ELS Design Studios, nor with any designated representatives, agents, or heirs thereof.

''Limits on Liability:''

All materials are presented on an &quot;as-is&quot; basis and are subject to change without notice.  The author of this document makes no claims regarding the suitability or reliability of the information presented, and assumes no liability for any damages that may occur as a result of its use.

''Privacy Notice: ''

This site limits the collection and use of non-public, personal customer information to that which is needed to offer products and services, and to file reports or financial statements as required by law. This site has physical, electronic and procedural safeguards to maintain the protections of private information, and does not provide, sell or otherwise disclose such information to non-affiliated third parties.
&lt;&lt;&lt;

!! Plugins from tiddlywiki.bidx.info

Licensed under BSD open source license. http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D

!! Plugins from tw.lewcid.org

Plugins created by Saq Imtiaz are covered under the creative commons license: http://creativecommons.org/licenses/by-sa/3.0/ license.

!! Plugins from tiddlywiki.abego-software.de

Are licensed under the Bsd License that is referenced from the plugin and is located at:
http://tiddlywiki.abego-software.de/#%5B%5BBSD%20open%20source%20license%5D%5D

!! Paulo Soares plugins

http://www.math.ist.utl.pt/~psoares/addons.html  licensed under http://creativecommons.org/licenses/by-sa/3.0/

!! ~Clint Checketts and Paul Petterson

RedirectMacro - Multiple attempts to contact the author have failed. From this thread:
&lt;&lt;&lt;
http://groups.google.com/group/tiddlywiki/browse_thread/thread/2e65045b53d231cf/efc9861ded20605e?q=redirect#efc9861ded20605e
&lt;&lt;&lt;
it appears to be abandoned. As a result it falls into the public domain.

!! TiddlyLockPlugin

http://creativecommons.org/licenses/by-sa/3.0/

!! RefreshCommand

Email addresses were changed to prevent harvesting.

{{{
From:    Simon Baird &lt;simon.baird at gmail dot .com&gt;
Subject: Re: Rights to redistribute the RefreshCommand

--0016e64bd5bc00cdad0471eff216
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit

Please go ahead.

License details for my TW related plugins:
http://mptw.tiddlyspot.com/#License%20TheBSDLicense

On Tue, Aug 25, 2009 at 2:23 PM, John P. Rouillard &lt;[[redacted]]&gt;wrote:

&gt;
&gt; Hello Mr. Baird:
&gt;
&gt; I am developing a TiddlyWiki for use in a class I am teaching.  I
&gt; would like to include your RefreshCommand plugin, however I am unable
&gt; to find any license/copyright for it.
&gt;
&gt; Since the TiddlyWiki will be distributed by the sponsor as part of the
&gt; materials for the course, I need to be able to satisfy them that I
&gt; have the right to redistribute the plugin as part of the course book.
&gt;
&gt; Also I plan on releasing the TiddlyWiki Coursebook for others to use
&gt; and as a result it would include a copy of your plugin.
&gt;
&gt; Do I have your permission to redistribute the plugin?
&gt;
&gt; Thank you for your time.
&gt;
}}}

!! DisplayOpenTiddlersPlugin

{{{
Date:    Wed, 26 Aug 2009 14:15:19 -0000
To:      rouilj@[[redacted]]

From:    shadowman131 at comcast dot net
Subject: Re: Right to redistribute the DisplayOpenTiddlersPlugin

------=_Part_192496_151585835.1251296119472
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

Hi John, 

You have absolute permission to distribute/modify DisplayOpenTiddlersPlugin as
much as you like. It was very kind of you to ask. Let me know if you happen to
need anything else.

Thanks, 
-Walt 

----- Original Message ----- 
From: &quot;John P. Rouillard&quot; &lt;rouilj at cs.umb.edu&gt; 
To: shadowman131 at comcast dot .net 
Sent: Monday, August 24, 2009 8:48:37 PM GMT -08:00 US/Canada Pacific 
Subject: Right to redistribute the DisplayOpenTiddlersPlugin 

Hello Mr. Woods: 

I am developing a TiddlyWiki for use in a class I am teaching. I 
would like to include your DisplayOpenTiddlersPlugin plugin, however I 
am unable to find any license/copyright for it. 

Since the tiddlywiki will be distributed by the sponsor as part of the 
materials for the course, I need to be able to satisfy them that I 
have the right to redistribute the plugin as part of the course book. 

Also I plan on releasing the TiddlyWiki Coursebook for other to use 
and as a result it would include a copy of your plugin. 

Do I have your permission to redistribute the plugin? 

Thank you for your time. 

Sincerely yours, 

-- 
-- rouilj 
John Rouillard 
}}}</pre>
</div>
<div title="CoreTweaksLocal" modifier="JohnRouillard" created="200903180244" modified="201007170407" tags="systemConfig excludeMissing">
<pre>/***
''Selective copy of www.tiddlytools.com CoreTweaks renamed so that updates don't pull in the full CoreTweaks.''
***/
/***
http://trac.tiddlywiki.org/ticket/683 - OPEN
The web standard 'type=file' input control that has been used as a local path/file picker for TiddlyWiki no longer works as expected in FireFox3, which has, for security reasons, limited javascript access to this control so that *no* local filesystem path information can be revealed, even when it is intentional and necessary, as it is with TiddlyWiki.  This tweak provides alternative HTML source that patches the backstage import panel.  It replaces the 'type=file' input control with a text+button combination of controls that invokes a system-native secure 'file-chooser' dialog box to provide TiddlyWiki with access to a complete path+filename so that TW functions properly locate user-selected local files.
&gt;Note: ''This tweak also requires http://trac.tiddlywiki.org/ticket/604 - cross-platform askForFilename()''

DISABLED: rolled into tw 2.5.2
***/
/***
//{{{
if (window.Components {
	var fixhtml='&lt;input name=&quot;txtBrowse&quot; style=&quot;width:30em&quot;&gt;&lt;input type=&quot;button&quot; value=&quot;...&quot;'
		+' onClick=&quot;window.browseForFilename(this.previousSibling,true)&quot;&gt;';
	var cmi=config.macros.importTiddlers;
	cmi.step1Html=cmi.step1Html.replace(/&lt;input type='file' size=50 name='txtBrowse'&gt;/,fixhtml);
}

merge(config.messages,{selectFile:'Please enter or select a file'}); // ready for I18N translation

window.browseForFilename=function(target,mustExist) { // note: both params are optional
	var msg=config.messages.selectFile;
	if (target &amp;&amp; target.title) msg=target.title; // use target field tooltip (if any) as dialog prompt text
	// get local path for current document
	var path=getLocalPath(document.location.href);
	var p=path.lastIndexOf('/'); if (p==-1) p=path.lastIndexOf('\\'); // Unix or Windows
	if (p!=-1) path=path.substr(0,p+1); // remove filename, leave trailing slash
	var file=''
	var result=window.askForFilename(msg,path,file,mustExist); // requires #604
	if (target &amp;&amp; result.length) // set target field and trigger handling
		{ target.value=result; target.onchange(); }
	return result; 
}
//}}}
***/
/***
!!!604 cross-platform askForFilename()
***/
/***
http://trac.tiddlywiki.org/ticket/604 - OPEN
invokes a system-native secure 'file-chooser' dialog box to provide TiddlyWiki with access to a complete path+filename so that TW functions properly locate user-selected local files.

DISABLED: rolled into tw 2.5.2
***/
/***
//{{{
window.askForFilename=function(msg,path,file,mustExist) {
	var r = window.mozAskForFilename(msg,path,file,mustExist);
	if(r===null || r===false)
		r = window.ieAskForFilename(msg,path,file,mustExist);
	if(r===null || r===false)
		r = window.javaAskForFilename(msg,path,file,mustExist);
	if(r===null || r===false)
		r = prompt(msg,path+file);
	return r||'';
}

window.mozAskForFilename=function(msg,path,file,mustExist) {
	if(!window.Components) return false;
	try {
		netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
		var nsIFilePicker = window.Components.interfaces.nsIFilePicker;
		var picker = Components.classes['@mozilla.org/filepicker;1'].createInstance(nsIFilePicker);
		picker.init(window, msg, mustExist?nsIFilePicker.modeOpen:nsIFilePicker.modeSave);
		var thispath = Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);
		thispath.initWithPath(path);
		picker.displayDirectory=thispath;
		picker.defaultExtension='html';
		picker.defaultString=file;
		picker.appendFilters(nsIFilePicker.filterAll|nsIFilePicker.filterText|nsIFilePicker.filterHTML);
		if (picker.show()!=nsIFilePicker.returnCancel)
			var result=picker.file.persistentDescriptor;
	}
	catch(ex) { displayMessage(ex.toString()); }
	return result;
}

window.ieAskForFilename=function(msg,path,file,mustExist) {
	if(!config.browser.isIE) return false;
	try {
		var s = new ActiveXObject('UserAccounts.CommonDialog');
		s.Filter='All files|*.*|Text files|*.txt|HTML files|*.htm;*.html|';
		s.FilterIndex=3; // default to HTML files;
		s.InitialDir=path;
		s.FileName=file;
		return s.showOpen()?s.FileName:'';
	}
	catch(ex) { displayMessage(ex.toString()); }
	return result;
}

window.javaAskForFilename=function(msg,path,file,mustExist) {
	if(!document.applets['TiddlySaver']) return false;
	// TBD: implement java-based askFile(...) function
	try { return document.applets['TiddlySaver'].askFile(msg,path,file,mustExist); } 
	catch(ex) { displayMessage(ex.toString()); }
}
//}}}
***/

/***
!!!529 IE fixup - case-sensitive element lookup of tiddler elements
***/
/***
http://trac.tiddlywiki.org/ticket/529 - OPEN
This tweak hijacks the standard browser function, document.getElementById(), to work-around the case-INsensitivity error in Internet Explorer (all versions up to and including IE7) //''Note: This tweak is only applied when using IE, and only for lookups of rendered tiddler elements within the containing 'tiddlerDisplay' element.''//
***/
//{{{
if (config.browser.isIE) {
document.coreTweaks_coreGetElementById=document.getElementById;
document.getElementById=function(id) {
	var e=document.coreTweaks_coreGetElementById(id);
	if (!e || !e.parentNode || e.parentNode.id!='tiddlerDisplay') return e;
	for (var i=0; i&lt;e.parentNode.childNodes.length; i++)
		if (id==e.parentNode.childNodes[i].id) return e.parentNode.childNodes[i];
	return null;
};
}
//}}}

/***
!!! 1134 handle references to tiddler sections in shadows
***/
/***
http://trac.tiddlywiki.org/ticket/1134
This tweak REPLACES and extends {{{store.getTiddlerText()}}} so it can return sections defined in shadow tiddlers.  It also permits use of leading whitespace in section headings.
***/
//{{{
TiddlyWiki.prototype.getTiddlerText = function(title,defaultText)
{
	if(!title) return defaultText;
	var parts = title.split(config.textPrimitives.sectionSeparator);
	var title = parts[0];
	var section = parts[1];
	var parts = title.split(config.textPrimitives.sliceSeparator);
	var title = parts[0];
	var slice = parts[1]?this.getTiddlerSlice(title,parts[1]):null;
	if(slice) return slice;
	var tiddler = this.fetchTiddler(title);
	var text = defaultText;
	if(this.isShadowTiddler(title))
		text = this.getShadowTiddlerText(title);
	if(tiddler)
		text = tiddler.text;
	if(!section) return text;
	var re = new RegExp(&quot;(^!{1,6}[ \t]*&quot; + section.escapeRegExp() + &quot;[ \t]*\n)&quot;,&quot;mg&quot;);
	re.lastIndex = 0;
	var match = re.exec(text);
	if(match) {
		var t = text.substr(match.index+match[1].length);
		var re2 = /^!/mg;
		re2.lastIndex = 0;
		match = re2.exec(t); //# search for the next heading
		if(match)
			t = t.substr(0,match.index-1);//# don't include final \n
		return t;
	}
	return defaultText;
};
//}}}

/***
!!!608/609/610 toolbars - toggles, separators and transclusion
***/
/***
http://trac.tiddlywiki.org/ticket/608 - OPEN (more/less toggle)
http://trac.tiddlywiki.org/ticket/609 - OPEN (separators)
http://trac.tiddlywiki.org/ticket/610 - OPEN (wikify tiddler/slice/section content)

This combination tweak extends the &quot;&quot;&quot;&lt;&lt;toolbar&gt;&gt;&quot;&quot;&quot; macro to add use of '&lt;' to insert a 'less' menu command (the opposite of '&gt;' == 'more'), as well as use of '*' to insert linebreaks and &quot;!&quot; to insert a vertical line separator between toolbar items.  In addition, this tweak add the ability to use references to tiddlernames, slices, or sections and render their content inline within the toolbar, allowing easy creation of new toolbar commands using TW content (such as macros, links, inline scripts, etc.)

To produce a one-line style, with &quot;less&quot; at the end, use
| ViewToolbar| foo bar baz &gt; yabba dabba doo &lt; |
or to use a two-line style with more/less toggle:
| ViewToolbar| foo bar baz &gt; &lt; * yabba dabba doo |
***/
//{{{
merge(config.macros.toolbar,{
	moreLabel: 'more\u25BC',
	morePrompt: 'Show additional commands',
	lessLabel: '\u25C4less',
	lessPrompt: 'Hide additional commands',
	separator: '|'
});
config.macros.toolbar.onClickMore = function(ev) {
	var e = this.nextSibling;
	e.style.display = 'inline'; // show menu
	this.style.display = 'none'; // hide button
	return false;
};
config.macros.toolbar.onClickLess = function(ev) {
	var e = this.parentNode;
	var m = e.previousSibling;
	e.style.display = 'none'; // hide menu
	m.style.display = 'inline'; // show button
	return false;
};
config.macros.toolbar.handler = function(place,macroName,params,wikifier,paramString,tiddler) {
	for(var t=0; t&lt;params.length; t++) {
		var c = params[t];
		switch(c) {
			case '!':  // ELS - SEPARATOR (added)
				createTiddlyText(place,this.separator);
				break;
			case '*':  // ELS - LINEBREAK (added)
				createTiddlyElement(place,'BR');
				break;
			case '&lt;': // ELS - LESS COMMAND (added)
				var btn = createTiddlyButton(place,
					this.lessLabel,this.lessPrompt,config.macros.toolbar.onClickLess,'moreCommand');
				break;
			case '&gt;':
				var btn = createTiddlyButton(place,
					this.moreLabel,this.morePrompt,config.macros.toolbar.onClickMore,'moreCommand');
				var e = createTiddlyElement(place,'span',null,'moreCommand');
				e.style.display = 'none';
				place = e;
				break;
			default:
				var theClass = '';
				switch(c.substr(0,1)) {
					case '+':
						theClass = 'defaultCommand';
						c = c.substr(1);
						break;
					case '-':
						theClass = 'cancelCommand';
						c = c.substr(1);
						break;
				}
				if(c in config.commands)

					this.createCommand(place,c,tiddler,theClass);
				else { // ELS - WIKIFY TIDDLER/SLICE/SECTION (added)
					if (c.substr(0,1)=='~') c=c.substr(1); // ignore leading ~
					var txt=store.getTiddlerText(c);
					if (txt) {
						// trim any leading/trailing newlines
						txt=txt.replace(/^\n*/,'').replace(/\n*$/,'');
						// trim PRE format wrapper if any
						txt=txt.replace(/^\{\{\{\n/,'').replace(/\n\}\}\}$/,'');
						// render content into toolbar
						wikify(txt,createTiddlyElement(place,'span'),null,tiddler);
					}
				} // ELS - end WIKIFY CONTENT
				break;
		}
	}
};
//}}}
</pre>
</div>
<div title="Course Structure" modifier="JohnRouillard" created="200907111939" modified="200909020144" tags="slide content">
<pre>This course has:
&lt;html&gt;
&lt;ul&gt;
&lt;li class=&quot;overlay1&quot;&gt;Presentations - instructor led slide shows&lt;/li&gt;
&lt;li class=&quot;overlay2&quot;&gt;Chapters - additional contents that extends the presentations and reference material&lt;/li&gt;
&lt;li class=&quot;overlay3&quot;&gt;Quizzes - usually included in the chapters, these test your knowledge of the material&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
{{overlay4 {
All three are accessible from the left hand menu
}}}</pre>
</div>
<div title="Coursebook Orientation" modifier="JohnRouillard" created="200907111943" modified="200909020331" tags="slide content">
<pre>In normal mode coursebook has a three column layout:
* left - the MainMenu has links to the major components of the coursebook
* center - called the story column (or just story) contains the tiddlers for reading
* right - controls to search, jump to tiddlers, save configure and get additional info

@@display: block;text-align: center;[img(75%,)[Frontscreen.png]]@@

In presentation (slide show) mode the three columns are reduced to one and a slide is shown full screen.</pre>
</div>
<div title="Creating Chapter Content" modifier="JohnRouillard" created="201007311925" modified="201008081900" tags="content">
<pre>There are three ways to create chapter content:
# writing as separate small tiddlers
# writing as single tiddler and split into multiple tiddlers
# writing as a single large tiddler

!! Writing as Separate Small Tiddlers

* advantages
** it's the tiddlywiki way: small units of microcontent that can be searched, annotated and combined
** works well from an outline as each subhead is a tiddler
** can be expanded easily to include subsub heads as individual tiddlers
**  allows search to isolate just the small tiddler unit that matches the search
** since notes are at tiddler level, the notes are closely associated with the microcontent tiddler making them more useful and placing them in context
* disadvantages
** creates a lot of tiddlers and it's easy to get lost in multitudes of tiddlers
** writing is fragmented and flow through the chapter is sacrificed or harder to get
**  editing subitems needs to be done in tiddlywiki interface. Can't use other tools (e.g. a full featured editor with search/replace) easily.

!! Write as Single Tiddler and Split into Multiple Tiddlers

In this case you write a single large tiddler and when it is nearly complete, you use section heads and the SplitTiddler function to split it into separate bite size tiddlers.

* advantages
** provides microcontent tiddlers
** can be made to use subtiddlers (e.g. for second or third level items in an outline), but doing so selectively without manual cut and paste is a bit trickier
** large chapter format is easier to edit in a word processor or other tool
** better flow of text from section to section
** allows search to isolate just the small tiddler unit that matches the search
** since notes are at tiddler level, the notes are closely associated with the microcontent tiddler making them more useful and placing them in context. But usually the context is larger in this method compared to writing content as multiple tiddlers to begin with.
* disadvantages
** better text flow may not make sense when tiddlers are split apart (since tiddlers are stand alone, units, reference to other content is the chapter is in a different tiddler that may not be displayed)
** links to other content within the chapter usually have to be redone
** spitting the chapter content using SplitTiddler is a little tricky and may require additional effort

!! writing as a single large tiddler
You can also write a chapter as one large multi-page/screen tiddler.

* advantages
** better flow of text in chapter since the content isn't able to be displayed as individual tiddlers which breaks the flow
** ability to use external authoring tools
* disadvantages
** not the tiddlywiki way
** searching pulls up entire chapter and not the focused micro content, so browser search function may be needed to find desired content rather than being able to visually scan
** bookmarking tiddler is less useful because of larger scope of content
** notes/annotations by student are at the tiddler level, so a large chapter tiddler moves the notes far from where they are meant to be used and context for the notes is lost

Note that the content of the chapter needs to be in a separate tiddler linked from the control tiddler to make the standard links/section mechanisms work.
</pre>
</div>
<div title="Creating Chapter Content as Separate Tiddlers" modifier="JohnRouillard" created="201007311933" modified="201008081901" tags="content">
<pre>Create a new chapter control tiddler by selecting the @@new chapter tiddler@@ link from the sidebar.

In the tiddler create links to the subtiddlers. If you have an outline or mindmap of the content, the first and second level headers can be pasted into the tiddler and surrounded with double brackets {{[[...]]}} to create link from the entry. Once you are done editing, you have a list of tiddlers in the chapter. If the tiddler doesn't exist the link is in italics (links to existing tiddlers are in bold face type e.g. [[Creating Chapter Content as Separate Tiddlers]]).

For each link pointing to a non-existent tiddler click on the link to open the placeholder. The edit the place holder to add the content. Also you must add the tag {{{content}}} tag to the tiddler if the students should see the content. Continue until all the content has been created.

In the first tiddler of the chapter prepend {{{&lt;&lt;tiddler ChapterStart&gt;&gt;}}} to the first line of the tiddler. This will make the tiddler start on a new page when printed.
</pre>
</div>
<div title="Creating Chapter Content as Single Large Tiddler" modifier="JohnRouillard" created="201007312012" modified="201008081903" tags="content">
<pre>Create a new chapter control tiddler by selecting the @@new chapter tiddler@@ link from the sidebar and create a link to the large tiddler you will be editing. E.G. IF you have created the {{{Chapter  2 - chapter title here}}} control tiddler add the link to your content tiddler. For example: {{{[[chapter title here]]}}} and save the control tiddler.

Click on the link in italics, tag it with the {{{content}}} tag and start writing. Start the tiddler with {{{&lt;&lt;tiddler ChapterStart&gt;&gt;}}} prepended to the first line of the tiddler. This will make the tiddler start on a new page when printed.
</pre>
</div>
<div title="Creating Chapter Content as Single Tiddler and Split Into Multiple Tiddlers" modifier="JohnRouillard" created="201007311944" modified="201008081903" tags="content">
<pre>Create a new chapter control tiddler by selecting the @@new chapter tiddler@@ link from the sidebar and create a link to the large tiddler
you will be editing. E.G. IF you have created the Chapter 2 control tiddler add the link: {{{[[SOURCE Chapter  2 -- chapter title here]]}}}
and save the control tiddler. FIXME is this needed? Inde tiddler after split canbe made into control tiddler.

Click on the SOURCE link in the control tiddler and write your large tiddler using TiddlyWiki markup for the section heads. Tag the SOURCE tiddler with {{{InstructorOnly}}} as the SOURCE tiddler won't get published to the students. As you write assume each level 1 header (prefixed with a {{{!}}}) will be a tiddler. The level 2 headers (prefixed with  {{{!!}}}) may also become tiddlers depending on the length of the sections and your preference.

When the SOURCE tiddler is sufficiently polished break it apart by following the directions in [[Splitting Chapters]].

After you have split the tiddlers, make sure the first tiddler in the chapter has {{{&lt;&lt;tiddler ChapterStart&gt;&gt;}}} prepended to the first line of the tiddler. This will make the tiddler start on a new page when printed.
</pre>
</div>
<div title="Creating PDF's" modifier="JohnRouillard" created="201008071835" modified="201008072234">
<pre>When teaching the delivery of content is often required to be in a particular form. PDF is often used as the deliverable format because it is portable to many platforms (MS Windows, Apple, Linux, Unix) and is not able to be modified by default preserving the author's original intent. Note that creating pdf's is somewhat tedious and time consuming, so you may want to do it for only your final release.

To create a pdf that visually replicates the information in the Coursebook under MS Windows, you can use the free [[PDFCreator|http://sourceforge.net/projects/pdfcreator/]]. PDFCreator creates a new printer under windows and printing to that printer creates a pdf file. Details on setup/tuning can be found at http://www.linux.com/archive/feed/59229.

Once PDFCreator is installed, printing to the new printer produces a pdf file with the following restrictions:
* links are displayed as links but don't actually work
* no bookmarks are created (but see below)
* no active content (e.g. popups are supported)

You can add bookmarks to the pdf document using the free [[JPdfBookmarks|http://sourceforge.net/projects/jpdfbookmarks/]] software. It is written in java, so it should be usable on all the platforms java supports. An example using it is available at: http://www.freewaregenius.com/2010/05/24/how-to-add-bookmarks-to-a-pdf-document-using-free-software/.

Below I discuss printing details for slides/presentations and chapters.

!! Printing Presentations/Slides in 2up Format

Display your presentation for printing as described in [[Printing Slide Set]] using the steps for SlideShowPlugin print mode.

Choose Page Setup from the browsers menu. In the Page Setup/Margins dialog, set:
* left header to document title
* middle header to nothing
* right header to Page N of M (sometimes displayed as page # of #)
* left footer to the course instance, e.g. a short name/date string using the custom setting
* middle footer to the title of your course using the custom setting
* right footer to print date and time (used to identify which slide set you are looking at if multiple printouts were done at different times).
Each slide will be printed with these 5 pieces of info.

Since slides are displayed at a larger font than a chapter you can usually print them 2-up on a page. This also provides some room for students to write notes under each slide.

Set an appropriate title for the printed slide set using @@change title@@ from the instructor menu in the right sidebar as described in [[instructor menu|TiddlyWiki Page Layout (Instructor)##instructorMenu]]. Then use your browser's print menu item to start the printer setup process.
Set the print mode to 2up by:
* Choose the PDFCreator printer from the drop down selector.
* Choose Properties/Layout (or Properties/Advanced/Printing defaults)
* Set the Pages per sheet to 2
* Select ok to get back to the Print dialog.
Start printing by clicking on &quot;OK&quot; in the print dialog. This will pop up the PDFCreator configuration tool. Select autosave from the left hand tree and set the output directory. Set the filename to {{{&lt;Title&gt;-&lt;DateTime&gt;}}}. Note that the first 10 characters of the title of the web page must are used for the {{{&lt;Title&gt;}}} token.
As a result the title must be unique in the first 10 or so characters as that is used to determine the output file name. Adding the {{{&lt;DateTime&gt;}}} is optional, but it will prevent overwriting the file if you don't have a unique 10 characters at the beginning of the page title. You can also set other options as described in http://www.linux.com/archive/feed/59229 if you haven't already done so, but it will take effect only for this printing session.

When PDFCreator is set to autosave, it will generate a file in the autosave directory and optionally pull up the default pdf viewer on the file.

When all the slide show proofs look ok, use [[pdftk|http://www.accesspdf.com/pdftk/]] to combine them into a single pdf file:
{{{
pdftk Presentation\ ?\ *.pdf Presentation\ ??\ *.pdf cat output ../pdf/S2_SEC_Presentations.pdf
}}}
Go through the pdf file with a couple of pdf readers (acrobat and foxit for example) to verify headers on top left match the presentation, lines aren't too long which results in them being cut off etc.

!!  Chapters (1 up)
Chapters are usually printed with a page on a single sheet of paper. To start display one or more chapters for printing as described in [[Printing Chapters]].

Choose Page Setup from the browsers menu. In the Page Setup/Margins dialog, set:
* left header to document title
* middle header to nothing
* right header to Page N of M (sometimes displayed as page # of #)
* left footer to the course instance, e.g. a short name/date string using the custom setting
* middle footer to the title of your course using the custom setting
* right footer to print date and time (used to identify which slide set you are looking at if multiple printouts were done at different times).
Each slide will be printed with these 5 pieces of info.

Set an appropriate title for the printed slide set using @@change title@@ from the instructor menu in the right sidebar as described in [[instructor menu|TiddlyWiki Page Layout (Instructor)##instructorMenu]].  For example set it to &quot;Chapter 1-5&quot;  or &quot;Chapters 6-10&quot;. All the rest of the header/footer info stays the same. Then in the browser

* Use control-p or the print menu item to pull up the print dialog
* Choose the PDFCreator printer from the drop down selector.
* Choose Properties/Layout (or Properties/Advanced/Printing defaults)
* Set the Pages per sheet to 1
* Select ok to get back to the Print dialog.
Clicking on the &quot;OK&quot; button will start the printing process.</pre>
</div>
<div title="Creating Quizzes" modifier="JohnRouillard" created="201007312049" modified="201008081914" tags="content quiz">
<pre>To create new quiz tiddler:
# create a new content tiddler using @@new content tiddler@@ and add a link to it to an existing chapter or other tiddler.
# tag the tiddler with {{{quiz}}}. This allows it to show up in the  list of all quizzes in the QuizList tiddler.

The using the syntax of the  [[QuizzerPlugin|QuizzerPluginDoc]] create your quiz entries:
* select the correct item
* true/false question
* select all correct items
* respond as an essay answer

!! Select One Item Question

Example:

(FIXME the plugin is broken with 2.6 of tw core)
; 1: What is the unit of content in a TiddlyWiki called
&lt;&lt;quiz type:S= id:contenttw &gt;&gt; page
&lt;&lt;quiz type:S= id:contenttw value:true &gt;&gt; tiddler
&lt;&lt;quiz type:S= id:contenttw &gt;&gt; splonk
&lt;&lt;quiz type:S= id:contenttw &gt;&gt; content

The code to produce this quiz is:
{{{
; 1: What is the unit of content in a TiddlyWiki called
&lt;&lt;quiz type:S= id:contenttw &gt;&gt; page
&lt;&lt;quiz type:S= id:contenttw value:true &gt;&gt; tiddler
&lt;&lt;quiz type:S= id:contenttw &gt;&gt; splonk
&lt;&lt;quiz type:S= id:contenttw &gt;&gt; content
}}}

!! True/False Question

; 2: Classify the following sentences as ''true'' or ''false'':
| T/F ||h
|&lt;&lt;quiz type:T= value:true id:Q2.1&gt;&gt;|A. The Earth is bigger than the Sun. |
|&lt;&lt;quiz type:T= id:Q2.2&gt;&gt;|B. If all men are mortal, and John is a man, then John is mortal.|
|&lt;&lt;quiz type:T value:true id:Q2.3&gt;&gt;|C. The Earth is bigger then Saturn.|
|&lt;&lt;quiz type:T id:Q2.4&gt;&gt;|D. 2+2 = 4.|

The code to produce this quiz is:
{{{
; 2: Classify the following sentences as ''true'' or ''false'':
| T/F ||h
|&lt;&lt;quiz type:T= value:true id:Q2.1&gt;&gt;|A. The Earth is bigger than the Sun. |
|&lt;&lt;quiz type:T= id:Q2.2&gt;&gt;|B. If all men are mortal, and John is a man, then John is mortal.|
|&lt;&lt;quiz type:T value:true id:Q2.3&gt;&gt;|C. The Earth is bigger then Saturn.|
|&lt;&lt;quiz type:T id:Q2.4&gt;&gt;|D. 2+2 = 4.|
}}}

!! Select All Correct Items                
; 3:  Select all the valid SEC rule types
|&lt;&lt;quiz value:true score:5 &gt;&gt; calendar  |&lt;&lt;quiz score:-5 &gt;&gt; cron      |
|&lt;&lt;quiz score:-5 &gt;&gt; ignore                    |&lt;&lt;quiz value:true score:5 &gt;&gt; single       |
|&lt;&lt;quiz value:true score:5 &gt;&gt; suppress |&lt;&lt;quiz score:-5 &gt;&gt; handler |
|&lt;&lt;quiz value:true score:5 &gt;&gt; pair         |&lt;&lt;quiz value:true score:5 &gt;&gt; pairwithwindow |
|&lt;&lt;quiz score:-5&gt;&gt; triplet                     |&lt;&lt;quiz value:true score:5 &gt;&gt;singlewiththreshold |
|&lt;&lt;quiz score:-5 &gt;&gt; count                     |&lt;&lt;quiz score:-5&gt;&gt;threshold                              |

&lt;&lt;score&gt;&gt;

The code to create this is:
{{{
; 3:  Select all the valid SEC rule types
|&lt;&lt;quiz value:true score:5 &gt;&gt; calendar  |&lt;&lt;quiz score:-5 &gt;&gt; cron      |
|&lt;&lt;quiz score:-5 &gt;&gt; ignore                    |&lt;&lt;quiz value:true score:5 &gt;&gt; single       |
|&lt;&lt;quiz value:true score:5 &gt;&gt; suppress |&lt;&lt;quiz score:-5 &gt;&gt; handler |
|&lt;&lt;quiz value:true score:5 &gt;&gt; pair         |&lt;&lt;quiz value:true score:5 &gt;&gt; pairwithwindow |
|&lt;&lt;quiz score:-5&gt;&gt; triplet                     |&lt;&lt;quiz value:true score:5 &gt;&gt;singlewiththreshold |
|&lt;&lt;quiz score:-5 &gt;&gt; count                     |&lt;&lt;quiz score:-5&gt;&gt;threshold                              |

&lt;&lt;score&gt;&gt;
}}}

!! Respond as an Essay Answer
;4: Create a replacement for the following pair with window rule using contexts and single commands:
{{{
type=PairWithWindow
desc=Pair: the first event match
ptype=regexp
pattern=(Event) one
action=write - Pair: no event two seen
desc2=Pair the second event match
ptype2=regexp
pattern2=$1 two
action2= write - Pair: event one and two were seen
window = 20
}}}
Here is the sample input for [[play_events]]:
{{{
# will find both in the 20 second window
0 Event one
3 Event one
3 Something two
10 Event two
2 Event two
# will fail to find both in window
0 Event one
22 Event two
}}}
&lt;&lt;slider {{config.options['']=false;'';}} ./Answer1 &quot;Answer ...&quot; &quot;Answer to question&quot;&gt;&gt;
&lt;part Answer1 hidden&gt;
{{{
type = single
desc = The first event match
ptype = regexp
pattern = (Event) one
context = ! seen_$1_one
action = create seen_Event_one 20 write - Single: No event two seen

type = single
desc = The first event match - suppress while searching for event two
ptype = regexp
pattern = (Event) one
context = seen_$1_one
action = none

type = single
desc = The second event match
ptype = regexp
pattern = (Event) two
context = seen_$1_one
action = delete seen_$1_one; write - Single: event one and two were seen
}}}
&lt;/part&gt;

Edit this tiddler to see the code used to make this work.</pre>
</div>
<div title="Creating Reference Tiddlers" modifier="JohnRouillard" created="201007312131" modified="201007312143" tags="content">
<pre>To create tiddlers that can automatically show up in the [[reference]] tiddler:
# create a content tiddler using the @@new content tiddler@@ and add the {{{reference}}} tag to it.

Like Chapters, references are in alphabetic order. If you want another order editing ChapterList and replacing the matchtags macro with a manually ordered list of references. This way you can order the most used reference tiddlers at the top.
</pre>
</div>
<div title="Creating Your Own Presentation Theme" modifier="JohnRouillard" created="201007182106" modified="201007240200" tags="content">
<pre>The themes are created using CSS. You can see a couple of themes: InstructorSlideShowStyleSheet SlideShowTheme in this coursebook. For other info on creating slide, I suggest visiting the SlideShowPlugin author's site: 	http://www.math.ist.utl.pt/~psoares/addons.html and asking questions on the tiddlywiki google group: &lt;&lt;tiddler [[Resources::tiddlywikiGoogleGroup]]&gt;&gt;.</pre>
</div>
<div title="Creating a New Chapter from an Existing Tiddler" modifier="JohnRouillard" created="201007312017" modified="201007312146" tags="content">
<pre>Edit the tags on the tiddler prepending: {{{chapter story content}}} as first tags on the tiddler. Change title of tiddler if needed to make it show up in the correct place in the Chapter list in the MainMenu.  Note that content of the chapter tiddler is ignored by the chapter mechanism. Only links to other tiddlers int he chapter control tiddler are used. If you want the content of the tiddler to be displayed, move it to a new tiddler tagged with content and create a link to the new tiddler.

For the first tiddler in a chapter, prepend {{{&lt;&lt;tiddler ChapterStart&gt;&gt;}}} to the first line of the tiddler. This will make the tiddler start on a new page when printed.
</pre>
</div>
<div title="Creating a Presentation" modifier="JohnRouillard" created="201007181835" modified="201008012203" tags="content">
<pre>! Creating the Presentation
There are two ways to create a presentation:
# From the right hand sidebar, choose @@new presentation@@
## a tiddler tagged with {{{presentation content story}}} is created
## add a title in the top single line box. Presentations are sorted by title so a standard title prefix &quot;Presentation  1&quot; with two spaces before the 1 allows sorting to work properly as it sorts {{{Presentation  1}}} before &quot;Presentation 11&quot;. Note that some browsers (IE for example) don't display the full presentation title in the pull down list in the MainMenu on the left hand side of the display. As a result you should make title unique in first 15 characters to allow the user to properly identify and select the presentation from the pull down list.
## add double bracketed references to the titles of the slides to be displayed in this presentation to the tiddler. For example: {{{[[Introduction to the topic]] [[More info on topic]]}}} ...
## if a slide is missing, it will be in italics and not normal bolded text
## click on each slide title reference to create/edit the slide. Add the tags {{{slide content}}} to the beginning of the tag list (in the bottom single line box if needed.
# edit existing tiddler
## add the tags {{{presentation content story}}} as the first tags on the tiddler
## change title of tiddler if needed
## proceed as above with adding double bracketed references to the presentation tiddler.

The procedures above create a multi-tiddler presentation. If you want to create a single tiddler presentation, the process is similar:
# From the right hand sidebar, choose @@new presentation@@
# delete the {{{story}}} tag from the tiddler.
##  Rather than creating links/reference to tiddlers, each slide is separated from the next by the use of {{{-s-}}} markers in the tiddler. Each @@white-space:nowrap;{{{-s-}}}@@ sits on a line of it's own.
## You need to include a custom slideShow start button that uses the single keyword at the top of the tiddler.
*** For example: &lt;&lt;tiddler [[Creating a Presentation##SlideButton]]&gt;&gt;
*** {{{exclude}}} prevents any WikiWords or bracketed references from being part of the slide show
*** {{{comment}}} prevents the button from showing up on the slide
** Include the comment class in the button text so that WikiWords in the slideShow macro don't show up as slides in the presentation.

Tiddlers tagged with Presentation are automatically included in the PresentationList tiddler which formats the Presentation section in the MainMenu displayed on the left hand side of the coursebook. If you want to change the way the presentations are displayed, edit the PresentationList tiddler. Also if you want to order the presentations explicitly, you will need to edit the PresentationList tiddler and explicitly add links for all the presentations you want to have displayed.

/%
A tiddlywiki trick to create a hidden section that will be included in the visible topic using a tiddler macro call. This
gets around parsing issues when you have a lot of tiddlywiki markup involved.
!SlideButton
{{{
{{exclude comment{&lt;&lt;slideShow single  theme:InstructorSlideShowStyleSheet3 toc:header  footer:&quot;copyright&amp;copy; 2010&quot;  label:&quot;Start autoplay&quot; tooltip:&quot;Autoplay show in instructor projection mode&quot; cycle auto:10&gt;&gt; }}}
}}}
!end
%/</pre>
</div>
<div title="Creating a Slide" modifier="YourName" created="201007182010" modified="201007270333" tags="content">
<pre>There are two ways to make a slide:

# From the right sidebar, choose @@new slide@@
** a tiddler tagged with *slide content* is created.
** edit slide
** add reference to slide to a presentation tiddler. If the slide title is a WikiWord, just include the WikiWord otherwise place the slide title inside of double brackets. E.G. {{{[[slide title]]}}}. You can change the displayed name of the slide using the {{{[[descriptive string|slide title]]}}} linking mechanism
# edit existing tiddler
** add &quot;slide content&quot; as first tags on tiddler
** add reference to tiddler to existing presentation tiddler as above.

Add content to your slide using [[standard tiddlywiki markup|FormattingCheatSheet]] or you can embed raw html in the tiddler by surrounding the html with {{{&lt;html&gt;}}} and {{{&lt;/html&gt;}}} tags. If you want to place tiddlywiki markup inside of your html block, you will want to install the [[HtmlFormattingPlugin|http://www.TiddlyTools.com/#HTMLFormattingPluginInfo]] from 	http://www.TiddlyTools.com/#HTMLFormattingPlugin. ([img(16px,)[warning-icon.png]] Note that you will need to tag the plugin with the tag @@structure@@ so that it will be exported to the coursebook framework.)</pre>
</div>
<div title="Creating the Student's Coursebook" modifier="YourName" created="201007251945" tags="slide content">
<pre>The student textbook is a exported copy of the instructor book.

Use the:
* @@Instructor@@-&gt;@@save studentbook@@
* @@Instructor@@-&gt;@@save content@@
links in the right hand sidebar.

As with normal student and instructor text books, additional info in instructor book.

{{comment{
As discussed previously, the framework and content are separate entities that are combined to make the coursebook. The separate content allows updating of only the content in the coursebook without updating the javascript and other programmatic elements that make the coursebook work.
}}}</pre>
</div>
<div title="Creating visual html" modifier="JohnRouillard" created="201008072016" modified="201008072146" tags="content">
<pre>Besides producing PDF, you can create a snapshot of the page with the html required to display the same was as in tiddlywiki. Note that links (unless explicitly written using html) popups, sliders and other active content won't work as there is no javascript in the snapshot page to provide the functionality. However this may be a useful mechanism for somebody.

The [[snapshot plugin|http://www.tiddlytools.com/#SnapshotPluginInfo%20SnapshotPlugin]] can be [[imported|Using the Backstage Link##Importing a new plugin]] from http://www.tiddlytools.com and used to create a snapshot. The [[SnapshotPluginInfo|http://www.tiddlytools.com/#SnapshotPluginInfo]] tiddler describes how to use the plugin.
</pre>
</div>
<div title="CreatingChapters" modifier="JohnRouillard" created="201007050223" modified="201007050226" tags="content">
<pre>A chapter is an ordered list of tiddlers. The first tiddler in the chapter should start with:
{{{
&lt;&lt;tiddler ChapterStart&gt;&gt;
}}}

This will create a page break when printing the cgapter so it starts on a new page.
Follow it with the text of the tiddler on the same line right after the closing &gt;&gt;'s.

All the tiddlers for a chapter are gathered into a master chapter tiddler.
</pre>
</div>
<div title="Credits" modifier="JohnRouillard" created="200907042159" modified="201008081847" tags="content">
<pre>Author: John Rouillard rouilj+coursebook@cs.~NOSPAMumb.edu (remove NOSPAM from the address before sending)

Thanks to the following TiddlyWiki plugin authors for their adaptations and changes to plugins in response to the needs of this coursebook.

A special mention to Eric L. Shulman for his SectionLinksPlugin and many others. Also credit must be given for his extensive help in IRC with debugging this coursebook.

Paulo Soares: SlideShowPlugin

Plus I must thank the staff at the University of Massachusetts at Boston Math and Computer Science departments for their continued support.</pre>
</div>
<div title="DefaultTiddlers" modifier="JohnRouillard" created="200903151820" modified="200909050106" tags="InstructorOnly">
<pre>ReadMe
[[Welcome]]
</pre>
</div>
<div title="DeletedTiddler" modifier="JohnRouillard" created="200907260036" modified="200910251755" tags="structure">
<pre>The tiddlers marked with DeletedTiddler have been superseded by other tiddlers. To cleanup your coursebook, delete them.

If there are any tiddlers you need to delete, there will be a grey box marked &quot;tagging&quot; on the top left (not to be confused with the &quot;tags&quot; box on the right). You can go through each tiddler and find out why it was deleted and preserve any notes you may have for that tiddler before you delete it.

The following link will delete them automatically, it can not be undone, you will have to reload this tiddlywiki before saving or go to backups to recover the tiddlers.

&lt;script label=&quot;Remove the tiddlers marked with DeletedTiddlers&quot;&gt;
var tids=store.getTaggedTiddlers('DeletedTiddler'); for (var t=0; t&lt;tids.length; t++) store.deleteTiddler(tids[t].title);
displayMessage('Deleted ' + tids.length + ' tiddlers.');
&lt;/script&gt;

After deleting the tiddlers, you need to save the coursebook using the ''save changes'' link in the right hand sidebar. Note that there may not be any indication that the coursebook has changed.</pre>
</div>
<div title="Differences between student and instructor books" modifier="YourName" created="201007251947" tags="slide content">
<pre>* Instructor has tools for improving editing/creation
* Instructor tiddlywiki has themes for presentations
* Student is a read-mostly config
* Instructor book can publish documents
</pre>
</div>
<div title="Display a Presentation" modifier="JohnRouillard" created="201007182013" modified="201007182124" tags="content">
<pre>There are two ways to start a presentation:
# Choose the presentation title link from the presentation link section
** In the instructor coursebook it starts the presentation with the [[instructor theme|InstructorSlideShowStyleSheet]].
** In the student coursebook it starts the presentation with the [[student theme|SlideShowTheme]]
# Open the presentation control tiddler and chose the Instructor, Student or Print display mode.
</pre>
</div>
<div title="DisplayOpenTiddlersPlugin" modifier="JohnRouillard" created="200909061913" modified="200909120054" tags="Plugin systemConfig">
<pre>/***
|Name|DisplayOpenTiddlersPlugin|
|Location|http://www.orst.edu/~woodswa/tiddlywikiplugs.html|
|Version|1.0|
|Author|Walt Woods|
|Requirements||

!Description
Displays similar to the popular BreadCrumbsPlugin by AlanHecht, this plugin instead keeps a list of currently open tiddlers.

!History
09-06-2009: JohnRouillard modified seperator between items on tiddler line.
08-06-2007: Initial version.

!Code
***/
//{{{
version.extensions.DisplayOpenTiddlers = {major: 1, minor: 0, revision: 0};

function addOpenTiddlerLine(title, element)
{
 if (title != openTiddlerClosing)
 {
  if (tiddlerLine != &quot;&quot;)
   tiddlerLine += &quot; &amp;bull; &quot;;
  tiddlerLine += &quot;[[&quot; + title + &quot;]]&quot;;
 }
}

function refreshOpenTiddlersList()
{
 if (!document.getElementById(&quot;openTiddlers&quot;)) {
  var ta = document.createElement(&quot;div&quot;);
  ta.id = &quot;openTiddlers&quot;;
  ta.style.visibility= &quot;hidden&quot;;
  var targetArea = document.getElementById(&quot;tiddlerDisplay&quot;)||document.getElementById(&quot;storyDisplay&quot;);
  targetArea.parentNode.insertBefore(ta,targetArea);
 }

 var tiddlers = document.getElementById(&quot;openTiddlers&quot;);
 tiddlers.style.visibility = &quot;visible&quot;;
 removeChildren(tiddlers);
 
 tiddlerLine = &quot;&quot;;
 story.forEachTiddler(addOpenTiddlerLine);
 wikify(tiddlerLine,tiddlers)
}

Story.prototype.displayTiddlerDisplayOpenTiddlers = Story.prototype.displayTiddler;
Story.prototype.displayTiddler = function(srcElement,title,template,animate,slowly)
{
 this.displayTiddlerDisplayOpenTiddlers(srcElement,title,template,animate,slowly);
 openTiddlerClosing = &quot;&quot;;
 refreshOpenTiddlersList();
}

Story.prototype.closeTiddlerDisplayOpenTiddlers = Story.prototype.closeTiddler;
Story.prototype.closeTiddler = function(title,animate,unused)
{
 this.closeTiddlerDisplayOpenTiddlers(title,animate,unused);
 openTiddlerClosing = title;
 refreshOpenTiddlersList();
}
//}}}</pre>
</div>
<div title="Dynamic Content" modifier="YourName" created="201007251932" modified="201007251932" tags="InstructorOnly">
<pre>! Dynamic content - footnotes, annotations, popups, sliders oh my

There are multiple ways to add dynamic content: i.e. content that displays something when triggered by mouse click, hover ...

|Technique                    |Popup  |Footnote    |Annotation  | Slider |h
|Display Location           |at site   |end tiddler |at site          |at site |
|Printable                       |yes       |yes            |no                |yes if open |
|Covers Text                  |yes       |no              |yes              |no moves text |

Annotations vs footnotes (really endnotes). Footnotes are displayed at the end of the tiddler and are displayed in print. Footnotes print after the tiddler is displayed. So the footnotes for the current chapter may be pushed to the top of the page for the next chapter when printed. Annotations are displayed in place, but obscure text and can not be printed, also their contents can't be clicked on or interacted with.

Popups used when I have a larger amount of text to show. More than 2-3 sentences. It should not be used for core content since it obscures text when displayed. Popups particularly good for navigation features, lists of terms/jumps to other tiddlers. It can be intereacted with by the user unlike annotations which disappear when the mouse is moved off the trigger.

Sliders like popups are good for large amounts of text. Can be printed and don't obscure other text.
They can be made to display or not display by default. They may simplify the layout of large text segments or allow optional segments to be hidden but still easily accessible if the student is interested.</pre>
</div>
<div title="EchoTiddler" modifier="YourName" created="201007270444">
<pre>$1</pre>
</div>
<div title="EditTemplate" modifier="JohnRouillard" created="200908250031" modified="200909052003" tags="InstructorOnly">
<pre>&lt;!--{{{--&gt;
&lt;!--added convert macro to toolbar--&gt;
&lt;div class='toolbar'&gt;&lt;span  macro='toolbar [[ToolbarCommands::EditToolbar]]'&gt;&lt;/span&gt;
&lt;span class='toolbar' macro='tiddler QuickEdit_convert'&gt;&lt;/span&gt; &lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit title'&gt;&lt;/div&gt;
&lt;div macro='annotations'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit text'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit tags'&gt;&lt;/div&gt;&lt;div class='editorFooter'&gt;&lt;span macro='message views.editor.tagPrompt'&gt;&lt;/span&gt;&lt;span macro='tagChooser excludeLists'&gt;&lt;/span&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="ExportTiddlersPlugin" modifier="ELSDesignStudios" created="200512240702" modified="201002252058" tags="systemConfig ImportExportPackage excludeMissing">
<pre>/***
|Name|ExportTiddlersPlugin|
|Source|http://www.TiddlyTools.com/#ExportTiddlersPlugin|
|Documentation|http://www.TiddlyTools.com/#ExportTiddlersPluginInfo|
|Version|2.9.5|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Description|interactively select/export tiddlers to a separate file|
!!!!!Documentation
&gt;see [[ExportTiddlersPluginInfo]]
!!!!!Inline control panel (live):
&gt;&lt;&lt;exportTiddlers inline&gt;&gt;
!!!!!Revisions
&lt;&lt;&lt;
2010.02.25 2.9.5 added merge checkbox option and improved 'merge' status message
|please see [[ExportTiddlersPluginInfo]] for additional revision details|
2005.10.09 0.0.0 development started
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
// version
version.extensions.ExportTiddlersPlugin= {major: 2, minor: 9, revision: 5, date: new Date(2010,2,25)};

// default shadow definition
config.shadowTiddlers.ExportTiddlers='&lt;&lt;exportTiddlers inline&gt;&gt;';

// add 'export' backstage task (following built-in import task)
if (config.tasks) { // TW2.2 or above
	config.tasks.exportTask = {
		text:'export',
		tooltip:'Export selected tiddlers to another file',
		content:'&lt;&lt;exportTiddlers inline&gt;&gt;'
	}
	config.backstageTasks.splice(config.backstageTasks.indexOf('importTask')+1,0,'exportTask');
}

config.macros.exportTiddlers = {
	$: function(id) { return document.getElementById(id); }, // abbreviation
	label: 'export tiddlers',
	prompt: 'Copy selected tiddlers to an export document',
	okmsg: '%0 tiddler%1 written to %2',
	failmsg: 'An error occurred while creating %1',
	overwriteprompt: '%0\ncontains %1 tiddler%2 that will be discarded or replaced',
	mergestatus: '%0 tiddler%1 added, %2 tiddler%3 updated, %4 tiddler%5 unchanged',
	statusmsg: '%0 tiddler%1 - %2 selected for export',
	newdefault: 'export.html',
	datetimefmt: '0MM/0DD/YYYY 0hh:0mm:0ss',  // for 'filter date/time' edit fields
	type_TW: &quot;tw&quot;, type_PS: &quot;ps&quot;, type_TX: &quot;tx&quot;, type_CS: &quot;cs&quot;, type_NF: &quot;nf&quot;, // file type tokens
	type_map: { // maps type param to token values
		tiddlywiki:&quot;tw&quot;, tw:&quot;tw&quot;, wiki: &quot;tw&quot;,
		purestore: &quot;ps&quot;, ps:&quot;ps&quot;, store:&quot;ps&quot;,
		plaintext: &quot;tx&quot;, tx:&quot;tx&quot;, text: &quot;tx&quot;,
		comma:     &quot;cs&quot;, cs:&quot;cs&quot;, csv:  &quot;cs&quot;,
		newsfeed:  &quot;nf&quot;, nf:&quot;nf&quot;, xml:  &quot;nf&quot;, rss:&quot;nf&quot;
	},
	handler: function(place,macroName,params) {
		if (params[0]!='inline')
			{ createTiddlyButton(place,this.label,this.prompt,this.togglePanel); return; }
		var panel=this.createPanel(place);
		panel.style.position='static';
		panel.style.display='block';
	},
	createPanel: function(place) {
		var panel=this.$('exportPanel');
		if (panel) { panel.parentNode.removeChild(panel); }
		setStylesheet(store.getTiddlerText('ExportTiddlersPlugin##css',''),'exportTiddlers');
		panel=createTiddlyElement(place,'span','exportPanel',null,null)
		panel.innerHTML=store.getTiddlerText('ExportTiddlersPlugin##html','');
		this.initFilter();
		this.refreshList(0);
		var fn=this.$('exportFilename');
		if (window.location.protocol=='file:' &amp;&amp; !fn.value.length) {
			// get new target path/filename
			var newPath=getLocalPath(window.location.href);
			var slashpos=newPath.lastIndexOf('/'); if (slashpos==-1) slashpos=newPath.lastIndexOf('\\'); 
			if (slashpos!=-1) newPath=newPath.substr(0,slashpos+1); // trim filename
			fn.value=newPath+this.newdefault;
		}
		return panel;
	},
	togglePanel: function(e) { var e=e||window.event;
		var cme=config.macros.exportTiddlers; // abbrev
		var parent=resolveTarget(e).parentNode;
		var panel=cme.$('exportPanel');
		if (panel==undefined || panel.parentNode!=parent)
			panel=cme.createPanel(parent);
		var isOpen=panel.style.display=='block';
		if(config.options.chkAnimate)
			anim.startAnimating(new Slider(panel,!isOpen,e.shiftKey || e.altKey,'none'));
		else
			panel.style.display=isOpen?'none':'block' ;
		if (panel.style.display!='none') {
			cme.refreshList(0);
			cme.$('exportFilename').focus(); 
			cme.$('exportFilename').select();
		}
		e.cancelBubble = true; if (e.stopPropagation) e.stopPropagation(); return(false);
	},
	process: function(which) { // process panel control interactions
		var theList=this.$('exportList'); if (!theList) return false;
		var count = 0;
		var total = store.getTiddlers('title').length;
		switch (which.id) {
			case 'exportFilter':
				count=this.filterExportList();
				var panel=this.$('exportFilterPanel');
				if (count==-1) { panel.style.display='block'; break; }
				this.$('exportStart').disabled=(count==0);
				this.$('exportDelete').disabled=(count==0);
				this.displayStatus(count,total);
				if (count==0) { alert('No tiddlers were selected'); panel.style.display='block'; }
				break;
			case 'exportStart':
				this.go();
				break;
			case 'exportDelete':
				this.deleteTiddlers();
				break;
			case 'exportHideFilter':
			case 'exportToggleFilter':
				var panel=this.$('exportFilterPanel')
				panel.style.display=(panel.style.display=='block')?'none':'block';
				break;
			case 'exportSelectChanges':
				var lastmod=new Date(document.lastModified);
				for (var t = 0; t &lt; theList.options.length; t++) {
					if (theList.options[t].value=='') continue;
					var tiddler=store.getTiddler(theList.options[t].value); if (!tiddler) continue;
					theList.options[t].selected=(tiddler.modified&gt;lastmod);
					count += (tiddler.modified&gt;lastmod)?1:0;
				}
				this.$('exportStart').disabled=(count==0);
				this.$('exportDelete').disabled=(count==0);
				this.displayStatus(count,total);
				if (count==0) alert('There are no unsaved changes');
				break;
			case 'exportSelectAll':
				for (var t = 0; t &lt; theList.options.length; t++) {
					if (theList.options[t].value=='') continue;
					theList.options[t].selected=true;
					count += 1;
				}
				this.$('exportStart').disabled=(count==0);
				this.$('exportDelete').disabled=(count==0);
				this.displayStatus(count,count);
				break;
			case 'exportSelectOpened':
				for (var t=0; t&lt;theList.options.length; t++) theList.options[t].selected=false;
				var tiddlerDisplay=this.$('tiddlerDisplay');
				for (var t=0; t&lt;tiddlerDisplay.childNodes.length;t++) {
					var tiddler=tiddlerDisplay.childNodes[t].id.substr(7);
					for (var i=0; i&lt;theList.options.length; i++) {
						if (theList.options[i].value!=tiddler) continue;
						theList.options[i].selected=true; count++; break;
					}
				}
				this.$('exportStart').disabled=(count==0);
				this.$('exportDelete').disabled=(count==0);
				this.displayStatus(count,total);
				if (count==0) alert('There are no tiddlers currently opened');
				break;
			case 'exportSelectRelated':
				// recursively build list of related tiddlers
				function getRelatedTiddlers(tid,tids) {
					var t=store.getTiddler(tid); if (!t || tids.contains(tid)) return tids;
					tids.push(t.title);
					if (!t.linksUpdated) t.changed();
					for (var i=0; i&lt;t.links.length; i++)
						if (t.links[i]!=tid) tids=getRelatedTiddlers(t.links[i],tids);
					return tids;
				}
				// for all currently selected tiddlers, gather up the related tiddlers (including self) and select them as well
				var tids=[];
				for (var i=0; i&lt;theList.options.length; i++)
					if (theList.options[i].selected) tids=getRelatedTiddlers(theList.options[i].value,tids);
				// select related tiddlers (includes original selected tiddlers)
				for (var i=0; i&lt;theList.options.length; i++)
					theList.options[i].selected=tids.contains(theList.options[i].value);
				this.displayStatus(tids.length,total);
				break;
			case 'exportListSmaller':	// decrease current listbox size
				var min=5;
				theList.size-=(theList.size&gt;min)?1:0;
				break;
			case 'exportListLarger':	// increase current listbox size
				var max=(theList.options.length&gt;25)?theList.options.length:25;
				theList.size+=(theList.size&lt;max)?1:0;
				break;
			case 'exportClose':
				this.$('exportPanel').style.display='none';
				break;
		}
		return false;
	},
	displayStatus: function(count,total) {
		var txt=this.statusmsg.format([total,total!=1?'s':'',!count?'none':count==total?'all':count]);
		clearMessage();	displayMessage(txt);
		return txt;
	},
	refreshList: function(selectedIndex) {
		var theList = this.$('exportList'); if (!theList) return;
		// get the sort order
		var sort;
		if (!selectedIndex)   selectedIndex=0;
		if (selectedIndex==0) sort='modified';
		if (selectedIndex==1) sort='title';
		if (selectedIndex==2) sort='modified';
		if (selectedIndex==3) sort='modifier';
		if (selectedIndex==4) sort='tags';

		// unselect headings and count number of tiddlers actually selected
		var count=0;
		for (var t=5; t &lt; theList.options.length; t++) {
			if (!theList.options[t].selected) continue;
			if (theList.options[t].value!='')
				count++;
			else { // if heading is selected, deselect it, and then select and count all in section
				theList.options[t].selected=false;
				for ( t++; t&lt;theList.options.length &amp;&amp; theList.options[t].value!=''; t++) {
					theList.options[t].selected=true;
					count++;
				}
			}
		}

		// disable 'export' and 'delete' buttons if no tiddlers selected
		this.$('exportStart').disabled=(count==0);
		this.$('exportDelete').disabled=(count==0);

		// show selection count
		var tiddlers = store.getTiddlers('title');
		if (theList.options.length) this.displayStatus(count,tiddlers.length);

		// if a [command] item, reload list... otherwise, no further refresh needed
		if (selectedIndex&gt;4) return;

		// clear current list contents
		while (theList.length &gt; 0) { theList.options[0] = null; }
		// add heading and control items to list
		var i=0;
		var indent=String.fromCharCode(160)+String.fromCharCode(160);
		theList.options[i++]=
			new Option(tiddlers.length+' tiddlers in document', '',false,false);
		theList.options[i++]=
			new Option(((sort=='title'   )?'&gt;':indent)+' [by title]', '',false,false);
		theList.options[i++]=
			new Option(((sort=='modified')?'&gt;':indent)+' [by date]', '',false,false);
		theList.options[i++]=
			new Option(((sort=='modifier')?'&gt;':indent)+' [by author]', '',false,false);
		theList.options[i++]=
			new Option(((sort=='tags'    )?'&gt;':indent)+' [by tags]', '',false,false);

		// output the tiddler list
		switch(sort) {
			case 'title':
				for(var t = 0; t &lt; tiddlers.length; t++)
					theList.options[i++] = new Option(tiddlers[t].title,tiddlers[t].title,false,false);
				break;
			case 'modifier':
			case 'modified':
				var tiddlers = store.getTiddlers(sort);
				// sort descending for newest date first
				tiddlers.sort(function (a,b) {if(a[sort] == b[sort]) return(0); else return (a[sort] &gt; b[sort]) ? -1 : +1; });
				var lastSection = '';
				for(var t = 0; t &lt; tiddlers.length; t++) {
					var tiddler = tiddlers[t];
					var theSection = '';
					if (sort=='modified') theSection=tiddler.modified.toLocaleDateString();
					if (sort=='modifier') theSection=tiddler.modifier;
					if (theSection != lastSection) {
						theList.options[i++] = new Option(theSection,'',false,false);
						lastSection = theSection;
					}
					theList.options[i++] = new Option(indent+indent+tiddler.title,tiddler.title,false,false);
				}
				break;
			case 'tags':
				var theTitles = {}; // all tiddler titles, hash indexed by tag value
				var theTags = new Array();
				for(var t=0; t&lt;tiddlers.length; t++) {
					var title=tiddlers[t].title;
					var tags=tiddlers[t].tags;
					if (!tags || !tags.length) {
						if (theTitles['untagged']==undefined) { theTags.push('untagged'); theTitles['untagged']=new Array(); }
						theTitles['untagged'].push(title);
					}
					else for(var s=0; s&lt;tags.length; s++) {
						if (theTitles[tags[s]]==undefined) { theTags.push(tags[s]); theTitles[tags[s]]=new Array(); }
						theTitles[tags[s]].push(title);
					}
				}
				theTags.sort();
				for(var tagindex=0; tagindex&lt;theTags.length; tagindex++) {
					var theTag=theTags[tagindex];
					theList.options[i++]=new Option(theTag,'',false,false);
					for(var t=0; t&lt;theTitles[theTag].length; t++)
						theList.options[i++]=new Option(indent+indent+theTitles[theTag][t],theTitles[theTag][t],false,false);
				}
				break;
			}
		theList.selectedIndex=selectedIndex; // select current control item
		this.$('exportStart').disabled=true;
		this.$('exportDelete').disabled=true;
		this.displayStatus(0,tiddlers.length);
	},
	askForFilename: function(here) {
		var msg=here.title; // use tooltip as dialog box message
		var path=getLocalPath(document.location.href);
		var slashpos=path.lastIndexOf('/'); if (slashpos==-1) slashpos=path.lastIndexOf('\\'); 
		if (slashpos!=-1) path = path.substr(0,slashpos+1); // remove filename from path, leave the trailing slash
		var filetype=this.$('exportFormat').value.toLowerCase();
		var defext='html';
		if (filetype==this.type_TX) defext='txt';
		if (filetype==this.type_CS) defext='csv';
		if (filetype==this.type_NF) defext='xml';
		var file=this.newdefault.replace(/html$/,defext);
		var result='';
		if(window.Components) { // moz
			try {
				netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
				var nsIFilePicker = window.Components.interfaces.nsIFilePicker;
				var picker = Components.classes['@mozilla.org/filepicker;1'].createInstance(nsIFilePicker);
				picker.init(window, msg, nsIFilePicker.modeSave);
				var thispath = Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);
				thispath.initWithPath(path);
				picker.displayDirectory=thispath;
				picker.defaultExtension=defext;
				picker.defaultString=file;
				picker.appendFilters(nsIFilePicker.filterAll|nsIFilePicker.filterText|nsIFilePicker.filterHTML);
				if (picker.show()!=nsIFilePicker.returnCancel) var result=picker.file.persistentDescriptor;
			}
			catch(e) { alert('error during local file access: '+e.toString()) }
		}
		else { // IE
			try { // XPSP2 IE only
				var s = new ActiveXObject('UserAccounts.CommonDialog');
				s.Filter='All files|*.*|Text files|*.txt|HTML files|*.htm;*.html|XML files|*.xml|';
				s.FilterIndex=defext=='txt'?2:'html'?3:'xml'?4:1;
				s.InitialDir=path;
				s.FileName=file;
				if (s.showOpen()) var result=s.FileName;
			}
			catch(e) {  // fallback
				var result=prompt(msg,path+file);
			}
		}
		return result;
	},
	initFilter: function() {
		this.$('exportFilterStart').checked=false; this.$('exportStartDate').value='';
		this.$('exportFilterEnd').checked=false;  this.$('exportEndDate').value='';
		this.$('exportFilterTags').checked=false; this.$('exportTags').value='';
		this.$('exportFilterText').checked=false; this.$('exportText').value='';
		this.showFilterFields();
	},
	showFilterFields: function(which) {
		var show=this.$('exportFilterStart').checked;
		this.$('exportFilterStartBy').style.display=show?'block':'none';
		this.$('exportStartDate').style.display=show?'block':'none';
		var val=this.$('exportFilterStartBy').value;
		this.$('exportStartDate').value
			=this.getFilterDate(val,'exportStartDate').formatString(this.datetimefmt);
		if (which &amp;&amp; (which.id=='exportFilterStartBy') &amp;&amp; (val=='other'))
			this.$('exportStartDate').focus();

		var show=this.$('exportFilterEnd').checked;
		this.$('exportFilterEndBy').style.display=show?'block':'none';
		this.$('exportEndDate').style.display=show?'block':'none';
		var val=this.$('exportFilterEndBy').value;
		this.$('exportEndDate').value
			=this.getFilterDate(val,'exportEndDate').formatString(this.datetimefmt);
		 if (which &amp;&amp; (which.id=='exportFilterEndBy') &amp;&amp; (val=='other'))
			this.$('exportEndDate').focus();

		var show=this.$('exportFilterTags').checked;
		this.$('exportTags').style.display=show?'block':'none';

		var show=this.$('exportFilterText').checked;
		this.$('exportText').style.display=show?'block':'none';
	},
	getFilterDate: function(val,id) {
		var result=0;
		switch (val) {
			case 'file':
				result=new Date(document.lastModified);
				break;
			case 'other':
				result=new Date(this.$(id).value);
				break;
			default: // today=0, yesterday=1, one week=7, two weeks=14, a month=31
				var now=new Date(); var tz=now.getTimezoneOffset()*60000; now-=tz;
				var oneday=86400000;
				if (id=='exportStartDate')
					result=new Date((Math.floor(now/oneday)-val)*oneday+tz);
				else
					result=new Date((Math.floor(now/oneday)-val+1)*oneday+tz-1);
				break;
		}
		return result;
	},
	filterExportList: function() {
		var theList  = this.$('exportList'); if (!theList) return -1;
		var filterStart=this.$('exportFilterStart').checked;
		var val=this.$('exportFilterStartBy').value;
		var startDate=config.macros.exportTiddlers.getFilterDate(val,'exportStartDate');
		var filterEnd=this.$('exportFilterEnd').checked;
		var val=this.$('exportFilterEndBy').value;
		var endDate=config.macros.exportTiddlers.getFilterDate(val,'exportEndDate');
		var filterTags=this.$('exportFilterTags').checked;
		var tags=this.$('exportTags').value;
		var filterText=this.$('exportFilterText').checked;
		var text=this.$('exportText').value;
		if (!(filterStart||filterEnd||filterTags||filterText)) {
			alert('Please set the selection filter');
			this.$('exportFilterPanel').style.display='block';
			return -1;
		}
		if (filterStart&amp;&amp;filterEnd&amp;&amp;(startDate&gt;endDate)) {
			var msg='starting date/time:\n'
			msg+=startDate.toLocaleString()+'\n';
			msg+='is later than ending date/time:\n'
			msg+=endDate.toLocaleString()
			alert(msg);
			return -1;
		}
		// if filter by tags, get list of matching tiddlers
		// use getMatchingTiddlers() (if MatchTagsPlugin is installed) for full boolean expressions
		// otherwise use getTaggedTiddlers() for simple tag matching
		if (filterTags) {
			var fn=store.getMatchingTiddlers||store.getTaggedTiddlers;
			var t=fn.apply(store,[tags]);
			var tagged=[];
			for (var i=0; i&lt;t.length; i++) tagged.push(t[i].title);
		}
		// scan list and select tiddlers that match all applicable criteria
		var total=0;
		var count=0;
		for (var i=0; i&lt;theList.options.length; i++) {
			// get item, skip non-tiddler list items (section headings)
			var opt=theList.options[i]; if (opt.value=='') continue;
			// get tiddler, skip missing tiddlers (this should NOT happen)
			var tiddler=store.getTiddler(opt.value); if (!tiddler) continue; 
			var sel=true;
			if ( (filterStart &amp;&amp; tiddler.modified&lt;startDate)
			|| (filterEnd &amp;&amp; tiddler.modified&gt;endDate)
			|| (filterTags &amp;&amp; !tagged.contains(tiddler.title))
			|| (filterText &amp;&amp; (tiddler.text.indexOf(text)==-1) &amp;&amp; (tiddler.title.indexOf(text)==-1)))
				sel=false;
			opt.selected=sel;
			count+=sel?1:0;
			total++;
		}
		return count;
	},
	deleteTiddlers: function() {
		var list=this.$('exportList'); if (!list) return;
		var tids=[];
		for (i=0;i&lt;list.length;i++)
			if (list.options[i].selected &amp;&amp; list.options[i].value.length)
				tids.push(list.options[i].value);
		if (!confirm('Are you sure you want to delete these tiddlers:\n\n'+tids.join(', '))) return;
		store.suspendNotifications();
		for (t=0;t&lt;tids.length;t++) {
			var tid=store.getTiddler(tids[t]); if (!tid) continue;
			var msg=&quot;'&quot;+tid.title+&quot;' is tagged with 'systemConfig'.\n\n&quot;;
			msg+='Removing this tiddler may cause unexpected results.  Are you sure?'
			if (tid.tags.contains('systemConfig') &amp;&amp; !confirm(msg)) continue;
			store.removeTiddler(tid.title);
			story.closeTiddler(tid.title);
		}
		store.resumeNotifications();
		alert(tids.length+' tiddlers deleted');
		this.refreshList(0); // reload listbox
		store.notifyAll(); // update page display
	},
	go: function() {
		if (window.location.protocol!='file:') // make sure we are local
			{ displayMessage(config.messages.notFileUrlError); return; }
		// get selected tidders, target filename, target type, and notes
		var list=this.$('exportList'); if (!list) return;
		var tids=[]; for (var i=0; i&lt;list.options.length; i++) {
			var opt=list.options[i]; if (!opt.selected||!opt.value.length) continue;
			var tid=store.getTiddler(opt.value); if (!tid) continue;
			tids.push(tid);
		}
		if (!tids.length) return; // no tiddlers selected
		var target=this.$('exportFilename').value.trim();
		if (!target.length) {
			displayMessage('A local target path/filename is required',target);
			return;
		}
		var merge=this.$('exportMerge').checked;
		var filetype=this.$('exportFormat').value.toLowerCase();
		var notes=this.$('exportNotes').value.replace(/\n/g,'&lt;br&gt;');
		var total={val:0};
		var out=this.assembleFile(target,filetype,tids,notes,total,merge);
		if (!total.val) return; // cancelled file overwrite
		var link='file:///'+target.replace(/\\/g,'/');
		var samefile=link==decodeURIComponent(window.location.href);
		var p=getLocalPath(document.location.href);
		if (samefile) {
			if (config.options.chkSaveBackups) { var t=loadOriginal(p);if(t)saveBackup(p,t); }
			if (config.options.chkGenerateAnRssFeed &amp;&amp; saveRss instanceof Function) saveRss(p);
		}
		var ok=saveFile(target,out);
		displayMessage((ok?this.okmsg:this.failmsg).format([total.val,total.val!=1?'s':'',target]),link);
	},
	plainTextHeader:
		 'Source:\n\t%0\n'
		+'Title:\n\t%1\n'
		+'Subtitle:\n\t%2\n'
		+'Created:\n\t%3 by %4\n'
		+'Application:\n\tTiddlyWiki %5 / %6 %7\n\n',
	plainTextTiddler:
		'- - - - - - - - - - - - - - -\n'
		+'|     title: %0\n'
		+'|   created: %1\n'
		+'|  modified: %2\n'
		+'| edited by: %3\n'
		+'|      tags: %4\n'
		+'- - - - - - - - - - - - - - -\n'
		+'%5\n',
	plainTextFooter:
		'',
	newsFeedHeader:
		 '&lt;'+'?xml version=&quot;1.0&quot;?'+'&gt;\n'
		+'&lt;rss version=&quot;2.0&quot;&gt;\n'
		+'&lt;channel&gt;\n'
		+'&lt;title&gt;%1&lt;/title&gt;\n'
		+'&lt;link&gt;%0&lt;/link&gt;\n'
		+'&lt;description&gt;%2&lt;/description&gt;\n'
		+'&lt;language&gt;en-us&lt;/language&gt;\n'
		+'&lt;copyright&gt;Copyright '+(new Date().getFullYear())+' %4&lt;/copyright&gt;\n'
		+'&lt;pubDate&gt;%3&lt;/pubDate&gt;\n'
		+'&lt;lastBuildDate&gt;%3&lt;/lastBuildDate&gt;\n'
		+'&lt;docs&gt;http://blogs.law.harvard.edu/tech/rss&lt;/docs&gt;\n'
		+'&lt;generator&gt;TiddlyWiki %5 / %6 %7&lt;/generator&gt;\n',
	newsFeedTiddler:
		'\n%0\n',
	newsFeedFooter:
		'&lt;/channel&gt;&lt;/rss&gt;',
	pureStoreHeader:
		 '&lt;html&gt;&lt;body&gt;'
		+'&lt;style type=&quot;text/css&quot;&gt;'
		+'	#storeArea {display:block;margin:1em;}'
		+'	#storeArea div {padding:0.5em;margin:1em;border:2px solid black;height:10em;overflow:auto;}'
		+'	#pureStoreHeading {width:100%;text-align:left;background-color:#eeeeee;padding:1em;}'
		+'&lt;/style&gt;'
		+'&lt;div id=&quot;pureStoreHeading&quot;&gt;'
		+'	TiddlyWiki &quot;PureStore&quot; export file&lt;br&gt;'
		+'	Source'+': &lt;b&gt;%0&lt;/b&gt;&lt;br&gt;'
		+'	Title: &lt;b&gt;%1&lt;/b&gt;&lt;br&gt;'
		+'	Subtitle: &lt;b&gt;%2&lt;/b&gt;&lt;br&gt;'
		+'	Created: &lt;b&gt;%3&lt;/b&gt; by &lt;b&gt;%4&lt;/b&gt;&lt;br&gt;'
		+'	TiddlyWiki %5 / %6 %7&lt;br&gt;'
		+'	Notes:&lt;hr&gt;&lt;pre&gt;%8&lt;/pre&gt;'
		+'&lt;/div&gt;'
		+'&lt;div id=&quot;storeArea&quot;&gt;',
	pureStoreTiddler:
		'%0\n%1',
	pureStoreFooter:
		'&lt;/div&gt;&lt;!--POST-BODY-START--&gt;\n&lt;!--POST-BODY-END--&gt;&lt;/body&gt;&lt;/html&gt;',
	assembleFile: function(target,filetype,tids,notes,total,merge) {
		var revised='';
		var now = new Date().toLocaleString();
		var src=convertUnicodeToUTF8(document.location.href);
		var title = convertUnicodeToUTF8(wikifyPlain('SiteTitle').htmlEncode());
		var subtitle = convertUnicodeToUTF8(wikifyPlain('SiteSubtitle').htmlEncode());
		var user = convertUnicodeToUTF8(config.options.txtUserName.htmlEncode());
		var twver = version.major+'.'+version.minor+'.'+version.revision;
		var v=version.extensions.ExportTiddlersPlugin; var pver = v.major+'.'+v.minor+'.'+v.revision;
		var headerargs=[src,title,subtitle,now,user,twver,'ExportTiddlersPlugin',pver,notes];
		switch (filetype) {
			case this.type_TX: // plain text
				var header=this.plainTextHeader.format(headerargs);
				var footer=this.plainTextFooter;
				break;
			case this.type_CS: // comma-separated
				var fields={};
				for (var i=0; i&lt;tids.length; i++) for (var f in tids[i].fields) fields[f]=f;
				var names=['title','created','modified','modifier','tags','text'];
				for (var f in fields) names.push(f);
				var header=names.join(',')+'\n';
				var footer='';
				break;
			case this.type_NF: // news feed (XML)
				headerargs[0]=store.getTiddlerText('SiteUrl','');
				var header=this.newsFeedHeader.format(headerargs);
				var footer=this.newsFeedFooter;
				break;
			case this.type_PS: // PureStore (no code)
				var header=this.pureStoreHeader.format(headerargs);
				var footer=this.pureStoreFooter;
				break;
			case this.type_TW: // full TiddlyWiki
			default:
				var currPath=getLocalPath(window.location.href);
				var original=loadFile(currPath);
				if (!original) { displayMessage(config.messages.cantSaveError); return; }
				var posDiv = locateStoreArea(original);
				if (!posDiv) { displayMessage(config.messages.invalidFileError.format([currPath])); return; }
				var header = original.substr(0,posDiv[0]+startSaveArea.length)+'\n';
				var footer = '\n'+original.substr(posDiv[1]);
				break;
		}
		var out=this.getData(target,filetype,tids,fields,merge);
		var revised = header+convertUnicodeToUTF8(out.join('\n'))+footer;
		// if full TW, insert page title and language attr, and reset all MARKUP blocks...
		if (filetype==this.type_TW) {
			var newSiteTitle=convertUnicodeToUTF8(getPageTitle()).htmlEncode();
			revised=revised.replaceChunk('&lt;title'+'&gt;','&lt;/title'+'&gt;',' ' + newSiteTitle + ' ');
			revised=updateLanguageAttribute(revised);
			var titles=[]; for (var i=0; i&lt;tids.length; i++) titles.push(tids[i].title);
			revised=updateMarkupBlock(revised,'PRE-HEAD',
				titles.contains('MarkupPreHead')? 'MarkupPreHead' :null);
			revised=updateMarkupBlock(revised,'POST-HEAD',
				titles.contains('MarkupPostHead')?'MarkupPostHead':null);
			revised=updateMarkupBlock(revised,'PRE-BODY',
				titles.contains('MarkupPreBody')? 'MarkupPreBody' :null);
			revised=updateMarkupBlock(revised,'POST-SCRIPT',
				titles.contains('MarkupPostBody')?'MarkupPostBody':null);
		}
		total.val=out.length;
		return revised;
	},
	getData: function(target,filetype,tids,fields,merge) {
		// output selected tiddlers and gather list of titles (for use with merge)
		var out=[]; var titles=[];
		var url=store.getTiddlerText('SiteUrl','');
		for (var i=0; i&lt;tids.length; i++) {
			out.push(this.formatItem(store,filetype,tids[i],url,fields));
			titles.push(tids[i].title);
		}
		// if TW or PureStore format, ask to merge with existing tiddlers (if any)
		if (filetype==this.type_TW || filetype==this.type_PS) {
			var txt=loadFile(target);
			if (txt &amp;&amp; txt.length) {
				var remoteStore=new TiddlyWiki();
				if (version.major+version.minor*.1+version.revision*.01&lt;2.52) txt=convertUTF8ToUnicode(txt);
				if (remoteStore.importTiddlyWiki(txt)) {
					var existing=remoteStore.getTiddlers('title');
					var msg=this.overwriteprompt.format([target,existing.length,existing.length!=1?'s':'']);
					if (merge) {
						var added=titles.length; var updated=0; var kept=0;
						for (var i=0; i&lt;existing.length; i++)
							if (titles.contains(existing[i].title)) {
								added--; updated++;
							} else {
								out.push(this.formatItem(remoteStore,filetype,existing[i],url));
								kept++;
							}
						displayMessage(this.mergestatus.format(
							[added,added!=1?'s':'',updated,updated!=1?'s':'',kept,kept!=1?'s':'',]));
					}
					else if (!confirm(msg)) out=[]; // empty the list = don't write file
				}
			}
		}
		return out;
	},
	formatItem: function(s,f,t,u,fields) {
		if (f==this.type_TW)
			var r=s.getSaver().externalizeTiddler(s,t);
		if (f==this.type_PS)
			var r=this.pureStoreTiddler.format([t.title,s.getSaver().externalizeTiddler(s,t)]);
		if (f==this.type_NF)
			var r=this.newsFeedTiddler.format([t.saveToRss(u)]);
		if (f==this.type_TX)
			var r=this.plainTextTiddler.format([t.title, t.created.toLocaleString(), t.modified.toLocaleString(),
				t.modifier, String.encodeTiddlyLinkList(t.tags), t.text]);
		if (f==this.type_CS) {
			function toCSV(t) { return '&quot;'+t.replace(/&quot;/g,'&quot;&quot;')+'&quot;'; } // always encode CSV
			var out=[ toCSV(t.title), toCSV(t.created.toLocaleString()), toCSV(t.modified.toLocaleString()),
				toCSV(t.modifier), toCSV(String.encodeTiddlyLinkList(t.tags)), toCSV(t.text) ];
			for (var f in fields) out.push(toCSV(t.fields[f]||''));
			var r=out.join(',');
		}
		return r||&quot;&quot;;
	}
}
//}}}
/***
!!!Control panel CSS
//{{{
!css
#exportPanel {
	display: none; position:absolute; z-index:12; width:35em; right:105%; top:6em;
	background-color: #eee; color:#000; font-size: 8pt; line-height:110%;
	border:1px solid black; border-bottom-width: 3px; border-right-width: 3px;
	padding: 0.5em; margin:0em; -moz-border-radius:1em;-webkit-border-radius:1em;
}
#exportPanel a, #exportPanel td a { color:#009; display:inline; margin:0px; padding:1px; }
#exportPanel table {
	width:100%; border:0px; padding:0px; margin:0px;
	font-size:8pt; line-height:110%; background:transparent;
}
#exportPanel tr { border:0px;padding:0px;margin:0px; background:transparent; }
#exportPanel td { color:#000; border:0px;padding:0px;margin:0px; background:transparent; }
#exportPanel select { width:98%;margin:0px;font-size:8pt;line-height:110%;}
#exportPanel input  { width:98%;padding:0px;margin:0px;font-size:8pt;line-height:110%; }
#exportPanel textarea  { width:98%;padding:0px;margin:0px;overflow:auto;font-size:8pt; }
#exportPanel .box {
	border:1px solid black; padding:3px; margin-bottom:5px;
	background:#f8f8f8; -moz-border-radius:5px;-webkit-border-radius:5px; }
#exportPanel .topline { border-top:2px solid black; padding-top:3px; margin-bottom:5px; }
#exportPanel .rad { width:auto;border:0 }
#exportPanel .chk { width:auto;border:0 }
#exportPanel .btn { width:auto; }
#exportPanel .btn1 { width:98%; }
#exportPanel .btn2 { width:48%; }
#exportPanel .btn3 { width:32%; }
#exportPanel .btn4 { width:24%; }
#exportPanel .btn5 { width:19%; }
!end
//}}}
!!!Control panel HTML
//{{{
!html
&lt;!-- target path/file  --&gt;
&lt;div&gt;
&lt;div style=&quot;float:right;padding-right:.5em&quot;&gt;
&lt;input type=&quot;checkbox&quot; style=&quot;width:auto&quot; id=&quot;exportMerge&quot; CHECKED
	title=&quot;combine selected tiddlers with existing tiddlers (if any) in export file&quot;&gt; merge
&lt;/div&gt;
export to:&lt;br&gt;
&lt;input type=&quot;text&quot; id=&quot;exportFilename&quot; size=40 style=&quot;width:93%&quot;&gt;&lt;input 
	type=&quot;button&quot; id=&quot;exportBrowse&quot; value=&quot;...&quot; title=&quot;select or enter a local folder/file...&quot; style=&quot;width:5%&quot; 
	onclick=&quot;var fn=config.macros.exportTiddlers.askForFilename(this); if (fn.length) this.previousSibling.value=fn; &quot;&gt;
&lt;/div&gt;

&lt;!-- output format --&gt;
&lt;div&gt;
format:
&lt;select id=&quot;exportFormat&quot; size=1&gt;
	&lt;option value=&quot;TW&quot;&gt;TiddlyWiki HTML document (includes core code)&lt;/option&gt;
	&lt;option value=&quot;PS&quot;&gt;TiddlyWiki &quot;PureStore&quot; HTML file (tiddler data only)&lt;/option&gt;
	&lt;option value=&quot;TX&quot;&gt;TiddlyWiki plain text TXT file (tiddler source listing)&lt;/option&gt;
	&lt;option value=&quot;CS&quot;&gt;Comma-Separated Value (CSV) data file&lt;/option&gt;
	&lt;option value=&quot;NF&quot;&gt;RSS NewsFeed XML file&lt;/option&gt;
&lt;/select&gt;
&lt;/div&gt;

&lt;!-- notes --&gt;
&lt;div&gt;
notes:&lt;br&gt;
&lt;textarea id=&quot;exportNotes&quot; rows=3 cols=40 style=&quot;height:4em;margin-bottom:5px;&quot; onfocus=&quot;this.select()&quot;&gt;&lt;/textarea&gt; 
&lt;/div&gt;

&lt;!-- list of tiddlers --&gt;
&lt;table&gt;&lt;tr align=&quot;left&quot;&gt;&lt;td&gt;
	select:
	&lt;a href=&quot;JavaScript:;&quot; id=&quot;exportSelectAll&quot;
		onclick=&quot;return config.macros.exportTiddlers.process(this)&quot; title=&quot;select all tiddlers&quot;&gt;
		&amp;nbsp;all&amp;nbsp;&lt;/a&gt;
	&lt;a href=&quot;JavaScript:;&quot; id=&quot;exportSelectChanges&quot;
		onclick=&quot;return config.macros.exportTiddlers.process(this)&quot; title=&quot;select tiddlers changed since last save&quot;&gt;
		&amp;nbsp;changes&amp;nbsp;&lt;/a&gt;
	&lt;a href=&quot;JavaScript:;&quot; id=&quot;exportSelectOpened&quot;
		onclick=&quot;return config.macros.exportTiddlers.process(this)&quot; title=&quot;select tiddlers currently being displayed&quot;&gt;
		&amp;nbsp;opened&amp;nbsp;&lt;/a&gt;
	&lt;a href=&quot;JavaScript:;&quot; id=&quot;exportSelectRelated&quot;
		onclick=&quot;return config.macros.exportTiddlers.process(this)&quot; title=&quot;select tiddlers related to the currently selected tiddlers&quot;&gt;
		&amp;nbsp;related&amp;nbsp;&lt;/a&gt;
	&lt;a href=&quot;JavaScript:;&quot; id=&quot;exportToggleFilter&quot;
		onclick=&quot;return config.macros.exportTiddlers.process(this)&quot; title=&quot;show/hide selection filter&quot;&gt;
		&amp;nbsp;filter&amp;nbsp;&lt;/a&gt;
&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;
	&lt;a href=&quot;JavaScript:;&quot; id=&quot;exportListSmaller&quot;
		onclick=&quot;return config.macros.exportTiddlers.process(this)&quot; title=&quot;reduce list size&quot;&gt;
		&amp;nbsp;&amp;#150;&amp;nbsp;&lt;/a&gt;
	&lt;a href=&quot;JavaScript:;&quot; id=&quot;exportListLarger&quot;
		onclick=&quot;return config.macros.exportTiddlers.process(this)&quot; title=&quot;increase list size&quot;&gt;
		&amp;nbsp;+&amp;nbsp;&lt;/a&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;select id=&quot;exportList&quot; multiple size=&quot;10&quot; style=&quot;margin-bottom:5px;&quot;
	onchange=&quot;config.macros.exportTiddlers.refreshList(this.selectedIndex)&quot;&gt;
&lt;/select&gt;&lt;br&gt;

&lt;!-- selection filter --&gt;
&lt;div id=&quot;exportFilterPanel&quot; style=&quot;display:none&quot;&gt;
&lt;table&gt;&lt;tr align=&quot;left&quot;&gt;&lt;td&gt;
	selection filter
&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;
	&lt;a href=&quot;JavaScript:;&quot; id=&quot;exportHideFilter&quot;
		onclick=&quot;return config.macros.exportTiddlers.process(this)&quot; title=&quot;hide selection filter&quot;&gt;hide&lt;/a&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;div class=&quot;box&quot;&gt;

&lt;input type=&quot;checkbox&quot; class=&quot;chk&quot; id=&quot;exportFilterStart&quot; value=&quot;1&quot;
	onclick=&quot;config.macros.exportTiddlers.showFilterFields(this)&quot;&gt; starting date/time&lt;br&gt;
&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;&lt;tr valign=&quot;center&quot;&gt;&lt;td width=&quot;50%&quot;&gt;
	&lt;select size=1 id=&quot;exportFilterStartBy&quot;
		onchange=&quot;config.macros.exportTiddlers.showFilterFields(this);&quot;&gt;
		&lt;option value=&quot;0&quot;&gt;today&lt;/option&gt;
		&lt;option value=&quot;1&quot;&gt;yesterday&lt;/option&gt;
		&lt;option value=&quot;7&quot;&gt;a week ago&lt;/option&gt;
		&lt;option value=&quot;30&quot;&gt;a month ago&lt;/option&gt;
		&lt;option value=&quot;file&quot;&gt;file date&lt;/option&gt;
		&lt;option value=&quot;other&quot;&gt;other (mm/dd/yyyy hh:mm)&lt;/option&gt;
	&lt;/select&gt;
&lt;/td&gt;&lt;td width=&quot;50%&quot;&gt;
	&lt;input type=&quot;text&quot; id=&quot;exportStartDate&quot; onfocus=&quot;this.select()&quot;
		onchange=&quot;config.macros.exportTiddlers.$('exportFilterStartBy').value='other';&quot;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;input type=&quot;checkbox&quot; class=&quot;chk&quot; id=&quot;exportFilterEnd&quot; value=&quot;1&quot;
	onclick=&quot;config.macros.exportTiddlers.showFilterFields(this)&quot;&gt; ending date/time&lt;br&gt;
&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;&lt;tr valign=&quot;center&quot;&gt;&lt;td width=&quot;50%&quot;&gt;
	&lt;select size=1 id=&quot;exportFilterEndBy&quot;
		onchange=&quot;config.macros.exportTiddlers.showFilterFields(this);&quot;&gt;
		&lt;option value=&quot;0&quot;&gt;today&lt;/option&gt;
		&lt;option value=&quot;1&quot;&gt;yesterday&lt;/option&gt;
		&lt;option value=&quot;7&quot;&gt;a week ago&lt;/option&gt;
		&lt;option value=&quot;30&quot;&gt;a month ago&lt;/option&gt;
		&lt;option value=&quot;file&quot;&gt;file date&lt;/option&gt;
		&lt;option value=&quot;other&quot;&gt;other (mm/dd/yyyy hh:mm)&lt;/option&gt;
	&lt;/select&gt;
&lt;/td&gt;&lt;td width=&quot;50%&quot;&gt;
	&lt;input type=&quot;text&quot; id=&quot;exportEndDate&quot; onfocus=&quot;this.select()&quot;
		onchange=&quot;config.macros.exportTiddlers.$('exportFilterEndBy').value='other';&quot;&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;input type=&quot;checkbox&quot; class=&quot;chk&quot; id=exportFilterTags value=&quot;1&quot;
	onclick=&quot;config.macros.exportTiddlers.showFilterFields(this)&quot;&gt; match tags&lt;br&gt;
&lt;input type=&quot;text&quot; id=&quot;exportTags&quot; onfocus=&quot;this.select()&quot;&gt;

&lt;input type=&quot;checkbox&quot; class=&quot;chk&quot; id=exportFilterText value=&quot;1&quot;
	onclick=&quot;config.macros.exportTiddlers.showFilterFields(this)&quot;&gt; match titles/tiddler text&lt;br&gt;
&lt;input type=&quot;text&quot; id=&quot;exportText&quot; onfocus=&quot;this.select()&quot;&gt;

&lt;/div&gt; &lt;!--box--&gt;
&lt;/div&gt; &lt;!--panel--&gt;

&lt;!-- action buttons --&gt;
&lt;div style=&quot;text-align:center&quot;&gt;
&lt;input type=button class=&quot;btn4&quot; onclick=&quot;config.macros.exportTiddlers.process(this)&quot;
	id=&quot;exportFilter&quot; value=&quot;apply filter&quot;&gt;
&lt;input type=button class=&quot;btn4&quot; onclick=&quot;config.macros.exportTiddlers.process(this)&quot;
	id=&quot;exportStart&quot; value=&quot;export tiddlers&quot;&gt;
&lt;input type=button class=&quot;btn4&quot; onclick=&quot;config.macros.exportTiddlers.process(this)&quot;
	id=&quot;exportDelete&quot; value=&quot;delete tiddlers&quot;&gt;
&lt;input type=button class=&quot;btn4&quot; onclick=&quot;config.macros.exportTiddlers.process(this)&quot;
	id=&quot;exportClose&quot; value=&quot;close&quot;&gt;
&lt;/div&gt;&lt;!--center--&gt;
!end
//}}}
***/
 </pre>
</div>
<div title="ExportTiddlersPluginInfo" modifier="ELSDesignStudios" created="200703222349" modified="201002252057" tags="pluginInfo ImportExportPackage excludeMissing">
<pre>/***
|Name|ExportTiddlersPluginInfo|
|Source|http://www.TiddlyTools.com/#ExportTiddlersPlugin|
|Documentation|http://www.TiddlyTools.com/#ExportTiddlersPluginInfo|
|Version|2.9.5|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|documentation|
|Description|Documentation for ExportTiddlersPlugin|
interactively select and extract tiddlers from your ~TiddlyWiki document, and write them into another file, using one of several different file formats:
* ~TiddlyWiki - a complete, stand-alone, standard TiddlyWiki HTML document
* ~PureStore - a small HTML archive file containing tiddler data only (no core code)
* ~PlainText - a simple TXT text file with tiddler source listings
* Comma - a &quot;Comma Separated Value&quot; data/spreadsheet file
* ~NewsFeed  - an XML-format file that can be published for RSS syndication.
!!!!!Usage
&lt;&lt;&lt;
{{{
&lt;&lt;exportTiddlers&gt;&gt; (sidebar menu item)
&lt;&lt;exportTiddlers inline&gt;&gt; (embedded control panel)
}}}

Inline control panel (live):
&lt;&lt;exportTiddlers inline&gt;&gt;

Optional &quot;special tiddlers&quot; used by this plugin:
* SiteUrl&lt;br&gt;URL for official server-published version of document being viewed (used in XML export). Default: //none//
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2010.02.25 2.9.5 added merge checkbox option and improved 'merge' status message
2009.09.12 2.9.4 fixed 'return false' to prevent IE page transitions
2009.07.06 2.9.3 moved HTML to section for size reduction
2009.07.03 2.9.2 TW252 fixup: don't call convertUTF8ToUnicode() for local loadFile() I/O
2009.04.30 2.9.1 custom fields in CSV output
2009.04.19 2.9.0 added CSV format
2009.02.26 2.8.5 use macro-specific definition of $() function abbreviation (avoids conflict with JQuery)
2008.09.29 2.8.4 in getData(), convert existing TW file from UTF8 to Unicode before merging to correct handling of international characters and symbols.
2008.09.26 2.8.3 in go(), if rewriting *current* file and chkSaveBackups and/or chkGenerateAnRssFeed is enabled, then write a backup file or RSS feed, respectively.
2008.09.24 2.8.2 in assembleFile(), make sure that markup block is updated if corresponding Markup* tiddler is exported.
2008.09.19 2.8.1 in formatItem(), removed unnecessary convertUnicodeToUTF8() (was causing double-conversion!)
2008.09.11 2.8.0 extensive code cleanup: moved all global functions inside macro object. Re-wrote file generator and I/O to support TiddlyWiki, PlainText, PureStore, and NewsFeed file formats.  Replaced inline 'match tags' code with use of getMatchingTiddlers() from [[MatchTagsPlugin]] (if installed), with fallback to core getTaggedTiddlers() otherwise.
2008.05.27 2.7.0 added ability to 'merge' with existing export file.  Also, revised 'matchTags' functionality to be more robust and more efficient
2008.05.12 2.6.1 automatically add 'export' task to backstage (moved from BackstageTweaks)
2008.03.10 2.6.0 added &quot;delete tiddlers&quot; button
2007.12.04 *.*.* update for TW2.3.0: replaced deprecated core functions, regexps, and macros
2007.11.10 2.5.1 removed debugging alert messages from promptForExportFilename()
2007.10.31 2.5.0 code reduction: removed incomplete/unused interface and supporting functions for exporting directly to http, https or ftp servers.  Plugin now supports exporting to local file only.  Also, updated TW document output to generate TW2.2 compatible file format.
2007.10.30 2.4.2 added automatic shadow tiddler definition for [[ExportTiddlers]]
2007.07.16 2.4.1 in exportTWHeader(), reset HTML source 'markup' so installed markup is NOT copied to new file.
2007.06.30 2.4.0 added &quot;select related tiddlers&quot; feature.  Recursively scans the tiddler links[] info to find all tiddlers referenced by any of the currently selected tiddler, and then selects them all (including the original tiddlers).
2007.04.19 2.3.0 in exportData(), pass SiteURL value as param to saveToRss().  Fixes 'undefined' appearing in tiddler link in XML output.  Also, in refreshExportList(), added 'sort by tags'.  Also, added 'group select'... selecting a heading (date,author,tag) auto-selects all tiddlers in that group.
2007.03.02 2.2.6 in onClickExportButton(), when selecting open tiddlers for TW2.2, look for &quot;storyDisplay&quot; with fallback to &quot;tiddlerDisplay&quot; for TW2.1 or earlier
2007.03.01 2.2.5 removed hijack of store.saveChanges()
2006.11.08 2.2.4 added promptForExportFilename() and replaced type=&quot;file&quot; control with edit field + browse button (&quot;...&quot;).
2006.10.12 2.2.3 in exportDIVFooter(), write POST-BODY-START/END markers for compatibility with TW2.1 core file format.
2006.05.11 2.2.2 in createExportPanel, removed call to addNotification() to reduce unneeded feedback messages and increase overall document performance.
2006.05.02 2.2.1 Use displayMessage() to show number of selected tiddlers instead of updating listbox 'header' item after each selection.  Prevents awkward 'scroll-to-top' behavior that made multi-select via ctrl-click nearly impossible.
2006.04.29 2.2.0 New features: free-form &quot;Notes&quot; text inserted in the header of PureStore files.
2006.03.29 2.1.3 added calls to convertUnicodeToUTF8() for generated output, so it better handles international characters.
2006.02.12 2.1.2 more FF1501 bug fixes.
2006.02.04 2.1.1 added var to unintended globals to avoids FireFox1501 crash bug
2006.02.02 2.1.0 Added support for output of complete TiddlyWiki documents
2006.01.21 2.0.1 Defer initial panel creation and only register a notification function when panel first is created
in saveChanges 'hijack', create panel as needed.  Note: if window.event is not available to identify the click location, the export panel is positioned relative to the 'tiddlerDisplay' element of the TW document.
2005.12.27 2.0.0 Update for TW2.0.
2005.12.24 0.9.5 Minor adjustments to CSS to force correct link colors regardless of TW stylesheet selection
2005.12.16 0.9.4 Dynamically create/remove exportPanel so only one instance exists at a time
2005.11.15 0.9.2 added non-Ajax post to bypass cross-domain security restrictions.
2005.11.08 0.9.1 moved HTML, CSS and control initialization into exportInit() function and call from macro handler instead of at load time.
2005.10.28 0.9.0 added 'select opened tiddlers' feature. Based on a suggestion by Geoff Slocock
2005.10.24 0.8.3 Corrected hijack of 'save changes' when using http:
2005.10.18 0.8.2 added AJAX functions
2005.10.18 0.8.1 Corrected timezone handling and error checking/reporting when filtering tiddlers. More style tweaks, minor text changes and some assorted layout cleanup.
2005.10.17 0.8.0 First pre-release.
2005.10.16 0.7.0 filter by tags
2005.10.15 0.6.0 filter by title/text
2005.10.14 0.5.0 export to local file (DIV or XML)
2005.10.14 0.4.0 filter by start/end date
2005.10.13 0.3.0 panel interaction
2005.10.11 0.2.0 panel layout
2005.10.10 0.1.0 code framework
2005.10.09 0.0.0 development started
&lt;&lt;&lt;</pre>
</div>
<div title="FAQ_RescueStoreArea" modifier="YourName" created="200803312237" modified="201007120114" tags="faq excludeMissing systemConfigDisable">
<pre>/%
|Description|Saving changes for online documents if the network goes down|
%/
{{small{
__Saving changes to online documents if your network connection goes down while editing__

If you have been editing a document online (e.g., using an account on http://www.TiddlySpot.com with [[UploadPlugin]]), and your internet connection has gone down while editing, it is not possible to save your changes in the usual manner because, without the internet, the remotely-stored document is //inaccessible//.

Unfortunately, you also cannot save the document locally because of security restrictions that prevent access to your local filesystem when working with a server-hosted document (i.e., viewed via http:).

Fortunately, there is a ''manual work-around that will let you 'rescue' TiddlyWiki's internal //storeArea// for the current document, including your unsaved changes to tiddler content'' by using the following command link:

{{big center{&lt;&lt;tiddler RescueStoreAreaCommand with: &quot;rescue storeArea&quot;&gt;&gt;}}}
When clicked, this link ''opens a new window and writes a copy of the storeArea into that window.''  The content in that window is displayed as plain-text, and includes //only the storeArea DIVs that define the tiddlers, without any of the surrounding TiddlyWiki core code.//  To preserve this storeArea, ''select and copy/paste the displayed content into a local text file for safe-keeping.''

Then, to merge this 'rescued store area' with the rest of the TW core, use a plain-text editor (not the browser) to open a ''copy'' of any locally-stored TW document.  If a locally-stored TiddlyWiki document is not available, you will have to wait until your network connection has been re-established, so that you can download your TiddlyWiki document from the server, or [[obtain an empty TiddlyWiki document from http://www.TiddlyWiki.com|http://www.TiddlyWiki.com/empty.html]].

Then, find the 'storeArea' in that document, which looks like this:
{{{
&lt;!--POST-SHADOWAREA--&gt;
&lt;div id=&quot;storeArea&quot;&gt;
.... *** replace this part *** ...
&lt;/div&gt;
&lt;!--POST-STOREAREA--&gt;
}}}
Select everything //inside the storeArea DIV//, and replace it with the rescued store area content, and then save the file.  If all goes well, the saved file can then be opened in your browser as a complete TW document, *with* all the saved content in place!

Note: The command link shown above may also be installed directly into your browser as an [[InstantBookmarklet|InstantBookmarklets]]. To create a bookmarklet, simply ''//drag-and-drop the command link directly onto your browser's toolbar//'' or right-click and use 'bookmark this link' (or 'add to favorites') to add the bookmarklet to your browser's bookmarks menu.  Once installed, you can use this command with //any// TiddlyWiki document, even when [[RescueStoreAreaCommand]] and [[InlineJavascriptPlugin]] have not been installed in that document!
}}}
</pre>
</div>
<div title="Factoids" modifier="JohnRouillard" created="200910120221" modified="201007170537" tags="InstructorOnly">
<pre>A TiddlyWiki is a single html file that acts like a wiki.
----
TiddlyWiki is driven by javascript and css.
----
TiddlyWiki is cross platform and runs in:
* ~FireFox
* Internet Explorer
* Chrome
* Safari
----
TiddlyWiki was written by Jeremy Ruston, and is supported by British Telecom
----
The basic unit of content in a TiddlyWiki is the tiddler which plays the role of a web page in other wiki's.
----
A tiddler (the basic unit of content in a tiddlywiki) is a form of microcontent.
----
There are many macros for TiddlyWiki that allows reuse of content in different tiddlers.
----
TiddlyWiki is published by UnaMesa  a non-profit association  under a BSD  open source license and is thus freely available.
----
//J. Ruston//
&lt;&lt;&lt;
A TiddlyWiki is like a blog because it's divided up into neat little chunks (tiddlers), but it encourages you to read it by hyperlinking  rather than sequentially: if you like, a non-linear blog analogue that binds the individual microcontent  items into a cohesive whole. I think that TiddlyWiki represents a novel medium for writing, and will promote its own distinctive writing style.
&lt;&lt;&lt;
----
TiddlyWiki can also be used as a personal productivity tool using the methods in David Allen's book //Getting Things Done//.
----
TiddlyWiki has a number of verticals: adaptations for a specific purpose including:
* twab - address book
* multiple //Getting Things Done// implementations
* genealogy tool
* database
----
TiddlyWiki has an extensive tagging system including TagglyTagging that allows structured relationships between tiddlers.
----
There are hundreds of plugins that enhance:
* searching
* tag manipulation
* formatting
* and much more ...


</pre>
</div>
<div title="FieldsEditorPlugin" modifier="JohnRouillard" created="200707031052" modified="200909070158" tags="VisualTW systemConfig Tools InstructorOnly" label="FieldsEditor">
<pre>/***
|''Name:''|FieldsEditorPlugin|
|''Description:''|//create//, //edit//, //view// and //delete// commands in toolbar &lt;&lt;toolbar fields&gt;&gt;.|
|''Version:''|1.0.2|
|''Date:''|Dec 21,2007|
|''Source:''|http://visualtw.ouvaton.org/VisualTW.html|
|''Author:''|Pascal Collin|
|''License:''|[[BSD open source license|License]]|
|''~CoreVersion:''|2.2.0|
|''Browser:''|Firefox 2.0; InternetExplorer 6.0, others|
!Demo:
On [[homepage|http://visualtw.ouvaton.org/VisualTW.html]], see [[FieldEditor example]]
!Installation:
*import this tiddler from [[homepage|http://visualtw.ouvaton.org/VisualTW.html]] (tagged as systemConfig)
*save and reload
*optionnaly : add the following css text in your StyleSheet : {{{#popup tr.fieldTableRow td {padding:1px 3px 1px 3px;}}}}
!Code
***/

//{{{

config.commands.fields.handlePopup = function(popup,title) {
	var tiddler = store.fetchTiddler(title);
	if(!tiddler)
		return;
	var fields = {};
	store.forEachField(tiddler,function(tiddler,fieldName,value) {fields[fieldName] = value;},true);
	var items = [];
	for(var t in fields) {
		var editCommand = &quot;&lt;&lt;untiddledCall editFieldDialog &quot;+escape(title)+&quot; &quot;+escape(t)+&quot;&gt;&gt;&quot;;
		var deleteCommand = &quot;&lt;&lt;untiddledCall deleteField &quot;+escape(title)+&quot; &quot;+escape(t)+&quot;&gt;&gt;&quot;;
		var renameCommand = &quot;&lt;&lt;untiddledCall renameField &quot;+escape(title)+&quot; &quot;+escape(t)+&quot;&gt;&gt;&quot;;
		items.push({field: t,value: fields[t], actions: editCommand+renameCommand+deleteCommand});
	}
	items.sort(function(a,b) {return a.field &lt; b.field ? -1 : (a.field == b.field ? 0 : +1);});
	var createNewCommand = &quot;&lt;&lt;untiddledCall createField &quot;+escape(title)+&quot;&gt;&gt;&quot;;
	items.push({field : &quot;&quot;, value : &quot;&quot;, actions:createNewCommand });
	if(items.length &gt; 0)
		ListView.create(popup,items,this.listViewTemplate);
	else
		createTiddlyElement(popup,&quot;div&quot;,null,null,this.emptyText);
}

config.commands.fields.listViewTemplate = {
	columns: [
		{name: 'Field', field: 'field', title: &quot;Field&quot;, type: 'String'},
		{name: 'Actions', field: 'actions', title: &quot;Actions&quot;, type: 'WikiText'},
		{name: 'Value', field: 'value', title: &quot;Value&quot;, type: 'WikiText'}
	],
	rowClasses: [
			{className: 'fieldTableRow', field: 'actions'}
	],
	buttons: [	//can't use button for selected then delete, because click on checkbox will hide the popup
	]
}

config.macros.untiddledCall = {  // when called from listview, tiddler is unset, so we need to pass tiddler as parameter
	handler : function(place,macroName,params,wikifier,paramString) {
		var macroName = params.shift();
		if (macroName) var macro = config.macros[macroName];
		var title = params.shift();
		if (title) var tiddler = store.getTiddler(unescape(title));
		if (macro) macro.handler(place,macroName,params,wikifier,paramString,tiddler);		
	}
}

config.macros.deleteField = {
	handler : function(place,macroName,params,wikifier,paramString,tiddler) {
		if(!readOnly &amp;&amp; params[0]) {
			fieldName = unescape(params[0]);
			var btn = createTiddlyButton(place,&quot;delete&quot;, &quot;delete &quot;+fieldName,this.onClickDeleteField);
			btn.setAttribute(&quot;title&quot;,tiddler.title);
			btn.setAttribute(&quot;fieldName&quot;, fieldName);
		}
	},
	onClickDeleteField : function() {
		var title=this.getAttribute(&quot;title&quot;);
		var fieldName=this.getAttribute(&quot;fieldName&quot;);
		var tiddler = store.getTiddler(title);
		if (tiddler &amp;&amp; fieldName &amp;&amp; confirm(&quot;delete field &quot; + fieldName+&quot; from &quot; + title +&quot; tiddler ?&quot;)) {
			delete tiddler.fields[fieldName];
			store.saveTiddler(tiddler.title,tiddler.title,tiddler.text,tiddler.modifier,tiddler.modified,tiddler.tags,tiddler.fields);
			story.refreshTiddler(title,&quot;ViewTemplate&quot;,true);
		}
		return false;
	}
}

config.macros.createField = {
	handler : function(place,macroName,params,wikifier,paramString,tiddler) {
		if(!readOnly) {
			var btn = createTiddlyButton(place,&quot;create new&quot;, &quot;create a new field&quot;,this.onClickCreateField);
			btn.setAttribute(&quot;title&quot;,tiddler.title);
		}
	},
	onClickCreateField : function() {
		var title=this.getAttribute(&quot;title&quot;);
		var tiddler = store.getTiddler(title);
		if (tiddler) {
			var fieldName = prompt(&quot;Field name&quot;,&quot;&quot;);
			if (store.getValue(tiddler,fieldName)) {
				window.alert(&quot;This field already exists.&quot;);
			}
			else if (fieldName) {
				var v = prompt(&quot;Field value&quot;,&quot;&quot;);
				tiddler.fields[fieldName]=v;
				store.saveTiddler(tiddler.title,tiddler.title,tiddler.text,tiddler.modifier,tiddler.modified,tiddler.tags,tiddler.fields);
				story.refreshTiddler(title,&quot;ViewTemplate&quot;,true);
			}
		}
		return false;
	}
}

config.macros.editFieldDialog = {
	handler : function(place,macroName,params,wikifier,paramString,tiddler) {
		if(!readOnly &amp;&amp; params[0]) {
			fieldName = unescape(params[0]);
			var btn = createTiddlyButton(place,&quot;edit&quot;, &quot;edit this field&quot;,this.onClickEditFieldDialog);
			btn.setAttribute(&quot;title&quot;,tiddler.title);
			btn.setAttribute(&quot;fieldName&quot;, fieldName);
		}
	},
	onClickEditFieldDialog : function() {
		var title=this.getAttribute(&quot;title&quot;);
		var tiddler = store.getTiddler(title);
		var fieldName=this.getAttribute(&quot;fieldName&quot;);
		if (tiddler &amp;&amp; fieldName) {
			var value = tiddler.fields[fieldName];
			value = value ? value : &quot;&quot;;
			var lines = value.match(/\n/mg);
			lines = lines ? true : false;
			if (!lines || confirm(&quot;This field contains more than one line. Only the first line will be kept if you edit it here. Proceed ?&quot;)) {
				var v = prompt(&quot;Field value&quot;,value);
				tiddler.fields[fieldName]=v;
				store.saveTiddler(tiddler.title,tiddler.title,tiddler.text,tiddler.modifier,tiddler.modified,tiddler.tags,tiddler.fields);
				story.refreshTiddler(title,&quot;ViewTemplate&quot;,true);
			}
		}
		return false;
	}
}

config.macros.renameField = {
	handler : function(place,macroName,params,wikifier,paramString,tiddler) {
		if(!readOnly &amp;&amp; params[0]) {
			fieldName = unescape(params[0]);
			var btn = createTiddlyButton(place,&quot;rename&quot;, &quot;rename &quot;+fieldName,this.onClickRenameField);
			btn.setAttribute(&quot;title&quot;,tiddler.title);
			btn.setAttribute(&quot;fieldName&quot;, fieldName);
		}
	},
	onClickRenameField : function() {
		var title=this.getAttribute(&quot;title&quot;);
		var fieldName=this.getAttribute(&quot;fieldName&quot;);
		var tiddler = store.getTiddler(title);
		if (tiddler &amp;&amp; fieldName) {
			var newName = prompt(&quot;Rename &quot; + fieldName + &quot; as ?&quot;, fieldName);
			if (newName) {
				tiddler.fields[newName]=tiddler.fields[fieldName];
				delete tiddler.fields[fieldName];
				store.saveTiddler(tiddler.title,tiddler.title,tiddler.text,tiddler.modifier,tiddler.modified,tiddler.tags,tiddler.fields);
				story.refreshTiddler(title,&quot;ViewTemplate&quot;,true);
			}
		}
		return false;
	}
}

config.shadowTiddlers.StyleSheetFieldsEditor = &quot;/*{{{*/\n&quot;;
config.shadowTiddlers.StyleSheetFieldsEditor += &quot;.fieldTableRow td {padding : 1px 3px}\n&quot;;
config.shadowTiddlers.StyleSheetFieldsEditor += &quot;.fieldTableRow .button {border:0; padding : 0 0.2em}\n&quot;;
config.shadowTiddlers.StyleSheetFieldsEditor +=&quot;/*}}}*/&quot;;
store.addNotification(&quot;StyleSheetFieldsEditor&quot;, refreshStyles);

//}}}</pre>
</div>
<div title="FileDropPlugin" modifier="JohnRouillard" created="200611080217" modified="201007310838" tags="AttachFilePackage systemConfig excludeMissing systemConfigDisable">
<pre>/***
|Name|FileDropPlugin|
|Source|http://www.TiddlyTools.com/#FileDropPlugin|
|Version|2.1.4|
|Author|BradleyMeck and Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Description|drag-and-drop files/directories to create tiddlers|
''requires FireFox or another Mozilla-compatible browser.''
!!!!!Usage
&lt;&lt;&lt;
This plugin automatically creates tiddlers from files that are dropped onto an open TiddlyWiki document.  You can drop multiple selected files and/or folders to create many tiddlers at once.  New tiddler titles are created using the filename of each dropped file (i.e., omitting the path).  If a title is already in use, you are prompted to enter a new title for that file.  If you drop a folder, you will be asked if you want to create a simple 'directory list' of files in a single tiddler or create one tiddler for each file in that folder.  

By default, it is assumed that all dropped files contain text.  However, if [[AttachFilePlugin]], [[AttachFilePluginFormatters]] and [[AttachFileMIMETypes]] are installed, then you can drop ''//binary data files//'' as well as text files.  If the MIME type of a dropped file is not &quot;text/plain&quot;, then AttachFilePlugin is used to create an 'attachment' tiddler, rather than creating a simple text tiddler.

When creating text tiddlers, you can embed a //link// to the original external file at the top of the new tiddler, in addition to (or instead of) the text content itself.  The format for this link (see Configuration, below) uses embedded ''//replacement markers//'' that allow you to generate a variety of wiki-formatted output, where:
*%0 = filename (without path)
*%1 = local &quot;&quot;&quot;file://...&quot;&quot;&quot; URL
*%2 = local path and filename (OS-native format)
*%3 = relative path (if subdirectory of current document directory)
*%4 = file size
*%5 = file date
*%6 = current date
*%7 = current ~TiddlyWiki username
*\n = newline
By default, the link format uses the filename (%0) and local URL (%1), enclosed within a //hidden section// syntax, like this:
{{{
/%
!link
[[%0|%1]]
!end
%/
}}}
This permits the link to be embedded along with the text content, without changing the appearance of that content when the tiddler is viewed.  To display the link in your tiddler content, use:
{{{
&lt;&lt;tiddler TiddlerName##link&gt;&gt;
}}}
&lt;&lt;&lt;
!!!!!Configuration
&lt;&lt;&lt;
__FileDropPlugin options:__
&lt;&lt;option chkFileDropContent&gt;&gt;Copy file content into tiddlers if smaller than: &lt;&lt;option txtFileDropDataLimit&gt;&gt; bytes
&amp;nbsp; //(note: excess text content will be truncated, oversized binary files will skipped, 0=no limit)//
&lt;&lt;option chkFileDropLink&gt;&gt;Generate external links to files, using this format:{{editor{&lt;html&gt;&lt;nowiki&gt;&lt;textarea rows=&quot;4&quot; onchange=&quot;
config.macros.option.propagateOption('txtFileDropLinkFormat','value',this.value.escapeLineBreaks(),'input');
&quot;&gt;&lt;/textarea&gt;&lt;/html&gt;&lt;&lt;tiddler {{
	var ta=place.lastChild.getElementsByTagName('textarea')[0];
	var v=config.options.txtFileDropLinkFormat.unescapeLineBreaks();
	ta.value=v;
&quot;&quot;;}}&gt;&gt;}}}&lt;&lt;option chkFileDropTrimFilename&gt;&gt;Omit file extensions from tiddler titles
&lt;&lt;option chkFileDropDisplay&gt;&gt;Automatically display newly created tiddlers
Tag newly created tiddlers with: &lt;&lt;option txtFileDropTags&gt;&gt;

__FileDropPlugin+AttachFilePlugin options:__ //(binary file data as encoded 'base64' text)//
&lt;&lt;option chkFileDropAttachLocalLink&gt;&gt; attachment includes reference to local path/filename
&gt;Note: if the plugin does not seem to work, enter ''about:config'' in the Firefox address bar, and make sure that {{{signed.applets.codebase_principal_support}}} is set to ''true''
&lt;&lt;&lt;
!!!!!Examples (custom handler functions)
&lt;&lt;&lt;
Adds a single file with confirmation and prompting for title:
{{{
config.macros.fileDrop.addEventListener('application/x-moz-file',
	function(nsiFile) {
		var msg='You have dropped the file:\n'
			+nsiFile.path+'\n'
			+'onto the page, it will be imported as a tiddler. Is that ok?'
		if(confirm(msg)) {
			var newDate = new Date();
			var title = prompt('what would you like to name the tiddler?');
			store.saveTiddler(title,title,loadFile(nsiFile.path),config.options.txtUserName,newDate,[]);
		}
		return true;
	});
}}}
Adds a single file without confirmation, using path/filename as tiddler title:
{{{
config.macros.fileDrop.addEventListener('application/x-moz-file',
	function(nsiFile) {
		var newDate = new Date();
		store.saveTiddler(nsiFile.path,nsiFile.path,loadFile(nsiFile.path),config.options.txtUserName,newDate,[]);
		story.displayTiddler(null,nsiFile.path)
		return true;
	});
}}}
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2010.03.06 2.1.4 added event listener for 'dragover' (for FireFox 3.6+)
2009.10.10 2.1.3 fixed IE code error
2009.10.08 2.1.2 fixed chkFileDropContent bypass handling for binary attachments
2009.10.07 2.1.0 added chkFileDropContent and chkFileDropLink/txtFileDropLinkFormat
2009.08.19 2.0.0 fixed event listener registration for FireFox 3.5+.  Also, merged with FileDropPluginConfig, with code cleanup/reduction
2008.08.11 1.5.1 added chkFileDropAttachLocalLink option to allow suppression of local path/file link
2007.xx.xx *.*.* add suspend/resume of notifications to improve performance when multiple files are handled
2007.01.01 0.9.9 extensions for AttachFilePlugin
2006.11.04 0.1.1 initial release by Bradley Meck
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.FileDropPlugin={major:2, minor:1, revision:4, date: new Date(2010,3,6)};

config.macros.fileDrop = {
	customDropHandlers: [],
	addEventListener: function(paramflavor,func,inFront) {
		var obj={}; obj.flavor=paramflavor; obj.handler=func;
		if (!inFront) this.customDropHandlers.push(obj);
		else this.customDropHandlers.shift(obj);
	},
	dragDropHandler: function(evt) {
		netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
		var dragService = Components.classes['@mozilla.org/widget/dragservice;1'].getService(Components.interfaces.nsIDragService);
		var dragSession = dragService.getCurrentSession();
		var transferObject = Components.classes['@mozilla.org/widget/transferable;1'].createInstance();
		transferObject = transferObject.QueryInterface(Components.interfaces.nsITransferable);
		transferObject.addDataFlavor('application/x-moz-file');
		var numItems = dragSession.numDropItems;
		if (numItems&gt;1) {
			clearMessage();
			displayMessage('Reading '+numItems+' files...');
			store.suspendNotifications();
		}
		for (var i = 0; i &lt; numItems; i++) {
			dragSession.getData(transferObject, i);
			var dataObj = {};
			var dropSizeObj = {};
			for(var ind=0; ind&lt;config.macros.fileDrop.customDropHandlers.length; ind++) {
				var item = config.macros.fileDrop.customDropHandlers[ind];
				if(dragSession.isDataFlavorSupported(item.flavor)) {
					transferObject.getTransferData(item.flavor, dataObj, dropSizeObj);
					var droppedFile = dataObj.value.QueryInterface(Components.interfaces.nsIFile);
					var result = item.handler.call(item,droppedFile);
					evt.stopPropagation();
					evt.preventDefault();
					if (result) break;
				}
			}
		}
		if (numItems&gt;1) {
			store.resumeNotifications();
			store.notifyAll();
			displayMessage(numItems+' files have been processed');
		}
	}
}
//}}}
/***
!!!!!window event handlers
***/
//{{{
if(!window.event) {
	window.addEventListener('dragdrop',	// FireFox3.1-
		config.macros.fileDrop.dragDropHandler, true);
	window.addEventListener('drop',		// FireFox3.5+
		config.macros.fileDrop.dragDropHandler, true);
	window.addEventListener('dragover',	// FireFox3.6+
		function(e){e.stopPropagation();e.preventDefault();}, true); 
}
//}}}
/***
!!!!!handler for files, directories and binary attachments (see [[AttachFilePlugin]])
***/
//{{{
var defaults={
	chkFileDropDisplay:		true,
	chkFileDropTrimFilename:	false,
	chkFileDropContent:		true,
	chkFileDropLink:		true,
	txtFileDropLinkFormat:		'/%\\n!link\\n[[%0|%1]]\\n!end\\n%/',
	txtFileDropDataLimit:		'32768',
	chkFileDropAttachLocalLink:	true,
	txtFileDropTags:		''
};
for (var id in defaults) if (config.options[id]===undefined)
	config.options[id]=defaults[id];

config.macros.fileDrop.addEventListener('application/x-moz-file',function(nsiFile) {
	var co=config.options; // abbrev
	var header='Index of %0\n^^(as of %1)^^\n|!filename| !size | !modified |\n';
	var item='|[[%0|%1]]| %2|%3|\n';
	var footer='Total of %0 bytes in %1 files\n';
	var now=new Date();
	var files=[nsiFile];
	if (nsiFile.isDirectory()) {
		var folder=nsiFile.directoryEntries;
		var files=[];
		while (folder.hasMoreElements()) {
			var f=folder.getNext().QueryInterface(Components.interfaces.nsILocalFile);
			if (f instanceof Components.interfaces.nsILocalFile &amp;&amp; !f.isDirectory()) files.push(f);
		}
		var msg=nsiFile.path.replace(/\\/g,'/')+'\n\n';
		msg+='contains '+files.length+' files... ';
		msg+='select OK to attach all files or CANCEL to create a list...';
		if (!confirm(msg)) { // create a list in a tiddler
			var title=nsiFile.leafName; // tiddler name is last directory name in path
			while (title &amp;&amp; title.length &amp;&amp; store.tiddlerExists(title)) {
				if (confirm(config.messages.overwriteWarning.format([title]))) break;
				title=prompt('Enter a new tiddler title',nsiFile.path.replace(/\\/g,'/'));
			}
			if (!title || !title.length) return true; // cancelled
			var text=header.format([nsiFile.path.replace(/\\/g,'/'),now.toLocaleString()]);
			var total=0;
			for (var i=0; i&lt;files.length; i++) { var f=files[i];
				var name=f.leafName;
				if (co.chkFileDropTrimFilename)
					{ var p=name.split('.'); if (p.length&gt;1) p.pop(); name=p.join('.'); }
				var path='file:///'+f.path.replace(/\\/g,'/');
				var size=f.fileSize; total+=size;
				var when=new Date(f.lastModifiedTime).formatString('YYYY.0MM.0DD 0hh:0mm:0ss');
				text+=item.format([name,path,size,when]);
			}
			text+=footer.format([total,files.length]);
			var newtags=co.txtFileDropTags?co.txtFileDropTags.readBracketedList():[];
			store.saveTiddler(null,title,text,co.txtUserName,now,newtags);
			if (co.chkFileDropDisplay) story.displayTiddler(null,title);
			return true;
		}
	}
	if (files.length&gt;1) store.suspendNotifications();
	for (i=0; i&lt;files.length; i++) {
		var file=files[i];
		if (file.isDirectory()) continue; // skip over nested directories
		var type='text/plain';
		var title=file.leafName; // tiddler name is file name
		if (co.chkFileDropTrimFilename)
			{ var p=title.split('.'); if (p.length&gt;1) p.pop(); title=p.join('.'); }
		var name=file.leafName;
		var path=file.path;
		var url='file:///'+path.replace(/\\/g,'/');
		var size=file.fileSize;
		var when=new Date(file.lastModifiedTime);
		var now=new Date();
		var who=config.options.txtUserName;
		var h=document.location.href;
		var cwd=getLocalPath(decodeURIComponent(h.substr(0,h.lastIndexOf('/')+1)));
		var relpath=path.startsWith(cwd)?'./'+path.substr(cwd.length):path;
		while (title &amp;&amp; title.length &amp;&amp; store.tiddlerExists(title)) {
			if (confirm(config.messages.overwriteWarning.format([title]))) break;
			title=prompt('Enter a new tiddler title',path.replace(/\\/g,'/'));
		}
		if (!title || !title.length) continue; // cancelled
		if (config.macros.attach) {
			type=config.macros.attach.getMIMEType(name,'');
			if (!type.length)
				type=prompt('Unknown file type.  Enter a MIME type','text/plain');
			if (!type||!type.length) continue; // cancelled
		}
		var newtags=co.txtFileDropTags?co.txtFileDropTags.readBracketedList():[];
		if (type=='text/plain' || !co.chkFileDropContent) {
			var txt=''; var fmt=co.txtFileDropLinkFormat.unescapeLineBreaks();
			if (co.chkFileDropLink) txt+=fmt.format([name,url,path,relpath,size,when,now,who]);
			if (co.chkFileDropContent) {
				var out=loadFile(path); var lim=co.txtFileDropDataLimit;
				txt+=co.txtFileDropDataLimit?out.substr(0,lim):out;
				if (size&gt;lim) txt+='\n----\nfilesize ('+size+')'
					+' is larger than FileDrop limit ('+lim+')...\n'
					+'additional content has been omitted';
			}
			store.saveTiddler(null,title,txt,co.txtUserName,now,newtags);
		} else {
			var embed=co.chkFileDropContent
				&amp;&amp; (!co.txtFileDropDataLimit||size&lt;co.txtFileDropDataLimit);
			newtags.push('attachment'); newtags.push('excludeMissing');
			config.macros.attach.createAttachmentTiddler(path,
				now.formatString(config.macros.timeline.dateFormat),
				'attached by FileDropPlugin', newtags, title,
				embed, co.chkFileDropAttachLocalLink, false,
				relpath, '', type,!co.chkFileDropDisplay);
		}
		if (co.chkFileDropDisplay) story.displayTiddler(null,title);
	}
	if (files.length&gt;1) { store.resumeNotifications(); store.notifyAll(); }
	return true;
})
//}}}</pre>
</div>
<div title="FileDropPluginConfig" modifier="JohnRouillard" created="200611131926" modified="201007310839" tags="AttachFilePackage settings systemConfig excludeMissing systemConfigDisable">
<pre>/***
|Name|FileDropPluginConfig|
|Source|http://www.TiddlyTools.com/#FileDropPluginConfig|
|Version|1.5.1|
|Author|Eric Shulman - ELS Design Studios|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.1|
|Type|plugin|
|Requires|FileDropPlugin, AttachFilePlugin|
|Overrides||
|Options|##Configuration|
|Description|Adds drag-and-drop handlers for creating binary attachments or directory lists|

__TiddlyTools FileDrop+AttachFile extended handler:__
* use just filename instead of whole path as tiddler title
* check for existing tiddler and prompt for new name
* handle folder drops (drops each file or creates a file list in a tiddler)
* use AttachFilePlugin if MIME type is not text/plain
* autotag created tiddlers (e.g., &quot;temporary&quot;, &quot;dropped&quot;, etc.)
* option to suppress automatic display of newly created tiddlers
* suspend/resume notifications when handling multiple files (performance improvement)
!!!!!Configuration
&lt;&lt;&lt;
&lt;&lt;option chkFileDropTrimFilename&gt;&gt; Omit file extensions from tiddler titles when creating new tiddlers
&amp;nbsp;&amp;nbsp;{{{usage: &lt;&lt;option chkFileDropTrimFilename&gt;&gt; }}}
&lt;&lt;option chkFileDropDisplay&gt;&gt; Automatically display newly created tiddlers
&amp;nbsp;&amp;nbsp;{{{usage: &lt;&lt;option chkFileDropDisplay&gt;&gt; }}}
Tag newly created tiddlers with: &lt;&lt;option txtFileDropTags&gt;&gt;
&amp;nbsp;&amp;nbsp;{{{usage: &lt;&lt;option txtFileDropTags&gt;&gt;}}}

__FileDrop+AttachFile configuration options:__
&lt;&lt;option chkFileDropAttachLocalLink&gt;&gt; Include reference to local path/filename
&amp;nbsp;&amp;nbsp;{{{usage: &lt;&lt;option chkFileDropAttachLocalLink&gt;&gt; }}}
&lt;&lt;option chkFileDropAttachEncodeData&gt;&gt; Include binary file data as encoded &quot;base64&quot; text
&amp;nbsp;&amp;nbsp;{{{usage: &lt;&lt;option chkFileDropAttachEncodeData&gt;&gt; }}}
...only if file is smaller than: &lt;&lt;option txtFileDropAttachDataLimit&gt;&gt; bytes
&amp;nbsp;&amp;nbsp;{{{usage: &lt;&lt;option txtFileDropAttachDataLimit&gt;&gt;}}}

See [[FileDropPlugin]] for more documentation on handler implementation specifics, including sample code for default drop handlers.
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2008.08.11 [1.5.1] added chkFileDropAttachLocalLink option to allow suppression of local path/file link
2007.01.01 [0.9.9] initial release with extensions for AttachFilePlugin
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
if (config.options.chkFileDropAttachEncodeData==undefined)
	config.options.chkFileDropAttachEncodeData=true;
if (config.options.chkFileDropAttachLocalLink==undefined)
	config.options.chkFileDropAttachLocalLink=true;
if (config.options.txtFileDropAttachDataLimit==undefined)
	config.options.txtFileDropAttachDataLimit=32768;
if (config.options.txtFileDropTags==undefined)
	config.options.txtFileDropTags=&quot;&quot;;
if (config.options.chkFileDropDisplay==undefined)
	config.options.chkFileDropDisplay=true;
if (config.options.chkFileDropTrimFilename==undefined)
	config.options.chkFileDropTrimFilename=false;

config.macros.fileDrop.addEventListener(&quot;application/x-moz-file&quot;,function(nsiFile)
{
	var header=&quot;Index of %0\n^^(as of %1)^^\n|!filename| !size | !modified |\n&quot;;
	var item=&quot;|[[%0|%1]]| %2|%3|\n&quot;;
	var footer=&quot;Total of %0 bytes in %1 files\n&quot;;

	var now=new Date();
	var files=[nsiFile];
	if (nsiFile.isDirectory()) {
		var folder=nsiFile.directoryEntries;
		var files=[];
		while (folder.hasMoreElements()) {
			var f=folder.getNext().QueryInterface(Components.interfaces.nsILocalFile);
			if (f instanceof Components.interfaces.nsILocalFile &amp;&amp; !f.isDirectory()) files.push(f);
		}
		var msg=nsiFile.path.replace(/\\/g,&quot;/&quot;)+&quot;\n\n&quot;;
		msg+=&quot;contains &quot;+files.length+&quot; files... &quot;;
		msg+=&quot;select OK to attach all files or CANCEL to create a list...&quot;;
		if (!confirm(msg)) { // create a list in a tiddler
			var title=nsiFile.leafName; // tiddler name is last directory name in path
			while (title &amp;&amp; title.length &amp;&amp; store.tiddlerExists(title)) {
				if (confirm(config.messages.overwriteWarning.format([title]))) break; // use existing title
				title=prompt(&quot;Please enter a different tiddler title for this file&quot;,nsiFile.path.replace(/\\/g,&quot;/&quot;));
			}
			if (!title || !title.length) return true; // aborted by user... we're done!
			var text=header.format([nsiFile.path.replace(/\\/g,&quot;/&quot;),now.toLocaleString()]);
			var total=0;
			for (var i=0; i&lt;files.length; i++) { var f=files[i];
				var name=f.leafName;
				if (config.options.chkFileDropTrimFilename)
					{ var p=name.split(&quot;.&quot;); if (p.length&gt;1) p.pop(); name=p.join(&quot;.&quot;); }
				var path=&quot;file:///&quot;+f.path.replace(/\\/g,&quot;/&quot;);
				var size=f.fileSize; total+=size;
				var when=new Date(f.lastModifiedTime).formatString(&quot;YYYY.0MM.0DD 0hh:0mm:0ss&quot;);
				text+=item.format([name,path,size,when]);
			}
			text+=footer.format([total,files.length]);
			var newtags=config.options.txtFileDropTags?config.options.txtFileDropTags.readBracketedList():[];
			store.saveTiddler(null,title,text,config.options.txtUserName,now,newtags);
			if (config.options.chkFileDropDisplay) story.displayTiddler(null,title);
			return true;
		}
	}
	if (files.length&gt;1) store.suspendNotifications();
	for (i=0; i&lt;files.length; i++) {
		var file=files[i];
		if (file.isDirectory()) continue; // skip over nested directories
		var type=&quot;text/plain&quot;;
		var title=file.leafName; // tiddler name is file name
		if (config.options.chkFileDropTrimFilename)
			{ var p=title.split(&quot;.&quot;); if (p.length&gt;1) p.pop(); title=p.join(&quot;.&quot;); }
		var path=file.path;
		var size=file.fileSize;
		while (title &amp;&amp; title.length &amp;&amp; store.tiddlerExists(title)) {
			if (confirm(config.messages.overwriteWarning.format([title]))) break; // use existing title
			title=prompt(&quot;Please enter a different tiddler title for this file&quot;,path.replace(/\\/g,&quot;/&quot;));
		}
		if (!title || !title.length) continue; // cancelled by user... skip this file
		if (config.macros.attach) {
			type=config.macros.attach.getMIMEType(file.leafName,&quot;&quot;);
			if (!type.length)
				type=prompt(&quot;Unrecognized file type.  Please enter a MIME type for this file&quot;,&quot;text/plain&quot;);
			if (!type||!type.length) continue; // cancelled by user... skip this file
		}
		var newtags=config.options.txtFileDropTags?config.options.txtFileDropTags.readBracketedList():[];
		if (type==&quot;text/plain&quot;)
			store.saveTiddler(null,title,loadFile(path),config.options.txtUserName,now,newtags);
		else {
			// only encode data if enabled and file is smaller than limit.  Default is 32768 (32K) bytes.
			var embed=config.options.chkFileDropAttachEncodeData
				&amp;&amp; file.fileSize&lt;config.options.txtFileDropAttachDataLimit;
			newtags.push(&quot;attachment&quot;); newtags.push(&quot;excludeMissing&quot;);
			var localfile=&quot;&quot;;
			if (config.options.chkFileDropAttachLocalLink) {
				// if file is in current document folder,
				// remove path prefix and use relative reference
				var localfile=path;
				var h=document.location.href;
				folder=getLocalPath(decodeURIComponent(h.substr(0,h.lastIndexOf(&quot;/&quot;)+1)));
				if (localfile.substr(0,folder.length)==folder)
					localfile='./'+localfile.substr(folder.length);
			}
			config.macros.attach.createAttachmentTiddler(path,
				now.formatString(config.macros.timeline.dateFormat),
				&quot;attached by FileDropPlugin&quot;, newtags,
				title, embed, config.options.chkFileDropAttachLocalLink, false,
				localfile, &quot;&quot;, type,!config.options.chkFileDropDisplay);
		}
		if (config.options.chkFileDropDisplay) story.displayTiddler(null,title);
	}
	if (files.length&gt;1) { store.resumeNotifications(); store.notifyAll(); }
	if (window.FFDEBUG) console.log(new Date()-now);
	return true;
})
//}}}</pre>
</div>
<div title="FootnotesPlugin" modifier="JohnRouillard" created="200710181504" modified="200909121326" tags="systemConfig lewcidExtension excludeMissing PatchedPlugin">
<pre>/***
|''Name:''|FootnotesPlugin|
|''Description:''|Create automated tiddler footnotes.|
|''Author:''|Saq Imtiaz ( lewcid@gmail.com )|
|''Source:''|http://tw.lewcid.org/#FootnotesPlugin|
|''Code Repository:''|http://tw.lewcid.org/svn/plugins|
|''Version:''|2.01|
|''Date:''|10/25/07|
|''License:''|[[Creative Commons Attribution-ShareAlike 3.0 License|http://creativecommons.org/licenses/by-sa/3.0/]]|
|''~CoreVersion:''|2.2.2|

!!Usage:
*To create a footnote, just put the footnote text inside triple backticks.
*Footnotes are numbered automatically, and listed at the bottom of the tiddler.
*{{{Creating a footnote is easy. ```This is the text for my footnote```}}}
*[[Example|FootnotesDemo]]
***/
// /%
//!BEGIN-PLUGIN-CODE
config.footnotesPlugin = {
	backLabel: &quot;back&quot;,
	prompt:&quot;show footnote&quot;
};

config.formatters.unshift( {
    name: &quot;footnotes&quot;,
    match: &quot;```&quot;,
    lookaheadRegExp: /```((?:.|\n)*?)```/g,
    handler: function(w)
    {
        // rouilj to prevent function from erroring when rendered during an rss export operation
        // just exit if not being rendered within a story.
        if (!story.findContainingTiddler(place)) return;
        // end patch
        this.lookaheadRegExp.lastIndex = w.matchStart;
        var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
        if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart )
            {
			var tiddler = story.findContainingTiddler(w.output);
			if (!tiddler.notes)
				tiddler.notes = [];
			var title = tiddler.getAttribute(&quot;tiddler&quot;);
			tiddler.notes.pushUnique(lookaheadMatch[1]);
			var pos = tiddler.notes.indexOf(lookaheadMatch[1]) + 1;
			createTiddlyButton(w.output,pos,config.footnotesPlugin.prompt,function(){var x = document.getElementById(title+&quot;ftn&quot;+pos);window.scrollTo(0,ensureVisible(x)+(ensureVisible(x)&lt;findScrollY()?(findWindowHeight()-x.offsetHeight):0));return false;},&quot;ftnlink&quot;,title+&quot;ftnlink&quot;+pos);			
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
            }
    }
});

old_footnotes_refreshTiddler = Story.prototype.refreshTiddler;
Story.prototype.refreshTiddler = function(title,template,force)
{
    var tiddler = old_footnotes_refreshTiddler.apply(this,arguments);
	if (tiddler &amp;&amp; tiddler.notes &amp;&amp; tiddler.notes.length)
	{
		var holder = createTiddlyElement(null,&quot;div&quot;,null,&quot;footnoteholder&quot;);
		var list = createTiddlyElement(holder,&quot;ol&quot;,title+&quot;footnoteholder&quot;);
		for (var i=0; i&lt;tiddler.notes.length; i++)
		{
			var ftn = createTiddlyElement(list,&quot;li&quot;,title+&quot;ftn&quot;+(i+1),&quot;footnote&quot;);
			wikify(tiddler.notes[i]+&quot; &quot;,ftn);
			createTiddlyButton(ftn,&quot;[&quot;+config.footnotesPlugin.backLabel+&quot;]&quot;,config.footnotesPlugin.backLabel,function(){window.scrollTo(0,ensureVisible(document.getElementById(this.parentNode.id.replace(&quot;ftn&quot;,&quot;ftnlink&quot;))));return false;},&quot;ftnbklink&quot;);
		}
		var count = tiddler.childNodes.length;
		for (var j=0; j&lt;count; j++){
			if(hasClass(tiddler.childNodes[j],&quot;viewer&quot;)){
				var viewer = tiddler.childNodes[j];	
			}
		}
		viewer.appendChild(holder);
		tiddler.notes = [];
	}
    return tiddler;
};

setStylesheet(
&quot;.tiddler a.ftnlink {vertical-align: super; font-size: 0.8em; color:red;}\n&quot;+
&quot;.tiddler a.ftnlink:hover, .tiddler .footnoteholder a.ftnbklink:hover{color:#fff;background:red;}\n&quot;+
&quot;.tiddler div.footnoteholder{margin:1.8em 1.0em; padding:0.1em 1.0em 0.1em 1.0em ;border-left: 1px solid #ccc;}&quot;+
&quot;.tiddler footnoteholder ol {font-size: 0.9em; line-height: 1.2em;}\n&quot;+
&quot;.tiddler .footnoteholder li.footnote {margin: 0 0 5px 0;}\n&quot;+
&quot;.tiddler .footnoteholder a.ftnbklink{color:red;}\n&quot;,&quot;FootNotesStyles&quot;);
//!END-PLUGIN-CODE
// %/</pre>
</div>
<div title="FormattingCheatSheet" modifier="JohnRouillard" created="200903200256" modified="200908170140" tags="excludeMissing">
<pre>!Inline Formatting
|!Option|!Syntax|!Output|
|bold font|{{{''bold''}}}|''bold''|
|italic type|{{{//italic//}}}|//italic//|
|underlined text|{{{__underlined__}}}|__underlined__|
|strikethrough text|{{{--strikethrough--}}}|--strikethrough--|
|superscript text|{{{^^super^^script}}}|^^super^^script|
|subscript text|{{{~~sub~~script}}}|~~sub~~script|
|highlighted text|{{{@@highlighted@@}}}|@@highlighted@@|
|preformatted text|&lt;html&gt;&lt;code&gt;{{{preformatted}}}&lt;/code&gt;&lt;/html&gt;|{{{preformatted}}}|
!Block Elements
!!Headings
{{{
!Heading 1
!!Heading 2
!!!Heading 3
!!!!Heading 4
!!!!!Heading 5
}}}
&lt;&lt;&lt;
!Heading 1
!!Heading 2
!!!Heading 3
!!!!Heading 4
!!!!!Heading 5
&lt;&lt;&lt;
!!Lists
{{{
* unordered list, level 1
** unordered list, level 2
*** unordered list, level 3

# ordered list, level 1
## ordered list, level 2
### unordered list, level 3

; definition list, term
: definition list, description
}}}
&lt;&lt;&lt;
* unordered list, level 1
** unordered list, level 2
*** unordered list, level 3

# ordered list, level 1
## ordered list, level 2
### unordered list, level 3

; definition list, term
: definition list, description
&lt;&lt;&lt;
!!Blockquotes
{{{
&gt; blockquote, level 1
&gt;&gt; blockquote, level 2
&gt;&gt;&gt; blockquote, level 3

&lt;&lt;&lt;
blockquote
&lt;&lt;&lt;
}}}
&lt;&lt;&lt;
&gt; blockquote, level 1
&gt;&gt; blockquote, level 2
&gt;&gt;&gt; blockquote, level 3

&gt; blockquote
&lt;&lt;&lt;
!!Preformatted Text
&lt;html&gt;&lt;pre&gt;
{{{
preformatted (e.g. code)
}}}
&lt;/pre&gt;&lt;/html&gt;
&lt;&lt;&lt;
{{{
preformatted (e.g. code)
}}}
&lt;&lt;&lt;
!!Tables
{{{
|CssClass|k
|!heading column 1|!heading column 2|
|row 1, column 1|row 1, column 2|
|row 2, column 1|row 2, column 2|
|&gt;|COLSPAN|
|ROWSPAN|  |
|~|  |
|CssProperty:value;|  |
|caption|c
}}}
''Annotation:''
* The {{{&gt;}}} marker creates a &quot;colspan&quot;, causing the current cell to merge with the one to the right.
* The {{{~}}} marker creates a &quot;rowspan&quot;, causing the current cell to merge with the one above.
&lt;&lt;&lt;
|CssClass|k
|!heading column 1|!heading column 2|
|row 1, column 1|row 1, column 2|
|row 2, column 1|row 2, column 2|
|&gt;|COLSPAN|
|ROWSPAN|  |
|~|  |
|CssProperty:value;|  |
|caption|c
&lt;&lt;&lt;
!!Images /% TODO %/
cf. [[TiddlyWiki.com|http://www.tiddlywiki.com/#EmbeddedImages]]
!Hyperlinks
* [[WikiWords|WikiWord]] are automatically transformed to hyperlinks to the respective tiddler
** the automatic transformation can be suppressed by preceding the respective WikiWord with a tilde ({{{~}}}): {{{~WikiWord}}}
* [[PrettyLinks]] are enclosed in square brackets and contain the desired tiddler name: {{{[[tiddler name]]}}}
** optionally, a custom title or description can be added, separated by a pipe character ({{{|}}}): {{{[[title|target]]}}}&lt;br&gt;'''N.B.:''' In this case, the target can also be any website (i.e. URL).
!Custom Styling
* {{{@@CssProperty:value;CssProperty:value;@@}}}&lt;br&gt;''N.B.:'' CSS color definitions should use lowercase letters to prevent the inadvertent creation of WikiWords.
* &lt;html&gt;&lt;code&gt;{{customCssClass{}}}&lt;/code&gt;&lt;/html&gt;
* raw HTML can be inserted by enclosing the respective code in HTML tags: {{{&lt;html&gt;  &lt;/html&gt;}}}
!Special Markers
* {{{&lt;br&gt;}}} forces a manual line break
* {{{----}}} creates a horizontal ruler
* [[HTML entities|http://www.tiddlywiki.com/#HtmlEntities]]
* {{{&lt;&lt;macroName&gt;&gt;}}} calls the respective [[macro|Macros]]
* To hide text within a tiddler so that it is not displayed, it can be wrapped in {{{/%}}} and {{{%/}}}.&lt;br/&gt;This can be a useful trick for hiding drafts or annotating complex markup.
* To prevent wiki markup from taking effect for a particular section, that section can be enclosed in three double quotes: e.g. {{{&quot;&quot;&quot;WikiWord&quot;&quot;&quot;}}}.</pre>
</div>
<div title="Frontscreen.png" modifier="JohnRouillard" created="200909020330" modified="201008020345" tags="attachment excludeMissing content excludeOrphans">
<pre>!usage
{{{[img[Frontscreen.png]]}}}
[img[Frontscreen.png]]
!notes
//none//
!type
image/png
!file
./support/images/Frontscreen.png
!url

!data
</pre>
</div>
<div title="GettingStarted" modifier="JohnRouillard" created="200909030346" modified="201008012022">
<pre>{{adiv{
&lt;&lt;showWhen window.location.protocol!='file:'&gt;&gt;
You ''MUST'' download the coursebook to your local disk from: &lt;&lt;wikify {{location.href}}&gt;&gt; (using the browser's download/save link mechanism). You are currently viewing it using http or https and ''can not'' save it while viewing it from the net.
{{adiv{
&lt;&lt;showWhen ! (config.browser.isIE || (navigator.userAgent.indexOf('Firefox') != -1)) &gt;&gt;
You must also download/save to disk &lt;&lt;wikify {{location.href}}&gt;&gt; in the same directory as the coursebook since you are not using Internet Explorer or Firefox.
}}}
}}} {{adiv{
&lt;&lt;showWhen window.location.protocol=='file:'&gt;&gt;
If you are seeing this tiddler when you first load the file, there is no content loaded in your coursebook yet. Follow the directions below to prepare this coursebook.

# Enter your username for signing your edits: &lt;&lt;option txtUserName&gt;&gt;.
# Click the outlined `button' below to load content into this empty book:&lt;br /&gt; &lt;&lt;loadTiddlers &quot;label:Import new content from %0&quot; updates {{store.getTiddlerSlice('GettingStarted','courseHomeContent')}} {{config.options['chkLoadTiddlersShowReport']=false;}} &gt;&gt;.{{aspan{&lt;&lt;showWhenExists Welcome&gt;&gt;@@&lt;br /&gt;''Content has been loaded successfully''.@@}}}
# Once the content is loaded (it can take a minute),  click on &lt;&lt;saveChanges&gt;&gt; to save the changes.
# Then click to &lt;html&gt;&lt;a style=&quot;border: 1px solid #DDBB44&quot; onClick=&quot;window.location.reload()&quot;&gt;reload the page&lt;/a&gt;&lt;/html&gt; or use F5 in your browser.
}}}

/%
Original content of this tiddler is located below.
----
To get started with this blank [[TiddlyWiki]], you'll need to modify the following tiddlers:
* [[SiteTitle]] &amp; [[SiteSubtitle]]: The title and subtitle of the site, as shown above (after saving, they will also appear in the browser title bar)
* [[MainMenu]]: The menu (usually on the left)
* [[DefaultTiddlers]]: Contains the names of the tiddlers that you want to appear when the TiddlyWiki is opened
%/


/%
URL's for LISA 2009

courseHome: http://www.cs.umb.edu/~rouilj/classes/SEC_LISA09
courseHomeBook: http://www.cs.umb.edu/~rouilj/classes/SEC_LISA09/SEC_tw.html
courseHomeTs: http://www.cs.umb.edu/~rouilj/classes/SEC_LISA09/TiddlySaver.jar
courseHomeContent: http://coursebook.tiddlyspot.com/coursebook_ps.html
courseHomeRss: http://www.cs.umb.edu/~rouilj/classes/SEC_LISA09/SEC_tw.xml
%/</pre>
</div>
<div title="GettingStarted - LISA" modifier="JohnRouillard" created="200909030314" modified="201007312201" tags="InstructorOnly">
<pre>{{adiv{
&lt;&lt;showWhen window.location.protocol!='file:'&gt;&gt;
You ''MUST'' download the coursebook to your local disk from: &lt;&lt;wikify {{location.href}}&gt;&gt; (using the browser's download/save link mechanism). You are currently viewing it using http or https and ''can not'' save it while viewing it from the net.
{{adiv{
&lt;&lt;showWhen ! (config.browser.isIE || (navigator.userAgent.indexOf('Firefox') != -1)) &gt;&gt;
You must also download/save to disk &lt;&lt;wikify {{location.href}}&gt;&gt; in the same directory as the coursebook since you are not using Internet Explorer or Firefox.
}}}
}}} {{adiv{
&lt;&lt;showWhen window.location.protocol=='file:'&gt;&gt;
If you are seeing this tiddler when you first load the file, there is no content loaded in your coursebook yet. Follow the directions below to prepare this coursebook.

# Enter your username for signing your edits: &lt;&lt;option txtUserName&gt;&gt;.
# Click the outlined `button' below to load content into this empty book:&lt;br /&gt; &lt;&lt;loadTiddlers &quot;label:Import new content from %0&quot; updates {{store.getTiddlerSlice('GettingStarted','courseHomeContent')}} {{config.options['chkLoadTiddlersShowReport']=false;}} &gt;&gt;.{{aspan{&lt;&lt;showWhenExists Welcome&gt;&gt;@@&lt;br /&gt;''Content has been loaded successfully''.@@}}}
# Once the content is loaded (it can take a minute),  click on &lt;&lt;saveChanges&gt;&gt; to save the changes.
# Then click to &lt;html&gt;&lt;a style=&quot;border: 1px solid #DDBB44&quot; onClick=&quot;window.location.reload()&quot;&gt;reload the page&lt;/a&gt;&lt;/html&gt; or use F5 in your browser.
}}}

/%
Original content of this tiddler is located below.
----
To get started with this blank [[TiddlyWiki]], you'll need to modify the following tiddlers:
* [[SiteTitle]] &amp; [[SiteSubtitle]]: The title and subtitle of the site, as shown above (after saving, they will also appear in the browser title bar)
* [[MainMenu]]: The menu (usually on the left)
* [[DefaultTiddlers]]: Contains the names of the tiddlers that you want to appear when the TiddlyWiki is opened
%/


/%
URL's for LISA 2009

courseHome: http://www.cs.umb.edu/~rouilj/classes/SEC_LISA09
courseHomeBook: http://www.cs.umb.edu/~rouilj/classes/SEC_LISA09/SEC_tw.html
courseHomeTs: http://www.cs.umb.edu/~rouilj/classes/SEC_LISA09/TiddlySaver.jar
courseHomeContent: http://coursebook.tiddlyspot.com/coursebook_ps.html
courseHomeRss: http://www.cs.umb.edu/~rouilj/classes/SEC_LISA09/SEC_tw.xml
%/</pre>
</div>
<div title="Glossary" modifier="JohnRouillard" created="200903200245" modified="201008081717" tags="content reference">
<pre>&lt;part chapterControlTiddler&gt;
; Chapter Control Tiddler
:A tiddler tagged with the {{{chapter}}} tag. Each control tiddler has a control panel at the top that allows you to display the contents of the chapter. Changes to tiddler links in the chapter tiddler change the tiddlers that are considered part of the chapter.
&lt;/part&gt;
&lt;part multiTiddlerPresentation&gt;
; multi-tiddler presentation
: a presentation where each slide is a different tiddler. This is the recommended form for presentations being distributed to students. See [[Chapter  1 - Types of Presentations##Multi-tiddler Presentations]].
&lt;/part&gt;
&lt;part presentationControlTiddler&gt;
; Presentation Control Tiddler
:A tiddler tagged with the {{{presentation}}} tag. Each control tiddler has a control panel at the top that allows you to start the presentation in Instructor, Student or Print mode. Changes to this tiddler change the slides that are presented as part of the presentation.
&lt;/part&gt;
&lt;part singleTiddlerPresentation&gt;
; single tiddler presentation
: a presentation where each slide is a delimited secton of a single tiddler. This is useful for kiosk type presentations that are meant to loop and stand alone. It is not the recommended form for presentations being distributed to students. See [[Chapter  1 - Types of Presentations##Single Tiddler Presentations]].
&lt;/part&gt;
&lt;part slice&gt;
;slice
:A way of storing names and values inside a tiddler that can be extracted by using a reference in the form: {{{tiddlerName::sliceName}}}. Slices are defined using {{{slicename: sliceValue}}}  on a single line in a tiddler. There are alternate forms for creating a slice. See http://tiddlywiki.org/wiki/Tiddler_Slices for the details.
&lt;/part&gt;
&lt;part sync&gt;
;sync
:1) The act of importing new copies of tiddlers from an external tiddlywiki. The act of syncing overwrites the imported tiddlers losing any changes made to them. The normal one-click [[sync tool|sync]] in the coursebook only updates content tiddlers. Note tiddlers are always preserved. &lt;br /&gt;2) Do not confuse this with the sync mechanism in the backstage toolbar. The sync mechanism in the backstage toolbar replaces the plugins that make the coursebook work with the original published versions. Do not use [[sync from the backstage toolbar|Using the Backstage Link]] unless you are very experienced in managing  tiddlywiki.
&lt;/part&gt;
&lt;part transcluded&gt;
;transcluded; transclude
:Including the contents or partial content of another tiddler in the current tiddler using the {{{&lt;&lt;tiddler&gt;&gt;}}} macro. Transcluded content can be in the form of: &lt;&lt;tiddler Glossary##transcludedTypes&gt;&gt; Tiddlers are referenced as {{{&lt;&lt;tiddler tiddlerName&gt;&gt;}}}. Sections are referenced as {{{&lt;&lt;tiddler tiddlerName##sectionTitle&gt;&gt;}}}, slices are referenced as {{{&lt;&lt;tiddler tiddlerName::sliceName&gt;&gt;}}} and parts (available with the PartTiddlerPlugin) are referenced as {{{&lt;&lt;tiddler tiddlerName/partName&gt;&gt;}}}. If the reference includes spaces, the reference must be surrounded by single quotes, double quotes or {{{[[...]]}}} doubled square brackets. For example: {{{&lt;&lt;tiddler &quot;My Tiddler##Section One&quot;&gt;&gt;}}}
&lt;/part&gt;
&lt;part tiddlyWiki&gt;
; ~TiddlyWiki
:A single file editable web page driven by javascript.
&lt;/part&gt;
&lt;part wikiWord&gt;
; ~WikiWord
:A specially formatted word starting with a capital letter and having at least one more capital letter in the word. Also called camel case worids because the capital letters are like the humps on a camel. The unique thing about WikiWords is that they are automatically recognised as links to tiddlers with the same name. No other special formatting other than naming the tiddler is required to create a hyperlink.
&lt;/part&gt;

/%
!transcludedTypes
* (whole) tiddlers
* sections
* slices
* parts.
!end
%/</pre>
</div>
<div title="Goals" modifier="JohnRouillard" created="201007251848" modified="201007310701" tags="slide content">
<pre>&lt;&lt;tiddler SlideSubstyle##levelOne with: url(&quot;goal.jpg&quot;)&gt;&gt; {{overlay1{Presentations}}} {{overlay2{Textbook}}} {{overlay3{Notebook}}}

{{comment{
picture of a goal

[img[goal.jpg]]

Teaching tool for the Simple Event Correlator workshop at LISA 2009.
Meant to replace the usual tools:
*  powerpoint presentation
*  pdf's of slides for offline use/notes
*  supplimentary info as pdf or printed hardcopy
Since I had real working exercises, laptops/computers in class were required so an interactive coursebook was a possibility.
}}}
</pre>
</div>
<div title="GotoPlugin" modifier="ELSDesignStudios" created="200605052341" modified="200905221854" tags="NavigationPackage systemConfig excludeMissing">
<pre>/***
|Name|GotoPlugin|
|Source|http://www.TiddlyTools.com/#GotoPlugin|
|Documentation|http://www.TiddlyTools.com/#GotoPluginInfo|
|Version|1.9.2|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides||
|Description|view any tiddler by entering it's title - displays list of possible matches|
''View a tiddler by typing its title and pressing //enter//.''  As you type, a list of possible matches is displayed.  You can scroll-and-click (or use arrows+enter) to select/view a tiddler, or press escape to close the listbox to resume typing.  When the listbox is not displayed, pressing //escape// clears the current input.
!!!Documentation
&gt;see [[GotoPluginInfo]]
!!!Configuration
&lt;&lt;&lt;
*Match titles only after {{twochar{&lt;&lt;option txtIncrementalSearchMin&gt;&gt;}}} or more characters are entered.&lt;br&gt;Use down-arrow to start matching with shorter input.  //Note: This option value is also set/used by [[SearchOptionsPlugin]]//.
*To set the maximum height of the listbox, you can create a tiddler tagged with &lt;&lt;tag systemConfig&gt;&gt;, containing:
//{{{
config.macros.gotoTiddler.listMaxSize=10;  // change this number
//}}}
&lt;&lt;&lt;
!!!Revisions
&lt;&lt;&lt;
2009.05.22 [1.9.2] use reverseLookup() for IncludePlugin
|please see [[GotoPluginInfo]] for additional revision details|
2006.05.05 [0.0.0] started
&lt;&lt;&lt;
!!!Code
***/
//{{{
version.extensions.GotoPlugin= {major: 1, minor: 9, revision: 2, date: new Date(2009,5,22)};

// automatically tweak shadow SideBarOptions to add &lt;&lt;gotoTiddler&gt;&gt; macro above &lt;&lt;search&gt;&gt;
config.shadowTiddlers.SideBarOptions=config.shadowTiddlers.SideBarOptions.replace(/&lt;&lt;search&gt;&gt;/,&quot;{{button{goto}}}\n&lt;&lt;gotoTiddler&gt;&gt;&lt;&lt;search&gt;&gt;&quot;);

if (config.options.txtIncrementalSearchMin===undefined) config.options.txtIncrementalSearchMin=3;

config.macros.gotoTiddler= { 
	listMaxSize: 10,
	listHeading: 'Found %0 matching title%1...',
	searchItem: &quot;Search for '%0'...&quot;,
	handler:
	function(place,macroName,params,wikifier,paramString,tiddler) {
		var quiet	=params.contains(&quot;quiet&quot;);
		var showlist	=params.contains(&quot;showlist&quot;);
		var search	=params.contains(&quot;search&quot;);
		params = paramString.parseParams(&quot;anon&quot;,null,true,false,false);
		var instyle	=getParam(params,&quot;inputstyle&quot;,&quot;&quot;);
		var liststyle	=getParam(params,&quot;liststyle&quot;,&quot;&quot;);
		var filter	=getParam(params,&quot;filter&quot;,&quot;&quot;);
		var html=this.html;
		var keyevent=window.event?&quot;onkeydown&quot;:&quot;onkeypress&quot;; // IE event fixup for ESC handling
		html=html.replace(/%keyevent%/g,keyevent);
		html=html.replace(/%search%/g,search);
		html=html.replace(/%quiet%/g,quiet);
		html=html.replace(/%showlist%/g,showlist);
		html=html.replace(/%display%/g,showlist?'block':'none');
		html=html.replace(/%position%/g,showlist?'static':'absolute');
		html=html.replace(/%instyle%/g,instyle);
		html=html.replace(/%liststyle%/g,liststyle);
		html=html.replace(/%filter%/g,filter);
		if (config.browser.isIE) html=this.IEtableFixup.format([html]);
		var span=createTiddlyElement(place,'span');
		span.innerHTML=html; var form=span.getElementsByTagName(&quot;form&quot;)[0];
		if (showlist) this.fillList(form.list,'',filter,search,0);
	},
	html:
	'&lt;form onsubmit=&quot;return false&quot; style=&quot;display:inline;margin:0;padding:0&quot;&gt;\
		&lt;input name=gotoTiddler type=text autocomplete=&quot;off&quot; accesskey=&quot;G&quot; style=&quot;%instyle%&quot;\
			title=&quot;Enter title text... ENTER=goto, SHIFT-ENTER=search for text, DOWN=select from list&quot;\
			onfocus=&quot;this.select(); this.setAttribute(\'accesskey\',\'G\');&quot;\
			%keyevent%=&quot;return config.macros.gotoTiddler.inputEscKeyHandler(event,this,this.form.list,%search%,%showlist%);&quot;\
			onkeyup=&quot;return config.macros.gotoTiddler.inputKeyHandler(event,this,%quiet%,%search%,%showlist%);&quot;&gt;\
		&lt;select name=list style=&quot;display:%display%;position:%position%;%liststyle%&quot;\
			onchange=&quot;if (!this.selectedIndex) this.selectedIndex=1;&quot;\
			onblur=&quot;this.style.display=%showlist%?\'block\':\'none\';&quot;\
			%keyevent%=&quot;return config.macros.gotoTiddler.selectKeyHandler(event,this,this.form.gotoTiddler,%showlist%);&quot;\
			onclick=&quot;return config.macros.gotoTiddler.processItem(this.value,this.form.gotoTiddler,this,%showlist%);&quot;&gt;\
		&lt;/select&gt;&lt;input name=&quot;filter&quot; type=&quot;hidden&quot; value=&quot;%filter%&quot;&gt;\
	&lt;/form&gt;',
	IEtableFixup:
	&quot;&lt;table style='width:100%;display:inline;padding:0;margin:0;border:0;'&gt;\
		&lt;tr style='padding:0;margin:0;border:0;'&gt;&lt;td style='padding:0;margin:0;border:0;'&gt;\
		%0&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;,
	getItems:
	function(list,val,filter) {
		if (!list.cache || !list.cache.length || val.length&lt;=config.options.txtIncrementalSearchMin) {
			// starting new search, fetch and cache list of tiddlers/shadows/tags
			list.cache=new Array();
			if (filter.length) {
				var fn=store.getMatchingTiddlers||store.getTaggedTiddlers;
				var tiddlers=store.sortTiddlers(fn.apply(store,[filter]),'title');
			} else 
				var tiddlers=store.reverseLookup('tags','excludeLists');
			for(var t=0; t&lt;tiddlers.length; t++) list.cache.push(tiddlers[t].title);
			if (!filter.length) {
				for (var t in config.shadowTiddlers) list.cache.pushUnique(t);
				var tags=store.getTags();
				for(var t=0; t&lt;tags.length; t++) list.cache.pushUnique(tags[t][0]);
			}
		}
		var found = [];
		var match=val.toLowerCase();
		for(var i=0; i&lt;list.cache.length; i++)
			if (list.cache[i].toLowerCase().indexOf(match)!=-1) found.push(list.cache[i]);
		return found;
	},
	getItemSuffix:
	function(t) {
		if (store.tiddlerExists(t)) return &quot;&quot;;  // tiddler
		if (store.isShadowTiddler(t)) return &quot; (shadow)&quot;; // shadow
		return &quot; (tag)&quot;; // tag 
	},
	fillList:
	function(list,val,filter,search,key) {
		if (list.style.display==&quot;none&quot;) return; // not visible... do nothing!
		var indent='\xa0\xa0\xa0';
		var found = this.getItems(list,val,filter); // find matching items...
		found.sort(); // alpha by title
		while (list.length &gt; 0) list.options[0]=null; // clear list
		var hdr=this.listHeading.format([found.length,found.length==1?&quot;&quot;:&quot;s&quot;]);
		list.options[0]=new Option(hdr,&quot;&quot;,false,false);
		for (var t=0; t&lt;found.length; t++) list.options[list.length]=
			new Option(indent+found[t]+this.getItemSuffix(found[t]),found[t],false,false);
		if (search)
			list.options[list.length]=new Option(this.searchItem.format([val]),&quot;*&quot;,false,false);
		list.size=(list.length&lt;this.listMaxSize?list.length:this.listMaxSize); // resize list...
		list.selectedIndex=key==38?list.length-1:key==40?1:0;
	},
	keyProcessed:
	function(ev) { // utility function
		ev.cancelBubble=true; // IE4+
		try{event.keyCode=0;}catch(e){}; // IE5
		if (window.event) ev.returnValue=false; // IE6
		if (ev.preventDefault) ev.preventDefault(); // moz/opera/konqueror
		if (ev.stopPropagation) ev.stopPropagation(); // all
		return false;
	},
	inputEscKeyHandler:
	function(event,here,list,search,showlist) {
		if (event.keyCode==27) {
			if (showlist) { // clear input, reset list
				here.value=here.defaultValue;
				this.fillList(list,'',here.form.filter.value,search,0);
			}
			else if (list.style.display==&quot;none&quot;) // clear input
				here.value=here.defaultValue;
			else list.style.display=&quot;none&quot;; // hide list
			return this.keyProcessed(event);
		}
		return true; // key bubbles up
	},
	inputKeyHandler:
	function(event,here,quiet,search,showlist) {
		var key=event.keyCode;
		var list=here.form.list;
		var filter=here.form.filter;
		// non-printing chars bubble up, except for a few:
		if (key&lt;48) switch(key) {
			// backspace=8, enter=13, space=32, up=38, down=40, delete=46
			case 8: case 13: case 32: case 38: case 40: case 46: break; default: return true;
		}
		// blank input... if down/enter... fall through (list all)... else, and hide or reset list
		if (!here.value.length &amp;&amp; !(key==40 || key==13)) {
			if (showlist) this.fillList(here.form.list,'',here.form.filter.value,search,0);
			else list.style.display=&quot;none&quot;;
			return this.keyProcessed(event);
		}
		// hide list if quiet, or below input minimum (and not showlist)
		list.style.display=(!showlist&amp;&amp;(quiet||here.value.length&lt;config.options.txtIncrementalSearchMin))?'none':'block';
		// non-blank input... enter=show/create tiddler, SHIFT-enter=search for text
		if (key==13 &amp;&amp; here.value.length) return this.processItem(event.shiftKey?'*':here.value,here,list,showlist);
		// up or down key, or enter with blank input... shows and moves to list...
		if (key==38 || key==40 || key==13) { list.style.display=&quot;block&quot;; list.focus(); }
		this.fillList(list,here.value,filter.value,search,key);
		return true; // key bubbles up
	},
	selectKeyHandler:
	function(event,list,editfield,showlist) {
		if (event.keyCode==27) // escape... hide list, move to edit field
			{ editfield.focus(); list.style.display=showlist?'block':'none'; return this.keyProcessed(event); }
		if (event.keyCode==13 &amp;&amp; list.value.length) // enter... view selected item
			{ this.processItem(list.value,editfield,list,showlist); return this.keyProcessed(event); }
		return true; // key bubbles up
	},
	processItem:
	function(title,here,list,showlist) {
		if (!title.length) return;
		list.style.display=showlist?'block':'none';
		if (title==&quot;*&quot;)	{ story.search(here.value); return false; } // do full-text search
		if (!showlist) here.value=title;
		story.displayTiddler(null,title); // show selected tiddler
		return false;
	}
}
//}}}</pre>
</div>
<div title="GotoPluginInfo" modifier="ELSDesignStudios" created="200801081338" modified="200905221746" tags="pluginInfo excludeMissing">
<pre>/***
|Name|GotoPluginInfo|
|Source|http://www.TiddlyTools.com/#GotoPlugin|
|Documentation|http://www.TiddlyTools.com/#GotoPluginInfo|
|Version|1.9.2|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.1|
|Type|documentation|
|Requires||
|Overrides||
|Description|Documentation for GotoPlugin|
''View a tiddler by typing its title and pressing //enter//.''  As you type, a list of possible matches is displayed.  You can scroll-and-click (or use arrows+enter) to select/view a tiddler, or press escape to close the listbox to resume typing.  When the listbox is not displayed, pressing //escape// clears the current input.
!!!!!Usage/Examples
&lt;&lt;&lt;
syntax: {{{&lt;&lt;gotoTiddler quiet search inputstyle:... liststyle:... filter:...&gt;&gt;}}}
All parameters are optional.
* ''quiet'' (//keyword//)&lt;br&gt;list will not be automatically display as each character is typed.  Use //down// or //enter// to view the list.
* ''showlist'' (//keyword//)&lt;br&gt;list will always be displayed, inline, directly below the input field.
* ''search'' (//keyword//)&lt;br&gt;adds an extra 'command item' to the list that can be used to invoke a full-text search using the entered value.  This can be especially useful when no matching tiddler titles have been found.
* ''inputstyle:'' and ''liststyle:''&lt;br&gt;are CSS declarations that modify the default input and listbox styles, respectively.  Note: the CSS styles must be surrounded by ({{{&quot;...&quot;}}} or {{{'...'}}}) or ({{{[[...]]}}}) (e.g., {{{liststyle:&quot;border:1px dotted blue;color:green;...&quot;}}}.
* ''filter:''&lt;br&gt;is a single tag value (or a boolean tag expression if MatchTagsPlugin is installed), and is used to limit the search to only those tiddlers matching the indicated tag or tag expression (e.g., {{{&lt;&lt;gotoTiddler filter:&quot;faq or help&quot;&gt;&gt;}}})
{{{&lt;&lt;gotoTiddler&gt;&gt;}}}
&lt;&lt;gotoTiddler&gt;&gt;
{{{&lt;&lt;gotoTiddler search&gt;&gt;}}}
&lt;&lt;gotoTiddler search&gt;&gt;
{{{&lt;&lt;gotoTiddler showlist filter:&quot;pluginInfo&quot; liststyle:&quot;height:10em;width:auto;&quot;&gt;&gt;}}}
&lt;&lt;gotoTiddler showlist filter:&quot;pluginInfo&quot; liststyle:&quot;height:10em;width:auto;&quot;&gt;&gt;
&lt;&lt;&lt;
!!!!!Configuration
&lt;&lt;&lt;
*Match titles only after {{twochar{&lt;&lt;option txtIncrementalSearchMin&gt;&gt;}}} or more characters are entered.&lt;br&gt;Use down-arrow to start matching with shorter input.  //Note: This option value is also set/used by [[SearchOptionsPlugin]]//.
*To set the maximum height of the listbox, you can create a tiddler tagged with &lt;&lt;tag systemConfig&gt;&gt;, containing:
//{{{
config.macros.gotoTiddler.listMaxSize=10;  // change this number
//}}}
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.05.22 [1.9.2] use reverseLookup() for IncludePlugin
2009.04.12 [1.9.1] support multiple instances with different filters by using per-element tiddler cache instead of shared static cache
2009.04.05 [1.9.0] added 'showlist' parameter for inline display with listbox always visible.
2009.03.23 [1.8.0] added txtIncrementalSearchMin (default=3).  Avoids fetching long lists.  Use down arrow to force search with short input.
2008.12.15 [1.7.1] up arrow from input field now moves to end of droplist (search for input).  Also, shift+enter cam now be used to quickly invoke search for text.
2008.10.16 [1.7.0] in macro handler(), changed to use //named// params instead of positional params, and added optional &quot;filter:&quot; param for tag filtering.  Removed 'insert' handling (now provided by [[QuickEditPlugin]]).
2008.10.02 [1.6.1] for IE, wrap controls in a table.  Corrects placement of listbox so it is below input field.
2008.10.02 [1.6.0] added 'search' param for optional &quot;Search for:&quot; item that invokes full text search (especially useful when no title matches are found)
2008.02.17 [1.5.0] ENTER key always displays tiddler based on current input regardless of whether input matches any existing tiddler
2007.10.31 [1.4.3] removed extra trailing comma on last property of config.macros.gotoTiddler object.  This fixes an error under InternetExplorer that was introduced 6 days ago... sure, I should have found it sooner, but... WHY DON'T PEOPLE TELL ME WHEN THINGS ARE BROKEN!!!!
2007.10.25 [1.4.2] added onclick handler for input field, so that clicking in field hides the listbox.
2007.10.25 [1.4.1] re-wrote getItems() to cache list of tiddlers/shadows/tags and use case-folded simple text match instead of regular expression to find matching tiddlers.  This *vastly* reduces processing overhead between keystrokes, especially for documents with many (&gt;1000) tiddlers.  Also, removed local definition of replaceSelection(), now supported directly by the TW2.2+ core, as well as via backward-compatible plugin
2007.04.25 [1.4.0] renamed macro from &quot;goto&quot; to &quot;gotoTiddler&quot;.  This was necessary to avoid a fatal syntax error in Opera (and other browsers) that require strict adherence to ECMAScript 1.5 standards which defines the identifier &quot;goto&quot; as &quot;reserved for FUTURE USE&quot;... *sigh*
2007.04.21 [1.3.2] in html definition, removed DIV around droplist (see 1.2.6 below).  It created more layout problems then it solved. :-(
2007.04.01 [1.3.1] in processItem(), ensure that correct textarea field is found by checking for edit==&quot;text&quot; attribute
2007.03.30 [1.3.0] tweak SideBarOptions shadow to automatically add {{{&lt;&lt;goto&gt;&gt;}}} when using default sidebar content
2007.03.30 [1.2.6] in html definition, added DIV around droplist to fix IE problem where list appears next to input field instead of below it.  
2007.03.28 [1.2.5] in processItem(), set focus to text area before setting selection (needed for IE to get correct selection 'range')
2007.03.28 [1.2.4] added prompt for 'pretty text' when inserting a link into tiddler content
2007.03.28 [1.2.3] added local copy of core replaceSelection() and modified for different replace logic
2007.03.27 [1.2.2] in processItem(), use story.getTiddlerField() to retrieve textarea control
2007.03.26 [1.2.1] in html, use either 'onkeydown' (IE) or 'onkeypress' (Moz) event to process &lt;esc&gt; key sooner, to prevent &lt;esc&gt; from 'bubbling up' to the tiddler (which will close the current editor).
2007.03.26 [1.2.0] added support for optional &quot;insert&quot; keyword param.
2006.05.10 [1.1.2] when filling listbox, set selection to 'heading' item... auto-select first tiddler title when down/enter moves focus into listbox
2006.05.08 [1.1.1] added accesskey (&quot;G&quot;) to input field html (also set when field gets focus).  Also, inputKeyHandler() skips non-printing/non-editing keys. 
2006.05.08 [1.1.0] added heading to listbox for better feedback (also avoids problems with 1-line droplist)
2006.05.07 [1.0.0] list matches against tiddlers/shadows/tags.  input field auto-completion... 1st enter=complete matching input (or show list)... 2nd enter=view tiddler.  &quot;quiet&quot; param controls when listbox appears.  handling for enter (13), escape(27), and down(40) keys.   Change 'ondblclick' to 'onclick' to avoid unintended triggering of tiddler editor).  Shadow titles inserted into list instead of appended to the end.
2006.05.05 [0.0.0] started
&lt;&lt;&lt;</pre>
</div>
<div title="HideWhenPlugin" modifier="MPTW" created="200901131132" modified="200906031203" tags="systemConfig">
<pre>/***
|Name:|HideWhenPlugin|
|Description:|Allows conditional inclusion/exclusion in templates|
|Version:|3.1 ($Rev: 3919 $)|
|Date:|$Date: 2008-03-13 02:03:12 +1000 (Thu, 13 Mar 2008) $|
|Source:|http://mptw.tiddlyspot.com/#HideWhenPlugin|
|Author:|Simon Baird &lt;simon.baird@gmail.com&gt;|
|License:|http://mptw.tiddlyspot.com/#TheBSDLicense|
For use in ViewTemplate and EditTemplate. Example usage:
{{{&lt;div macro=&quot;showWhenTagged Task&quot;&gt;[[TaskToolbar]]&lt;/div&gt;}}}
{{{&lt;div macro=&quot;showWhen tiddler.modifier == 'BartSimpson'&quot;&gt;&lt;img src=&quot;bart.gif&quot;/&gt;&lt;/div&gt;}}}
***/
//{{{

window.hideWhenLastTest = false;

window.removeElementWhen = function(test,place) {
	window.hideWhenLastTest = test;
	if (test) {
		removeChildren(place);
		place.parentNode.removeChild(place);
	}
};


merge(config.macros,{

	hideWhen: { handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( eval(paramString), place);
	}},

	showWhen: { handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( !eval(paramString), place);
	}},

	hideWhenTagged: { handler: function (place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( tiddler.tags.containsAll(params), place);
	}},

	showWhenTagged: { handler: function (place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( !tiddler.tags.containsAll(params), place);
	}},

	hideWhenTaggedAny: { handler: function (place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( tiddler.tags.containsAny(params), place);
	}},

	showWhenTaggedAny: { handler: function (place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( !tiddler.tags.containsAny(params), place);
	}},

	hideWhenTaggedAll: { handler: function (place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( tiddler.tags.containsAll(params), place);
	}},

	showWhenTaggedAll: { handler: function (place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( !tiddler.tags.containsAll(params), place);
	}},

	hideWhenExists: { handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( store.tiddlerExists(params[0]) || store.isShadowTiddler(params[0]), place);
	}},

	showWhenExists: { handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( !(store.tiddlerExists(params[0]) || store.isShadowTiddler(params[0])), place);
	}},

	hideWhenTitleIs: { handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( tiddler.title == params[0], place);
	}},

	showWhenTitleIs: { handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( tiddler.title != params[0], place);
	}},

	'else': { handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		removeElementWhen( !window.hideWhenLastTest, place);
	}}

});

//}}}</pre>
</div>
<div title="How to Create Additional Content" modifier="JohnRouillard" created="201007312033" modified="201007312146" tags="content">
<pre>The directions on creating chapters and presentations assume as top down construction style. Create the containing/referring tiddlers first then create the content. However you can also create content directly and then link them back into large units (or not).
To create new content:
#  choose @@new content tiddler@@ from the sidebar
** a tiddler tagged with *content* is created.
** edit tiddler adding content
** add a reference to content tiddler to a chapter or other tiddler (optional)
*** If the tiddler title is a [[wikiword|Glossary/wikiWord]], just type the wikiword otherwise surround the title with double square brackets, e.g. {{{[[slide title]]}}}.

Because TiddlyWiki also functions as a non-linear textbook, linking all the content tiddlers into a chapter or presentation or another tiddler is not required. By using search, no links to a tiddler may be needed, although it is a good idea to provide some. You can find unlinked (orphaned) tiddlers by looking at the more tab in the sidebar and choosing the orphans subtab. If you have a tiddler that you want to keep unlinked, tag it with {{{excludeOrphans}} to remove it from the orphans tab.</pre>
</div>
<div title="How to Create a Chapter" modifier="JohnRouillard" created="201007311908" modified="201007312144" tags="content">
<pre>In the right hand sidebar, choose @@new chapter tiddler@@. A   tiddler tagged with {{{chapter story content}}} is created. If this chapter is not supposed to be published to the student, replace the content tag with {{{InstructorOnly}}}.

Note that chapters in the main menu are sorted by title so the new tiddler is created with the standard title prefix &quot;Chapter  1&quot; with two spaces before the 1. This allows proper sorting it sorts {{{Chapter  1}}} before {{{Chapter 11}}}. Also some browsers (IE for example) don't display the full chapter title in the pull down list. As a result make your title unique in the first 15 or so characters so the student can look for the title in the title links section and select the properly named chapter from the pull down selection list.
</pre>
</div>
<div title="IconsSource" modifier="JohnRouillard" created="201007270248" modified="201007310850" tags="content">
<pre>The icons used in this coursebook were created by http://pixel-mixer.com. There are more in this set and can be seen at: http://www.iconarchive.com/category/application/basic-icons-by-pixelmixer.html

The following icons with suggested uses are available in this coursebook (shown reduced to 24 pixel size):

;[img(24px,)[block-icon.png]]
:error, danger, not recommended
;[img(24px,)[bookmark-icon.png]]
:bookmark
;[img(24px,)[bubble-icon.png]]
:idea, concept
;[img(24px,)[clipboard-icon.png]]
:record
;[img(24px,)[delete-icon.png]]
:delete, alternate danger don't do this
;[img(24px,)[flag-icon.png]]
:flag, mark as notable
;[img(24px,)[info-icon.png]]
:information
;[img(24px,)[label-icon.png]]
:label
;[img(24px,)[pencil-icon.png]]
:make note of
;[img(24px,)[search-icon.png]]
:reminder, references prior item, look at
;[img(24px,)[tick-icon.png]]
:recommended, tip
;[img(24px,)[warning-icon.png]]
:warning, caution
</pre>
</div>
<div title="ImagePathList" modifier="JohnRouillard" created="200703251919" modified="201008020311" tags="IconPackage settings">
<pre>./support/
./support/images/
./support/icons/
</pre>
</div>
<div title="ImagePathPlugin" modifier="ELSDesignStudios" created="200703240806" modified="200704131948" tags="IconPackage systemConfig">
<pre>/***
|Name|ImagePathPlugin|
|Source|http://www.TiddlyTools.com/#ImagePathPlugin|
|Version|0.7.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin,formatter|
|Requires||
|Overrides|'image' formatter|
|Description|Tell TiddlyWiki where to look for image files.  Permits multiple 'fallback' locations|
|Status|ALPHA - initial development/testing only - may be unstable - do not distribute|

!!!!!Usage
&lt;&lt;&lt;
This plugin adds &quot;resolvePath()&quot; fallback processing to the {{{[img[...]]}}} formatter's handler, so that local image file references can be successfully resolved, even if the files cannot be located on the local filesystem.

The plugin tries alternative file &quot;paths&quot; that are listed, one per line, in an optional tiddler, [[ImagePathList]].  Each path in the list is combined with the image filename, which is then checked for existence, until the file is located.  If no alternative is found, or [[ImagePathList]] is not present, then a 'last-ditch' fallback is attempted using the remote system and path specified in [[SiteUrl]] (if present).

If no fallback attempt is successful (i.e., because no [[ImagePathList]] OR [[SiteUrl]] tiddlers have been defined), the plugin simply passes the original image file value along for default handling by the browser without any &quot;path resolution&quot; being applied.(i.e, the current TW core behavior occurs).

| ''Important note: This plugin may cause one or more security alert messages to appear, because it uses browser-specific functions that can require security permission in order to access the local filesystem to check for the existence of a given image file.  If you block local access, the 'last-ditch' fallback using the remote [[SiteUrl]] (if present) will be attempted.'' |

Note: the image formatter code contained here also includes support for AttachFilePlugin extensions (if installed).  AttachFilePlugin includes its own fallback mechanism for handling embedded vs. local file vs. remote URL references to the attached binary file.  Both methods may be used: ImagePathPlugin provides fallback for images contained in tiddler content, while AttachFilePlugin works well for access to non-image binary files (or images used in CSS as backgrounds, textures, etc.)
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
coming soon...
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
''2007.04.13 [0.7.1]'' in testFile(), convert any file:// references to local native format before checking for existence.
''2007.03.26 [0.7.0]'' for IE, use onError handling to trigger call to resolvePath() so it will only be invoked if the original path/file is not found by the browser-native lookup.  This avoids an unneeded call to fileExists() and the accompanying ActiveX security alert message box (as well as being slightly more efficient...)
''2007.03.25 [0.6.0]'' code cleanup (moved global functions into config.formatterHelpers) plus documentation re-write
''2007.03.24 [0.5.0]'' initial implementation - ALPHA - do not distribute
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.ImagePathPlugin= {major: 0, minor: 7, revision: 1, date: new Date(2007,4,13)};
//}}}
//{{{
// name of path definition tiddler
if (config.options.txtPathTiddler==undefined) config.options.txtPathTiddler=&quot;ImagePathList&quot;;
//}}}
//{{{
// low-level wrapper for platform-specific tests for local file existence
// returns true/false without visible error display
// Uses Components for FF and ActiveX FSO object for MSIE
// NOTE: this can cause a security warning on some browsers
config.formatterHelpers.fileExists=function(theFile) {
	var found=false;
	// DEBUG: alert('testing fileExists('+theFile+')...');
	if(window.Components) {
		try { netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalXPConnect&quot;); }
		catch(e) { return false; } // security access denied
		var file = Components.classes[&quot;@mozilla.org/file/local;1&quot;].createInstance(Components.interfaces.nsILocalFile);
		try { file.initWithPath(theFile); }
		catch(e) { return false; } // invalid directory
		found = file.exists();
	}
	else { // use ActiveX FSO object for MSIE 
		var fso = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);
		found = fso.FileExists(theFile)
	}
	// DEBUG: alert(theFile+&quot; &quot;+(found?&quot;exists&quot;:&quot;not found&quot;));
	return found;
}
//}}}
//{{{
// higher-level logic for checking local file existence.
// with secondary check for finding relative file references
// and automatic OK of http-based references without checking local filesystem
config.formatterHelpers.testFile=function(theFile) {
	if (document.location.protocol!=&quot;file:&quot;) return true; // viewing remote document, can't test local filesystem... assume OK
	if (theFile.substr(0,5)==&quot;http:&quot;) return true; // remote HTTP reference... assume OK
	if (theFile.substr(0,5)==&quot;file:&quot;) theFile=getLocalPath(theFile); // convert local FILE reference to native format
	if (this.fileExists(theFile)) return true; // file exists locally... OK to use!
	// file might have been relative, add path from current document and try again
	var docPath=document.location.href;
	var slashpos=docPath.lastIndexOf(&quot;/&quot;); if (slashpos==-1) slashpos=docPath.lastIndexOf(&quot;\\&quot;); 
	if (slashpos!=-1 &amp;&amp; slashpos!=docPath.length-1) docPath=docPath.substr(0,slashpos+1); // trim off filename
	if (this.fileExists(getLocalPath(docPath+theFile)))
		return true; // ah ha!... file exists relative to current document... OK to use!
	return false; // file not found on local system
}
//}}}
//{{{
// given a path/file string, check for existence and
// try alternatives (if any) defined in a tiddler
// with last-ditch using system/path from SiteUrl (if any)
config.formatterHelpers.resolvePath=function(theFile,testoriginal) {
	if (testoriginal &amp;&amp; this.testFile(theFile)) return theFile; // FOUND FILE - use specified path/file without modification
	// get the filename portion only
	var slashpos=theFile.lastIndexOf(&quot;/&quot;); if (slashpos==-1) slashpos=theFile.lastIndexOf(&quot;\\&quot;); 
	var theName=(slashpos==-1)?theFile:theFile.substr(slashpos+1);
	// get list of fallbacks (if any)
	var pathText=store.getTiddlerText(config.options.txtPathTiddler);
	if (pathText &amp;&amp; pathText.length) {
		var paths=pathText.split(&quot;\n&quot;);
		for (p=0; p&lt;paths.length; p++) // combine path+filename until one works...
			if (this.testFile(paths[p]+theName))
				return paths[p]+theName; // FOUND FILE - use alternative path+filename
	}
	// try &quot;last ditch&quot; fallback using SiteURL - assumes that original path/file was relative to document location
	var siteURL=store.getTiddlerText(&quot;SiteUrl&quot;);
	if (!siteURL||!siteURL.length) return theFile; // NO FALLBACK - use original path/file and hope for the best
	// trim filename (if any) from site URL
	var slashpos=siteURL.lastIndexOf(&quot;/&quot;); if (slashpos==-1) slashpos=siteURL.lastIndexOf(&quot;\\&quot;); 
	if (slashpos!=-1 &amp;&amp; slashpos!=siteURL.length-1) siteURL=siteURL.substr(0,slashpos+1);
	return siteURL+theFile; // LAST DITCH: use system/path from SiteUrl combined with original file/path
}
//}}}
//{{{
// replace standard handler for image formatter
// adds call to resolvePath() to handle fallback processing
// includes support for AttachFilePlugin as well
config.formatters[config.formatters.findByField(&quot;name&quot;,&quot;image&quot;)].handler=function(w) {
	if (!this.lookaheadRegExp)  // fixup for TW2.0.x
		this.lookaheadRegExp = new RegExp(this.lookahead,&quot;mg&quot;);
	this.lookaheadRegExp.lastIndex = w.matchStart;
	var lookaheadMatch = this.lookaheadRegExp.exec(w.source)
	if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) {
		// Simple bracketted link
		var e = w.output;
		if(lookaheadMatch[5]) {
			var link = lookaheadMatch[5];
			if (!config.formatterHelpers.isExternalLink) // fixup for TW2.0.x
				var external=!store.tiddlerExists(link)&amp;&amp;!store.isShadowTiddler(link);
			else
				var external=config.formatterHelpers.isExternalLink(link);
			if (external) {
				if (config.macros.attach &amp;&amp; config.macros.attach.isAttachment(link)) { // ELS - attachments
					e = createExternalLink(w.output,link);
					e.href=config.macros.attach.getAttachment(link);
					e.title = config.macros.attach.linkTooltip + link;
				} else
					e = createExternalLink(w.output,link);
			} else 
				e = createTiddlyLink(w.output,link,false,null,w.isStatic);
			addClass(e,&quot;imageLink&quot;);
		}
		var img = createTiddlyElement(e,&quot;img&quot;);
		if(lookaheadMatch[1])
			img.align = &quot;left&quot;;
		else if(lookaheadMatch[2])
			img.align = &quot;right&quot;;
		if(lookaheadMatch[3])
			img.title = lookaheadMatch[3];
		if (config.macros.attach!=undefined &amp;&amp; config.macros.attach.isAttachment(lookaheadMatch[4])) // ELS - attachments
			img.src=config.macros.attach.getAttachment(lookaheadMatch[4]);
		else {
			if (config.browser.isIE || config.browser.isSafari) { // ELS - path processing
				// IE and Safari use browser's onError handling to check the original file...
				// avoids extra security alert messages due to use of Components/ActiveX for filesystem access
				img.onerror=(function(){this.src=config.formatterHelpers.resolvePath(this.src,false);return false;});
				img.src=lookaheadMatch[4]; // ELS - path processing
			} else {
				// if NOT IE or Safari, always check the original path/file before rendering
				img.src=config.formatterHelpers.resolvePath(lookaheadMatch[4],true);
			}
		}
		w.nextMatch = this.lookaheadRegExp.lastIndex;
	}
}
//}}}</pre>
</div>
<div title="ImageSizePlugin" modifier="ELSDesignStudios" created="200801180032" modified="200902270002" tags="IconPackage systemConfig">
<pre>/***
|Name|ImageSizePlugin|
|Source|http://www.TiddlyTools.com/#ImageSizePlugin|
|Version|1.2.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.1|
|Type|plugin,formatter|
|Requires||
|Overrides|'image' formatter|
|Description|adds support for resizing images|
This plugin adds optional syntax to scale an image to a specified width and height and/or interactively resize the image with the mouse.
!!!!!Usage
&lt;&lt;&lt;
The extended image syntax is:
{{{
[img(w+,h+)[...][...]]
}}}
where ''(w,h)'' indicates the desired width and height (in CSS units, e.g., px, em, cm, in, or %). Use ''auto'' (or a blank value) for either dimension to scale that dimension proportionally (i.e., maintain the aspect ratio). You can also calculate a CSS value 'on-the-fly' by using a //javascript expression// enclosed between &quot;&quot;&quot;{{&quot;&quot;&quot; and &quot;&quot;&quot;}}&quot;&quot;&quot;. Appending a plus sign (+) to a dimension enables interactive resizing in that dimension (by dragging the mouse inside the image). Use ~SHIFT-click to show the full-sized (un-scaled) image. Use ~CTRL-click to restore the starting size (either scaled or full-sized).
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
{{{
[img(100px+,75px+)[images/meow2.jpg]]
}}}
[img(100px+,75px+)[images/meow2.jpg]]
{{{
[&lt;img(34%+,+)[images/meow.gif]]
[&lt;img(21% ,+)[images/meow.gif]]
[&lt;img(13%+, )[images/meow.gif]]
[&lt;img( 8%+, )[images/meow.gif]]
[&lt;img( 5% , )[images/meow.gif]]
[&lt;img( 3% , )[images/meow.gif]]
[&lt;img( 2% , )[images/meow.gif]]
[img(  1%+,+)[images/meow.gif]]
}}}
[&lt;img(34%+,+)[images/meow.gif]]
[&lt;img(21% ,+)[images/meow.gif]]
[&lt;img(13%+, )[images/meow.gif]]
[&lt;img( 8%+, )[images/meow.gif]]
[&lt;img( 5% , )[images/meow.gif]]
[&lt;img( 3% , )[images/meow.gif]]
[&lt;img( 2% , )[images/meow.gif]]
[img(  1%+,+)[images/meow.gif]]
{{tagClear{
}}}
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.02.24 [1.2.1] cleanup width/height regexp, use '+' suffix for resizing
2009.02.22 [1.2.0] added stretchable images
2008.01.19 [1.1.0] added evaluated width/height values
2008.01.18 [1.0.1] regexp for &quot;(width,height)&quot; now passes all CSS values to browser for validation
2008.01.17 [1.0.0] initial release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.ImageSizePlugin= {major: 1, minor: 2, revision: 1, date: new Date(2009,2,24)};
//}}}
//{{{
var f=config.formatters[config.formatters.findByField(&quot;name&quot;,&quot;image&quot;)];
f.match=&quot;\\[[&lt;&gt;]?[Ii][Mm][Gg](?:\\([^,]*,[^\\)]*\\))?\\[&quot;;
f.lookaheadRegExp=/\[([&lt;]?)(&gt;?)[Ii][Mm][Gg](?:\(([^,]*),([^\)]*)\))?\[(?:([^\|\]]+)\|)?([^\[\]\|]+)\](?:\[([^\]]*)\])?\]/mg;
f.handler=function(w) {
	this.lookaheadRegExp.lastIndex = w.matchStart;
	var lookaheadMatch = this.lookaheadRegExp.exec(w.source)
	if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) {
		var floatLeft=lookaheadMatch[1];
		var floatRight=lookaheadMatch[2];
		var width=lookaheadMatch[3];
		var height=lookaheadMatch[4];
		var tooltip=lookaheadMatch[5];
		var src=lookaheadMatch[6];
		var link=lookaheadMatch[7];

		// Simple bracketted link
		var e = w.output;
		if(link) { // LINKED IMAGE
			if (config.formatterHelpers.isExternalLink(link)) {
				if (config.macros.attach &amp;&amp; config.macros.attach.isAttachment(link)) {
					// see [[AttachFilePluginFormatters]]
					e = createExternalLink(w.output,link);
					e.href=config.macros.attach.getAttachment(link);
					e.title = config.macros.attach.linkTooltip + link;
				} else
					e = createExternalLink(w.output,link);
			} else 
				e = createTiddlyLink(w.output,link,false,null,w.isStatic);
			addClass(e,&quot;imageLink&quot;);
		}

		var img = createTiddlyElement(e,&quot;img&quot;);
		if(floatLeft) img.align=&quot;left&quot;; else if(floatRight) img.align=&quot;right&quot;;
		if(width||height) {
			var x=width.trim(); var y=height.trim();
			var stretchW=(x.substr(x.length-1,1)=='+'); if (stretchW) x=x.substr(0,x.length-1);
			var stretchH=(y.substr(y.length-1,1)=='+'); if (stretchH) y=y.substr(0,y.length-1);
			if (x.substr(0,2)==&quot;{{&quot;)
				{ try{x=eval(x.substr(2,x.length-4))} catch(e){displayMessage(e.description||e.toString())} }
			if (y.substr(0,2)==&quot;{{&quot;)
				{ try{y=eval(y.substr(2,y.length-4))} catch(e){displayMessage(e.description||e.toString())} }
			img.style.width=x.trim(); img.style.height=y.trim();
			config.formatterHelpers.addStretchHandlers(img,stretchW,stretchH);
		}
		if(tooltip) img.title = tooltip;

		// GET IMAGE SOURCE
		if (config.macros.attach &amp;&amp; config.macros.attach.isAttachment(src))
			src=config.macros.attach.getAttachment(src); // see [[AttachFilePluginFormatters]]
		else if (config.formatterHelpers.resolvePath) { // see [[ImagePathPlugin]]
			if (config.browser.isIE || config.browser.isSafari) {
				img.onerror=(function(){
					this.src=config.formatterHelpers.resolvePath(this.src,false);
					return false;
				});
			} else
				src=config.formatterHelpers.resolvePath(src,true);
		}
		img.src=src;
		w.nextMatch = this.lookaheadRegExp.lastIndex;
	}
}

config.formatterHelpers.addStretchHandlers=function(e,stretchW,stretchH) {
	e.title=((stretchW||stretchH)?'DRAG=stretch/shrink, ':'')
		+'SHIFT-CLICK=show full size, CTRL-CLICK=restore initial size';
	e.statusMsg='width=%0, height=%1';
	e.style.cursor='move';
	e.originalW=e.style.width;
	e.originalH=e.style.height;
	e.minW=Math.max(e.offsetWidth/20,10);
	e.minH=Math.max(e.offsetHeight/20,10);
	e.stretchW=stretchW;
	e.stretchH=stretchH;
	e.onmousedown=function(ev) { var ev=ev||window.event;
		this.sizing=true;
		this.startX=!config.browser.isIE?ev.pageX:(ev.clientX+findScrollX());
		this.startY=!config.browser.isIE?ev.pageY:(ev.clientY+findScrollY());
		this.startW=this.offsetWidth;
		this.startH=this.offsetHeight;
		return false;
	};
	e.onmousemove=function(ev) { var ev=ev||window.event;
		if (this.sizing) {
			var s=this.style;
			var currX=!config.browser.isIE?ev.pageX:(ev.clientX+findScrollX());
			var currY=!config.browser.isIE?ev.pageY:(ev.clientY+findScrollY());
			var newW=(currX-this.offsetLeft)/(this.startX-this.offsetLeft)*this.startW;
			var newH=(currY-this.offsetTop )/(this.startY-this.offsetTop )*this.startH;
			if (this.stretchW) s.width =Math.floor(Math.max(newW,this.minW))+'px';
			if (this.stretchH) s.height=Math.floor(Math.max(newH,this.minH))+'px';
			clearMessage(); displayMessage(this.statusMsg.format([s.width,s.height]));
		}
		return false;
	};
	e.onmouseup=function(ev) { var ev=ev||window.event;
		if (ev.shiftKey) { this.style.width=this.style.height=''; }
		if (ev.ctrlKey)  { this.style.width=this.originalW; this.style.height=this.originalH; }
		this.sizing=false;
		clearMessage();
		return false;
	};
	e.onmouseout=function(ev) { var ev=ev||window.event;
		this.sizing=false;
		clearMessage();
		return false;
	};
}
//}}}</pre>
</div>
<div title="ImportExportPackage" modifier="JohnRouillard" created="200807231302" modified="200908020123" tags="package ImportExportPackage excludeMissing excludeOrphans">
<pre>The plugins in this package provide interactive functionality for importing/exporting tiddlers to/from other TiddlyWiki documents.  Additional plugins provide enhanced local/remote file I/O features, including &quot;save as&quot;, &quot;save from web&quot; and &quot;upload&quot; functionality.</pre>
</div>
<div title="ImportTiddlersPlugin" modifier="ELSDesignStudios" created="200507201820" modified="200910070606" tags="ImportExportPackage systemConfig excludeMissing">
<pre>/***
|Name|ImportTiddlersPlugin|
|Source|http://www.TiddlyTools.com/#ImportTiddlersPlugin|
|Documentation|http://www.TiddlyTools.com/#ImportTiddlersPluginInfo|
|Version|4.6.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Description|interactive controls for import/export with filtering.|
Combine tiddlers from any two TiddlyWiki documents.  Interactively select and copy tiddlers from another TiddlyWiki source document.  Includes prompting for skip, rename, merge or replace actions when importing tiddlers that match existing titles.  When done, a list of all imported tiddlers is written into [[ImportedTiddlers]].
!!!!!Documentation
&lt;&lt;&lt;
see [[ImportTiddlersPluginInfo]] for details
&lt;&lt;&lt;
!!!!!interactive control panel
&lt;&lt;&lt;
&lt;&lt;importTiddlers inline&gt;&gt;
{{clear{
^^(see also: [[ImportTiddlers]] shadow tiddler)^^}}}
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.10.06 4.6.0 added createTiddlerFromFile (import text files)
|please see [[ImportTiddlersPluginInfo]] for additional revision details|
2005.07.20 1.0.0 Initial Release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.ImportTiddlersPlugin= {major: 4, minor: 6, revision: 0, date: new Date(2009,10,6)};

// IE needs explicit global scoping for functions/vars called from browser events
window.onClickImportButton=onClickImportButton;
window.refreshImportList=refreshImportList;

// default cookie/option values
if (!config.options.chkImportReport) config.options.chkImportReport=true;

// default shadow definition
config.shadowTiddlers.ImportTiddlers='&lt;&lt;importTiddlers inline&gt;&gt;';

// use shadow tiddler content in backstage panel
if (config.tasks) config.tasks.importTask.content='&lt;&lt;tiddler ImportTiddlers&gt;&gt;' // TW2.2 or above
//}}}
//{{{
// backward-compatiblity for TW2.0.x and TW1.2.x
if (config.macros.importTiddlers==undefined) config.macros.importTiddlers={};
if (typeof merge=='undefined') {
	function merge(dst,src,preserveExisting) {
		for(var i in src) { if(!preserveExisting || dst[i] === undefined) dst[i] = src[i]; }
		return dst;
	}
}
if (config.browser.isGecko===undefined)
	config.browser.isGecko=(config.userAgent.indexOf('gecko')!=-1);
//}}}
//{{{
merge(config.macros.importTiddlers,{
	$: function(id) { return document.getElementById(id); }, // abbreviation
	label: 'import tiddlers',
	prompt: 'Copy tiddlers from another document',
	openMsg: 'Opening %0',
	openErrMsg: 'Could not open %0 - error=%1',
	readMsg: 'Read %0 bytes from %1',
	foundMsg: 'Found %0 tiddlers in %1',
	filterMsg: &quot;Filtered %0 tiddlers matching '%1'&quot;,
	summaryMsg: '%0 tiddler%1 in the list',
	summaryFilteredMsg: '%0 of %1 tiddler%2 in the list',
	plural: 's are',
	single: ' is',
	countMsg: '%0 tiddlers selected for import',
	processedMsg: 'Processed %0 tiddlers',
	importedMsg: 'Imported %0 of %1 tiddlers from %2',
	loadText: 'please load a document...',
	closeText: 'close',
	doneText: 'done',
	startText: 'import',
	stopText: 'stop',
	local: true,		// default to import from local file
	src: '',		// path/filename or URL of document to import (retrieved from SiteUrl)
	proxy: '',		// URL for remote proxy script (retrieved from SiteProxy)
	useProxy: false,	// use specific proxy script in front of remote URL
	inbound: null,		// hash-indexed array of tiddlers from other document
	newTags: '',		// text of tags added to imported tiddlers
	addTags: true,		// add new tags to imported tiddlers
	listsize: 10,		// # of lines to show in imported tiddler list
	importTags: true,	// include tags from remote source document when importing a tiddler
	keepTags: true,		// retain existing tags when replacing a tiddler
	sync: false,		// add 'server' fields to imported tiddlers (for sync function)
	lastFilter: '',		// most recent filter (URL hash) applied
	lastAction: null,	// most recent collision button performed
	index: 0,		// current processing index in import list
	sort: ''		// sort order for imported tiddler listbox
});
//}}}
//{{{
// hijack core macro handler
if (config.macros.importTiddlers.coreHandler==undefined)
	config.macros.importTiddlers.coreHandler=config.macros.importTiddlers.handler;

config.macros.importTiddlers.handler = function(place,macroName,params,wikifier,paramString,tiddler) {
	if (!params[0] || params[0].toLowerCase()=='core') { // default to built in
		if (config.macros.importTiddlers.coreHandler)
			config.macros.importTiddlers.coreHandler.apply(this,arguments);
		else 
			createTiddlyButton(place,this.label,this.prompt,onClickImportMenu);
	} else if (params[0]=='link') { // show link to floating panel
		createTiddlyButton(place,params[1]||this.label,params[2]||this.prompt,onClickImportMenu);
	} else if (params[0]=='inline') {// show panel as INLINE tiddler content
		createImportPanel(place);
		this.$('importPanel').style.position='static';
		this.$('importPanel').style.display='block';
	} else if (config.macros.loadTiddlers)
		config.macros.loadTiddlers.handler(place,macroName,params); // any other params: loadtiddlers
}
//}}}
//{{{
// Handle link click to create/show/hide control panel
function onClickImportMenu(e) { var e=e||window.event;
	var parent=resolveTarget(e).parentNode;
	var panel=document.getElementById('importPanel');
	if (panel==undefined || panel.parentNode!=parent) panel=createImportPanel(parent);
	var isOpen=panel.style.display=='block';
	if(config.options.chkAnimate)
		anim.startAnimating(new Slider(panel,!isOpen,false,'none'));
	else
		panel.style.display=isOpen?'none':'block';
	e.cancelBubble = true; if (e.stopPropagation) e.stopPropagation(); return(false);
}
//}}}
//{{{
// Create control panel: HTML, CSS
function createImportPanel(place) {
	var cmi=config.macros.importTiddlers; // abbrev
	var panel=cmi.$('importPanel');
	if (panel) { panel.parentNode.removeChild(panel); }
	setStylesheet(store.getTiddlerText('ImportTiddlersPlugin##css'),'importTiddlers');
	panel=createTiddlyElement(place,'span','importPanel',null,null)
	panel.innerHTML=store.getTiddlerText('ImportTiddlersPlugin##html');
	refreshImportList();
	if (!cmi.src.length) cmi.src=store.getTiddlerText('SiteUrl')||'';
	cmi.$('importSourceURL').value=cmi.src;
	if (!cmi.proxy.length) cmi.proxy=store.getTiddlerText('SiteProxy')||'SiteProxy';
	cmi.$('importSiteProxy').value=cmi.proxy;
	if (config.browser.isGecko) { // FF3 FIXUP
		cmi.$('fileImportSource').style.display='none';
		cmi.$('importLocalPanelFix').style.display='block';
	}
	cmi.$('chkSync').checked=cmi.sync;
	cmi.$('chkImportTags').checked=cmi.importTags;
	cmi.$('chkKeepTags').checked=cmi.keepTags;
	cmi.$('chkAddTags').checked=cmi.addTags;
	cmi.$('txtNewTags').value=cmi.newTags;
	cmi.$('txtNewTags').style.display=cmi.addTags?'block':'none';
	cmi.$('chkSync').checked=cmi.sync;
	cmi.$('chkImportReport').checked=config.options.chkImportReport;
	return panel;
}
//}}}
//{{{
// process control interactions
function onClickImportButton(which,event) {
	var cmi=config.macros.importTiddlers; // abbreviation
	var list=cmi.$('importList'); if (!list) return false;
	var thePanel=cmi.$('importPanel');
	var theCollisionPanel=cmi.$('importCollisionPanel');
	var theNewTitle=cmi.$('importNewTitle');
	var count=0;
	switch (which.id)
		{
		case 'importFromFile':	// show local panel
		case 'importFromWeb':	// show HTTP panel
			cmi.local=(which.id=='importFromFile');
			cmi.showPanel('importLocalPanel',cmi.local);
			cmi.showPanel('importHTTPPanel',!cmi.local);
			break;
		case 'importOptions':	// show/hide options panel
			cmi.showPanel('importOptionsPanel',cmi.$('importOptionsPanel').style.display=='none');
			break;
		case 'fileImportSource':
		case 'importLoad':		// load import source into hidden frame
			importReport();		// if an import was in progress, generate a report
			cmi.inbound=null;	// clear the imported tiddler buffer
			refreshImportList();	// reset/resize the listbox
			if (cmi.src=='') break;
			// Load document, read it's DOM and fill the list
			cmi.loadRemoteFile(cmi.src,cmi.filterTiddlerList);
			break;
		case 'importSelectFeed':	// select a pre-defined systemServer feed URL
			var p=Popup.create(which); if (!p) return false;
			var tids=store.getTaggedTiddlers('systemServer');
			if (!tids.length)
				createTiddlyText(createTiddlyElement(p,'li'),'no pre-defined server feeds');
			for (var t=0; t&lt;tids.length; t++) {
				var u=store.getTiddlerSlice(tids[t].title,'URL');
				var d=store.getTiddlerSlice(tids[t].title,'Description');
				if (!d||!d.length) d=store.getTiddlerSlice(tids[t].title,'description');
				if (!d||!d.length) d=u;
				createTiddlyButton(createTiddlyElement(p,'li'),tids[t].title,d,
					function(){
						var u=this.getAttribute('url');
						document.getElementById('importSourceURL').value=u;
						config.macros.importTiddlers.src=u;
						document.getElementById('importLoad').onclick();
					},
					null,null,null,{url:u});
			}
			Popup.show();
			event.cancelBubble = true;
			if (event.stopPropagation) event.stopPropagation();
			return false;
			// create popup with feed list
			// onselect, insert feed URL into input field.
			break;
		case 'importSelectAll':		// select all tiddler list items (i.e., not headings)
			importReport();		// if an import was in progress, generate a report
			for (var t=0,count=0; t &lt; list.options.length; t++) {
				if (list.options[t].value=='') continue;
				list.options[t].selected=true;
				count++;
			}
			clearMessage(); displayMessage(cmi.countMsg.format([count]));
			cmi.$('importStart').disabled=!count;
			break;
		case 'importSelectNew':		// select tiddlers not in current document
			importReport();		// if an import was in progress, generate a report
			for (var t=0,count=0; t &lt; list.options.length; t++) {
				list.options[t].selected=false;
				if (list.options[t].value=='') continue;
				list.options[t].selected=!store.tiddlerExists(list.options[t].value);
				count+=list.options[t].selected?1:0;
			}
			clearMessage(); displayMessage(cmi.countMsg.format([count]));
			cmi.$('importStart').disabled=!count;
			break;
		case 'importSelectChanges':		// select tiddlers that are updated from existing tiddlers
			importReport();		// if an import was in progress, generate a report
			for (var t=0,count=0; t &lt; list.options.length; t++) {
				list.options[t].selected=false;
				if (list.options[t].value==''||!store.tiddlerExists(list.options[t].value)) continue;
				for (var i=0; i&lt;cmi.inbound.length; i++) // find matching inbound tiddler
					{ var inbound=cmi.inbound[i]; if (inbound.title==list.options[t].value) break; }
				list.options[t].selected=(inbound.modified-store.getTiddler(list.options[t].value).modified&gt;0); // updated tiddler
				count+=list.options[t].selected?1:0;
			}
			clearMessage(); displayMessage(cmi.countMsg.format([count]));
			cmi.$('importStart').disabled=!count;
			break;
		case 'importSelectDifferences':		// select tiddlers that are new or different from existing tiddlers
			importReport();		// if an import was in progress, generate a report
			for (var t=0,count=0; t &lt; list.options.length; t++) {
				list.options[t].selected=false;
				if (list.options[t].value=='') continue;
				if (!store.tiddlerExists(list.options[t].value)) { list.options[t].selected=true; count++; continue; }
				for (var i=0; i&lt;cmi.inbound.length; i++) // find matching inbound tiddler
					{ var inbound=cmi.inbound[i]; if (inbound.title==list.options[t].value) break; }
				list.options[t].selected=(inbound.modified-store.getTiddler(list.options[t].value).modified!=0); // changed tiddler
				count+=list.options[t].selected?1:0;
			}
			clearMessage(); displayMessage(cmi.countMsg.format([count]));
			cmi.$('importStart').disabled=!count;
			break;
		case 'importApplyFilter':	// filter list to include only matching tiddlers
			importReport();		// if an import was in progress, generate a report
			clearMessage();
			if (!cmi.all) // no tiddlers loaded = '0 selected'
				{ displayMessage(cmi.countMsg.format([0])); return false; }
			var hash=cmi.$('importLastFilter').value;
			cmi.inbound=cmi.filterByHash('#'+hash,cmi.all);
			refreshImportList();	// reset/resize the listbox
			break;
		case 'importStart':		// initiate the import processing
			importReport();		// if an import was in progress, generate a report
			cmi.$('importApplyToAll').checked=false;
			cmi.$('importStart').value=cmi.stopText;
			if (cmi.index&gt;0) cmi.index=-1; // stop processing
			else cmi.index=importTiddlers(0); // or begin processing
			importStopped();
			break;
		case 'importClose':		// unload imported tiddlers or hide the import control panel
			// if imported tiddlers not loaded, close the import control panel
			if (!cmi.inbound) { thePanel.style.display='none'; break; }
			importReport();		// if an import was in progress, generate a report
			cmi.inbound=null;	// clear the imported tiddler buffer
			refreshImportList();	// reset/resize the listbox
			break;
		case 'importSkip':	// don't import the tiddler
			cmi.lastAction=which;
			var theItem	= list.options[cmi.index];
			for (var j=0;j&lt;cmi.inbound.length;j++)
			if (cmi.inbound[j].title==theItem.value) break;
			var theImported = cmi.inbound[j];
			theImported.status='skipped after asking';			// mark item as skipped
			theCollisionPanel.style.display='none';
			cmi.index=importTiddlers(cmi.index+1);	// resume with NEXT item
			importStopped();
			break;
		case 'importRename':		// change name of imported tiddler
			cmi.lastAction=which;
			var theItem		= list.options[cmi.index];
			for (var j=0;j&lt;cmi.inbound.length;j++)
			if (cmi.inbound[j].title==theItem.value) break;
			var theImported		= cmi.inbound[j];
			theImported.status	= 'renamed from '+theImported.title;	// mark item as renamed
			theImported.set(theNewTitle.value,null,null,null,null);		// change the tiddler title
			theItem.value		= theNewTitle.value;			// change the listbox item text
			theItem.text		= theNewTitle.value;			// change the listbox item text
			theCollisionPanel.style.display='none';
			cmi.index=importTiddlers(cmi.index);	// resume with THIS item
			importStopped();
			break;
		case 'importMerge':	// join existing and imported tiddler content
			cmi.lastAction=which;
			var theItem	= list.options[cmi.index];
			for (var j=0;j&lt;cmi.inbound.length;j++)
			if (cmi.inbound[j].title==theItem.value) break;
			var theImported	= cmi.inbound[j];
			var theExisting	= store.getTiddler(theItem.value);
			var theText	= theExisting.text+'\n----\n^^merged from: ';
			theText		+='[['+cmi.src+'#'+theItem.value+'|'+cmi.src+'#'+theItem.value+']]^^\n';
			theText		+='^^'+theImported.modified.toLocaleString()+' by '+theImported.modifier+'^^\n'+theImported.text;
			var theDate	= new Date();
			var theTags	= theExisting.getTags()+' '+theImported.getTags();
			theImported.set(null,theText,null,theDate,theTags);
			theImported.status   = 'merged with '+theExisting.title;	// mark item as merged
			theImported.status  += ' - '+theExisting.modified.formatString('MM/DD/YYYY 0hh:0mm:0ss');
			theImported.status  += ' by '+theExisting.modifier;
			theCollisionPanel.style.display='none';
			cmi.index=importTiddlers(cmi.index);	// resume with this item
			importStopped();
			break;
		case 'importReplace':		// substitute imported tiddler for existing tiddler
			cmi.lastAction=which;
			var theItem		  = list.options[cmi.index];
			for (var j=0;j&lt;cmi.inbound.length;j++)
			if (cmi.inbound[j].title==theItem.value) break;
			var theImported     = cmi.inbound[j];
			var theExisting	  = store.getTiddler(theItem.value);
			theImported.status  = 'replaces '+theExisting.title;		// mark item for replace
			theImported.status += ' - '+theExisting.modified.formatString('MM/DD/YYYY 0hh:0mm:0ss');
			theImported.status += ' by '+theExisting.modifier;
			theCollisionPanel.style.display='none';
			cmi.index=importTiddlers(cmi.index);	// resume with THIS item
			importStopped();
			break;
		case 'importListSmaller':		// decrease current listbox size, minimum=5
			if (list.options.length==1) break;
			list.size-=(list.size&gt;5)?1:0;
			cmi.listsize=list.size;
			break;
		case 'importListLarger':		// increase current listbox size, maximum=number of items in list
			if (list.options.length==1) break;
			list.size+=(list.size&lt;list.options.length)?1:0;
			cmi.listsize=list.size;
			break;
		case 'importListMaximize':	// toggle listbox size between current and maximum
			if (list.options.length==1) break;
			list.size=(list.size==list.options.length)?cmi.listsize:list.options.length;
			break;
		}
}
//}}}
//{{{
config.macros.importTiddlers.showPanel=function(place,show,skipAnim) {
	if (typeof place=='string') var place=document.getElementById(place);
	if (!place||!place.style) return;
	if(!skipAnim &amp;&amp; anim &amp;&amp; config.options.chkAnimate) anim.startAnimating(new Slider(place,show,false,'none'));
	else place.style.display=show?'block':'none';
}
//}}}
//{{{
function refreshImportList(selectedIndex) {
	var cmi=config.macros.importTiddlers; // abbrev
	var list=cmi.$('importList'); if (!list) return;
	// if nothing to show, reset list content and size
	if (!cmi.inbound) {
		while (list.length &gt; 0) { list.options[0] = null; }
		list.options[0]=new Option(cmi.loadText,'',false,false);
		list.size=cmi.listsize;
		cmi.$('importLoad').disabled=false;
		cmi.$('importLoad').style.display='inline';
		cmi.$('importStart').disabled=true;
		cmi.$('importOptions').disabled=true;
		cmi.$('importOptions').style.display='none';
		cmi.$('fileImportSource').disabled=false;
		cmi.$('importFromFile').disabled=false;
		cmi.$('importFromWeb').disabled=false;
		cmi.$('importStart').value=cmi.startText;
		cmi.$('importClose').value=cmi.doneText;
		cmi.$('importSelectPanel').style.display='none';
		cmi.$('importOptionsPanel').style.display='none';
		return;
	}
	// there are inbound tiddlers loaded...
	cmi.$('importLoad').disabled=true;
	cmi.$('importLoad').style.display='none';
	cmi.$('importOptions').style.display='inline';
	cmi.$('importOptions').disabled=false;
	cmi.$('fileImportSource').disabled=true;
	cmi.$('importFromFile').disabled=true;
	cmi.$('importFromWeb').disabled=true;
	cmi.$('importClose').value=cmi.closeText;
	if (cmi.$('importSelectPanel').style.display=='none')
		cmi.showPanel('importSelectPanel',true);

	// get the sort order
	if (!selectedIndex)   selectedIndex=0;
	if (selectedIndex==0) cmi.sort='title';		// heading
	if (selectedIndex==1) cmi.sort='title';
	if (selectedIndex==2) cmi.sort='modified';
	if (selectedIndex==3) cmi.sort='tags';
	if (selectedIndex&gt;3) {
		// display selected tiddler count
		for (var t=0,count=0; t &lt; list.options.length; t++) {
			if (!list.options[t].selected) continue;
			if (list.options[t].value!='')
				count+=1;
			else { // if heading is selected, deselect it, and then select and count all in section
				list.options[t].selected=false;
				for ( t++; t&lt;list.options.length &amp;&amp; list.options[t].value!=''; t++) {
					list.options[t].selected=true;
					count++;
				}
			}
		}
		clearMessage(); displayMessage(cmi.countMsg.format([count]));
	}
	cmi.$('importStart').disabled=!count;
	if (selectedIndex&gt;3) return; // no refresh needed

	// get the alphasorted list of tiddlers
	var tiddlers=cmi.inbound;
	tiddlers.sort(function (a,b) {if(a['title'] == b['title']) return(0); else return (a['title'] &lt; b['title']) ? -1 : +1; });
	// clear current list contents
	while (list.length &gt; 0) { list.options[0] = null; }
	// add heading and control items to list
	var i=0;
	var indent=String.fromCharCode(160)+String.fromCharCode(160);
	if (cmi.all.length==tiddlers.length)
		var summary=cmi.summaryMsg.format([tiddlers.length,(tiddlers.length!=1)?cmi.plural:cmi.single]);
	else
		var summary=cmi.summaryFilteredMsg.format([tiddlers.length,cmi.all.length,(cmi.all.length!=1)?cmi.plural:cmi.single]);
	list.options[i++]=new Option(summary,'',false,false);
	list.options[i++]=new Option(((cmi.sort=='title'   )?'&gt;':indent)+' [by title]','',false,false);
	list.options[i++]=new Option(((cmi.sort=='modified')?'&gt;':indent)+' [by date]','',false,false);
	list.options[i++]=new Option(((cmi.sort=='tags')?'&gt;':indent)+' [by tags]','',false,false);
	// output the tiddler list
	switch(cmi.sort) {
		case 'title':
			for(var t = 0; t &lt; tiddlers.length; t++)
				list.options[i++] = new Option(tiddlers[t].title,tiddlers[t].title,false,false);
			break;
		case 'modified':
			// sort descending for newest date first
			tiddlers.sort(function (a,b) {if(a['modified'] == b['modified']) return(0); else return (a['modified'] &gt; b['modified']) ? -1 : +1; });
			var lastSection = '';
			for(var t = 0; t &lt; tiddlers.length; t++) {
				var tiddler = tiddlers[t];
				var theSection = tiddler.modified.toLocaleDateString();
				if (theSection != lastSection) {
					list.options[i++] = new Option(theSection,'',false,false);
					lastSection = theSection;
				}
				list.options[i++] = new Option(indent+indent+tiddler.title,tiddler.title,false,false);
			}
			break;
		case 'tags':
			var theTitles = {}; // all tiddler titles, hash indexed by tag value
			var theTags = new Array();
			for(var t=0; t&lt;tiddlers.length; t++) {
				var title=tiddlers[t].title;
				var tags=tiddlers[t].tags;
				if (!tags || !tags.length) {
					if (theTitles['untagged']==undefined) { theTags.push('untagged'); theTitles['untagged']=new Array(); }
					theTitles['untagged'].push(title);
				}
				else for(var s=0; s&lt;tags.length; s++) {
					if (theTitles[tags[s]]==undefined) { theTags.push(tags[s]); theTitles[tags[s]]=new Array(); }
					theTitles[tags[s]].push(title);
				}
			}
			theTags.sort();
			for(var tagindex=0; tagindex&lt;theTags.length; tagindex++) {
				var theTag=theTags[tagindex];
				list.options[i++]=new Option(theTag,'',false,false);
				for(var t=0; t&lt;theTitles[theTag].length; t++)
					list.options[i++]=new Option(indent+indent+theTitles[theTag][t],theTitles[theTag][t],false,false);
			}
			break;
		}
	list.selectedIndex=selectedIndex;		  // select current control item
	if (list.size&lt;cmi.listsize) list.size=cmi.listsize;
	if (list.size&gt;list.options.length) list.size=list.options.length;
}
//}}}
//{{{
// re-entrant processing for handling import with interactive collision prompting
function importTiddlers(startIndex) {
	var cmi=config.macros.importTiddlers; // abbrev
	if (!cmi.inbound) return -1;
	var list=cmi.$('importList'); if (!list) return;
	var t;
	// if starting new import, reset import status flags
	if (startIndex==0)
		for (var t=0;t&lt;cmi.inbound.length;t++)
			cmi.inbound[t].status='';
	for (var i=startIndex; i&lt;list.options.length; i++) {
		// if list item is not selected or is a heading (i.e., has no value), skip it
		if ((!list.options[i].selected) || ((t=list.options[i].value)==''))
			continue;
		for (var j=0;j&lt;cmi.inbound.length;j++)
			if (cmi.inbound[j].title==t) break;
		var inbound = cmi.inbound[j];
		var theExisting = store.getTiddler(inbound.title);
		// avoid redundant import for tiddlers that are listed multiple times (when 'by tags')
		if (inbound.status=='added')
			continue;
		// don't import the 'ImportedTiddlers' history from the other document...
		if (inbound.title=='ImportedTiddlers')
			continue;
		// if tiddler exists and import not marked for replace or merge, stop importing
		if (theExisting &amp;&amp; (inbound.status.substr(0,7)!='replace') &amp;&amp; (inbound.status.substr(0,5)!='merge'))
			return i;
		// assemble tags (remote + existing + added)
		var newTags = '';
		if (cmi.importTags)
			newTags+=inbound.getTags()	// import remote tags
		if (cmi.keepTags &amp;&amp; theExisting)
			newTags+=' '+theExisting.getTags(); // keep existing tags
		if (cmi.addTags &amp;&amp; cmi.newTags.trim().length)
			newTags+=' '+cmi.newTags; // add new tags
		inbound.set(null,null,null,null,newTags.trim());
		// set the status to 'added' (if not already set by the 'ask the user' UI)
		inbound.status=(inbound.status=='')?'added':inbound.status;
		// set sync fields
		if (cmi.sync) {
			if (!inbound.fields) inbound.fields={}; // for TW2.1.x backward-compatibility
			inbound.fields['server.page.revision']=inbound.modified.convertToYYYYMMDDHHMM();
			inbound.fields['server.type']='file';
			inbound.fields['server.host']=(cmi.local&amp;&amp;!cmi.src.startsWith('file:')?'file:///':'')+cmi.src;
		}
		// do the import!
		store.suspendNotifications();
		store.saveTiddler(inbound.title, inbound.title, inbound.text, inbound.modifier, inbound.modified, inbound.tags, inbound.fields, true, inbound.created);
                store.fetchTiddler(inbound.title).created = inbound.created; // force creation date to imported value (needed for TW2.1.x and earlier)
		store.resumeNotifications();
		}
	return(-1);	// signals that we really finished the entire list
}
function importStopped() {
	var cmi=config.macros.importTiddlers; // abbrev
	var list=cmi.$('importList'); if (!list) return;
	var theNewTitle=cmi.$('importNewTitle');
	if (cmi.index==-1){ 
		cmi.$('importStart').value=cmi.startText;
		importReport();	// import finished... generate the report
	} else {
		// import collision...
		// show the collision panel and set the title edit field
		cmi.$('importStart').value=cmi.stopText;
		cmi.showPanel('importCollisionPanel',true);
		theNewTitle.value=list.options[cmi.index].value;
		if (cmi.$('importApplyToAll').checked &amp;&amp; cmi.lastAction &amp;&amp; cmi.lastAction.id!='importRename')
			onClickImportButton(cmi.lastAction);
	}
}
//}}}
//{{{
function importReport() {
	var cmi=config.macros.importTiddlers; // abbrev
	if (!cmi.inbound) return;
	// if import was not completed, the collision panel will still be open... close it now.
	var panel=cmi.$('importCollisionPanel'); if (panel) panel.style.display='none';
	// get the alphasorted list of tiddlers
	var tiddlers = cmi.inbound;
	// gather the statistics
	var count=0; var total=0;
	for (var t=0; t&lt;tiddlers.length; t++) {
		if (!tiddlers[t].status || !tiddlers[t].status.trim().length) continue;
		if (tiddlers[t].status.substr(0,7)!='skipped') count++;
		total++;
	}
	// generate a report
	if (total) displayMessage(cmi.processedMsg.format([total]));
	if (count &amp;&amp; config.options.chkImportReport) {
		// get/create the report tiddler
		var theReport = store.getTiddler('ImportedTiddlers');
		if (!theReport) { theReport=new Tiddler(); theReport.title='ImportedTiddlers'; theReport.text=''; }
		// format the report content
		var now = new Date();
		var newText = 'On '+now.toLocaleString()+', '+config.options.txtUserName
		newText +=' imported '+count+' tiddler'+(count==1?'':'s')+' from\n[['+cmi.src+'|'+cmi.src+']]:\n';
		if (cmi.addTags &amp;&amp; cmi.newTags.trim().length)
			newText += 'imported tiddlers were tagged with: &quot;'+cmi.newTags+'&quot;\n';
		newText += '&lt;&lt;&lt;\n';
		for (var t=0; t&lt;tiddlers.length; t++) if (tiddlers[t].status)
			newText += '#[['+tiddlers[t].title+']] - '+tiddlers[t].status+'\n';
		newText += '&lt;&lt;&lt;\n';
		// update the ImportedTiddlers content and show the tiddler
		theReport.text	 = newText+((theReport.text!='')?'\n----\n':'')+theReport.text;
		theReport.modifier = config.options.txtUserName;
		theReport.modified = new Date();
                store.saveTiddler(theReport.title, theReport.title, theReport.text, theReport.modifier, theReport.modified, theReport.tags, theReport.fields);
		story.displayTiddler(null,theReport.title,1,null,null,false);
		story.refreshTiddler(theReport.title,1,true);
	}
	// reset status flags
	for (var t=0; t&lt;cmi.inbound.length; t++) cmi.inbound[t].status='';
	// mark document as dirty and let display update as needed
	if (count) { store.setDirty(true); store.notifyAll(); }
	// always show final message when tiddlers were actually loaded
	if (count) displayMessage(cmi.importedMsg.format([count,tiddlers.length,cmi.src.replace(/%20/g,' ')]));
}
//}}}
//{{{
// // File and XMLHttpRequest I/O
config.macros.importTiddlers.askForFilename=function(here) {
	var msg=here.title; // use tooltip as dialog box message
	var path=getLocalPath(document.location.href);
	var slashpos=path.lastIndexOf('/'); if (slashpos==-1) slashpos=path.lastIndexOf('\\'); 
	if (slashpos!=-1) path = path.substr(0,slashpos+1); // remove filename from path, leave the trailing slash
	var file='';
	var result='';
	if(window.Components) { // moz
		try {
			netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');

			var nsIFilePicker = window.Components.interfaces.nsIFilePicker;
			var picker = Components.classes['@mozilla.org/filepicker;1'].createInstance(nsIFilePicker);
			picker.init(window, msg, nsIFilePicker.modeOpen);
			var thispath = Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);
			thispath.initWithPath(path);
			picker.displayDirectory=thispath;
			picker.defaultExtension='html';
			picker.defaultString=file;
			picker.appendFilters(nsIFilePicker.filterAll|nsIFilePicker.filterText|nsIFilePicker.filterHTML);
			if (picker.show()!=nsIFilePicker.returnCancel) var result=picker.file.persistentDescriptor;
		}
		catch(e) { alert('error during local file access: '+e.toString()) }
	}
	else { // IE
		try { // XPSP2 IE only
			var s = new ActiveXObject('UserAccounts.CommonDialog');
			s.Filter='All files|*.*|Text files|*.txt|HTML files|*.htm;*.html|';
			s.FilterIndex=3; // default to HTML files;
			s.InitialDir=path;
			s.FileName=file;
			if (s.showOpen()) var result=s.FileName;
		}
		catch(e) {  // fallback
			var result=prompt(msg,path+file);
		}
	}
	return result;
}

config.macros.importTiddlers.loadRemoteFile = function(src,callback) {
	if (src==undefined || !src.length) return null; // filename is required
	var original=src; // URL as specified
	var hashpos=src.indexOf('#'); if (hashpos!=-1) src=src.substr(0,hashpos); // URL with #... suffix removed (needed for IE)
	clearMessage();
	displayMessage(this.openMsg.format([src.replace(/%20/g,' ')]));
	if (src.substr(0,5)!='http:' &amp;&amp; src.substr(0,5)!='file:') { // if not a URL, read from local filesystem
		var txt=loadFile(src);
		if (!txt) { // file didn't load, might be relative path.. try fixup
			var pathPrefix=document.location.href;  // get current document path and trim off filename
			var slashpos=pathPrefix.lastIndexOf('/'); if (slashpos==-1) slashpos=pathPrefix.lastIndexOf('\\'); 
			if (slashpos!=-1 &amp;&amp; slashpos!=pathPrefix.length-1) pathPrefix=pathPrefix.substr(0,slashpos+1);
			src=pathPrefix+src;
			if (pathPrefix.substr(0,5)!='http:') src=getLocalPath(src);
			var txt=loadFile(src);
		}
		if (!txt) { // file still didn't load, report error
			displayMessage(config.macros.importTiddlers.openErrMsg.format([src.replace(/%20/g,' '),'(filesystem error)']));
		} else {
			displayMessage(config.macros.importTiddlers.readMsg.format([txt.length,src.replace(/%20/g,' ')]));
			if (version.major+version.minor*.1+version.revision*.01!=2.52) txt=convertUTF8ToUnicode(txt);
			if (callback) callback(true,original,txt,src,null);
		}
	} else {
		doHttp('GET',src,null,null,config.options.txtRemoteUsername,config.options.txtRemotePassword,callback,original,null);
	}
}

config.macros.importTiddlers.readTiddlersFromHTML=function(html){
	var remoteStore=new TiddlyWiki();
	remoteStore.importTiddlyWiki(html);
	return remoteStore.getTiddlers('title');	
}

config.macros.importTiddlers.readTiddlersFromCSV=function(CSV){
	var remoteStore=new TiddlyWiki();
	// GET NAMES
	var lines=CSV.replace(/\r/g,'').split('\n');
	var names=lines.shift().replace(/&quot;/g,'').split(',');
	CSV=lines.join('\n');
	// ENCODE commas and newlines within quoted values
	var comma='!~comma~!'; var commaRE=new RegExp(comma,'g');
	var newline='!~newline~!'; var newlineRE=new RegExp(newline,'g');
	CSV=CSV.replace(/&quot;([^&quot;]*?)&quot;/g,
		function(x){ return x.replace(/\,/g,comma).replace(/\n/g,newline); });
	// PARSE lines
	var lines=CSV.split('\n');
	for (var i=0; i&lt;lines.length; i++) { if (!lines[i].length) continue;
		var values=lines[i].split(',');
		// DECODE commas, newlines, and doubled-quotes, and remove enclosing quotes (if any)
		for (var v=0; v&lt;values.length; v++)
			values[v]=values[v].replace(commaRE,',').replace(newlineRE,'\n')
				.replace(/^&quot;|&quot;$/g,'').replace(/&quot;&quot;/g,'&quot;');
		// EXTRACT tiddler values
		var title=''; var text=''; var tags=[]; var fields={};
		var created=null; var when=new Date(); var who=config.options.txtUserName;
		for (var v=0; v&lt;values.length; v++) { var val=values[v];
			if (names[v]) switch(names[v].toLowerCase()) {
				case 'title':	title=val.replace(/\[\]\|/g,'_'); break;
				case 'created': created=new Date(val); break;
				case 'modified':when=new Date(val); break;
				case 'modifier':who=val; break;
				case 'text':	text=val; break;
				case 'tags':	tags=val.readBracketedList(); break;
				default:	fields[names[v].toLowerCase()]=val; break;
			}
		}
		// CREATE tiddler in temporary store
		if (title.length)
			remoteStore.saveTiddler(title,title,text,who,when,tags,fields,true,created||when);
	}
	return remoteStore.getTiddlers('title');
}

config.macros.importTiddlers.createTiddlerFromFile=function(src,txt) {
	var t=new Tiddler();
	var pos=src.lastIndexOf(&quot;/&quot;); if (pos==-1) pos=src.lastIndexOf(&quot;\\&quot;);
	t.title=pos==-1?src:src.substr(pos+1);
	t.text=txt; 
	t.created=t.modified=new Date();
	t.modifier=config.options.txtUserName;
	if (src.substr(src.length-3,3)=='.js') t.tags=['systemConfig'];
	return [t];
}

config.macros.importTiddlers.filterTiddlerList=function(success,params,txt,src,xhr){
	var cmi=config.macros.importTiddlers; // abbreviation
	var src=src.replace(/%20/g,' ');
	if (!success) { displayMessage(cmi.openErrMsg.format([src,xhr.status])); return; }
	cmi.all=cmi.readTiddlersFromHTML(txt);
	if (!cmi.all||!cmi.all.length) cmi.all=cmi.readTiddlersFromCSV(txt)
	if (!cmi.all||!cmi.all.length) cmi.all=cmi.createTiddlerFromFile(src,txt)
	var count=cmi.all?cmi.all.length:0;
	var querypos=src.lastIndexOf('?'); if (querypos!=-1) src=src.substr(0,querypos);
	displayMessage(cmi.foundMsg.format([count,src]));
	cmi.inbound=cmi.filterByHash(params,cmi.all); // use full URL including hash (if any)
	cmi.$('importLastFilter').value=cmi.lastFilter;
	window.refreshImportList(0);
}

config.macros.importTiddlers.filterByHash=function(src,tiddlers){
	var hashpos=src.lastIndexOf('#'); if (hashpos==-1) return tiddlers;
	var hash=src.substr(hashpos+1); if (!hash.length) return tiddlers;
	var tids=[];
	var params=hash.parseParams('anon',null,true,false,false);
	for (var p=1; p&lt;params.length; p++) {
		switch (params[p].name) {
			case 'anon':
			case 'open':
				tids.pushUnique(params[p].value);
				break;
			case 'tag':
				if (store.getMatchingTiddlers) { // for boolean expressions - see MatchTagsPlugin
					var r=store.getMatchingTiddlers(params[p].value,null,tiddlers);
					for (var t=0; t&lt;r.length; t++) tids.pushUnique(r[t].title);
				} else for (var t=0; t&lt;tiddlers.length; t++)
					if (tiddlers[t].isTagged(params[p].value))
						tids.pushUnique(tiddlers[t].title);
				break;
			case 'story':
				for (var t=0; t&lt;tiddlers.length; t++)
					if (tiddlers[t].title==params[p].value) {
						tiddlers[t].changed();
						for (var s=0; s&lt;tiddlers[t].links.length; s++)
							tids.pushUnique(tiddlers[t].links[s]);
						break;
					}
				break;
			case 'search':
				for (var t=0; t&lt;tiddlers.length; t++)
					if (tiddlers[t].text.indexOf(params[p].value)!=-1)
						tids.pushUnique(tiddlers[t].title);
				break;
		}
	}
	var matches=[];
	for (var t=0; t&lt;tiddlers.length; t++)
		if (tids.contains(tiddlers[t].title))
			matches.push(tiddlers[t]);
	displayMessage(config.macros.importTiddlers.filterMsg.format([matches.length,hash]));
	config.macros.importTiddlers.lastFilter=hash;
	return matches;
}
//}}}
/***
!!!Control panel CSS
//{{{
!css
#importPanel {
	display: none; position:absolute; z-index:11; width:35em; right:105%; top:3em;
	background-color: #eee; color:#000; font-size: 8pt; line-height:110%;
	border:1px solid black; border-bottom-width: 3px; border-right-width: 3px;
	padding: 0.5em; margin:0em; -moz-border-radius:1em;-webkit-border-radius:1em;
}
#importPanel a, #importPanel td a { color:#009; display:inline; margin:0px; padding:1px; }
#importPanel table { width:100%; border:0px; padding:0px; margin:0px; font-size:8pt; line-height:110%; background:transparent; }
#importPanel tr { border:0px;padding:0px;margin:0px; background:transparent; }
#importPanel td { color:#000; border:0px;padding:0px;margin:0px; background:transparent; }
#importPanel select { width:100%;margin:0px;font-size:8pt;line-height:110%;}
#importPanel input  { width:98%;padding:0px;margin:0px;font-size:8pt;line-height:110%}
#importPanel .box { border:1px solid #000; background-color:#eee; padding:3px 5px; margin-bottom:5px; -moz-border-radius:5px;-webkit-border-radius:5px;}
#importPanel .topline { border-top:1px solid #999; padding-top:2px; margin-top:2px; }
#importPanel .rad { width:auto; }
#importPanel .chk { width:auto; margin:1px;border:0; }
#importPanel .btn { width:auto; }
#importPanel .btn1 { width:98%; }
#importPanel .btn2 { width:48%; }
#importPanel .btn3 { width:32%; }
#importPanel .btn4 { width:23%; }
#importPanel .btn5 { width:19%; }
#importPanel .importButton { padding: 0em; margin: 0px; font-size:8pt; }
#importPanel .importListButton { padding:0em 0.25em 0em 0.25em; color: #000000; display:inline }
#backstagePanel #importPanel { left:10%; right:auto; }
!end
//}}}
!!!Control panel HTML
//{{{
!html
&lt;!-- source and report --&gt;
&lt;table&gt;&lt;tr&gt;&lt;td align=left&gt;
	import from
	&lt;input type=&quot;radio&quot; class=&quot;rad&quot; name=&quot;importFrom&quot; id=&quot;importFromFile&quot; value=&quot;file&quot; CHECKED
		onclick=&quot;onClickImportButton(this,event)&quot; title=&quot;show file controls&quot;&gt; local file
	&lt;input type=&quot;radio&quot; class=&quot;rad&quot; name=&quot;importFrom&quot; id=&quot;importFromWeb&quot;  value=&quot;http&quot;
		onclick=&quot;onClickImportButton(this,event)&quot; title=&quot;show web controls&quot;&gt; web server
&lt;/td&gt;&lt;td align=right&gt;
	&lt;input type=checkbox class=&quot;chk&quot; id=&quot;chkImportReport&quot;
		onClick=&quot;config.options['chkImportReport']=this.checked;&quot;&gt; create report
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;div class=&quot;box&quot; id=&quot;importSourcePanel&quot; style=&quot;margin:.5em&quot;&gt;
&lt;div id=&quot;importLocalPanel&quot; style=&quot;display:block;margin-bottom:2px;&quot;&gt;&lt;!-- import from local file  --&gt;
enter or browse for source path/filename&lt;br&gt;
&lt;input type=&quot;file&quot; id=&quot;fileImportSource&quot; size=57 style=&quot;width:100%&quot;
	onKeyUp=&quot;config.macros.importTiddlers.src=this.value&quot;
	onChange=&quot;config.macros.importTiddlers.src=this.value;document.getElementById('importLoad').onclick()&quot;&gt;
&lt;div id=&quot;importLocalPanelFix&quot; style=&quot;display:none&quot;&gt;&lt;!-- FF3 FIXUP --&gt;
	&lt;input type=&quot;text&quot; id=&quot;fileImportSourceFix&quot; style=&quot;width:90%&quot;
		title=&quot;Enter a path/file to import&quot;
		onKeyUp=&quot;config.macros.importTiddlers.src=this.value&quot;
		onChange=&quot;config.macros.importTiddlers.src=this.value;document.getElementById('importLoad').onclick()&quot;&gt;
	&lt;input type=&quot;button&quot; id=&quot;fileImportSourceFixButton&quot; style=&quot;width:7%&quot; value=&quot;...&quot;
		title=&quot;Select a path/file to import&quot;
		onClick=&quot;var r=config.macros.importTiddlers.askForFilename(this); if (!r||!r.length) return;
			document.getElementById('fileImportSourceFix').value=r;
			config.macros.importTiddlers.src=r;
			document.getElementById('importLoad').onclick()&quot;&gt;
&lt;/div&gt;&lt;!--end FF3 FIXUP--&gt;
&lt;/div&gt;&lt;!--end local--&gt;
&lt;div id=&quot;importHTTPPanel&quot; style=&quot;display:none;margin-bottom:2px;&quot;&gt;&lt;!-- import from http server --&gt;
&lt;table&gt;&lt;tr&gt;&lt;td align=left&gt;
	enter a URL or &lt;a href=&quot;javascript:;&quot; id=&quot;importSelectFeed&quot;
		onclick=&quot;return onClickImportButton(this,event)&quot; title=&quot;select a pre-defined 'systemServer' URL&quot;&gt;
		select a server&lt;/a&gt;&lt;br&gt;
&lt;/td&gt;&lt;td align=right&gt;
	&lt;input type=&quot;checkbox&quot; class=&quot;chk&quot; id=&quot;importUsePassword&quot;
		onClick=&quot;config.macros.importTiddlers.usePassword=this.checked;
			config.macros.importTiddlers.showPanel('importIDPWPanel',this.checked,true);&quot;&gt;password
	&lt;input type=&quot;checkbox&quot; class=&quot;chk&quot; id=&quot;importUseProxy&quot;
		onClick=&quot;config.macros.importTiddlers.useProxy=this.checked;
			config.macros.importTiddlers.showPanel('importSiteProxy',this.checked,true);&quot;&gt;proxy
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;input type=&quot;text&quot; id=&quot;importSiteProxy&quot; style=&quot;display:none;margin-bottom:1px&quot; onfocus=&quot;this.select()&quot; value=&quot;SiteProxy&quot;
	onKeyUp=&quot;config.macros.importTiddlers.proxy=this.value&quot;
	onChange=&quot;config.macros.importTiddlers.proxy=this.value;&quot;&gt;
&lt;input type=&quot;text&quot; id=&quot;importSourceURL&quot; onfocus=&quot;this.select()&quot; value=&quot;SiteUrl&quot;
	onKeyUp=&quot;config.macros.importTiddlers.src=this.value&quot;
	onChange=&quot;config.macros.importTiddlers.src=this.value;&quot;&gt;
&lt;div id=&quot;importIDPWPanel&quot; style=&quot;text-align:center;margin-top:2px;display:none&quot;;&gt;
username: &lt;input type=text id=&quot;txtImportID&quot; style=&quot;width:25%&quot; 
	onChange=&quot;config.options.txtRemoteUsername=this.value;&quot;&gt;
 password: &lt;input type=password id=&quot;txtImportPW&quot; style=&quot;width:25%&quot; 
	onChange=&quot;config.options.txtRemotePassword=this.value;&quot;&gt;
&lt;/div&gt;&lt;!--end idpw--&gt;
&lt;/div&gt;&lt;!--end http--&gt;
&lt;/div&gt;&lt;!--end source--&gt;

&lt;div class=&quot;box&quot; id=&quot;importSelectPanel&quot; style=&quot;display:none;margin:.5em;&quot;&gt;
&lt;table&gt;&lt;tr&gt;&lt;td align=left&gt;
select:
&lt;a href=&quot;javascript:;&quot; id=&quot;importSelectAll&quot;
	onclick=&quot;return onClickImportButton(this)&quot; title=&quot;SELECT all tiddlers&quot;&gt;
	all&lt;/a&gt;
&amp;nbsp;&lt;a href=&quot;javascript:;&quot; id=&quot;importSelectNew&quot;
	onclick=&quot;return onClickImportButton(this)&quot; title=&quot;SELECT tiddlers not already in destination document&quot;&gt;
	added&lt;/a&gt;
&amp;nbsp;&lt;a href=&quot;javascript:;&quot; id=&quot;importSelectChanges&quot;
	onclick=&quot;return onClickImportButton(this)&quot; title=&quot;SELECT tiddlers that have been updated in source document&quot;&gt;
	changes&lt;/a&gt;
&amp;nbsp;&lt;a href=&quot;javascript:;&quot; id=&quot;importSelectDifferences&quot;
	onclick=&quot;return onClickImportButton(this)&quot; title=&quot;SELECT tiddlers that have been added or are different from existing tiddlers&quot;&gt;
	differences&lt;/a&gt;
&lt;/td&gt;&lt;td align=right&gt;
&lt;a href=&quot;javascript:;&quot; id=&quot;importListSmaller&quot;
	onclick=&quot;return onClickImportButton(this)&quot; title=&quot;SHRINK list size&quot;&gt;
	&amp;nbsp;&amp;#150;&amp;nbsp;&lt;/a&gt;
&lt;a href=&quot;javascript:;&quot; id=&quot;importListLarger&quot;
	onclick=&quot;return onClickImportButton(this)&quot; title=&quot;GROW list size&quot;&gt;
	&amp;nbsp;+&amp;nbsp;&lt;/a&gt;
&lt;a href=&quot;javascript:;&quot; id=&quot;importListMaximize&quot;
	onclick=&quot;return onClickImportButton(this)&quot; title=&quot;MAXIMIZE/RESTORE list size&quot;&gt;
	&amp;nbsp;=&amp;nbsp;&lt;/a&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;select id=&quot;importList&quot; size=8 multiple
	onchange=&quot;setTimeout('refreshImportList('+this.selectedIndex+')',1)&quot;&gt;
	&lt;!-- NOTE: delay refresh so list is updated AFTER onchange event is handled --&gt;
&lt;/select&gt;
&lt;div style=&quot;text-align:center&quot;&gt;
	&lt;a href=&quot;javascript:;&quot;
		title=&quot;click for help using filters...&quot;
		onclick=&quot;alert('A filter consists of one or more space-separated combinations of: tiddlertitle, tag:[[tagvalue]], tag:[[tag expression]] (requires MatchTagsPlugin), story:[[TiddlerName]], and/or search:[[searchtext]]. Use a blank filter to restore the list of all tiddlers.'); return false;&quot;
	&gt;filter&lt;/a&gt;
	&lt;input type=&quot;text&quot; id=&quot;importLastFilter&quot; style=&quot;margin-bottom:1px; width:65%&quot;
		title=&quot;Enter a combination of one or more filters. Use a blank filter for all tiddlers.&quot;
		onfocus=&quot;this.select()&quot; value=&quot;&quot;
		onKeyUp=&quot;config.macros.importTiddlers.lastFilter=this.value&quot;
		onChange=&quot;config.macros.importTiddlers.lastFilter=this.value;&quot;&gt;
	&lt;input type=&quot;button&quot; id=&quot;importApplyFilter&quot; style=&quot;width:20%&quot; value=&quot;apply&quot;
		title=&quot;filter list of tiddlers to include only those that match certain criteria&quot;
		onclick=&quot;return onClickImportButton(this)&quot;&gt;
	&lt;/div&gt;
&lt;/div&gt;&lt;!--end select--&gt;

&lt;div class=&quot;box&quot; id=&quot;importOptionsPanel&quot; style=&quot;text-align:center;margin:.5em;display:none;&quot;&gt;
	apply tags: &lt;input type=checkbox class=&quot;chk&quot; id=&quot;chkImportTags&quot; checked
		onClick=&quot;config.macros.importTiddlers.importTags=this.checked;&quot;&gt;from source&amp;nbsp;
	&lt;input type=checkbox class=&quot;chk&quot; id=&quot;chkKeepTags&quot; checked
		onClick=&quot;config.macros.importTiddlers.keepTags=this.checked;&quot;&gt;keep existing&amp;nbsp;
	&lt;input type=checkbox class=&quot;chk&quot; id=&quot;chkAddTags&quot; 
		onClick=&quot;config.macros.importTiddlers.addTags=this.checked;
			config.macros.importTiddlers.showPanel('txtNewTags',this.checked,false);
			if (this.checked) document.getElementById('txtNewTags').focus();&quot;&gt;add tags&lt;br&gt;
	&lt;input type=text id=&quot;txtNewTags&quot; style=&quot;margin-top:4px;display:none;&quot; size=15 onfocus=&quot;this.select()&quot; 
		title=&quot;enter tags to be added to imported tiddlers&quot; 
		onKeyUp=&quot;config.macros.importTiddlers.newTags=this.value;
		document.getElementById('chkAddTags').checked=this.value.length&gt;0;&quot; autocomplete=off&gt;
	&lt;nobr&gt;&lt;input type=checkbox class=&quot;chk&quot; id=&quot;chkSync&quot; 
		onClick=&quot;config.macros.importTiddlers.sync=this.checked;&quot;&gt;
		link tiddlers to source document (for sync later)&lt;/nobr&gt;
&lt;/div&gt;&lt;!--end options--&gt;

&lt;div id=&quot;importButtonPanel&quot; style=&quot;text-align:center&quot;&gt;
	&lt;input type=button id=&quot;importLoad&quot;	class=&quot;importButton btn3&quot; value=&quot;open&quot;
		title=&quot;load listbox with tiddlers from source document&quot;
		onclick=&quot;onClickImportButton(this)&quot;&gt;
	&lt;input type=button id=&quot;importOptions&quot;	class=&quot;importButton btn3&quot; value=&quot;options...&quot;
		title=&quot;set options for tags, sync, etc.&quot;
		onclick=&quot;onClickImportButton(this)&quot;&gt;
	&lt;input type=button id=&quot;importStart&quot;	class=&quot;importButton btn3&quot; value=&quot;import&quot;
		title=&quot;start/stop import of selected source tiddlers into current document&quot;
		onclick=&quot;onClickImportButton(this)&quot;&gt;
	&lt;input type=button id=&quot;importClose&quot;	class=&quot;importButton btn3&quot; value=&quot;done&quot;
		title=&quot;clear listbox or hide control panel&quot;
		onclick=&quot;onClickImportButton(this)&quot;&gt;
&lt;/div&gt;

&lt;div class=&quot;none&quot; id=&quot;importCollisionPanel&quot; style=&quot;display:none;margin:.5em 0 .5em .5em;&quot;&gt;
	&lt;table&gt;&lt;tr&gt;&lt;td style=&quot;width:65%&quot; align=&quot;left&quot;&gt;
		&lt;table&gt;&lt;tr&gt;&lt;td align=left&gt;
			tiddler already exists:
		&lt;/td&gt;&lt;td align=right&gt;
			&lt;input type=checkbox class=&quot;chk&quot; id=&quot;importApplyToAll&quot; 
			onclick=&quot;document.getElementById('importRename').disabled=this.checked;&quot;
			checked&gt;apply to all
		&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
		&lt;input type=text id=&quot;importNewTitle&quot; size=15 autocomplete=off&quot;&gt;
	&lt;/td&gt;&lt;td style=&quot;width:34%&quot; align=&quot;center&quot;&gt;
		&lt;input type=button id=&quot;importMerge&quot;
			class=&quot;importButton&quot; style=&quot;width:47%&quot; value=&quot;merge&quot;
			title=&quot;append the incoming tiddler to the existing tiddler&quot;
			onclick=&quot;onClickImportButton(this)&quot;&gt;&lt;!--
		--&gt;&lt;input type=button id=&quot;importSkip&quot;
			class=&quot;importButton&quot; style=&quot;width:47%&quot; value=&quot;skip&quot;
			title=&quot;do not import this tiddler&quot;
			onclick=&quot;onClickImportButton(this)&quot;&gt;&lt;!--
		--&gt;&lt;br&gt;&lt;input type=button id=&quot;importRename&quot;
			class=&quot;importButton&quot; style=&quot;width:47%&quot; value=&quot;rename&quot;
			title=&quot;rename the incoming tiddler&quot;
			onclick=&quot;onClickImportButton(this)&quot;&gt;&lt;!--
		--&gt;&lt;input type=button id=&quot;importReplace&quot;
			class=&quot;importButton&quot; style=&quot;width:47%&quot; value=&quot;replace&quot;
			title=&quot;discard the existing tiddler&quot;
			onclick=&quot;onClickImportButton(this)&quot;&gt;
	&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;&lt;!--end collision--&gt;
!end
//}}}
***/
 </pre>
</div>
<div title="ImportTiddlersPluginInfo" modifier="ELSDesignStudios" created="200801090740" modified="200910070605" tags="pluginInfo ImportExportPackage excludeMissing">
<pre>/***
|Name|ImportTiddlersPluginInfo|
|Source|http://www.TiddlyTools.com/#ImportTiddlersPlugin|
|Documentation|http://www.TiddlyTools.com/#ImportTiddlersPluginInfo|
|Version|4.6.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|documentation|
|Description|documentation for ImportTiddlersPlugin|
Combine tiddlers from any two TiddlyWiki documents.  An interactive control panel lets you pick a source document and import selected tiddlers, with prompting for skip, rename, merge or replace actions when importing tiddlers that match existing titles.  Generates a detailed report of import 'history' in ImportedTiddlers.
!!!!!Usage
&lt;&lt;&lt;
{{{&lt;&lt;importTiddlers&gt;&gt;}}} or {{{&lt;&lt;importTiddlers core&gt;&gt;}}}
invokes the built-in importTiddlers macro (TW2.1.x+).  If installed in documents using TW2.0.x or earlier, fallback is to use 'link' display (see below)

{{{&lt;&lt;importTiddlers link label tooltip&gt;&gt;}}}
The ''link'' keyword creates an &quot;import tiddlers&quot; link that when clicked to show/hide import control panel.  ''label'' and ''tooltip'' are optional text parameters (enclosed in quotes or {{{[[...]]}}}, and allow you to override the default display text for the link and the mouseover help text, respectively.

{{{&lt;&lt;importTiddlers inline&gt;&gt;}}}
creates import control panel directly in tiddler content

&lt;&lt;importTiddlers inline&gt;&gt;

Enter a document URL or press &quot;...&quot; to select a TiddlyWiki file to import, and then press ''[open]''.  //Note: There may be a delay before the list of tiddlers appears.//  Use the ''[-]'', ''[+]'', or ''[=]'' links to adjust the listbox size so you can view more (or less) tiddler titles at one time.

Select one or more titles from the listbox.  Use CTRL-click or SHIFT-click to select/deselect individual titles.  Click on ''all'', ''new'', ''changes'', or ''differences'' to automatically select a subset of tiddlers from the list, based on a comparison of the two documents:
*''all'' selects ALL tiddlers from the import source document, even if they have not been changed.
*''new'' selects only tiddlers that are found in the import source document, but do not yet exist in the destination document
*''changes'' selects only tiddlers that exist in both documents but that are newer in the source document
*''differences'' selects all new and existing tiddlers that are different from the destination document (even if destination tiddler is newer)

Press ''[import]'' to begin copying tiddlers to the current document.  If an 'inbound' tiddler matches one that already exists in the document, the import process pauses and the tiddler title is displayed in an input field, along with four push buttons: ''skip'', ''rename'', ''merge'' and ''replace''.
* to bypass importing the tiddler, press ''skip''
* to give the inbound tiddler a different name, so that both the old and new tiddlers will exist when the import is done, enter a new title in the input field and press ''rename'' 
* to combine the content from both tiddlers into a single tiddler so you can then edit it later to eliminate unwanted content, press ''merge''
* to overwrite the existing tiddler with the imported one (discarding the previous content), press ''[replace]''

''Import Report History''

Whenever tiddlers are imported, a report is generated into a tiddler named [[ImportedTiddlers]], recording when the latest import was performed, the number of tiddlers successfully imported, from what location, and by whom, as well as a list of the tiddlers that were processed.  When more tiddlers are imported at a later time, a new report is //added// to the existing [[ImportedTiddlers]], above the previous report (i.e., at the top of the tiddler), so that a history of imports is maintained.  If this record is not desired, you can delete [[ImportedTiddlers]] at any time.

Note: You can prevent a report from being generated for any given import activity by clearing the &quot;create a report&quot; checkbox before pressing the ''import'' button
&lt;&lt;&lt;
!!!!!Installation Notes
&lt;&lt;&lt;
* As of 6/27/2007, support for TW2.1.x and earlier have been moved to [[ImportTiddlersPluginPatch]].  ''//Only install the patch plugin when using TW2.1.x or earlier.//''
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.10.06 4.6.0 added createTiddlerFromFile (import text files)
2009.09.27 4.5.5 in readTiddlersFromCSV(), strip \r from input and fixed handling for quoted values
2009.09.12 4.5.4 fixed 'return false' to prevent IE page transition. Also, moved html/css definitions to separate sections
2009.08.23 4.5.3 in importTiddlers(), add 'file:///' to local server.host sync field only if not already present in URL
2009.08.20 4.5.2 only use SiteURL/SiteProxy values if control panel value has not yet been set
2009.07.03 4.5.1 fixups for TW252: doHttp() doesn't return XHR and convertUTF8ToUnicode() not needed for local I/O
2009.05.04 4.5.0 import from CSV-formatted files
2009.03.04 4.4.2 in createImportPanel(), init option checkboxes so display matches internal state variables
2009.02.26 4.4.1 use macro-specific definition of $() function abbreviation (avoids conflict with JQuery)
2008.09.30 4.4.0 added fallback definition of merge() for use with TW2.0.x and TW1.2.x
2008.08.12 4.3.3 rewrite backstage and shadow tiddler definitions for easier customization
2008.08.05 4.3.2 rewrote loadRemoteFile() to eliminate use of platform-specific fileExists() function
2008.06.29 4.3.1 More layout/animation work for simpler sequential interaction.  Code reduction/cleanup
2008.06.28 4.3.0 HTML and CSS cleanup and tweaks to layout.  Added animation to panels
2008.06.22 4.2.0 For FireFox, use HTML with separate text+button control instead of type='file' control
2008.06.05 4.1.0 in filterByHash(), added support for boolean tag expressions using getMatchingTiddlers() (defined by MatchTagsPlugin)
2008.05.12 4.0.2 automatically tweak the backstage &quot;import&quot; task to add the ImportTiddlers control panel
2008.04.30 4.0.1 trim #... suffix for loading files/URLs in IE
2008.04.30 4.0.0 added source filtering (using URL paramifiers).  Also, abbreviations for code-size reduction.
2008.04.13 3.9.0 added 'apply to all' checkbox for collision processing
2008.03.26 3.8.0 added support for selecting pre-defined systemServer URLs
2008.03.25 3.7.0 added support for setting 'server' fields on imported tiddlers (for later synchronizing of changes)
2008.01.03 3.6.0 in loadRemoteFile(), use lower-level doHttp() instead of loadRemoteFile() in order to support username/password access to remote server
2007.10.30 3.5.6 update [[ImportTiddlers]] shadow tiddler definition to include &quot;inline&quot; link
2007.06.27 3.5.5 added missing 'fields' params to saveTiddler() calls.  Fixes problem where importing tiddlers would lose the custom fields.  Also, moved functions for TW2.1.x to [[ImportTiddlersPluginPatch2.1.x]].
2007.06.25 3.5.4 added calls to store.suspendNotifications() and store.resumeNotifications().  Eliminates redisplay processing overhead DURING import activities
2007.04.29 3.5.3 in refreshImportList() when inbound tiddlers are loaded, change &quot;close&quot; button to &quot;done&quot;, and disable certain controls to creates a modal condition, so that actions that reload tiddlers cannot be performed unless &quot;done&quot; is first pressed to end the mode..
2007.04.28 3.5.2 in handler(), added param support for custom link label/prompt
2007.04.19 3.5.1 in readTiddlersFromHTML(), for TW2.2 and above, use importTiddlyWiki() (new core functionality) to get tiddlers from remote file content.  Also, copied updated TW21Loader.prototype.internalizeTiddler() definition from TW2.2b5 so plugin can read tiddlers from TW2.2+ even when running under TW2.1.x
2007.03.22 3.5.0 in refreshImportList(), add handling for 'select section' when a heading is selected.  Makes it really easy to import by tag or date!
2007.03.21 3.4.0 split loadTiddlers functionality into separate plugin (see [[LoadTiddlersPlugin]])
2007.03.20 3.3.1 tweak to previous change to allow relative file references via http: (bypasses getLocalPath() so remote URL will be used)
2007.03.20 3.3.0 added support for local, relative file references: in loadRemoteFile(), check for fileExists().  If not found, prepend relative path and retry.
2007.02.24 3.2.1 re-labeled control panel &quot;open&quot; button to &quot;load&quot;
2007.02.09 3.2.0 loadTiddlers: added support for &quot;noReload&quot; tag (prevents overwriting existing tiddler, even if inbound tiddler is newer)
2007.02.08 3.1.3 loadTiddlers: added missing code and documentation for &quot;newTags&quot; handling (a feature change from long, long ago that somehow got lost!)
2006.11.14 3.1.2 fix macro handler parameter declaration (double-pasted param list corrupts IE)
2006.11.13 3.1.1 use apply() method to invoke hijacked core handler
2006.11.13 3.1.0 hijack built-in importTiddlers.handler() to co-exist with plugin interface.  If no params or 'core' keyword, display core interface.  &quot;link&quot; param embeds &quot;import tiddlers&quot; link that shows floating panel when clicked.
2006.10.12 3.0.8 in readTiddlersFromHTML(), fallback to find end of store area by matching &quot;/body&quot; when POST-BODY-START is not present (backward compatibility for older documents)
2006.09.10 3.0.7 in readTiddlersFromHTML(), find end of store area by matching &quot;POST-BODY-START&quot; instead of &quot;/body&quot; 
2006.08.16 3.0.6 Use higher-level store.saveTiddler() instead of store.addTiddler() to avoid conflicts with adaptations that hijack low-level tiddler handling.  in CreateImportPanel(), removed &quot;refresh listbox after every tiddler change&quot;.
2006.07.29 3.0.5 added noChangeMsg to loadTiddlers processing.  if not 'quiet' mode, reports skipped tiddlers.
2006.04.18 3.0.4 in loadTiddlers.handler, fixed parsing of &quot;prompt:&quot; param. Also, corrected parameters mismatch in loadTiddlers() callback function definition (order of params was wrong, resulting in filters NOT being applied)
2006.04.12 3.0.3 moved many display messages to macro properties for easier L10N translations via 'lingo' definitions.
2006.04.12 3.0.2 more work on 'core candidate' code.  Proposed API now defines &quot;loadRemoteFile()&quot; for XMLHttpRequest processing with built in fallback for handling local filesystem access, and readTiddlersFromHTML() to process the resulting source HTML content.
2006.04.04 3.0.1 in refreshImportList(), when using [by tags], tiddlers without tags are now included in a new &quot;untagged&quot; psuedo-tag list section
2006.04.04 3.0.0 Separate non-interactive {{{&lt;&lt;importTiddlers...&gt;&gt;}}} macro functionality for incorporation into TW2.1 core and renamed as {{{&lt;&lt;loadTiddlers&gt;&gt;}}} macro.  New parameters for loadTiddlers: ''label:text'' and ''prompt:text'' for link creation,  ''ask'' for filename/URL, ''tag:text'' for filtering, &quot;confirm&quot; for accept/reject of individual inbound tiddlers.  Removed support for &quot;importReplace/importPublic&quot; tags and &quot;force&quot; param (unused feature). 
2006.03.30 2.9.1 when extracting store area from remote URL, look for &quot;&lt;/body&gt;&quot; instead of &quot;&lt;/body&gt;\n&lt;/html&gt;&quot; so it will match even if the &quot;\n&quot; is absent from the source.
2006.03.30 2.9.0 added optional 'force' macro param.  When present, autoImportTiddlers() bypasses the checks for importPublic and importReplace.  Based on a request from Tom Otvos.
2006.03.28 2.8.1 in loadImportFile(), added checks to see if 'netscape' and 'x.overrideMimeType()' are defined (not in IE). Also, when extracting store area, look for &quot;&lt;/body&gt;\n&lt;/html&gt;&quot; and omit extra content that may have been added to the end of the file.
2006.02.21 2.8.0 added support for &quot;tiddler:TiddlerName&quot; filtering parameter in auto-import processing
2006.02.21 2.7.1 Clean up layout problems with IE.  (Use tables for alignment instead of SPANs styled with float:left and float:right)
2006.02.21 2.7.0 Added &quot;local file&quot; and &quot;web server&quot; radio buttons.  Default remote URL uses value from [[SiteURL]].  Also, added 'proxy' option, using value from [[SiteProxy]] as prefix to permit cross-domain document access via server-side scripting.
2006.02.17 2.6.0 Removed &quot;differences only&quot; listbox display mode, replaced with selection filter 'presets': all/new/changes/differences.  fixed init of &quot;add new tags&quot; checkbox
2006.02.16 2.5.4 added checkbox options to control &quot;import remote tags&quot; and &quot;keep existing tags&quot; behavior, in addition to existing &quot;add new tags&quot; functionality.
2006.02.14 2.5.3 FF1501 corrected unintended global 't' (loop index) in importReport() and autoImportTiddlers()
2006.02.10 2.5.2 corrected unintended global variable in importReport().
2006.02.05 2.5.1 moved globals from window.* to config.macros.importTiddlers.* to avoid FireFox 1.5.0.1 crash bug when referencing globals
2006.01.18 2.5.0 added checkbox for &quot;create a report&quot;.  Default is to create/update the ImportedTiddlers report.
2006.01.15 2.4.1 added &quot;importPublic&quot; tag and inverted default so that auto sharing is NOT done unless tagged with importPublic
2006.01.15 2.4.0 Added support for tagging tiddlers with importSkip, importReplace, and/or importPrivate to enable/disable overwriting or sharing with others when using auto-import macro syntax.  Defaults: don't overwrite existing tiddlers, and allow your tiddlers to be auto-imported by others.
2006.01.15 2.3.2 Added &quot;ask&quot; parameter to confirm each tiddler before importing (for use with auto-importing)
2006.01.15 2.3.1 Strip TW core scripts from import source content and load just the storeArea into the hidden IFRAME to prevent imported document's core code from being invoked.  Also, when importing local documents, use convertUTF8ToUnicode() to support international characters sets.
2006.01.12 2.3.0 Reorganized code to use callback function for loading import files to support event-driven I/O via an ASYNCHRONOUS XMLHttpRequest instead of waiting for remote hosts to respond to URL requests.  Added non-interactive 'batch' mode, using macro parameters to specify source path/file or URL, and select tiddlers to import.  Improved messages and added optional 'quiet' switch for batch mode to eliminate //most// feedback.
2006.01.11 2.2.0 Added &quot;[by tags]&quot; to list of tiddlers, based on code submitted by BradleyMeck
2006.01.08 2.1.0 IMPORT FROM ANYWHERE!!! re-write getImportedTiddlers() logic to either read a local file (using local I/O), OR... read a remote file, using a combination of XML and an iframe to permit cross-domain reading of DOM elements.  Adapted from example code and techniques courtesy of Jonny LeRoy.
2006.01.06 2.0.2 When refreshing list contents, fixed check for tiddlerExists() when &quot;show differences only&quot; is selected, so that imported tiddlers that don't exist in the current file will be recognized as differences and included in the list.
2006.01.04 2.0.1 When &quot;show differences only&quot; is NOT checked, import all tiddlers that have been selected even when they have a matching title and date.
2005.12.27 2.0.0 Update for TW2.0
Defer initial panel creation and only register a notification function when panel first is created
2005.12.22 1.3.1 tweak formatting in importReport() and add 'discard report' link to output
2005.12.03 1.3.0 Dynamically create/remove importPanel as needed to ensure only one instance of interface elements exists, even if there are multiple instances of macro embedding.  Also, dynamically create/recreate importFrame each time an external TW document is loaded for importation (reduces DOM overhead and ensures a 'fresh' frame for each document)
2005.11.29 1.2.1 fixed formatting of 'detail info' in importReport()
2005.11.11 1.2.0 added 'inline' param to embed controls in a tiddler
2005.11.09 1.1.0 only load HTML and CSS the first time the macro handler is called.  Allows for redundant placement of the macro without creating multiple instances of controls with the same ID's.
2005.10.25 1.0.5 fixed typo in importReport() that prevented reports from being generated
2005.10.09 1.0.4 combined documentation with plugin code instead of using separate tiddlers
2005.08.05 1.0.3 moved CSS and HTML definitions into plugin code instead of using separate tiddlers
2005.07.27 1.0.2 core update 1.2.29: custom overlayStyleSheet() replaced with new core setStylesheet()
2005.07.23 1.0.1 added parameter checks and corrected addNotification() usage
2005.07.20 1.0.0 Initial Release
&lt;&lt;&lt;</pre>
</div>
<div title="ImportedTiddlers" modifier="JohnRouillard" created="200903151851" modified="201008081928" tags="excludeMissing InstructorOnly" changecount="3">
<pre>On Sunday, August 08, 2010 15:28:52, JohnRouillard imported 75 tiddlers from
[[C:\Users\rouilj\Documents\coursebook\CoursebookV2.html|C:\Users\rouilj\Documents\coursebook\CoursebookV2.html]]:
&lt;&lt;&lt;
#[[BookmarkList]] - replaces BookmarkList - 7/18/2010 22:38:00 by JohnRouillard
#[[Bugs And Feature Requests]] - replaces Bugs And Feature Requests - 7/27/2010 01:13:00 by YourName
#[[Changing the Style Sheet]] - added
#[[Chapter  1 - Types of Presentations]] - added
#[[Chapter  1 - Working with Presentations]] - replaces Chapter  1 - Working with Presentations - 7/18/2010 16:56:00 by JohnRouillard
#[[Chapter  2 - Chapters Defined]] - added
#[[Chapter  2 - Working with Chapters]] - added
#[[Chapter  3 - Non-tiddlywiki publication options]] - added
#[[Chapter  3 - Other Publication Options]] - added
#[[Chapter creation]] - replaces Chapter creation - 7/25/2010 16:13:00 by YourName
#[[ChapterList]] - replaces ChapterList - 7/23/2010 19:45:00 by JohnRouillard
#[[Creating Chapter Content]] - added
#[[Creating Chapter Content as Separate Tiddlers]] - added
#[[Creating Chapter Content as Single Large Tiddler]] - added
#[[Creating Chapter Content as Single Tiddler and Split Into Multiple Tiddlers]] - added
#[[Creating PDF's]] - added
#[[Creating Quizzes]] - added
#[[Creating Reference Tiddlers]] - added
#[[Creating a New Chapter from an Existing Tiddler]] - added
#[[Creating a Presentation]] - replaces Creating a Presentation - 7/18/2010 18:21:00 by YourName
#[[Creating visual html]] - added
#[[Credits]] - replaces Credits - 7/4/2010 21:44:00 by JohnRouillard
#[[FileDropPlugin]] - replaces FileDropPlugin - 3/8/2010 14:28:00 by ELSDesignStudios
#[[FileDropPluginConfig]] - replaces FileDropPluginConfig - 8/12/2008 00:41:00 by ELSDesignStudios
#[[Frontscreen.png]] - replaces Frontscreen.png - 10/24/2009 17:53:00 by JohnRouillard
#[[GettingStarted]] - replaces GettingStarted - 7/18/2010 17:51:00 by JohnRouillard
#[[GettingStarted - LISA]] - replaces GettingStarted - LISA - 7/18/2010 17:56:00 by JohnRouillard
#[[Glossary]] - replaces Glossary - 7/27/2010 01:12:00 by YourName
#[[How to Create Additional Content]] - added
#[[How to Create a Chapter]] - added
#[[IconsSource]] - replaces IconsSource - 7/26/2010 23:20:00 by YourName
#[[ImagePathList]] - replaces ImagePathList - 7/26/2010 23:23:00 by YourName
#[[InstructorSidebarFunctions]] - replaces InstructorSidebarFunctions - 7/31/2010 01:31:00 by JohnRouillard
#[[MainMenu]] - replaces MainMenu - 7/17/2010 00:57:00 by JohnRouillard
#[[Opening a Chapter]] - added
#[[Opening a Presentation]] - replaces Opening a Presentation - 7/18/2010 16:13:00 by JohnRouillard
#[[Opening the Coursebook]] - replaces Opening the Coursebook - 10/31/2009 22:49:00 by JohnRouillard
#[[Printing]] - replaces Printing - 7/25/2010 16:30:00 by YourName
#[[Printing Chapters]] - added
#[[Printing Slide Set]] - replaces Printing Slide Set - 7/18/2010 17:25:00 by JohnRouillard
#[[QuizList]] - replaces QuizList - 8/25/2009 23:00:00 by JohnRouillard
#[[ReadMe]] - replaces ReadMe - 7/31/2010 03:13:00 by JohnRouillard
#[[Reference Appendix 1 - TiddlyWiki Page Layout]] - added
#[[Reference Appendix 1 - Working with a TiddlyWiki]] - added
#[[SideBarOptions]] - replaces SideBarOptions - 7/31/2010 01:32:00 by JohnRouillard
#[[SiteStartup]] - replaces SiteStartup - 7/18/2010 15:56:00 by JohnRouillard
#[[Slide Tips]] - replaces Slide Tips - 7/27/2010 01:12:00 by YourName
#[[SlideSubstyle]] - replaces SlideSubstyle - 7/31/2010 03:25:00 by JohnRouillard
#[[Splitting Chapters]] - replaces Splitting Chapters - 8/29/2009 20:22:00 by JohnRouillard
#[[Tagging a Chapter]] - added
#[[Textbook]] - replaces Textbook - 7/25/2010 14:55:00 by YourName
#[[TiddlyWiki Page Layout (Instructor)]] - added
#[[ToolbarCommands]] - replaces ToolbarCommands - 7/4/2010 21:02:00 by JohnRouillard
#[[Using This Tiddlywiki]] - replaces Using This Tiddlywiki - 7/11/2010 20:55:00 by YourName
#[[Using the Backstage Link]] - added
#[[Using the Content Links in the Main Menu]] - added
#[[Welcome to the presentation]] - replaces Welcome to the presentation - 7/18/2010 17:33:00 by JohnRouillard
#[[WelcomeSlide]] - replaces WelcomeSlide - 7/18/2010 17:30:00 by JohnRouillard
#[[Working with Tiddlers]] - added
#[[block-icon.png]] - added
#[[bookmark-icon.png]] - added
#[[bubble-icon.png]] - added
#[[clipboard-icon.png]] - added
#[[delete-icon.png]] - added
#[[editModeTiddler.png]] - added
#[[flag-icon.png]] - added
#[[goal.jpg]] - added
#[[info-icon.png]] - added
#[[label-icon.png]] - added
#[[pageLayout.png]] - added
#[[pencil-icon.png]] - added
#[[search-icon.png]] - added
#[[tick-icon.png]] - added
#[[viewModeTiddler.png]] - added
#[[warning-icon.png]] - added
&lt;&lt;&lt;

----
On Saturday, July 31, 2010 3:29:26 AM, JohnRouillard imported 5 tiddlers from
[[C:\Documents and Settings\rouilj\My Documents\coursebook\CoursebookV2.html|C:\Documents and Settings\rouilj\My Documents\coursebook\CoursebookV2.html]]:
&lt;&lt;&lt;
#[[Goals]] - replaces Goals - 7/31/2010 01:17:00 by JohnRouillard
#[[Notebook]] - replaces Notebook - 7/25/2010 15:00:00 by YourName
#[[Quizzes]] - replaces Quizzes - 7/25/2010 14:57:00 by YourName
#[[ReadMe]] - replaces ReadMe - 7/31/2010 01:32:00 by JohnRouillard
#[[SlideSubstyle]] - replaces SlideSubstyle - 7/31/2010 02:51:00 by JohnRouillard
&lt;&lt;&lt;

----
On Saturday, July 31, 2010 2:57:23 AM, JohnRouillard imported 8 tiddlers from
[[C:\Documents and Settings\rouilj\My Documents\coursebook\CoursebookV2.html|C:\Documents and Settings\rouilj\My Documents\coursebook\CoursebookV2.html]]:
&lt;&lt;&lt;
#[[Goals]] - replaces Goals - 7/29/2010 21:32:00 by JohnRouillard
#[[InstructorSidebarFunctions]] - added
#[[Presentations]] - replaces Presentations - 7/29/2010 20:46:00 by JohnRouillard
#[[ReadMe]] - replaces ReadMe - 7/26/2010 23:27:00 by YourName
#[[SideBarOptions]] - replaces SideBarOptions - 7/11/2010 21:16:00 by YourName
#[[SlideShowPlugin]] - replaces SlideShowPlugin - 7/29/2010 21:31:00 by JohnRouillard
#[[SlideSubstyle]] - replaces SlideSubstyle - 7/29/2010 21:14:00 by JohnRouillard
#[[presentationViewTemplate]] - replaces presentationViewTemplate - 7/11/2010 21:12:00 by YourName
&lt;&lt;&lt;

----
On Sunday, July 18, 2010 10:34:49 PM, JohnRouillard imported 1 tiddler from
[[http://www.minormania.com/tiddlylock/tiddlylock.html|http://www.minormania.com/tiddlylock/tiddlylock.html]]:
&lt;&lt;&lt;
#[[TiddlyLockPlugin]] - replaces TiddlyLockPlugin - 7/18/2010 22:17:00 by YourName
&lt;&lt;&lt;

----
On Sunday, July 11, 2010 20:33:58, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SaveToClipboard]] - added
&lt;&lt;&lt;

----
On Monday, July 05, 2010 15:32:52, JohnRouillard imported 1 tiddler from
[[http://tw.lewcid.org/#ToggleSideBarMacro|http://tw.lewcid.org/#ToggleSideBarMacro]]:
&lt;&lt;&lt;
#[[ToggleSideBarMacro]] - replaces ToggleSideBarMacro - 3/30/2009 17:03:00 by PauloSoares
&lt;&lt;&lt;

----
On Monday, July 05, 2010 13:57:16, JohnRouillard imported 3 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons.html|http://www.math.ist.utl.pt/~psoares/addons.html]]:
&lt;&lt;&lt;
#[[SlideShowPlugin]] - replaces SlideShowPlugin - 8/30/2009 14:32:00 by JohnRouillard
#[[SlideShowPluginDoc]] - replaces SlideShowPluginDoc - 4/19/2009 14:44:00 by PauloSoares
#[[ToggleSideBarMacro]] - replaces ToggleSideBarMacro - 7/24/2006 06:18:00 by Saq
&lt;&lt;&lt;

----
On Monday, July 05, 2010 13:45:59, JohnRouillard imported 7 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[ExportTiddlersPlugin]] - replaces ExportTiddlersPlugin - 9/12/2009 21:02:00 by ELSDesignStudios
#[[ExportTiddlersPluginInfo]] - replaces ExportTiddlersPluginInfo - 4/30/2009 18:14:00 by ELSDesignStudios
#[[FileDropPlugin]] - replaces FileDropPlugin - 10/10/2009 15:57:00 by ELSDesignStudios
#[[MatchTagsPlugin]] - replaces MatchTagsPlugin - 8/30/2009 19:56:00 by ELSDesignStudios
#[[MatchTagsPluginInfo]] - replaces MatchTagsPluginInfo - 8/30/2009 19:55:00 by ELSDesignStudios
#[[ShowImage]] - added
#[[SplitTiddler]] - replaces SplitTiddler - 8/16/2009 21:01:00 by JohnRouillard
&lt;&lt;&lt;

----
On Sunday, July 04, 2010 9:43:42 PM, JohnRouillard imported 1 tiddler from
[[C:\Documents and Settings\rouilj\My Documents\sec_class\SEC_tw_inst.html|C:\Documents and Settings\rouilj\My Documents\sec_class\SEC_tw_inst.html]]:
&lt;&lt;&lt;
#[[Credits]] - added
&lt;&lt;&lt;

----
On Saturday, October 24, 2009 4:57:38 PM, JohnRouillard imported 4 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SaveAsPlugin]] - replaces SaveAsPlugin - 8/16/2009 15:43:00 by ELSDesignStudios
#[[SaveAsPluginInfo]] - replaces SaveAsPluginInfo - 8/16/2009 15:43:00 by ELSDesignStudios
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 8/29/2009 22:03:00 by ELSDesignStudios
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 8/29/2009 22:03:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, October 11, 2009 10:19:33 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[WikifyPlugin]] - added
#[[WikifyPluginInfo]] - added
&lt;&lt;&lt;

----
On Sunday, October 11, 2009 8:17:50 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com/|http://www.tiddlytools.com/]]:
&lt;&lt;&lt;
#[[SnapshotPlugin]] - added
#[[SnapshotPluginInfo]] - added
&lt;&lt;&lt;

----
On Saturday, October 10, 2009 11:21:36 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/faq.html|http://www.tiddlytools.com/faq.html]]:
&lt;&lt;&lt;
#[[FAQ_RescueStoreArea]] - replaces FAQ_RescueStoreArea - 3/31/2008 18:37:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Saturday, October 10, 2009 9:59:52 PM, JohnRouillard imported 3 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[AttachFilePluginFormatters]] - replaces AttachFilePluginFormatters - 6/4/2009 14:33:00 by ELSDesignStudios
#[[FileDropPlugin]] - replaces FileDropPlugin - 10/8/2009 23:56:00 by ELSDesignStudios
#[[ToggleFullScreen]] - replaces ToggleFullScreen - 10/10/2009 11:50:00 by JohnRouillard
&lt;&lt;&lt;

----
On Saturday, October 10, 2009 11:49:03 AM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[ToggleFullScreen]] - added
&lt;&lt;&lt;

----
On Friday, October 09, 2009 10:37:27 PM, JohnRouillard imported 8 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[FileDropPlugin]] - replaces FileDropPlugin - 8/21/2009 00:36:00 by ELSDesignStudios
#[[ImportTiddlersPlugin]] - replaces ImportTiddlersPlugin - 9/12/2009 21:09:00 by ELSDesignStudios
#[[ImportTiddlersPluginInfo]] - replaces ImportTiddlersPluginInfo - 8/23/2009 18:55:00 by ELSDesignStudios
#[[LoadTiddlersPlugin]] - replaces LoadTiddlersPlugin - 9/1/2009 19:19:00 by ELSDesignStudios
#[[LoadTiddlersPluginInfo]] - replaces LoadTiddlersPluginInfo - 9/1/2009 19:18:00 by ELSDesignStudios
#[[RelatedTiddlersPlugin]] - replaces RelatedTiddlersPlugin - 11/11/2007 02:26:00 by ELSDesignStudios
#[[TiddlerTweakerPlugin]] - replaces TiddlerTweakerPlugin - 9/13/2009 13:33:00 by ELSDesignStudios
#[[ToggleFullScreen]] - replaces ToggleFullScreen - 9/6/2009 22:22:00 by JohnRouillard
&lt;&lt;&lt;

----
On Tuesday, October 06, 2009 10:17:15 PM, JohnRouillard imported 2 tiddlers from
[[http://tiddlytagmindmap.tiddlyspot.com/|http://tiddlytagmindmap.tiddlyspot.com/]]:
&lt;&lt;&lt;
#[[TiddlyTagMindMapPlugin]] - added
#[[VismoLibrary]] - added
&lt;&lt;&lt;

----
On Sunday, September 13, 2009 2:01:22 PM, JohnRouillard imported 4 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[AliasPlugin]] - replaces AliasPlugin - 3/22/2007 01:36:00 by ELSDesignStudios
#[[ExportTiddlersPlugin]] - replaces ExportTiddlersPlugin - 7/6/2009 11:02:00 by ELSDesignStudios
#[[ImportTiddlersPlugin]] - replaces ImportTiddlersPlugin - 8/23/2009 18:55:00 by ELSDesignStudios
#[[ShowPopup]] - replaces ShowPopup - 8/13/2009 14:59:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, September 13, 2009 1:48:21 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[TiddlerTweakerPlugin]] - replaces TiddlerTweakerPlugin - 6/26/2009 07:28:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Saturday, September 12, 2009 7:24:14 PM, JohnRouillard imported 1 tiddler from
[[C:\Documents and Settings\rouilj\My Documents\sec_class\SEC_tw.html|C:\Documents and Settings\rouilj\My Documents\sec_class\SEC_tw.html]]:
&lt;&lt;&lt;
#[[SlideShowPlugin]] - replaces SlideShowPlugin - 9/12/2009 16:50:00 by JohnRouillard
&lt;&lt;&lt;

----
On Saturday, September 12, 2009 5:33:09 PM, JohnRouillard imported 1 tiddler from
[[http://sidebarpluginvault.tiddlyspot.com/|http://sidebarpluginvault.tiddlyspot.com/]]:
&lt;&lt;&lt;
#[[BetterTimelineMacroMG]] - added
&lt;&lt;&lt;

----
On Thursday, September 10, 2009 12:08:17 AM, JohnRouillard imported 1 tiddler from
[[http://devpad.tiddlyspot.com/|http://devpad.tiddlyspot.com/]]:
&lt;&lt;&lt;
#[[TaggedBackupsPlugin]] - added
&lt;&lt;&lt;

----
On Tuesday, September 08, 2009 4:55:58 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[AttachFilePluginFormatters]] - replaces AttachFilePluginFormatters - 6/4/2009 14:33:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Monday, September 07, 2009 3:30:54 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/faq.html|http://www.tiddlytools.com/faq.html]]:
&lt;&lt;&lt;
#[[FAQ_RescueStoreArea]] - added
&lt;&lt;&lt;

----
On Monday, September 07, 2009 3:28:25 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[RescueStoreAreaCommand]] - added
&lt;&lt;&lt;

----
On Sunday, September 06, 2009 3:32:09 PM, JohnRouillard imported 1 tiddler from
[[http://www.math.ist.utl.pt/~psoares/addons_2.4.html|http://www.math.ist.utl.pt/~psoares/addons_2.4.html]]:
&lt;&lt;&lt;
#[[QuizzerPluginDoc]] - replaces QuizzerPluginDoc - 9/6/2009 15:30:40 by JohnRouillard
&lt;&lt;&lt;

----
On Sunday, September 06, 2009 3:27:21 PM, JohnRouillard imported 2 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons_2.4.html|http://www.math.ist.utl.pt/~psoares/addons_2.4.html]]:
&lt;&lt;&lt;
#[[QuizzerPlugin - fcs]] - renamed from QuizzerPlugin
#[[QuizzerPluginDoc - fcs]] - renamed from QuizzerPluginDoc
&lt;&lt;&lt;

----
On Sunday, September 06, 2009 3:16:30 PM, JohnRouillard imported 1 tiddler from
[[http://www.orst.edu/~woodswa/tiddlywikiplugs.html|http://www.orst.edu/~woodswa/tiddlywikiplugs.html]]:
&lt;&lt;&lt;
#[[DisplayOpenTiddlersPlugin]] - replaces DisplayOpenTiddlersPlugin - 9/6/2009 15:13:38 by JohnRouillard
&lt;&lt;&lt;

----
On Friday, September 04, 2009 8:29:39 PM, JohnRouillard imported 1 tiddler from
[[http://www.linux-lovers.be/RevisionsPlugin/#RevisionsPlugin|http://www.linux-lovers.be/RevisionsPlugin/#RevisionsPlugin]]:
&lt;&lt;&lt;
#[[RevisionsPlugin]] - replaces RevisionsPlugin - 9/4/2009 20:29:16 by JohnRouillard
&lt;&lt;&lt;

----
On Friday, September 04, 2009 9:43:21 AM, JohnRouillard imported 1 tiddler from
[[http://tiddlywiki.abego-software.de/|http://tiddlywiki.abego-software.de/]]:
&lt;&lt;&lt;
#[[YourSearchPlugin]] - replaces YourSearchPlugin - 4/16/2008 05:08:00 by UdoBorkowski
&lt;&lt;&lt;

----
On Thursday, September 03, 2009 9:34:38 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[RelatedTiddlersPlugin]] - replaces RelatedTiddlersPlugin - 8/25/2009 00:15:00 by JohnRouillard
&lt;&lt;&lt;

----
On Thursday, September 03, 2009 9:31:55 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[TiddlerTweakerPlugin]] - replaces TiddlerTweakerPlugin - 8/16/2009 21:02:00 by JohnRouillard
&lt;&lt;&lt;

----
On Thursday, September 03, 2009 9:28:56 PM, JohnRouillard imported 4 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[InlineJavascriptPlugin]] - replaces InlineJavascriptPlugin - 4/12/2009 01:17:00 by ELSDesignStudios
#[[InlineJavascriptPluginInfo]] - replaces InlineJavascriptPluginInfo - 8/22/2009 17:56:00 by JohnRouillard
#[[TaggedTemplateTweak]] - replaces TaggedTemplateTweak - 7/31/2009 14:48:00 by ELSDesignStudios
#[[TaggedTemplateTweakInfo]] - replaces TaggedTemplateTweakInfo - 7/31/2009 14:45:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Tuesday, September 01, 2009 7:56:09 PM, JohnRouillard imported 4 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[MatchTagsPlugin]] - replaces MatchTagsPlugin - 8/30/2009 19:56:00 by ELSDesignStudios
#[[MatchTagsPluginInfo]] - replaces MatchTagsPluginInfo - 8/30/2009 19:55:00 by ELSDesignStudios
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 8/29/2009 22:03:00 by ELSDesignStudios
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 8/29/2009 22:03:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Tuesday, September 01, 2009 7:42:42 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[LoadTiddlersPlugin]] - added
#[[LoadTiddlersPluginInfo]] - replaces LoadTiddlersPluginInfo - 8/30/2009 23:01:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, August 30, 2009 11:33:15 PM, JohnRouillard imported 4 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[LoadTiddlersPluginInfo]] - replaces LoadTiddlersPluginInfo - 8/29/2009 19:56:00 by ELSDesignStudios
#[[LoadTiddlersPlugin]] - replaces LoadTiddlersPlugin - 8/29/2009 19:56:00 by ELSDesignStudios
#[[MatchTagsPlugin]] - replaces MatchTagsPlugin - 9/4/2008 12:45:00 by ELSDesignStudios
#[[MatchTagsPluginInfo]] - replaces MatchTagsPluginInfo - 9/4/2008 01:36:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, August 30, 2009 4:01:44 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[CompareTiddlersPlugin]] - replaces CompareTiddlersPlugin - 8/30/2009 15:59:26 by JohnRouillard
&lt;&lt;&lt;

----
On Sunday, August 30, 2009 1:03:13 PM, JohnRouillard imported 4 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 8/23/2009 23:27:00 by ELSDesignStudios
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 8/23/2009 23:27:00 by ELSDesignStudios
#[[LoadTiddlersPluginInfo]] - replaces LoadTiddlersPluginInfo - 8/29/2009 19:56:00 by ELSDesignStudios
#[[LoadTiddlersPlugin]] - replaces LoadTiddlersPlugin - 8/29/2009 19:56:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Saturday, August 29, 2009 10:31:34 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[LoadTiddlersPlugin]] - replaces LoadTiddlersPlugin - 8/19/2009 16:53:00 by ELSDesignStudios
#[[LoadTiddlersPluginInfo]] - replaces LoadTiddlersPluginInfo - 8/19/2009 16:53:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Saturday, August 29, 2009 7:09:36 PM, JohnRouillard imported 1 tiddler from
[[http://tiddlywiki.abego-software.de|http://tiddlywiki.abego-software.de]]:
&lt;&lt;&lt;
#[[YourSearchPlugin]] - replaces YourSearchPlugin - 8/29/2009 13:39:00 by YourName
&lt;&lt;&lt;

----
On Saturday, August 29, 2009 5:38:27 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 8/29/2009 16:52:00 by JohnRouillard
&lt;&lt;&lt;

----
On Friday, August 28, 2009 10:19:36 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[StickyPopupPlugin]] - added
&lt;&lt;&lt;

----
On Friday, August 28, 2009 8:09:32 PM, JohnRouillard imported 1 tiddler from
[[http://mptw.tiddlyspot.com/|http://mptw.tiddlyspot.com/]]:
&lt;&lt;&lt;
#[[HideWhenPlugin]] - added
&lt;&lt;&lt;

----
On Monday, August 24, 2009 8:46:36 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[AliasPlugin]] - added
&lt;&lt;&lt;

----
On Monday, August 24, 2009 8:37:15 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[QuickEditPlugin]] - added
&lt;&lt;&lt;

----
On Monday, August 24, 2009 8:15:48 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[QuickEdit_convert]] - added
&lt;&lt;&lt;

----
On Monday, August 24, 2009 3:09:20 PM, JohnRouillard imported 4 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 8/21/2009 15:44:00 by ELSDesignStudios
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 8/21/2009 15:44:00 by ELSDesignStudios
#[[ImportTiddlersPluginInfo]] - replaces ImportTiddlersPluginInfo - 8/21/2009 03:49:00 by ELSDesignStudios
#[[ImportTiddlersPlugin]] - replaces ImportTiddlersPlugin - 8/21/2009 03:59:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Saturday, August 22, 2009 11:51:20 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 8/22/2009 18:08:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Saturday, August 22, 2009 8:50:19 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 8/14/2009 11:27:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Friday, August 21, 2009 4:28:30 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 7/27/2009 22:27:00 by ELSDesignStudios
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 8/21/2009 14:57:00 by JohnRouillard
&lt;&lt;&lt;

----
On Friday, August 21, 2009 1:47:22 PM, JohnRouillard imported 1 tiddler from
[[http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html|http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html]]:
&lt;&lt;&lt;
#[[InlineJavascriptPluginInfo]] - added
&lt;&lt;&lt;

----
On Friday, August 21, 2009 1:45:05 PM, JohnRouillard imported 3 tiddlers from
[[http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html|http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html]]:
&lt;&lt;&lt;
#[[ImportTiddlersPlugin]] - replaces ImportTiddlersPlugin - 7/3/2009 18:32:00 by ELSDesignStudios
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 8/2/2009 05:18:00 by ELSDesignStudios
#[[InlineJavascriptPlugin]] - replaces InlineJavascriptPlugin - 2/26/2009 16:09:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Friday, August 21, 2009 1:44:02 PM, JohnRouillard imported 4 tiddlers from
[[http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html|http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html]]:
&lt;&lt;&lt;
#[[ImportTiddlersPlugin]] - skipped after asking
#[[ImportTiddlersPluginInfo]] - replaces ImportTiddlersPluginInfo - 5/4/2009 20:26:00 by ELSDesignStudios
#[[FileDropPlugin]] - replaces FileDropPlugin - 12/3/2007 15:22:00 by ELSDesignStudios
#[[LoadTiddlersPluginInfo]] - replaces LoadTiddlersPluginInfo - 8/16/2009 18:24:00 by ELSDesignStudios
#[[LoadTiddlersPlugin]] - replaces LoadTiddlersPlugin - 8/16/2009 18:24:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, August 16, 2009 8:12:21 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[LoadTiddlersPluginInfo]] - replaces LoadTiddlersPluginInfo - 5/4/2009 20:08:00 by ELSDesignStudios
#[[LoadTiddlersPlugin]] - replaces LoadTiddlersPlugin - 7/3/2009 18:32:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, August 16, 2009 4:07:28 PM, JohnRouillard imported 3 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SaveAsPluginInfo]] - replaces SaveAsPluginInfo - 8/4/2009 16:00:00 by ELSDesignStudios
#[[SaveAsPlugin]] - replaces SaveAsPlugin - 8/4/2009 16:01:00 by ELSDesignStudios
#[[SplitTiddler]] - replaces SplitTiddler - 8/16/2009 00:19:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, August 16, 2009 12:56:03 AM, JohnRouillard imported 1 tiddler from
[[http://www.orst.edu/~woodswa/tiddlywikiplugs.html|http://www.orst.edu/~woodswa/tiddlywikiplugs.html]]:
&lt;&lt;&lt;
#[[DisplayOpenTiddlersPlugin]] - replaces DisplayOpenTiddlersPlugin - 8/4/2009 22:43:00 by JohnRouillard
&lt;&lt;&lt;

----
On Sunday, August 16, 2009 12:23:28 AM, JohnRouillard loaded 1 tiddlers from
[[http://www.TiddlyTools.com/|http://www.TiddlyTools.com/]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - updated
&lt;&lt;&lt;

----
On Sunday, August 16, 2009 12:14:29 AM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - replaces SplitTiddler - 8/15/2009 23:39:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Saturday, August 15, 2009 11:50:16 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - replaces SplitTiddler - 8/14/2009 21:14:00 by JohnRouillard
&lt;&lt;&lt;

----
On Saturday, August 15, 2009 8:17:20 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[ToggleFullScreen]] - added
&lt;&lt;&lt;

----
On Friday, August 14, 2009 9:40:22 AM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - replaces SplitTiddler - 8/13/2009 21:07:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Thursday, August 13, 2009 9:27:25 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - replaces SplitTiddler - 8/13/2009 21:15:34 by JohnRouillard
&lt;&lt;&lt;

----
On Thursday, August 13, 2009 9:15:03 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - replaces SplitTiddler - 8/13/2009 21:13:38 by JohnRouillard
&lt;&lt;&lt;

----
On Thursday, August 13, 2009 8:07:41 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - replaces SplitTiddler - 8/13/2009 20:06:46 by JohnRouillard
&lt;&lt;&lt;

----
On Thursday, August 13, 2009 3:19:40 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - replaces SplitTiddler - 8/1/2009 22:59:00 by ELSDesignStudios
#[[ShowPopup]] - replaces ShowPopup - 8/12/2009 22:12:00 by YourName
&lt;&lt;&lt;

----
On Tuesday, August 11, 2009 2:27:31 PM, JohnRouillard imported 1 tiddler from
[[http://tiddlywiki.com/beta/BetaUpgradePlugin.html|http://tiddlywiki.com/beta/BetaUpgradePlugin.html]]:
&lt;&lt;&lt;
#[[BetaUpgradePlugin]] - added
&lt;&lt;&lt;

----
On Saturday, August 08, 2009 4:26:38 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - replaces SplitTiddler - 8/8/2009 16:18:34 by JohnRouillard
&lt;&lt;&lt;

----
On Saturday, August 08, 2009 4:24:08 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[ShowPopup]] - replaces ShowPopup - 8/1/2009 21:44:00 by JohnRouillard
&lt;&lt;&lt;

----
On Friday, August 07, 2009 11:04:28 PM, YourName imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[RearrangeTiddlersPlugin]] - added
&lt;&lt;&lt;

----
On Friday, August 07, 2009 10:15:04 PM, YourName imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[ImagePathPlugin]] - replaces ImagePathPlugin - 8/7/2009 22:13:00 by YourName
&lt;&lt;&lt;

----
On Thursday, August 06, 2009 12:15:00 AM, YourName imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[RelatedTiddlersPlugin]] - added
&lt;&lt;&lt;

----
On Tuesday, August 04, 2009 4:52:48 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SaveAsPlugin]] - replaces SaveAsPlugin - 8/3/2009 19:01:00 by ELSDesignStudios
#[[SaveAsPluginInfo]] - replaces SaveAsPluginInfo - 8/3/2009 18:45:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Tuesday, August 04, 2009 4:48:44 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SaveAsPlugin]] - replaces SaveAsPlugin - 8/3/2009 23:01:00 by JohnRouillard
#[[SaveAsPluginInfo]] - replaces SaveAsPluginInfo - 8/3/2009 18:45:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Tuesday, August 04, 2009 3:21:44 PM, JohnRouillard imported 1 tiddler from
[[http://oregonstate.edu/~woodswa/tiddlywikiplugs.html|http://oregonstate.edu/~woodswa/tiddlywikiplugs.html]]:
&lt;&lt;&lt;
#[[DisplayOpenTiddlersPlugin]] - added
&lt;&lt;&lt;

----
On Monday, August 03, 2009 10:39:36 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SaveAsPlugin]] - replaces SaveAsPlugin - 7/4/2009 01:19:00 by ELSDesignStudios
#[[SaveAsPluginInfo]] - replaces SaveAsPluginInfo - 4/30/2009 15:52:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, August 02, 2009 3:28:32 PM, JohnRouillard imported 1 tiddler from
[[http://visualtw.ouvaton.org/VisualTW.html|http://visualtw.ouvaton.org/VisualTW.html]]:
&lt;&lt;&lt;
#[[FieldsEditorPlugin]] - replaces FieldsEditorPlugin - 7/5/2009 00:24:00 by JohnRouillard
&lt;&lt;&lt;

----
On Sunday, August 02, 2009 3:25:35 PM, JohnRouillard imported 1 tiddler from
[[http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html|http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html]]:
&lt;&lt;&lt;
#[[CompareTiddlersPlugin]] - replaces CompareTiddlersPlugin - 7/28/2009 00:31:00 by YourName
&lt;&lt;&lt;

----
On Sunday, August 02, 2009 1:00:23 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 8/1/2009 15:35:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, August 02, 2009 12:55:52 AM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 7/6/2009 09:10:00 by ELSDesignStudios
#[[SplitTiddler]] - replaces SplitTiddler - 8/1/2009 20:26:00 by JohnRouillard
&lt;&lt;&lt;

----
On Saturday, August 01, 2009 2:11:06 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 7/25/2009 15:19:00 by JohnRouillard
&lt;&lt;&lt;

----
On Friday, July 31, 2009 9:35:58 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[TaggedTemplateTweak]] - replaces TaggedTemplateTweak - 5/3/2009 22:16:00 by ELSDesignStudios
#[[TaggedTemplateTweakInfo]] - replaces TaggedTemplateTweakInfo - 5/3/2009 22:15:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Thursday, July 30, 2009 9:58:51 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[ExportTiddlersPlugin]] - replaces ExportTiddlersPlugin - 7/6/2009 11:02:00 by ELSDesignStudios
#[[ExportTiddlersPluginInfo]] - replaces ExportTiddlersPluginInfo - 4/30/2009 18:14:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Monday, July 27, 2009 11:13:19 PM, JohnRouillard imported 1 tiddler from
[[http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html|http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html]]:
&lt;&lt;&lt;
#[[CompareTiddlersPlugin]] - replaces CompareTiddlersPlugin - 7/27/2009 23:13:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Monday, July 27, 2009 10:59:28 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 7/27/2009 19:07:00 by ELSDesignStudios
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 7/27/2009 18:42:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Monday, July 27, 2009 8:36:25 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 7/27/2009 19:07:00 by ELSDesignStudios
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 7/27/2009 20:18:00 by JohnRouillard
&lt;&lt;&lt;

----
On Monday, July 27, 2009 8:15:02 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com/|http://www.tiddlytools.com/]]:
&lt;&lt;&lt;
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 7/26/2009 17:41:00 by ELSDesignStudios
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 7/26/2009 17:40:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, July 26, 2009 11:13:48 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com/|http://www.tiddlytools.com/]]:
&lt;&lt;&lt;
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 7/6/2009 20:52:00 by ELSDesignStudios
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 7/6/2009 20:51:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Sunday, July 26, 2009 10:58:24 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#SaveFromWebConfig|http://www.tiddlytools.com/#SaveFromWebConfig]]:
&lt;&lt;&lt;
#[[SaveFromWebConfig]] - replaces SaveFromWebConfig - 7/25/2009 13:21:00 by JohnRouillard
&lt;&lt;&lt;

----
On Saturday, July 25, 2009 2:42:37 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/|http://www.tiddlytools.com/]]:
&lt;&lt;&lt;
#[[CompareTiddlersPlugin]] - replaces CompareTiddlersPlugin - 7/25/2009 14:37:00 by JohnRouillard
&lt;&lt;&lt;

----
On Thursday, July 23, 2009 9:47:06 PM, JohnRouillard imported 1 tiddler from
[[http://tiddlywiki.bidix.info|http://tiddlywiki.bidix.info]]:
&lt;&lt;&lt;
#[[RSSReaderPluginDescription]] - replaces RSSReaderPluginDescription - 7/4/2009 23:34:00 by JohnRouillard
&lt;&lt;&lt;

----
On Thursday, July 23, 2009 9:22:13 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/|http://www.tiddlytools.com/]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - replaces SplitTiddler - 7/5/2009 00:27:00 by JohnRouillard
&lt;&lt;&lt;

----
On Thursday, July 23, 2009 9:07:18 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/|http://www.tiddlytools.com/]]:
&lt;&lt;&lt;
#[[ShowPopup]] - added
&lt;&lt;&lt;

----
On Thursday, July 09, 2009 12:48:03 AM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#StorySaverPlugin|http://www.tiddlytools.com/#StorySaverPlugin]]:
&lt;&lt;&lt;
#[[SaveAsPlugin]] - replaces SaveAsPlugin - 4/30/2009 15:55:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Thursday, July 09, 2009 12:28:47 AM, JohnRouillard imported 8 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 4/24/2009 11:45:00 by ELSDesignStudios
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 7/4/2009 23:30:00 by JohnRouillard
#[[ExportTiddlersPlugin]] - replaces ExportTiddlersPlugin - 4/30/2009 18:16:00 by ELSDesignStudios
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 7/6/2009 09:10:00 by ELSDesignStudios
#[[LoadTiddlersPlugin]] - replaces LoadTiddlersPlugin - 5/4/2009 20:08:00 by ELSDesignStudios
#[[ImportTiddlersPlugin]] - replaces ImportTiddlersPlugin - 5/4/2009 20:27:00 by ELSDesignStudios
#[[TiddlerTweakerPlugin]] - replaces TiddlerTweakerPlugin - 6/26/2009 07:28:00 by ELSDesignStudios
#[[CopyTiddlerPlugin]] - replaces CopyTiddlerPlugin - 6/8/2009 04:34:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Tuesday, July 07, 2009 8:50:38 PM, JohnRouillard imported 1 tiddler from
[[http://www.TiddlyTools.com|http://www.TiddlyTools.com]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 7/4/2009 00:21:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Saturday, July 04, 2009 10:52:42 PM, JohnRouillard imported 1 tiddler from
[[http://gwsyzygy.googlepages.com/creator.html|http://gwsyzygy.googlepages.com/creator.html]]:
&lt;&lt;&lt;
#[[ScrollingTabsPlugin]] - added
&lt;&lt;&lt;

----
On Saturday, July 04, 2009 1:26:07 AM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#SectionLinksPlugin|http://www.tiddlytools.com/#SectionLinksPlugin]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 6/3/2009 00:27:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Saturday, July 04, 2009 1:16:15 AM, JohnRouillard imported 2 tiddlers from
[[http://www.TiddlyTools.com|http://www.TiddlyTools.com]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 7/4/2009 00:08:58 by JohnRouillard
#[[SwitchThemePlugin]] - replaces SwitchThemePlugin - 4/23/2008 19:16:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Friday, July 03, 2009 10:29:00 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/|http://www.tiddlytools.com/]]:
&lt;&lt;&lt;
#[[SplitTiddler]] - added
&lt;&lt;&lt;

----
On Thursday, July 02, 2009 11:37:37 PM, JohnRouillard imported 2 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons.html|http://www.math.ist.utl.pt/~psoares/addons.html]]:
&lt;&lt;&lt;
#[[SlideShowPlugin]] - replaces SlideShowPlugin - 4/13/2009 09:17:00 by PauloSoares
#[[SlideShowPluginDoc]] - replaces SlideShowPluginDoc - 3/29/2009 19:49:00 by PauloSoares
&lt;&lt;&lt;

----
On Thursday, July 02, 2009 11:21:27 PM, JohnRouillard imported 10 tiddlers from
[[http://www.tiddlytools.com/|http://www.tiddlytools.com/]]:
&lt;&lt;&lt;
#[[AttachFileMIMETypes]] - replaces AttachFileMIMETypes - 5/14/2006 21:21:00 by ELSDesignStudios
#[[CompareTiddlersPlugin]] - replaces CompareTiddlersPlugin - 6/9/2009 15:52:00 by JohnRouillard
#[[ImagePathPlugin]] - replaces ImagePathPlugin - 4/13/2007 15:48:00 by ELSDesignStudios
#[[ImageSizePlugin]] - replaces ImageSizePlugin - 2/26/2009 19:02:00 by ELSDesignStudios
#[[NestedSlidersPlugin]] - replaces NestedSlidersPlugin - 11/16/2008 01:23:00 by ELSDesignStudios
#[[NestedSlidersPluginInfo]] - replaces NestedSlidersPluginInfo - 11/16/2008 01:22:00 by ELSDesignStudios
#[[RefreshTiddler]] - added
#[[SwitchThemePlugin]] - replaces SwitchThemePlugin - 4/23/2008 19:16:00 by ELSDesignStudios
#[[SwitchThemePluginInfo]] - replaces SwitchThemePluginInfo - 4/23/2008 18:57:00 by ELSDesignStudios
#[[UnsavedChangesPlugin]] - replaces UnsavedChangesPlugin - 3/2/2009 14:33:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Thursday, July 02, 2009 11:00:17 PM, JohnRouillard imported 3 tiddlers from
[[http://tiddlywiki.bidix.info|http://tiddlywiki.bidix.info]]:
&lt;&lt;&lt;
#[[RSSReaderPlugin]] - replaces RSSReaderPlugin - 9/2/2008 16:25:00 by BidiX
#[[RSSReaderPluginDescription]] - added
#[[RSSReaderPluginDoc]] - replaces RSSReaderPluginDoc - 4/22/2007 04:57:00 by BidiX
&lt;&lt;&lt;

----
On Thursday, July 02, 2009 10:57:08 PM, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com/|http://www.tiddlytools.com/]]:
&lt;&lt;&lt;
#[[MatchTagsPlugin]] - replaces MatchTagsPlugin - 9/4/2008 12:45:00 by ELSDesignStudios
#[[MatchTagsPluginInfo]] - replaces MatchTagsPluginInfo - 9/4/2008 01:36:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Thursday, July 02, 2009 10:52:37 PM, JohnRouillard imported 1 tiddler from
[[http://visualtw.ouvaton.org/VisualTW.html|http://visualtw.ouvaton.org/VisualTW.html]]:
&lt;&lt;&lt;
#[[SyncFromSourcePlugin]] - replaces SyncFromSourcePlugin - 1/5/2008 04:31:00 by Pascal
&lt;&lt;&lt;

----
On Thursday, July 02, 2009 10:41:51 PM, JohnRouillard imported 20 tiddlers from
[[http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html|http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html]]:
&lt;&lt;&lt;
#[[TiddlerTweakerPlugin]] - replaces TiddlerTweakerPlugin - 1/22/2009 12:12:00 by ELSDesignStudios
#[[CopyTiddlerPlugin]] - replaces CopyTiddlerPlugin - 3/9/2009 20:48:00 by ELSDesignStudios
#[[AttachFilePlugin]] - replaces AttachFilePlugin - 7/21/2008 19:45:00 by ELSDesignStudios
#[[AttachFilePluginFormatters]] - replaces AttachFilePluginFormatters - 12/4/2007 15:56:00 by ELSDesignStudios
#[[AttachFilePluginInfo]] - replaces AttachFilePluginInfo - 7/21/2008 19:44:00 by ELSDesignStudios
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 6/3/2009 00:27:00 by ELSDesignStudios
#[[GotoPlugin]] - replaces GotoPlugin - 12/15/2008 19:42:00 by ELSDesignStudios
#[[GotoPluginInfo]] - replaces GotoPluginInfo - 12/15/2008 19:41:00 by ELSDesignStudios
#[[ImportTiddlersPlugin]] - replaces ImportTiddlersPlugin - 3/5/2009 11:45:00 by ELSDesignStudios
#[[ImportTiddlersPluginInfo]] - replaces ImportTiddlersPluginInfo - 3/4/2009 20:28:00 by ELSDesignStudios
#[[LoadTiddlersPluginInfo]] - replaces LoadTiddlersPluginInfo - 11/14/2008 10:51:00 by ELSDesignStudios
#[[LoadTiddlersPlugin]] - replaces LoadTiddlersPlugin - 11/14/2008 10:51:00 by ELSDesignStudios
#[[TaggedTemplateTweak]] - replaces TaggedTemplateTweak - 1/6/2009 05:19:00 by ELSDesignStudios
#[[TaggedTemplateTweakInfo]] - replaces TaggedTemplateTweakInfo - 3/29/2009 00:49:00 by JohnRouillard
#[[ExportTiddlersPlugin]] - replaces ExportTiddlersPlugin - 2/26/2009 15:21:00 by ELSDesignStudios
#[[ExportTiddlersPluginInfo]] - replaces ExportTiddlersPluginInfo - 2/26/2009 15:20:00 by ELSDesignStudios
#[[SaveAsPlugin]] - replaces SaveAsPlugin - 9/29/2008 11:12:00 by ELSDesignStudios
#[[SaveAsPluginInfo]] - replaces SaveAsPluginInfo - 9/29/2008 11:11:00 by ELSDesignStudios
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 4/24/2009 11:45:00 by ELSDesignStudios
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 4/24/2009 11:24:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Thursday, July 02, 2009 10:27:38 PM, JohnRouillard imported 1 tiddler from
[[http://visualtw.ouvaton.org/VisualTW.html|http://visualtw.ouvaton.org/VisualTW.html]]:
&lt;&lt;&lt;
#[[SyncFromSourcePlugin]] - replaces SyncFromSourcePlugin - 3/22/2009 21:58:00 by JohnRouillard
&lt;&lt;&lt;

----
On Thursday, July 02, 2009 10:21:26 PM, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#SectionLinksPlugin|http://www.tiddlytools.com/#SectionLinksPlugin]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 6/2/2009 18:02:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Tuesday, June 09, 2009 12:26:52, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#CompareTiddlersPlugin|http://www.tiddlytools.com/#CompareTiddlersPlugin]]:
&lt;&lt;&lt;
#[[CompareTiddlersPlugin]] - added
&lt;&lt;&lt;

----
On Tuesday, June 09, 2009 12:21:29, JohnRouillard imported 1 tiddler from
[[http://www.linux-lovers.be/RevisionsPlugin/#RevisionsPlugin|http://www.linux-lovers.be/RevisionsPlugin/#RevisionsPlugin]]:
&lt;&lt;&lt;
#[[RevisionsPlugin]] - added
&lt;&lt;&lt;

----
On Tuesday, June 02, 2009 22:36:25, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#SectionLinksPlugin|http://www.tiddlytools.com/#SectionLinksPlugin]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 4/23/2009 23:14:00 by JohnRouillard
&lt;&lt;&lt;

----
On Wednesday, May 27, 2009 21:18:01, JohnRouillard imported 2 tiddlers from
[[http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html|http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/SEC_ps.html]]:
&lt;&lt;&lt;
#[[StorySaverPlugin]] - replaces StorySaverPlugin - 4/24/2009 11:45:00 by ELSDesignStudios
#[[StorySaverPluginInfo]] - replaces StorySaverPluginInfo - 4/24/2009 11:24:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Wednesday, May 27, 2009 21:17:39, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com|http://www.tiddlytools.com]]:
&lt;&lt;&lt;
#[[StorySaverPlugin]] - added
#[[StorySaverPluginInfo]] - added
&lt;&lt;&lt;

----
On Friday, April 17, 2009 23:14:48, JohnRouillard imported 3 tiddlers from
[[http://www.TiddlyTools.com|http://www.TiddlyTools.com]]:
&lt;&lt;&lt;
#[[ImagePathList]] - added
#[[ImagePathPlugin]] - added
#[[ImageSizePlugin]] - added
&lt;&lt;&lt;

----
On Friday, April 17, 2009 22:34:10, JohnRouillard imported 1 tiddler from
[[http://www.TiddlyTools.com|http://www.TiddlyTools.com]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - replaces SectionLinksPlugin - 1/18/2009 12:17:00 by ELSDesignStudios
&lt;&lt;&lt;

----
On Thursday, April 16, 2009 00:16:38, JohnRouillard imported 2 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons.html|http://www.math.ist.utl.pt/~psoares/addons.html]]:
&lt;&lt;&lt;
#[[SlideShowPlugin]] - replaces SlideShowPlugin - 3/30/2009 17:03:00 by PauloSoares
#[[SlideShowPluginDoc]] - replaces SlideShowPluginDoc - 4/5/2009 14:02:00 by JohnRouillard
&lt;&lt;&lt;

----
On Saturday, April 04, 2009 22:28:45, JohnRouillard imported 2 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons.html|http://www.math.ist.utl.pt/~psoares/addons.html]]:
&lt;&lt;&lt;
#[[SlideShowPlugin]] - added
#[[SlideShowPluginDoc]] - replaces SlideShowPluginDoc - 3/26/2009 14:58:00 by PauloSoares
&lt;&lt;&lt;

----
On Monday, March 30, 2009 09:37:56, JohnRouillard imported 1 tiddler from
[[http://tiddlystyles.com/|http://tiddlystyles.com/]]:
&lt;&lt;&lt;
#[[RedirectMacro]] - added
&lt;&lt;&lt;

----
On Sunday, March 29, 2009 22:34:44, JohnRouillard imported 4 tiddlers from
[[C:\Documents and Settings\rouilj\Desktop\sec_class\SEC_tw.html|C:\Documents and Settings\rouilj\Desktop\sec_class\SEC_tw.html]]:
&lt;&lt;&lt;
#[[StudentSlideShowViewTemplate]] - replaces StudentSlideShowViewTemplate - 3/29/2009 21:59:00 by JohnRouillard
#[[SlideShowViewTemplate]] - replaces SlideShowViewTemplate - 3/29/2009 21:59:00 by JohnRouillard
#[[contentViewTemplate]] - replaces contentViewTemplate - 3/29/2009 19:26:00 by JohnRouillard
#[[OtherToolbarCommands]] - added
&lt;&lt;&lt;

----
On Sunday, March 29, 2009 19:32:26, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#TiddlerTweakerPlugin|http://www.tiddlytools.com/#TiddlerTweakerPlugin]]:
&lt;&lt;&lt;
#[[TiddlerTweakerPlugin]] - added
&lt;&lt;&lt;

----
On Sunday, March 29, 2009 12:18:38, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#UnsavedChangesPlugin|http://www.tiddlytools.com/#UnsavedChangesPlugin]]:
&lt;&lt;&lt;
#[[UnsavedChangesPlugin]] - added
&lt;&lt;&lt;

----
On Sunday, March 29, 2009 00:45:05, JohnRouillard imported 1 tiddler from
[[http://www.TiddlyTools.com/#TaggedTemplateTweakInfo|http://www.TiddlyTools.com/#TaggedTemplateTweakInfo]]:
&lt;&lt;&lt;
#[[TaggedTemplateTweakInfo]] - added
&lt;&lt;&lt;

----
On Sunday, March 29, 2009 00:26:42, JohnRouillard imported 1 tiddler from
[[http://www.tiddlywiki.com/coreplugins.html|http://www.tiddlywiki.com/coreplugins.html]]:
&lt;&lt;&lt;
#[[SparklinePlugin]] - added
&lt;&lt;&lt;

----
On Saturday, March 28, 2009 21:40:52, JohnRouillard imported 1 tiddler from
[[http://visualtw.ouvaton.org/VisualTW.html|http://visualtw.ouvaton.org/VisualTW.html]]:
&lt;&lt;&lt;
#[[TiddlersBarPlugin]] - added
&lt;&lt;&lt;

----
On Saturday, March 28, 2009 20:47:18, JohnRouillard imported 1 tiddler from
[[http://tw.lewcid.org/#TableSortingPlugin|http://tw.lewcid.org/#TableSortingPlugin]]:
&lt;&lt;&lt;
#[[TableSortingPlugin]] - added
&lt;&lt;&lt;

----
On Saturday, March 28, 2009 20:36:12, JohnRouillard imported 1 tiddler from
[[http://www.minormania.com/tiddlylock/tiddlylock.html|http://www.minormania.com/tiddlylock/tiddlylock.html]]:
&lt;&lt;&lt;
#[[TiddlyLockPlugin]] - added 
&lt;&lt;&lt;

----
On Saturday, March 28, 2009 20:19:40, JohnRouillard imported 1 tiddler from
[[http://mptw2.tiddlyspot.com/#Plugins|http://mptw2.tiddlyspot.com/#Plugins]]:
&lt;&lt;&lt;
#[[RefreshCommand]] - added
&lt;&lt;&lt;

----
On Saturday, March 28, 2009 20:11:12, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#RefreshTiddler|http://www.tiddlytools.com/#RefreshTiddler]]:
&lt;&lt;&lt;
#[[RefreshTiddler]] - added
&lt;&lt;&lt;

----
On Saturday, March 28, 2009 19:33:40, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#SectionLinksPlugin|http://www.tiddlytools.com/#SectionLinksPlugin]]:
&lt;&lt;&lt;
#[[SectionLinksPlugin]] - added
&lt;&lt;&lt;

----
On Thursday, March 26, 2009 23:02:31, JohnRouillard imported 2 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons.html|http://www.math.ist.utl.pt/~psoares/addons.html]]:
&lt;&lt;&lt;
#[[SlideShowPlugin]] - replaces SlideShowPlugin - 3/26/2009 22:43:00 by JohnRouillard
#[[SlideShowPluginDoc]] - replaces SlideShowPluginDoc - 3/25/2009 19:12:00 by PauloSoares
&lt;&lt;&lt;

----
On Thursday, March 26, 2009 00:13:39, JohnRouillard imported 2 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons.html|http://www.math.ist.utl.pt/~psoares/addons.html]]:
&lt;&lt;&lt;
#[[SlideShowPlugin]] - replaces SlideShowPlugin - 3/25/2009 15:38:00 by PauloSoares
#[[SlideShowPluginDoc]] - replaces SlideShowPluginDoc - 3/25/2009 16:04:00 by PauloSoares
&lt;&lt;&lt;

----
On Wednesday, March 25, 2009 19:06:36, JohnRouillard imported 2 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons.html|http://www.math.ist.utl.pt/~psoares/addons.html]]:
&lt;&lt;&lt;
#[[SlideShowPlugin]] - replaces SlideShowPlugin - 3/25/2009 15:38:00 by PauloSoares
#[[SlideShowPluginDoc]] - replaces SlideShowPluginDoc - 3/25/2009 16:04:00 by PauloSoares
&lt;&lt;&lt;

----
On Wednesday, March 25, 2009 18:55:09, JohnRouillard imported 5 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons.html|http://www.math.ist.utl.pt/~psoares/addons.html]]:
&lt;&lt;&lt;
#[[PrintingTheme]] - added
#[[SlideShowPlugin]] - replaces SlideShowPlugin - 3/22/2009 22:22:00 by JohnRouillard
#[[SlideShowPluginDoc]] - replaces SlideShowPluginDoc - 3/14/2009 12:02:00 by PauloSoares
#[[SlideShowTheme]] - added
#[[StudentTheme]] - added
&lt;&lt;&lt;

----
On Sunday, March 22, 2009 22:20:27, JohnRouillard imported 2 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons.html|http://www.math.ist.utl.pt/~psoares/addons.html]]:
&lt;&lt;&lt;
#[[SlideShowPlugin]] - replaces SlideShowPlugin - 3/21/2009 20:58:00 by JohnRouillard
#[[SlideShowPluginDoc]] - replaces SlideShowPluginDoc - 3/14/2009 12:02:00 by PauloSoares
&lt;&lt;&lt;

----
On Sunday, March 22, 2009 17:33:31, JohnRouillard imported 1 tiddler from
[[http://www.tiddlytools.com/#InlineJavascriptPlugin|http://www.tiddlytools.com/#InlineJavascriptPlugin]]:
&lt;&lt;&lt;
#[[InlineJavascriptPlugin]] - added
&lt;&lt;&lt;

----
On Sunday, March 22, 2009 17:08:31, JohnRouillard imported 1 tiddler from
[[http://tw.lewcid.org/#ToggleSideBarMacro|http://tw.lewcid.org/#ToggleSideBarMacro]]:
&lt;&lt;&lt;
#[[ToggleSideBarMacro]] - added
&lt;&lt;&lt;

----
On Sunday, March 22, 2009 00:29:19, JohnRouillard imported 6 tiddlers from
[[http://tiddlytools.com/|http://tiddlytools.com/]]:
&lt;&lt;&lt;
#[[AttachFileMIMETypes]] - added
#[[AttachFilePlugin]] - added
#[[AttachFilePluginFormatters]] - added
#[[AttachFilePluginInfo]] - added
#[[FileDropPlugin]] - added
#[[FileDropPluginConfig]] - added
&lt;&lt;&lt;

----
On Saturday, March 21, 2009 19:31:04, JohnRouillard imported 1 tiddler from
[[http://tiddlytools.com/|http://tiddlytools.com/]]:
&lt;&lt;&lt;
#[[CopyTiddlerPlugin]] - added
&lt;&lt;&lt;

----
On Saturday, March 21, 2009 18:41:06, JohnRouillard imported 1 tiddler from
[[http://tw.lewcid.org/|http://tw.lewcid.org/]]:
&lt;&lt;&lt;
#[[OpenTiddlersMacro]] - added
&lt;&lt;&lt;

----
On Thursday, March 19, 2009 21:50:24, JohnRouillard imported 1 tiddler from
[[http://devpad.tiddlyspot.com/#DcTableOfContentsPlugin|http://devpad.tiddlyspot.com/#DcTableOfContentsPlugin]]:
&lt;&lt;&lt;
#[[DcTableOfContentsPlugin]] - added
&lt;&lt;&lt;

----
On Tuesday, March 17, 2009 01:19:43, JohnRouillard imported 1 tiddler from
[[http://tw.lewcid.org/#OpenTiddlersMacro|http://tw.lewcid.org/#OpenTiddlersMacro]]:
&lt;&lt;&lt;
#[[OpenTiddlersMacro]] - added
&lt;&lt;&lt;

----
On Tuesday, March 17, 2009 00:12:59, JohnRouillard imported 1 tiddler from
[[http://tw.lewcid.org/#BetterTimelineMacro|http://tw.lewcid.org/#BetterTimelineMacro]]:
&lt;&lt;&lt;
#[[BetterTimelineMacro]] - added
&lt;&lt;&lt;

----
On Monday, March 16, 2009 23:08:31, JohnRouillard imported 2 tiddlers from
[[http://www.TiddlyTools.com|http://www.TiddlyTools.com]]:
&lt;&lt;&lt;
#[[NestedSlidersPlugin]] - added
#[[NestedSlidersPluginInfo]] - added
&lt;&lt;&lt;

----
On Monday, March 16, 2009 23:01:22, JohnRouillard imported 1 tiddler from
[[http://tiddlywiki.abego-software.de/#PartTiddlerPlugin|http://tiddlywiki.abego-software.de/#PartTiddlerPlugin]]:
&lt;&lt;&lt;
#[[PartTiddlerPlugin]] - added
&lt;&lt;&lt;

----
On Monday, March 16, 2009 22:33:01, JohnRouillard imported 3 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons_2.4.html|http://www.math.ist.utl.pt/~psoares/addons_2.4.html]]:
&lt;&lt;&lt;
#[[Quiz]] - added
#[[QuizzerPlugin]] - replaces QuizzerPlugin - 10/13/2007 17:17:00 by PauloSoares
#[[QuizzerPluginDoc]] - replaces QuizzerPluginDoc - 10/13/2007 17:16:00 by PauloSoares
&lt;&lt;&lt;

----
On Monday, March 16, 2009 22:19:29, JohnRouillard imported 2 tiddlers from
[[http://vextor.net/|http://vextor.net/]]:
&lt;&lt;&lt;
#[[QuizzerPlugin]] - added
#[[QuizzerPluginDoc]] - added
&lt;&lt;&lt;

----
On Monday, March 16, 2009 00:19:02, JohnRouillard imported 2 tiddlers from
[[http://www.math.ist.utl.pt/~psoares/addons.html|http://www.math.ist.utl.pt/~psoares/addons.html]]:
&lt;&lt;&lt;
#[[SlideShowPlugin]] - added
#[[SlideShowPluginDoc]] - added
&lt;&lt;&lt;

----
On Sunday, March 15, 2009 18:30:46, JohnRouillard imported 2 tiddlers from
[[http://www.tiddlytools.com/#GotoPlugin|http://www.tiddlytools.com/#GotoPlugin]]:
&lt;&lt;&lt;
#[[GotoPlugin]] - added
#[[GotoPluginInfo]] - added
&lt;&lt;&lt;

----
On Sunday, March 15, 2009 18:01:56, JohnRouillard imported 2 tiddlers from
[[http://tiddlytools.com|http://tiddlytools.com]]:
&lt;&lt;&lt;
#[[SwitchThemePlugin]] - added
#[[SwitchThemePluginInfo]] - added
&lt;&lt;&lt;

----
On Sunday, March 15, 2009 17:08:36, JohnRouillard imported 1 tiddler from
[[http://visualtw.ouvaton.org/VisualTW.html|http://visualtw.ouvaton.org/VisualTW.html]]:
&lt;&lt;&lt;
#[[FieldsEditorPlugin]] - added
&lt;&lt;&lt;

----
On Sunday, March 15, 2009 15:55:36, JohnRouillard imported 4 tiddlers from
[[http://tw.lewcid.org/|http://tw.lewcid.org/]]:
&lt;&lt;&lt;
#[[AnnotationsPlugin]] - added
#[[FontSizePlugin]] - added
#[[FootnotesPlugin]] - added
#[[TiddlerNotesPlugin]] - replaces TiddlerNotesPlugin - 10/26/2007 08:34:00 by Saq
&lt;&lt;&lt;

----
On Sunday, March 15, 2009 15:08:51, JohnRouillard imported 8 tiddlers from
[[C:\Documents and Settings\rouilj\My Documents\downloads\coreaddons.export.html|C:\Documents and Settings\rouilj\My Documents\downloads\coreaddons.export.html]]:
&lt;&lt;&lt;
#[[MatchTagsPlugin]] - added
#[[MatchTagsPluginInfo]] - added
#[[RSSReaderPlugin]] - added
#[[RSSReaderPluginDescription]] - added
#[[RSSReaderPluginDoc]] - added
#[[TaggedTemplateTweak]] - added
#[[TiddlerNotesPlugin]] - added
#[[YourSearchPlugin]] - added
&lt;&lt;&lt;

----
On Sunday, March 15, 2009 15:03:06, JohnRouillard imported 2 tiddlers from
[[http://tiddlywiki.abego-software.de|http://tiddlywiki.abego-software.de]]:
&lt;&lt;&lt;
#[[IntelliTaggerPlugin]] - added
#[[IntelliTagsEditCommandPlugin]] - added
&lt;&lt;&lt;

----
On Sunday, March 15, 2009 14:59:54, JohnRouillard imported 1 tiddler from
[[http://no-sin.com/wiki/WorkTracker.html#AlternateBackupPlugin|http://no-sin.com/wiki/WorkTracker.html#AlternateBackupPlugin]]:
&lt;&lt;&lt;
#[[AlternateBackupPlugin]] - added
&lt;&lt;&lt;

----
On Sunday, March 15, 2009 14:51:54, JohnRouillard imported 1 tiddler from
[[http://visualtw.ouvaton.org/VisualTW.html|http://visualtw.ouvaton.org/VisualTW.html]]:
&lt;&lt;&lt;
#[[SyncFromSourcePlugin]] - added
&lt;&lt;&lt;</pre>
</div>
<div title="Initial Download" modifier="JohnRouillard" created="200908292008" modified="200909041951" tags="InstructorOnly">
<pre>Instructions for emailing to people on how to download the coursebook and get it working.

Welcome to the SEC course. This course comes with a coursebook based
on ~TiddlyWiki. A ~TiddlyWiki is a single html file that uses
~JavaScript to make it into a wiki. The coursebook works best with
Firefox, but you can use it with some restrictions in Internet
Explorer (versions 7 and 8) as well as recent versions of Safari. Google
Chrome does not work as it is unable to import the content into the coursebook.

To set up your coursebook, browse to:

   &lt;&lt;tiddler &quot;GettingStarted::courseHome&quot; &gt;&gt;

Use the &quot;Save Link as&quot; functionality in your browser download the
~SEC_tw.html file. Do not load ~SEC_tw.html in your browser and then
try to save it using the File/Save mechanism, you must download the
link directly.

If you use a browser other than:
* Firefox (or a derivative)
* Internet Explorer
you must also download and save ~TiddlySaver.jar in the same directory
you saved ~SEC_tw.html.  This jar file allows you to save any notes
that you record in the coursebook.

If you use windows and a browser other than Firefox, one additional
step is needed. Use the file system explorer to find the ~SEC_tw.html
file. Right click on the file and pull up the properties menu. If you
see an unblock button (as in
http://tiddlywiki.org/wiki/How_To/Configure_your_browser_to_allow_saves_to_disk),
click on it and then dismiss the properties window. If you downloaded
the ~TiddlySaver.jar file you need to unblock it as well. Now you
should be able to open ~SEC_tw.html file and have it work correctly.

Depending on which browser you use, you may need to explicitly allow
the ~SEC_tw.hrml file to execute javascript. If you downloaded
~TiddlySaver.jar make sure that java is also enabled in your browser.
Once you have this you should see the GettingStarted page of the
coursebook.  Please follow the 4 step sequence to load content into
the coursebook and prepare it for use.


----

Also see: http://tiddlywiki.com/#ServicePack2Problems</pre>
</div>
<div title="InlineJavascriptPlugin" modifier="ELSDesignStudios" created="200512130544" modified="200904120517" tags="DiscoveryPackage IconPackage MediaPackage TaskPackage TidIDEPackage systemConfig ScrollbarPackage QuickEditPackage excludeMissing">
<pre>/***
|Name|InlineJavascriptPlugin|
|Source|http://www.TiddlyTools.com/#InlineJavascriptPlugin|
|Documentation|http://www.TiddlyTools.com/#InlineJavascriptPluginInfo|
|Version|1.9.5|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides||
|Description|Insert Javascript executable code directly into your tiddler content.|
''Call directly into TW core utility routines, define new functions, calculate values, add dynamically-generated TiddlyWiki-formatted output'' into tiddler content, or perform any other programmatic actions each time the tiddler is rendered.
!!!!!Documentation
&gt;see [[InlineJavascriptPluginInfo]]
!!!!!Revisions
&lt;&lt;&lt;
2009.04.11 [1.9.5] pass current tiddler object into wrapper code so it can be referenced from within 'onclick' scripts
2009.02.26 [1.9.4] in $(), handle leading '#' on ID for compatibility with JQuery syntax
|please see [[InlineJavascriptPluginInfo]] for additional revision details|
2005.11.08 [1.0.0] initial release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.InlineJavascriptPlugin= {major: 1, minor: 9, revision: 5, date: new Date(2009,4,11)};

config.formatters.push( {
	name: &quot;inlineJavascript&quot;,
	match: &quot;\\&lt;script&quot;,
	lookahead: &quot;\\&lt;script(?: src=\\\&quot;((?:.|\\n)*?)\\\&quot;)?(?: label=\\\&quot;((?:.|\\n)*?)\\\&quot;)?(?: title=\\\&quot;((?:.|\\n)*?)\\\&quot;)?(?: key=\\\&quot;((?:.|\\n)*?)\\\&quot;)?( show)?\\&gt;((?:.|\\n)*?)\\&lt;/script\\&gt;&quot;,

	handler: function(w) {
		var lookaheadRegExp = new RegExp(this.lookahead,&quot;mg&quot;);
		lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = lookaheadRegExp.exec(w.source)
		if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) {
			var src=lookaheadMatch[1];
			var label=lookaheadMatch[2];
			var tip=lookaheadMatch[3];
			var key=lookaheadMatch[4];
			var show=lookaheadMatch[5];
			var code=lookaheadMatch[6];
			if (src) { // external script library
				var script = document.createElement(&quot;script&quot;); script.src = src;
				document.body.appendChild(script); document.body.removeChild(script);
			}
			if (code) { // inline code
				if (show) // display source in tiddler
					wikify(&quot;{{{\n&quot;+lookaheadMatch[0]+&quot;\n}}}\n&quot;,w.output);
				if (label) { // create 'onclick' command link
					var link=createTiddlyElement(w.output,&quot;a&quot;,null,&quot;tiddlyLinkExisting&quot;,wikifyPlainText(label));
					var fixup=code.replace(/document.write\s*\(/gi,'place.bufferedHTML+=(');
					link.code=&quot;function _out(place,tiddler){&quot;+fixup+&quot;\n};_out(this,this.tiddler);&quot;
					link.tiddler=w.tiddler;
					link.onclick=function(){
						this.bufferedHTML=&quot;&quot;;
						try{ var r=eval(this.code);
							if(this.bufferedHTML.length || (typeof(r)===&quot;string&quot;)&amp;&amp;r.length)
								var s=this.parentNode.insertBefore(document.createElement(&quot;span&quot;),this.nextSibling);
							if(this.bufferedHTML.length)
								s.innerHTML=this.bufferedHTML;
							if((typeof(r)===&quot;string&quot;)&amp;&amp;r.length) {
								wikify(r,s,null,this.tiddler);
								return false;
							} else return r!==undefined?r:false;
						} catch(e){alert(e.description||e.toString());return false;}
					};
					link.setAttribute(&quot;title&quot;,tip||&quot;&quot;);
					var URIcode='javascript:void(eval(decodeURIComponent(%22(function(){try{';
					URIcode+=encodeURIComponent(encodeURIComponent(code.replace(/\n/g,' ')));
					URIcode+='}catch(e){alert(e.description||e.toString())}})()%22)))';
					link.setAttribute(&quot;href&quot;,URIcode);
					link.style.cursor=&quot;pointer&quot;;
					if (key) link.accessKey=key.substr(0,1); // single character only
				}
				else { // run script immediately
					var fixup=code.replace(/document.write\s*\(/gi,'place.innerHTML+=(');
					var c=&quot;function _out(place,tiddler){&quot;+fixup+&quot;\n};_out(w.output,w.tiddler);&quot;;
					try	 { var out=eval(c); }
					catch(e) { out=e.description?e.description:e.toString(); }
					if (out &amp;&amp; out.length) wikify(out,w.output,w.highlightRegExp,w.tiddler);
				}
			}
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
		}
	}
} )
//}}}

// // Backward-compatibility for TW2.1.x and earlier
//{{{
if (typeof(wikifyPlainText)==&quot;undefined&quot;) window.wikifyPlainText=function(text,limit,tiddler) {
	if(limit &gt; 0) text = text.substr(0,limit);
	var wikifier = new Wikifier(text,formatter,null,tiddler);
	return wikifier.wikifyPlain();
}
//}}}

// // GLOBAL FUNCTION: $(...) -- 'shorthand' convenience syntax for document.getElementById()
//{{{
if (typeof($)=='undefined') { function $(id) { return document.getElementById(id.replace(/^#/,'')); } }
//}}}</pre>
</div>
<div title="InlineJavascriptPluginInfo" modifier="ELSDesignStudios" created="200801081257" modified="200902262108" tags="pluginInfo excludeMissing">
<pre>/***
|Name|InlineJavascriptPluginInfo|
|Source|http://www.TiddlyTools.com/#InlineJavascriptPlugin|
|Documentation|http://www.TiddlyTools.com/#InlineJavascriptPluginInfo|
|Version|1.9.4|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|documentation|
|Requires||
|Overrides||
|Description|Documentation for InlineJavascriptPlugin|
''Call directly into TW core utility routines, define new functions, calculate values, add dynamically-generated TiddlyWiki-formatted output'' into tiddler content, or perform any other programmatic actions each time the tiddler is rendered.
!!!!!Usage
&lt;&lt;&lt;
This plugin adds wiki syntax for surrounding tiddler content with {{{&lt;script&gt;}}} and {{{&lt;/script&gt;}}} markers, so that it can be recognized as embedded javascript code.
&lt;script show&gt;
	/* javascript code goes here... */
&lt;/script&gt;Every time the tiddler content is rendered, the javascript code is automatically evaluated, allowing you to invoke 'side-effect' processing and/or produce dynamically-generated content that is then inserted into the tiddler content, immediately following the script (see below).  By including the optional ''show'' keyword as the final parameter in a {{{&lt;script&gt;}}} marker, the plugin will also include the script source code in the output that it displays in the tiddler.  This is helpful when creating examples for documentation purposes (such as used in this tiddler!)

__''Deferred execution from an 'onClick' link''__
&lt;script label=&quot;click here&quot; title=&quot;mouseover tooltip text&quot; key=&quot;X&quot; show&gt;
	/* javascript code goes here... */
	alert('you clicked on the link!');
&lt;/script&gt;
By including a {{{label=&quot;...&quot;}}} parameter in the initial {{{&lt;script&gt;}}} marker, the plugin will create a link to an 'onclick' script that will only be executed when that specific link is clicked, rather than running the script each time the tiddler is rendered.  You may also include a {{{title=&quot;...&quot;}}} parameter to specify the 'tooltip' text that will appear whenever the mouse is moved over the onClick link text, and a {{{key=&quot;X&quot;}}} parameter to specify an //access key// (which must be a //single// letter or numeric digit only).

__''Loading scripts from external source files''__
&lt;script src=&quot;URL&quot; show&gt;
	/* optional javascript code goes here... */
&lt;/script&gt;You can also load javascript directly from an external source URL, by including a src=&quot;...&quot; parameter in the initial {{{&lt;script&gt;}}} marker (e.g., {{{&lt;script src=&quot;demo.js&quot;&gt;&lt;/script&gt;}}}).  This is particularly useful when incorporating third-party javascript libraries for use in custom extensions and plugins.  The 'foreign' javascript code remains isolated in a separate file that can be easily replaced whenever an updated library file becomes available.

In addition to loading the javascript from the external file, you can also use this feature to invoke javascript code contained within the {{{&lt;script&gt;...&lt;/script&gt;}}} markers.  This code is invoked //after// the external script file has been processed, and can make immediate use of the functions and/or global variables defined by the external script file.
&gt;Note: To ensure that your javascript functions are always available when needed, you should load the libraries from a tiddler that is rendered as soon as your TiddlyWiki document is opened, such as MainMenu.  For example: put your {{{&lt;script src=&quot;...&quot;&gt;&lt;/script&gt;}}} syntax into a separate 'library' tiddler (e.g., LoadScripts), and then add {{{&lt;&lt;tiddler LoadScripts&gt;&gt;}}} to MainMenu so that the library is loaded before any other tiddlers that rely upon the functions it defines. 
&gt;
&gt;Normally, loading external javascript in this way does not produce any direct output, and should not have any impact on the appearance of your MainMenu.  However, if your LoadScripts tiddler contains notes or other visible content, you can suppress this output by using 'inline CSS' in the MainMenu, like this: {{{@@display:none;&lt;&lt;tiddler LoadScripts&gt;&gt;@@}}}
&lt;&lt;&lt;
!!!!!Creating dynamic tiddler content and accessing the ~TiddlyWiki DOM
&lt;&lt;&lt;
An important difference between TiddlyWiki inline scripting and conventional embedded javascript techniques for web pages is the method used to produce output that is dynamically inserted into the document: in a typical web document, you use the {{{document.write()}}} (or {{{document.writeln()}}}) function to output text sequences (often containing HTML tags) that are then rendered when the entire document is first loaded into the browser window.

However, in a ~TiddlyWiki document, tiddlers (and other DOM elements) are created, deleted, and rendered &quot;on-the-fly&quot;, so writing directly to the global 'document' object does not produce the results you want (i.e., replacing the embedded script within the tiddler content), and instead will //completely replace the entire ~TiddlyWiki document in your browser window (which is clearly not a good thing!)//.  In order to allow scripts to use {{{document.write()}}}, the plugin automatically converts and buffers all HTML output so it can be safely inserted into your tiddler content, immediately following the script.

''Note that {{{document.write()}}} can only be used to output &quot;pure HTML&quot; syntax.  To produce //wiki-formatted// output, your script should instead return a text value containing the desired wiki-syntax content'', which will then be automatically rendered immediately following the script.  If returning a text value is not sufficient for your needs, the plugin also provides an automatically-defined variable, 'place', that gives the script code ''direct access to the //containing DOM element//'' into which the tiddler output is being rendered.  You can use this variable to ''perform direct DOM manipulations'' that can, for example:
* generate wiki-formatted output using {{{wikify(&quot;...content...&quot;,place)}}}
* vary the script's actions based upon the DOM element in which it is embedded
* access 'tiddler-relative' DOM information using {{{story.findContainingTiddler(place)}}}
Note:
''When using an 'onclick' script, the 'place' element actually refers to the onclick //link text// itself, instead of the containing DOM element.''  This permits you to directly reference or modify the link text to reflect any 'stateful' conditions that might set by the script.  To refer to the containing DOM element from within an 'onclick' script, you can use &quot;place.parentNode&quot; instead.
&lt;&lt;&lt;
!!!!!Instant &quot;bookmarklets&quot;
&lt;&lt;&lt;
You can also use an 'onclick' link to define a &quot;bookmarklet&quot;: a small piece of javascript that can be ''invoked directly from the browser without having to be defined within the current document.''  This allows you to create 'stand-alone' commands that can be applied to virtually ANY TiddlyWiki document... even remotely-hosted documents that have been written by others!!  To create a bookmarklet, simply define an 'onclick' script and then grab the resulting link text and drag-and-drop it onto your browser's toolbar (or right-click and use the 'bookmark this link' command to add it to the browser's menu).

Notes:
*When writing scripts intended for use as bookmarklets, due to the ~URI-encoding required by the browser, ''you cannot not use ANY double-quotes (&quot;) within the bookmarklet script code.''
*All comments embedded in the bookmarklet script must ''use the fully-delimited {{{/* ... */}}} comment syntax,'' rather than the shorter {{{//}}} comment syntax.
*Most importantly, because bookmarklets are invoked directly from the browser interface and are not embedded within the TiddlyWiki document, there is NO containing 'place' DOM element surrounding the script.  As a result, ''you cannot use a bookmarklet to generate dynamic output in your document,''  and using {{{document.write()}}} or returning wiki-syntax text or making reference to the 'place' DOM element will halt the script and report a &quot;Reference Error&quot; when that bookmarklet is invoked.  
Please see [[InstantBookmarklets]] for many examples of 'onclick' scripts that can also be used as bookmarklets.
&lt;&lt;&lt;
!!!!!Special reserved function name
&lt;&lt;&lt;
The plugin 'wraps' all inline javascript code inside a function, {{{_out()}}}, so that any return value you provide can be correctly handled by the plugin and inserted into the tiddler.  To avoid unpredictable results (and possibly fatal execution errors), this function should never be redefined or called from ''within'' your script code.
&lt;&lt;&lt;
!!!!!$(...) 'shorthand' function
&lt;&lt;&lt;
As described by Dustin Diaz [[here|http://www.dustindiaz.com/top-ten-javascript/]], the plugin defines a 'shorthand' function that allows you to write:
{{{
$(id)
}}}
in place of the normal standard javascript syntax:
{{{
document.getElementById(id)
}}}
This function is provided merely as a convenience for javascript coders that may be familiar with this abbreviation, in order to allow them to save a few bytes when writing their own inline script code.
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
simple dynamic output:
&gt;&lt;script show&gt;
	document.write(&quot;The current date/time is: &quot;+(new Date())+&quot;&lt;br&gt;&quot;);
	return &quot;link to current user: [[&quot;+config.options.txtUserName+&quot;]]\n&quot;;
&lt;/script&gt;
dynamic output using 'place' to get size information for current tiddler:
&gt;&lt;script show&gt;
	if (!window.story) window.story=window;
	var title=story.findContainingTiddler(place).getAttribute(&quot;tiddler&quot;);
	var size=store.getTiddlerText(title).length;
	return title+&quot; is using &quot;+size+&quot; bytes&quot;;
&lt;/script&gt;
dynamic output from an 'onclick' script, using {{{document.write()}}} and/or {{{return &quot;...&quot;}}}
&gt;&lt;script label=&quot;click here&quot; show&gt;
	document.write(&quot;&lt;br&gt;The current date/time is: &quot;+(new Date())+&quot;&lt;br&gt;&quot;);
	return &quot;link to current user: [[&quot;+config.options.txtUserName+&quot;]]\n&quot;;
&lt;/script&gt;
creating an 'onclick' button/link that accesses the link text AND the containing tiddler:
&gt;&lt;script label=&quot;click here&quot; title=&quot;clicking this link will show an 'alert' box&quot; key=&quot;H&quot; show&gt;
	if (!window.story) window.story=window;
	var txt=place.firstChild.data;
	var tid=story.findContainingTiddler(place).getAttribute('tiddler');
	alert('Hello World!\nlinktext='+txt+'\ntiddler='+tid);
&lt;/script&gt;
dynamically setting onclick link text based on stateful information:
&gt;{{block{
{{{
&lt;script label=&quot;click here&quot;&gt;
	/* toggle &quot;txtSomething&quot; value */
	var on=(config.txtSomething==&quot;ON&quot;);
	place.innerHTML=on?&quot;enable&quot;:&quot;disable&quot;;
	config.txtSomething=on?&quot;OFF&quot;:&quot;ON&quot;;
	return &quot;\nThe current value is: &quot;+config.txtSomething;
&lt;/script&gt;&lt;script&gt;
	/* initialize onclick link text based on current &quot;txtSomething&quot; value */
	var on=(config.txtSomething==&quot;ON&quot;);
	place.lastChild.previousSibling.innerHTML=on?&quot;disable&quot;:&quot;enable&quot;;
&lt;/script&gt;
}}}
&lt;script label=&quot;click here&quot;&gt;
	/* toggle &quot;txtSomething&quot; value */
	var on=(config.txtSomething==&quot;ON&quot;);
	place.innerHTML=on?&quot;enable&quot;:&quot;disable&quot;;
	config.txtSomething=on?&quot;OFF&quot;:&quot;ON&quot;;
	return &quot;\nThe current value is: &quot;+config.txtSomething;
&lt;/script&gt;&lt;script&gt;
	/* initialize onclick link text based on current &quot;txtSomething&quot; value */
	var on=(config.txtSomething==&quot;ON&quot;);
	place.lastChild.innerHTML=on?&quot;enable&quot;:&quot;disable&quot;;
&lt;/script&gt;
}}}
loading a script from a source url:
&gt;http://www.TiddlyTools.com/demo.js contains:
&gt;&gt;{{{function inlineJavascriptDemo() { alert('Hello from demo.js!!') } }}}
&gt;&gt;{{{displayMessage('InlineJavascriptPlugin: demo.js has been loaded');}}}
&gt;note: When using this example on your local system, you will need to download the external script file from the above URL and install it into the same directory as your document.
&gt;
&gt;&lt;script src=&quot;demo.js&quot; show&gt;
	return &quot;inlineJavascriptDemo() function has been defined&quot;
&lt;/script&gt;
&gt;&lt;script label=&quot;click to invoke inlineJavascriptDemo()&quot; key=&quot;D&quot; show&gt;
	inlineJavascriptDemo();
&lt;/script&gt;
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.02.26 [1.9.4] in $(), handle leading '#' on ID for compatibility with JQuery syntax
2008.06.11 [1.9.3] added $(...) function as 'shorthand' for document.getElementById()
2008.03.03 [1.9.2] corrected fallback declaration of wikifyPlainText() (fixes Safari &quot;parse error&quot;)
2008.02.23 [1.9.1] in onclick function, use string instead of array for 'bufferedHTML' (fixes IE errors)
2008.02.21 [1.9.0] output from 'onclick' scripts (return value or document.write() calls) are now buffered and rendered into into a span following the script.  Also, added default 'return false' handling if no return value provided (prevents HREF from being triggered -- return TRUE to allow HREF to be processed).  Thanks to Xavier Verges for suggestion and preliminary code.
2008.02.14 [1.8.1] added backward-compatibility for use of wikifyPlainText() in TW2.1.3 and earlier
2008.01.08 [*.*.*] plugin size reduction: documentation moved to ...Info tiddler
2007.12.28 [1.8.0] added support for key=&quot;X&quot; syntax to specify custom access key definitions
2007.12.15 [1.7.0] autogenerate URI encoded HREF on links for onclick scripts.  Drag links to browser toolbar to create bookmarklets.  IMPORTANT NOTE: place is NOT defined when scripts are used as bookmarklets.  In addition, double-quotes will cause syntax errors.  Thanks to PaulReiber for debugging and brainstorming.
2007.11.26 [1.6.2] when converting &quot;document.write()&quot; function calls in inline code, allow whitespace between &quot;write&quot; and &quot;(&quot; so that &quot;document.write ( foobar )&quot; is properly converted.
2007.11.16 [1.6.1] when rendering &quot;onclick scripts&quot;, pass label text through wikifyPlainText() to parse any embedded wiki-syntax to enable use of HTML entities or even TW macros to generate dynamic label text.
2007.02.19 [1.6.0] added support for title=&quot;...&quot; to specify mouseover tooltip when using an onclick (label=&quot;...&quot;) script
2006.10.16 [1.5.2] add newline before closing '}' in 'function out_' wrapper.  Fixes error caused when last line of script is a comment.
2006.06.01 [1.5.1] when calling wikify() on script return value, pass hightlightRegExp and tiddler params so macros that rely on these values can render properly
2006.04.19 [1.5.0] added 'show' parameter to force display of javascript source code in tiddler output
2006.01.05 [1.4.0] added support 'onclick' scripts.  When label=&quot;...&quot; param is present, a button/link is created using the indicated label text, and the script is only executed when the button/link is clicked.  'place' value is set to match the clicked button/link element.
2005.12.13 [1.3.1] when catching eval error in IE, e.description contains the error text, instead of e.toString().  Fixed error reporting so IE shows the correct response text.  Based on a suggestion by UdoBorkowski
2005.11.09 [1.3.0] for 'inline' scripts (i.e., not scripts loaded with src=&quot;...&quot;), automatically replace calls to 'document.write()' with 'place.innerHTML+=' so script output is directed into tiddler content.  Based on a suggestion by BradleyMeck
2005.11.08 [1.2.0] handle loading of javascript from an external URL via src=&quot;...&quot; syntax
2005.11.08 [1.1.0] pass 'place' param into scripts to provide direct DOM access 
2005.11.08 [1.0.0] initial release
&lt;&lt;&lt;</pre>
</div>
<div title="Instructor book can publish documents" modifier="YourName" created="201007251954" tags="slide content">
<pre>* Student book without contents (framework)
** Meant to be portable for multiple classes.
* Student content to be imported
** Imported into framework to allow separation of framework updates from content updates
** Content updates are smaller than the whole TiddlyWiki
* rss feed of content changes</pre>
</div>
<div title="Instructor has tools for improving editing/creation" modifier="YourName" created="201007251947" modified="201007251948" tags="slide content">
<pre>* Tool for mass editing of tiddlers, tags
* Tool for maintaining different versions of tiddlers
* Tools for embedding/attaching files inside TiddlyWiki document
* Tool for showing relations between tiddlers
* Tool for easier tag management
* Configuration that displays missing tiddlers rather then replacing with nothing
* Double click to edit a tiddler is enabled</pre>
</div>
<div title="Instructor tiddlywiki has themes for presentations" modifier="YourName" created="201007251950" tags="slide content">
<pre>* The instructor book has theme(s) meant for pretty display.
** It can include images, gradients and is all css controlled.
* The student book has a stripped down presentation mode and navigation/note taking interface
</pre>
</div>
<div title="InstructorFunctions" modifier="JohnRouillard" created="200903152135" modified="201007050401" tags="InstructorOnly excludeMissing">
<pre>&lt;&lt;tiddler ChangeTitle##Script&gt;&gt;

&lt;&lt;tiddler SwitchContent with: 'Switch to alternate urls'  'GettingStarted - LISA'  'GettingStarted'&gt;&gt;
&lt;&lt;saveAs &quot;label:save studentbook&quot; &quot;filename:CoursebookV2_student.html&quot; &quot;type:TiddlyWiki&quot; not (content or structure or InstructorOnly or Notes or Revisions or nopublish or systemConfigDisable or temporary)&gt;&gt;
&lt;&lt;saveAs &quot;label:save content&quot; &quot;filename:CoursebookV2_content_ps.html&quot; &quot;type:PureStore&quot; not (nopublish or InstructorOnly or bblisaOnly) and (content or structure)&gt;&gt;
&lt;&lt;saveAs &quot;label:save rss for content&quot; &quot;filename:CoursebookV2_rss.xml&quot; &quot;type:NewsFeed&quot; &quot;limit:30&quot; not (nopublish or InstructorOnly or bblisaOnly) and (content or structure)&gt;&gt;
</pre>
</div>
<div title="InstructorMainMenu" modifier="JohnRouillard" created="200908260427" modified="200910102002" tags="InstructorOnly">
<pre>&lt;&lt;tiddler ToggleFullScreen with: &quot;Toggle Fullscreen&quot;&gt;&gt;
--------
&lt;&lt;tiddler ShowPopup with: [[ReadMe/taglist]] &quot;Defined Tags&quot; &quot;Show tags with predfined meaning in this tiddlywiki.&quot; &gt;&gt;
--------
[[Bugs And Feature Requests]]
[[Content Bugs]]
--------</pre>
</div>
<div title="InstructorOnly" modifier="JohnRouillard" created="200904170353" modified="200907050413" tags="InstructorOnly">
<pre>Tiddlers tagged with this wiki word are not exported to the student tiddlywiki.</pre>
</div>
<div title="InstructorSidebarFunctions" modifier="JohnRouillard" created="200903152135" modified="201008011932" tags="InstructorOnly excludeMissing">
<pre>&lt;&lt;tiddler ChangeTitle##Script&gt;&gt;

&lt;&lt;tiddler SwitchContent with: 'Switch to alternate urls'  'GettingStarted - LISA'  'GettingStarted'&gt;&gt;
&lt;&lt;saveAs &quot;label:save studentbook&quot; &quot;filename:CoursebookV2_student.html&quot; &quot;type:TiddlyWiki&quot; not (content or structure or InstructorOnly or Notes or Revisions or nopublish or systemConfigDisable or temporary)&gt;&gt;
&lt;&lt;saveAs &quot;label:save content&quot; &quot;filename:CoursebookV2_content_ps.html&quot; &quot;type:PureStore&quot; not (nopublish or InstructorOnly or bblisaOnly) and (content or structure)&gt;&gt;
&lt;&lt;saveAs &quot;label:save rss for content&quot; &quot;filename:CoursebookV2_rss.xml&quot; &quot;type:NewsFeed&quot; &quot;limit:30&quot; not (nopublish or InstructorOnly or bblisaOnly) and (content or structure)&gt;&gt;
/%
!newTiddlers
&lt;&lt;newTiddler title:&quot;New Chapter  1 -&quot; tag:chapter tag:content tag:story label:&quot;new chapter tiddler&quot; prompt:&quot;Create a new chapter tiddler.&quot;&gt;&gt;&lt;&lt;newTiddler tag:content label:&quot;new content tiddler&quot; prompt:&quot;Create a new content tiddler.&quot;&gt;&gt;&lt;&lt;newTiddler title:&quot;New Presentation  1 - &quot; tag:presentation tag:content tag:story label:&quot;new presentation tiddler&quot; prompt:&quot;Create a new presentation tiddler.&quot;&gt;&gt;&lt;&lt;newTiddler title:&quot;New Slide&quot; tag:slide tag:content label:&quot;new slide tiddler&quot; prompt:&quot;Create a new slide tiddler.&quot;&gt;&gt;
!end
%/</pre>
</div>
<div title="InstructorSiteStartup" modifier="JohnRouillard" created="200908260423" modified="200908260435" tags="InstructorOnly">
<pre>/% transclude these tiddlers for their side effects. defining aliases and defining ability to toggle fullscreen %/
/% shortcuts to bugs/features %/
&lt;&lt;redirectExact Bugs [[Bugs And Feature Requests]]&gt;&gt;
&lt;&lt;redirectExact Features [[Bugs And Feature Requests]]&gt;&gt;</pre>
</div>
<div title="InstructorSlideShowStyleSheet" modifier="JohnRouillard" created="200903152211" modified="201007051850" tags="InstructorOnly excludeStory">
<pre>/*{{{*/

body {
  background-image: url('[[LeftGradientImageBlue]]');
  background-repeat: repeat-y;
  color: #000;
}

/* Start Shadow style sheet */
.header, #mainMenu, #sidebar, #backstageButton, #backstageArea, .toolbar, .title, .subtitle, .tagging, .tagged, .tagClear, .comment{
 display:none !important
}

#slideBlanker{
 position: absolute;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
 z-index: 90; 
 background-color: #000;
 opacity: 1.0;
 filter: alpha(opacity=100)
}

.nextOverlay{
 visibility: hidden
}

.previousOverlay,.currentOverlay{
 visibility: visible
}

#displayArea{
 font-size: 250%;
 margin: 0 !important;
 padding: 0
}

#controlBar{
 position: fixed;
 bottom: 2px;
 right: 2px;
 width: 100%;
 text-align: right
}

#controlBar .button{
 margin: 0 0.25em;
 padding: 0 0.25em
}

#slideHeader{
 font-size: 200%;
 font-weight: bold
}

#slideFooter{
 position: fixed;
 bottom: 2px
}

.slideFooterOff #navigator{
 visibility: hidden
}

#slideClock{
 margin: 0 5px 0 5px
}

#slideCounter{
 cursor: pointer;
 color: #aaa
}

#toc{
 display: none;
 position: absolute;
 font-size: .75em;
 bottom: 2em;
 right: 0;
 background: #fff;
 border: 1px solid #000;
 text-align: left
}

#jumpItem{
 padding-left:0.25em
}

#jumpInput{
 margin-left: 0.25em;
 width: 3em
}

.tocLevel1{
 font-size: .8em
}

.tocLevel2{
 margin-left: 1em;
 font-size: .75em
}

.tocLevel3{
 margin-left: 2em;
 font-size: .7em
}

.tocLevel4{
 margin-left: 3em;
 font-size: .65em
}

.tocLevel5{
 margin-left: 4em;
 font-size: .6em
}

.tocLevel6{
 margin-left: 5em;
 font-size: .55em
}

/* local changes for coursebook */

body {
cursor: crosshair;
}

/* set to 180% for 800x600 screen */
/*
#displayArea {
 font-size: 180%;
}
*/

/* change this to match the left border width to move the text out of the border */
.tiddler {
  margin-left: 100px !important;
}

#slideHeader {
 color: #0000BB;
 font-size: 50% !important;
 text-align: right;
}

#tiddlerDisplay {
margin-left: 0em;
margin-right: 0em;
padding: 0 !important;
}

/* background color matches the righthand gradient color. */
.title {
 color: #000000;
 border-bottom-style: outset;
 display: block !important;
 background-color: #B6B4FC;
 cursor:none;
}

.tiddler {
padding: 0px !important;
}

.viewer {
padding-left: 0.5em !important;
padding-right: 0.5em !important;
line-height: 1.2em;
}

/* tiddler content styles */
h1, h2, h3 {border-bottom: 0px}

.viewer ul, .viewer ol, .viewer dl{
margin: 0em !important;
}

.viewer code {
 font-weight: bold;
}

.viewer pre {
line-height: normal;
}

/* custom styles for 2 column layout */
.col2a {width:45%; float:left;}
.col2b {width:45%; float:left;}

/* custom syles for three column layout */
.col3a {width:32%; float:left;}
.col3b {width:32%; float:left;}
.col3c {width:32%; float:left;}

#slideFooter{
 font-size: 43%;
}

#toc{
 display: none;
 position: absolute;
 font-size: .75em;
 top: auto;
 bottom: 2em;
 right: 0em;
 background: #888;
 border: 1px solid #000;
 text-align: left;
}

/* navigator not always visible */
.slideFooterOff #navigator{
 visibility: hidden; 
}

/* do not display comments or notes */
#contentWrapper.slideShowMode .comment{
 display: none !important;
}

.notes{
 display: none !important;
}
/*}}}*/</pre>
</div>
<div title="InstructorSlideShowStyleSheet2" modifier="JohnRouillard" created="200910120237" modified="200910311452" tags="InstructorOnly excludeStory">
<pre>/*{{{*/

body {
  background-image: url('[[LeftGradientImageBlue]]');
  background-repeat: repeat-y;
  color: #000;
}

/* Start Shadow style sheet */
.header, #mainMenu, #sidebar, #backstageButton, #backstageArea, .toolbar, .title, .subtitle, .tagging, .tagged, .tagClear, .comment{
 display:none !important
}

#slideBlanker{
 position: absolute;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
 z-index: 90; 
 background-color: #000;
 opacity: 1.0;
 filter: alpha(opacity=100)
}

.nextOverlay{
 visibility: hidden
}

.previousOverlay,.currentOverlay{
 visibility: visible
}

#displayArea{
 font-size: 250%;
 margin: 0 !important;
 padding: 0
}

#controlBar{
 position: fixed;
 bottom: 2px;
 right: 2px;
 width: 100%;
 text-align: right
}

#controlBar .button{
 margin: 0 0.25em;
 padding: 0 0.25em
}

#slideHeader{
 font-size: 200%;
 font-weight: bold
}

#slideFooter{
 position: fixed;
 bottom: 2px
}

.slideFooterOff #navigator{
 visibility: hidden
}

#slideClock{
 margin: 0 5px 0 5px;
 visibility: visible;
}

#slideCounter{
 cursor: pointer;
 color: #aaa
}

#toc{
 display: none;
 position: absolute;
 font-size: .75em;
 bottom: 2em;
 right: 0;
 background: #fff;
 border: 1px solid #000;
 text-align: left
}

#jumpItem{
 padding-left:0.25em
}

#jumpInput{
 margin-left: 0.25em;
 width: 3em
}

.tocLevel1{
 font-size: .8em
}

.tocLevel2{
 margin-left: 1em;
 font-size: .75em
}

.tocLevel3{
 margin-left: 2em;
 font-size: .7em
}

.tocLevel4{
 margin-left: 3em;
 font-size: .65em
}

.tocLevel5{
 margin-left: 4em;
 font-size: .6em
}

.tocLevel6{
 margin-left: 5em;
 font-size: .55em
}

/* local changes for coursebook */

body {
cursor: crosshair;
}

/* set to 180% for 800x600 screen */
/*
#displayArea {
 font-size: 180%;
}
*/

/* change this to match the left border width to move the text out of the border */
.tiddler {
  margin-left: 100px !important;
}

#slideHeader {
 color: #FFFFFF;
 font-size: 50% !important;
 text-align: right;
 background-color: #3533BA;
}

#tiddlerDisplay {
margin-left: 0em;
margin-right: 0em;
padding: 0 !important;
}

/* background color matches the righthand gradient color. */
.title {
 color: #000000;
 border-bottom-style: outset;
 display: block !important;
 background-color: #B6B4FC;
 cursor:none;
 z-index: 20;
}

.tiddler {
padding: 0px !important;
}

.viewer {
padding-left: 0.5em !important;
padding-right: 0.5em !important;
line-height: 1.2em;
}

/* tiddler content styles */
h1, h2, h3 {border-bottom: 0px}

.viewer ul, .viewer ol, .viewer dl{
margin: 0em !important;
}

.viewer code {
 font-weight: bold;
}

.viewer pre {
line-height: normal;
}

/* custom styles for 2 column layout */
.col2a {width:45%; float:left;}
.col2b {width:45%; float:left;}

/* custom syles for three column layout */
.col3a {width:32%; float:left;}
.col3b {width:32%; float:left;}
.col3c {width:32%; float:left;}

#slideFooter{
 font-size: 43%;
}

#toc{
 display: none;
 position: absolute;
 font-size: .75em;
 top: auto;
 bottom: 2em;
 right: 0em;
 background: #888;
 border: 1px solid #000;
 text-align: left;
}

/* navigator not always visible */
.slideFooterOff #navigator{
 visibility: hidden; 
}

/* do not display comments or notes */
#contentWrapper.slideShowMode .comment{
 display: none !important;
}

.notes{
 display: none !important;
}
/*}}}*/</pre>
</div>
<div title="InstructorSlideShowStyleSheet3" modifier="YourName" created="201007112313" modified="201007112329" tags="InstructorOnly excludeStory">
<pre>/*{{{*/

body {
  background-image: url('[[LeftGradientImageBlue]]');
  background-repeat: repeat-y;
  color: #000;
}

/* Start Shadow style sheet */
.header, #mainMenu, #sidebar, #backstageButton, #backstageArea, .toolbar, .title, .subtitle, .tagging, .tagged, .tagClear, .comment{
 display:none !important
}

#slideBlanker{
 position: absolute;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
 z-index: 90; 
 background-color: #000;
 opacity: 1.0;
 filter: alpha(opacity=100)
}

.nextOverlay{
 visibility: hidden
}

.previousOverlay,.currentOverlay{
 visibility: visible
}

#displayArea{
 font-size: 250%;
 margin: 0 !important;
 padding: 0
}

#controlBar{
 position: fixed;
 bottom: 2px;
 right: 2px;
 width: 100%;
 text-align: right
}

#controlBar .button{
 margin: 0 0.25em;
 padding: 0 0.25em
}

#slideHeader{
 font-size: 200%;
 font-weight: bold
}

#slideFooter{
 position: fixed;
 bottom: 2px
}

.slideFooterOff #navigator{
 visibility: hidden
}

#slideClock{
 margin: 0 5px 0 5px;
 visibility: visible;
}

#slideCounter{
 cursor: pointer;
 color: #aaa
}

#toc{
 display: none;
 position: absolute;
 font-size: .75em;
 bottom: 2em;
 right: 0;
 background: #fff;
 border: 1px solid #000;
 text-align: left
}

#jumpItem{
 padding-left:0.25em
}

#jumpInput{
 margin-left: 0.25em;
 width: 3em
}

.tocLevel1{
 font-size: .8em
}

.tocLevel2{
 margin-left: 1em;
 font-size: .75em
}

.tocLevel3{
 margin-left: 2em;
 font-size: .7em
}

.tocLevel4{
 margin-left: 3em;
 font-size: .65em
}

.tocLevel5{
 margin-left: 4em;
 font-size: .6em
}

.tocLevel6{
 margin-left: 5em;
 font-size: .55em
}

/* local changes for coursebook */

body {
cursor: crosshair;
}

/* set to 180% for 800x600 screen */
/*
#displayArea {
 font-size: 180%;
}
*/

/* change this to match the left border width to move the text out of the border */
.tiddler {
  margin-left: 100px !important;
}

#slideHeader {
 color: #FFFFFF;
 font-size: 50% !important;
 text-align: right;
 background-color: #3533BA;
}

#tiddlerDisplay {
margin-left: 0em;
margin-right: 0em;
padding: 0 !important;
}

/* background color matches the righthand gradient color. */
.title {
 color: #000000;
 border-bottom-style: outset;
 display: block !important;
 background-color: #B6B4FC;
 cursor:none;
 z-index: 20;
display: none !important
}

.tiddler {
padding: 0px !important;
}

.viewer {
padding-left: 0.5em !important;
padding-right: 0.5em !important;
line-height: 1.2em;
}

/* tiddler content styles */
h1, h2, h3 {border-bottom: 0px}

.viewer ul, .viewer ol, .viewer dl{
margin: 0em !important;
}

.viewer code {
 font-weight: bold;
}

.viewer pre {
line-height: normal;
}

/* custom styles for 2 column layout */
.col2a {width:45%; float:left;}
.col2b {width:45%; float:left;}

/* custom syles for three column layout */
.col3a {width:32%; float:left;}
.col3b {width:32%; float:left;}
.col3c {width:32%; float:left;}

#slideFooter{
 font-size: 43%;
}

#toc{
 display: none;
 position: absolute;
 font-size: .75em;
 top: auto;
 bottom: 2em;
 right: 0em;
 background: #888;
 border: 1px solid #000;
 text-align: left;
}

/* navigator not always visible */
.slideFooterOff #navigator{
 visibility: hidden; 
}

/* do not display comments or notes */
#contentWrapper.slideShowMode .comment{
 display: none !important;
}

.notes{
 display: none !important;
}
/*}}}*/</pre>
</div>
<div title="InstructorStyleSheetDisabled" modifier="JohnRouillard" created="200908221943" modified="200910311940" tags="InstructorOnly excludeOrphans">
<pre>/*{{{*/
/* Make bad links very obvious */
.tiddlyLinkNonExistingSection {font-size: 200%; background-color: orange; }
.tiddlyLinkNonExisting {font-size: 200%; background-color: green; }
.tiddlyLinkNonExisting.shadow {font-size: 100%; background-color: transparent; }

/* Make it easier to see comment in slides when shown in story column */
.comment{
 border: 1pt dashed;
 padding: 0.5em;
}
/*}}}*/
</pre>
</div>
<div title="IntelliTaggerPlugin" modifier="UdoBorkowski" created="200604260721" modified="200707251213" tags="systemConfig excludeMissing">
<pre>/***
|''Name:''|IntelliTaggerPlugin|
|''Version:''|1.0.2 (2007-07-25)|
|''Type:''|plugin|
|''Source:''|http://tiddlywiki.abego-software.de/#IntelliTaggerPlugin|
|''Author:''|Udo Borkowski (ub [at] abego-software [dot] de)|
|''Documentation:''|[[IntelliTaggerPlugin Documentation]]|
|''~SourceCode:''|[[IntelliTaggerPlugin SourceCode]]|
|''Licence:''|[[BSD open source license (abego Software)]]|
|''~CoreVersion:''|2.0.8|
|''Browser:''|Firefox 1.5.0.2 or better|
***/
/***
!Version History
* 1.0.2 (2007-07-25): 
** Feature: &quot;Return&quot; key may be used to accept first tag suggestion (beside &quot;Alt-1&quot;)
** Bugfix: Keyboard shortcuts (Alt+3 etc.) shifted
* 1.0.1 (2007-05-18): Improvement: Speedup when using TiddlyWikis with many tags
* 1.0.0 (2006-04-26): Initial release

***/
// /%
if(!version.extensions.IntelliTaggerPlugin){if(!window.abego){window.abego={};}if(!abego.internal){abego.internal={};}abego.alertAndThrow=function(s){alert(s);throw s;};if(version.major&lt;2){abego.alertAndThrow(&quot;Use TiddlyWiki 2.0.8 or better to run the IntelliTagger Plugin.&quot;);}version.extensions.IntelliTaggerPlugin={major:1,minor:0,revision:2,date:new Date(2007,6,25),type:&quot;plugin&quot;,source:&quot;http://tiddlywiki.abego-software.de/#IntelliTaggerPlugin&quot;,documentation:&quot;[[IntelliTaggerPlugin Documentation]]&quot;,sourcecode:&quot;[[IntelliTaggerPlugin SourceCode]]&quot;,author:&quot;Udo Borkowski (ub [at] abego-software [dot] de)&quot;,licence:&quot;[[BSD open source license (abego Software)]]&quot;,tiddlywiki:&quot;Version 2.0.8 or better&quot;,browser:&quot;Firefox 1.5.0.2 or better&quot;};abego.createEllipsis=function(_2){var e=createTiddlyElement(_2,&quot;span&quot;);e.innerHTML=&quot;&amp;hellip;&quot;;};abego.isPopupOpen=function(_4){return _4&amp;&amp;_4.parentNode==document.body;};abego.openAsPopup=function(_5){if(_5.parentNode!=document.body){document.body.appendChild(_5);}};abego.closePopup=function(_6){if(abego.isPopupOpen(_6)){document.body.removeChild(_6);}};abego.getWindowRect=function(){return {left:findScrollX(),top:findScrollY(),height:findWindowHeight(),width:findWindowWidth()};};abego.moveElement=function(_7,_8,_9){_7.style.left=_8+&quot;px&quot;;_7.style.top=_9+&quot;px&quot;;};abego.centerOnWindow=function(_a){if(_a.style.position!=&quot;absolute&quot;){throw &quot;abego.centerOnWindow: element must have absolute position&quot;;}var _b=abego.getWindowRect();abego.moveElement(_a,_b.left+(_b.width-_a.offsetWidth)/2,_b.top+(_b.height-_a.offsetHeight)/2);};abego.isDescendantOrSelf=function(_c,e){while(e){if(_c==e){return true;}e=e.parentNode;}return false;};abego.toSet=function(_e){var _f={};for(var i=0;i&lt;_e.length;i++){_f[_e[i]]=true;}return _f;};abego.filterStrings=function(_11,_12,_13){var _14=[];for(var i=0;i&lt;_11.length&amp;&amp;(_13===undefined||_14.length&lt;_13);i++){var s=_11[i];if(s.match(_12)){_14.push(s);}}return _14;};abego.arraysAreEqual=function(a,b){if(!a){return !b;}if(!b){return false;}var n=a.length;if(n!=b.length){return false;}for(var i=0;i&lt;n;i++){if(a[i]!=b[i]){return false;}}return true;};abego.moveBelowAndClip=function(_1b,_1c){if(!_1c){return;}var _1d=findPosX(_1c);var _1e=findPosY(_1c);var _1f=_1c.offsetHeight;var _20=_1d;var _21=_1e+_1f;var _22=findWindowWidth();if(_22&lt;_1b.offsetWidth){_1b.style.width=(_22-100)+&quot;px&quot;;}var _23=_1b.offsetWidth;if(_20+_23&gt;_22){_20=_22-_23-30;}if(_20&lt;0){_20=0;}_1b.style.left=_20+&quot;px&quot;;_1b.style.top=_21+&quot;px&quot;;_1b.style.display=&quot;block&quot;;};abego.compareStrings=function(a,b){return (a==b)?0:(a&lt;b)?-1:1;};abego.sortIgnoreCase=function(arr){var _27=[];var n=arr.length;for(var i=0;i&lt;n;i++){var s=arr[i];_27.push([s.toString().toLowerCase(),s]);}_27.sort(function(a,b){return (a[0]==b[0])?0:(a[0]&lt;b[0])?-1:1;});for(i=0;i&lt;n;i++){arr[i]=_27[i][1];}};abego.getTiddlerField=function(_2d,_2e,_2f){var _30=document.getElementById(_2d.idPrefix+_2e);var e=null;if(_30!=null){var _32=_30.getElementsByTagName(&quot;*&quot;);for(var t=0;t&lt;_32.length;t++){var c=_32[t];if(c.tagName.toLowerCase()==&quot;input&quot;||c.tagName.toLowerCase()==&quot;textarea&quot;){if(!e){e=c;}if(c.getAttribute(&quot;edit&quot;)==_2f){e=c;}}}}return e;};abego.setRange=function(_35,_36,end){if(_35.setSelectionRange){_35.setSelectionRange(_36,end);var max=0+_35.scrollHeight;var len=_35.textLength;var top=max*_36/len,bot=max*end/len;_35.scrollTop=Math.min(top,(bot+top-_35.clientHeight)/2);}else{if(_35.createTextRange!=undefined){var _3b=_35.createTextRange();_3b.collapse();_3b.moveEnd(&quot;character&quot;,end);_3b.moveStart(&quot;character&quot;,_36);_3b.select();}else{_35.select();}}};abego.internal.TagManager=function(){var _3c=null;var _3d=function(){if(_3c){return;}_3c={};store.forEachTiddler(function(_3e,_3f){for(var i=0;i&lt;_3f.tags.length;i++){var tag=_3f.tags[i];var _42=_3c[tag];if(!_42){_42=_3c[tag]={count:0,tiddlers:{}};}_42.tiddlers[_3f.title]=true;_42.count+=1;}});};var _43=TiddlyWiki.prototype.saveTiddler;TiddlyWiki.prototype.saveTiddler=function(_44,_45,_46,_47,_48,_49){var _4a=this.fetchTiddler(_44);var _4b=_4a?_4a.tags:[];var _4c=(typeof _49==&quot;string&quot;)?_49.readBracketedList():_49;_43.apply(this,arguments);if(!abego.arraysAreEqual(_4b,_4c)){abego.internal.getTagManager().reset();}};var _4d=TiddlyWiki.prototype.removeTiddler;TiddlyWiki.prototype.removeTiddler=function(_4e){var _4f=this.fetchTiddler(_4e);var _50=_4f&amp;&amp;_4f.tags.length&gt;0;_4d.apply(this,arguments);if(_50){abego.internal.getTagManager().reset();}};this.reset=function(){_3c=null;};this.getTiddlersWithTag=function(tag){_3d();var _52=_3c[tag];return _52?_52.tiddlers:null;};this.getAllTags=function(_53){_3d();var _54=[];for(var i in _3c){_54.push(i);}for(i=0;_53&amp;&amp;i&lt;_53.length;i++){_54.pushUnique(_53[i],true);}abego.sortIgnoreCase(_54);return _54;};this.getTagInfos=function(){_3d();var _56=[];for(var _57 in _3c){_56.push([_57,_3c[_57]]);}return _56;};var _58=function(a,b){var a1=a[1];var b1=b[1];var d=b[1].count-a[1].count;return d!=0?d:abego.compareStrings(a[0].toLowerCase(),b[0].toLowerCase());};this.getSortedTagInfos=function(){_3d();var _5e=this.getTagInfos();_5e.sort(_58);return _5e;};this.getPartnerRankedTags=function(_5f){var _60={};for(var i=0;i&lt;_5f.length;i++){var _62=this.getTiddlersWithTag(_5f[i]);for(var _63 in _62){var _64=store.getTiddler(_63);if(!(_64 instanceof Tiddler)){continue;}for(var j=0;j&lt;_64.tags.length;j++){var tag=_64.tags[j];var c=_60[tag];_60[tag]=c?c+1:1;}}}var _68=abego.toSet(_5f);var _69=[];for(var n in _60){if(!_68[n]){_69.push(n);}}_69.sort(function(a,b){var d=_60[b]-_60[a];return d!=0?d:abego.compareStrings(a.toLowerCase(),b.toLowerCase());});return _69;};};abego.internal.getTagManager=function(){if(!abego.internal.gTagManager){abego.internal.gTagManager=new abego.internal.TagManager();}return abego.internal.gTagManager;};(function(){var _6e=2;var _6f=1;var _70=30;var _71;var _72;var _73;var _74;var _75;var _76;if(!abego.IntelliTagger){abego.IntelliTagger={};}var _77=function(){return _72;};var _78=function(tag){return _75[tag];};var _7a=function(s){var i=s.lastIndexOf(&quot; &quot;);return (i&gt;=0)?s.substr(0,i):&quot;&quot;;};var _7d=function(_7e){var s=_7e.value;var len=s.length;return (len&gt;0&amp;&amp;s[len-1]!=&quot; &quot;);};var _81=function(_82){var s=_82.value;var len=s.length;if(len&gt;0&amp;&amp;s[len-1]!=&quot; &quot;){_82.value+=&quot; &quot;;}};var _85=function(tag,_87,_88){if(_7d(_87)){_87.value=_7a(_87.value);}story.setTiddlerTag(_88.title,tag,0);_81(_87);abego.IntelliTagger.assistTagging(_87,_88);};var _89=function(n){if(_76&amp;&amp;_76.length&gt;n){return _76[n];}return (_74&amp;&amp;_74.length&gt;n)?_74[n]:null;};var _8b=function(n,_8d,_8e){var _8f=_89(n);if(_8f){_85(_8f,_8d,_8e);}};var _90=function(_91){var pos=_91.value.lastIndexOf(&quot; &quot;);var _93=(pos&gt;=0)?_91.value.substr(++pos,_91.value.length):_91.value;return new RegExp(_93.escapeRegExp(),&quot;i&quot;);};var _94=function(_95,_96){var _97=0;for(var i=0;i&lt;_95.length;i++){if(_96[_95[i]]){_97++;}}return _97;};var _99=function(_9a,_9b,_9c){var _9d=1;var c=_9a[_9b];for(var i=_9b+1;i&lt;_9a.length;i++){if(_9a[i][1].count==c){if(_9a[i][0].match(_9c)){_9d++;}}else{break;}}return _9d;};var _a0=function(_a1,_a2){var _a3=abego.internal.getTagManager().getSortedTagInfos();var _a4=[];var _a5=0;for(var i=0;i&lt;_a3.length;i++){var c=_a3[i][1].count;if(c!=_a5){if(_a2&amp;&amp;(_a4.length+_99(_a3,i,_a1)&gt;_a2)){break;}_a5=c;}if(c==1){break;}var s=_a3[i][0];if(s.match(_a1)){_a4.push(s);}}return _a4;};var _a9=function(_aa,_ab){return abego.filterStrings(abego.internal.getTagManager().getAllTags(_ab),_aa);};var _ac=function(){if(!_71){return;}var _ad=store.getTiddlerText(&quot;IntelliTaggerMainTemplate&quot;);if(!_ad){_ad=&quot;&lt;b&gt;Tiddler IntelliTaggerMainTemplate not found&lt;/b&gt;&quot;;}_71.innerHTML=_ad;applyHtmlMacros(_71,null);refreshElements(_71,null);};var _ae=function(e){if(!e){var e=window.event;}var tag=this.getAttribute(&quot;tag&quot;);if(_73){_73.call(this,tag,e);}return false;};var _b2=function(_b3){createTiddlyElement(_b3,&quot;span&quot;,null,&quot;tagSeparator&quot;,&quot; | &quot;);};var _b4=function(_b5,_b6,_b7,_b8,_b9){if(!_b6){return;}var _ba=_b8?abego.toSet(_b8):{};var n=_b6.length;var c=0;for(var i=0;i&lt;n;i++){var tag=_b6[i];if(_ba[tag]){continue;}if(c&gt;0){_b2(_b5);}if(_b9&amp;&amp;c&gt;=_b9){abego.createEllipsis(_b5);break;}c++;var _bf=&quot;&quot;;var _c0=_b5;if(_b7&lt;10){_c0=createTiddlyElement(_b5,&quot;span&quot;,null,&quot;numberedSuggestion&quot;);_b7++;var key=_b7&lt;10?&quot;&quot;+(_b7):&quot;0&quot;;createTiddlyElement(_c0,&quot;span&quot;,null,&quot;suggestionNumber&quot;,key+&quot;) &quot;);var _c2=_b7==1?&quot;Return or &quot;:&quot;&quot;;_bf=&quot; (Shortcut: %1Alt-%0)&quot;.format([key,_c2]);}var _c3=config.views.wikified.tag.tooltip.format([tag]);var _c4=(_78(tag)?&quot;Remove tag '%0'%1&quot;:&quot;Add tag '%0'%1&quot;).format([tag,_bf]);var _c5=&quot;%0; Shift-Click: %1&quot;.format([_c4,_c3]);var btn=createTiddlyButton(_c0,tag,_c5,_ae,_78(tag)?&quot;currentTag&quot;:null);btn.setAttribute(&quot;tag&quot;,tag);}};var _c7=function(){if(_71){window.scrollTo(0,ensureVisible(_71));}if(_77()){window.scrollTo(0,ensureVisible(_77()));}};var _c8=function(e){if(!e){var e=window.event;}if(!_71){return;}var _cb=resolveTarget(e);if(_cb==_77()){return;}if(abego.isDescendantOrSelf(_71,_cb)){return;}abego.IntelliTagger.close();};addEvent(document,&quot;click&quot;,_c8);var _cc=Story.prototype.gatherSaveFields;Story.prototype.gatherSaveFields=function(e,_ce){_cc.apply(this,arguments);var _cf=_ce.tags;if(_cf){_ce.tags=_cf.trim();}};var _d0=function(_d1){story.focusTiddler(_d1,&quot;tags&quot;);var _d2=abego.getTiddlerField(story,_d1,&quot;tags&quot;);if(_d2){var len=_d2.value.length;abego.setRange(_d2,len,len);window.scrollTo(0,ensureVisible(_d2));}};var _d4=config.macros.edit.handler;config.macros.edit.handler=function(_d5,_d6,_d7,_d8,_d9,_da){_d4.apply(this,arguments);var _db=_d7[0];if((_da instanceof Tiddler)&amp;&amp;_db==&quot;tags&quot;){var _dc=_d5.lastChild;_dc.onfocus=function(e){abego.IntelliTagger.assistTagging(_dc,_da);setTimeout(function(){_d0(_da.title);},100);};_dc.onkeyup=function(e){if(!e){var e=window.event;}if(e.altKey&amp;&amp;!e.ctrlKey&amp;&amp;!e.metaKey&amp;&amp;(e.keyCode&gt;=48&amp;&amp;e.keyCode&lt;=57)){_8b(e.keyCode==48?9:e.keyCode-49,_dc,_da);}else{if(e.ctrlKey&amp;&amp;e.keyCode==32){_8b(0,_dc,_da);}}if(!e.ctrlKey&amp;&amp;(e.keyCode==13||e.keyCode==10)){_8b(0,_dc,_da);}setTimeout(function(){abego.IntelliTagger.assistTagging(_dc,_da);},100);return false;};_81(_dc);}};var _e0=function(e){if(!e){var e=window.event;}var _e3=resolveTarget(e);var _e4=_e3.getAttribute(&quot;tiddler&quot;);if(_e4){story.displayTiddler(_e3,_e4,&quot;IntelliTaggerEditTagsTemplate&quot;,false);_d0(_e4);}return false;};var _e5=config.macros.tags.handler;config.macros.tags.handler=function(_e6,_e7,_e8,_e9,_ea,_eb){_e5.apply(this,arguments);abego.IntelliTagger.createEditTagsButton(_eb,createTiddlyElement(_e6.lastChild,&quot;li&quot;));};var _ec=function(){if(_71&amp;&amp;_72&amp;&amp;!abego.isDescendantOrSelf(document,_72)){abego.IntelliTagger.close();}};setInterval(_ec,100);abego.IntelliTagger.displayTagSuggestions=function(_ed,_ee,_ef,_f0,_f1){_74=_ed;_75=abego.toSet(_ee);_76=_ef;_72=_f0;_73=_f1;if(!_71){_71=createTiddlyElement(document.body,&quot;div&quot;,null,&quot;intelliTaggerSuggestions&quot;);_71.style.position=&quot;absolute&quot;;}_ac();abego.openAsPopup(_71);if(_77()){var w=_77().offsetWidth;if(_71.offsetWidth&lt;w){_71.style.width=(w-2*(_6e+_6f))+&quot;px&quot;;}abego.moveBelowAndClip(_71,_77());}else{abego.centerOnWindow(_71);}_c7();};abego.IntelliTagger.assistTagging=function(_f3,_f4){var _f5=_90(_f3);var s=_f3.value;if(_7d(_f3)){s=_7a(s);}var _f7=s.readBracketedList();var _f8=_f7.length&gt;0?abego.filterStrings(abego.internal.getTagManager().getPartnerRankedTags(_f7),_f5,_70):_a0(_f5,_70);abego.IntelliTagger.displayTagSuggestions(_a9(_f5,_f7),_f7,_f8,_f3,function(tag,e){if(e.shiftKey){onClickTag.call(this,e);}else{_85(tag,_f3,_f4);}});};abego.IntelliTagger.close=function(){abego.closePopup(_71);_71=null;return false;};abego.IntelliTagger.createEditTagsButton=function(_fb,_fc,_fd,_fe,_ff,id,_101){if(!_fd){_fd=&quot;[edit]&quot;;}if(!_fe){_fe=&quot;Edit the tags&quot;;}if(!_ff){_ff=&quot;editTags&quot;;}var _102=createTiddlyButton(_fc,_fd,_fe,_e0,_ff,id,_101);_102.setAttribute(&quot;tiddler&quot;,(_fb instanceof Tiddler)?_fb.title:String(_fb));return _102;};abego.IntelliTagger.getSuggestionTagsMaxCount=function(){return 100;};config.macros.intelliTagger={label:&quot;intelliTagger&quot;,handler:function(_103,_104,_105,_106,_107,_108){var _109=_107.parseParams(&quot;list&quot;,null,true);var _10a=_109[0][&quot;action&quot;];for(var i=0;_10a&amp;&amp;i&lt;_10a.length;i++){var _10c=_10a[i];var _10d=config.macros.intelliTagger.subhandlers[_10c];if(!_10d){abego.alertAndThrow(&quot;Unsupported action '%0'&quot;.format([_10c]));}_10d(_103,_104,_105,_106,_107,_108);}},subhandlers:{showTags:function(_10e,_10f,_110,_111,_112,_113){_b4(_10e,_74,_76?_76.length:0,_76,abego.IntelliTagger.getSuggestionTagsMaxCount());},showFavorites:function(_114,_115,_116,_117,_118,_119){_b4(_114,_76,0);},closeButton:function(_11a,_11b,_11c,_11d,_11e,_11f){var _120=createTiddlyButton(_11a,&quot;close&quot;,&quot;Close the suggestions&quot;,abego.IntelliTagger.close);},version:function(_121){var t=&quot;IntelliTagger %0.%1.%2&quot;.format([version.extensions.IntelliTaggerPlugin.major,version.extensions.IntelliTaggerPlugin.minor,version.extensions.IntelliTaggerPlugin.revision]);var e=createTiddlyElement(_121,&quot;a&quot;);e.setAttribute(&quot;href&quot;,&quot;http://tiddlywiki.abego-software.de/#IntelliTaggerPlugin&quot;);e.innerHTML=&quot;&lt;font color=\&quot;black\&quot; face=\&quot;Arial, Helvetica, sans-serif\&quot;&gt;&quot;+t+&quot;&lt;font&gt;&quot;;},copyright:function(_124){var e=createTiddlyElement(_124,&quot;a&quot;);e.setAttribute(&quot;href&quot;,&quot;http://tiddlywiki.abego-software.de&quot;);e.innerHTML=&quot;&lt;font color=\&quot;black\&quot; face=\&quot;Arial, Helvetica, sans-serif\&quot;&gt;&amp;copy; 2006-2007 &lt;b&gt;&lt;font color=\&quot;red\&quot;&gt;abego&lt;/font&gt;&lt;/b&gt; Software&lt;font&gt;&quot;;}}};})();config.shadowTiddlers[&quot;IntelliTaggerStyleSheet&quot;]=&quot;/***\n&quot;+&quot;!~IntelliTagger Stylesheet\n&quot;+&quot;***/\n&quot;+&quot;/*{{{*/\n&quot;+&quot;.intelliTaggerSuggestions {\n&quot;+&quot;\tposition: absolute;\n&quot;+&quot;\twidth: 600px;\n&quot;+&quot;\n&quot;+&quot;\tpadding: 2px;\n&quot;+&quot;\tlist-style: none;\n&quot;+&quot;\tmargin: 0;\n&quot;+&quot;\n&quot;+&quot;\tbackground: #eeeeee;\n&quot;+&quot;\tborder: 1px solid DarkGray;\n&quot;+&quot;}\n&quot;+&quot;\n&quot;+&quot;.intelliTaggerSuggestions .currentTag   {\n&quot;+&quot;\tfont-weight: bold;\n&quot;+&quot;}\n&quot;+&quot;\n&quot;+&quot;.intelliTaggerSuggestions .suggestionNumber {\n&quot;+&quot;\tcolor: #808080;\n&quot;+&quot;}\n&quot;+&quot;\n&quot;+&quot;.intelliTaggerSuggestions .numberedSuggestion{\n&quot;+&quot;\twhite-space: nowrap;\n&quot;+&quot;}\n&quot;+&quot;\n&quot;+&quot;.intelliTaggerSuggestions .intelliTaggerFooter {\n&quot;+&quot;\tmargin-top: 4px;\n&quot;+&quot;\tborder-top-width: thin;\n&quot;+&quot;\tborder-top-style: solid;\n&quot;+&quot;\tborder-top-color: #999999;\n&quot;+&quot;}\n&quot;+&quot;.intelliTaggerSuggestions .favorites {\n&quot;+&quot;\tborder-bottom-width: thin;\n&quot;+&quot;\tborder-bottom-style: solid;\n&quot;+&quot;\tborder-bottom-color: #999999;\n&quot;+&quot;\tpadding-bottom: 2px;\n&quot;+&quot;}\n&quot;+&quot;\n&quot;+&quot;.intelliTaggerSuggestions .normalTags {\n&quot;+&quot;\tpadding-top: 2px;\n&quot;+&quot;}\n&quot;+&quot;\n&quot;+&quot;.intelliTaggerSuggestions .intelliTaggerFooter .button {\n&quot;+&quot;\tfont-size: 10px;\n&quot;+&quot;\n&quot;+&quot;\tpadding-left: 0.3em;\n&quot;+&quot;\tpadding-right: 0.3em;\n&quot;+&quot;}\n&quot;+&quot;\n&quot;+&quot;/*}}}*/\n&quot;;config.shadowTiddlers[&quot;IntelliTaggerMainTemplate&quot;]=&quot;&lt;!--\n&quot;+&quot;{{{\n&quot;+&quot;--&gt;\n&quot;+&quot;&lt;div class=\&quot;favorites\&quot; macro=\&quot;intelliTagger action: showFavorites\&quot;&gt;&lt;/div&gt;\n&quot;+&quot;&lt;div class=\&quot;normalTags\&quot; macro=\&quot;intelliTagger action: showTags\&quot;&gt;&lt;/div&gt;\n&quot;+&quot;&lt;!-- The Footer (with the Navigation) ============================================ --&gt;\n&quot;+&quot;&lt;table class=\&quot;intelliTaggerFooter\&quot; border=\&quot;0\&quot; width=\&quot;100%\&quot; cellspacing=\&quot;0\&quot; cellpadding=\&quot;0\&quot;&gt;&lt;tbody&gt;\n&quot;+&quot;  &lt;tr&gt;\n&quot;+&quot;\t&lt;td align=\&quot;left\&quot;&gt;\n&quot;+&quot;\t\t&lt;span macro=\&quot;intelliTagger action: closeButton\&quot;&gt;&lt;/span&gt;\n&quot;+&quot;\t&lt;/td&gt;\n&quot;+&quot;\t&lt;td align=\&quot;right\&quot;&gt;\n&quot;+&quot;\t\t&lt;span macro=\&quot;intelliTagger action: version\&quot;&gt;&lt;/span&gt;, &lt;span macro=\&quot;intelliTagger action: copyright \&quot;&gt;&lt;/span&gt;\n&quot;+&quot;\t&lt;/td&gt;\n&quot;+&quot;  &lt;/tr&gt;\n&quot;+&quot;&lt;/tbody&gt;&lt;/table&gt;\n&quot;+&quot;&lt;!--\n&quot;+&quot;}}}\n&quot;+&quot;--&gt;\n&quot;;config.shadowTiddlers[&quot;IntelliTaggerEditTagsTemplate&quot;]=&quot;&lt;!--\n&quot;+&quot;{{{\n&quot;+&quot;--&gt;\n&quot;+&quot;&lt;div class='toolbar' macro='toolbar +saveTiddler -cancelTiddler'&gt;&lt;/div&gt;\n&quot;+&quot;&lt;div class='title' macro='view title'&gt;&lt;/div&gt;\n&quot;+&quot;&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;\n&quot;+&quot;&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;\n&quot;+&quot;&lt;div class='toolbar' macro='toolbar +saveTiddler -cancelTiddler'&gt;&lt;/div&gt;\n&quot;+&quot;&lt;div class='editor' macro='edit tags'&gt;&lt;/div&gt;&lt;div class='editorFooter'&gt;&lt;span macro='message views.editor.tagPrompt'&gt;&lt;/span&gt;&lt;span macro='tagChooser'&gt;&lt;/span&gt;&lt;/div&gt;\n&quot;+&quot;&lt;!--\n&quot;+&quot;}}}\n&quot;+&quot;--&gt;\n&quot;;config.shadowTiddlers[&quot;BSD open source license (abego Software)&quot;]=&quot;See [[Licence|http://tiddlywiki.abego-software.de/#%5B%5BBSD%20open%20source%20license%5D%5D]].&quot;;config.shadowTiddlers[&quot;IntelliTaggerPlugin Documentation&quot;]=&quot;[[Documentation on abego Software website|http://tiddlywiki.abego-software.de/doc/IntelliTagger.pdf]].&quot;;config.shadowTiddlers[&quot;IntelliTaggerPlugin SourceCode&quot;]=&quot;[[Plugin source code on abego Software website|http://tiddlywiki.abego-software.de/archive/IntelliTaggerPlugin/Plugin-IntelliTagger-src.1.0.2.js]]\n&quot;;(function(){var _126=restart;restart=function(){setStylesheet(store.getTiddlerText(&quot;IntelliTaggerStyleSheet&quot;),&quot;IntelliTaggerStyleSheet&quot;);_126.apply(this,arguments);};})();}
// %/</pre>
</div>
<div title="IntelliTagsEditCommandPlugin" modifier="UdoBorkowski" created="200710031345" modified="200710031402" tags="systemConfig excludeMissing">
<pre>/***
|''Name:''|IntelliTagsEditCommandPlugin|
|''Version:''|1.0.0 (2007-10-03)|
|''Type:''|plugin|
|''Description:''|A command for your tiddler's toolbar to directly edit the tiddler's tags using the IntelliTaggerPlugin, without switching to &quot;edit mode&quot;.|
|''Source:''|http://tiddlywiki.abego-software.de/#IntelliTagsEditCommandPlugin|
|''Requires:''|IntelliTaggerPlugin http://tiddlywiki.abego-software.de/#IntelliTaggerPlugin|
|''Author:''|Udo Borkowski (ub [at] abego-software [dot] de)|
|''Licence:''|[[BSD open source license (abego Software)]]|
|''~CoreVersion:''|2.0.8|
|''Browser:''|Firefox 1.5.0.2 or better|
***/
/***
!Using the &quot;IntelliTagsEditCommandPlugin&quot;
Add the command {{{intelliTagsEdit}}} into the 'macro' attribute of the 'toolbar' {{{&lt;div...&gt;}}} in your ViewTemplate.

''Example:''
{{{
&lt;div class='toolbar' 
        macro='toolbar -closeTiddler closeOthers +editTiddler intelliTagsEdit permalink references jump'&gt;
&lt;/div&gt;
}}}

This adds a &quot;tags&quot; button to the toolbar of the tiddlers (next to the ''edit'' button). Pressing the &quot;tags&quot; button will open the input field for the tiddler's tags and let you edit the tags with all the [[IntelliTaggerPlugin|http://tiddlywiki.abego-software.de/#IntelliTaggerPlugin]] features.
***/
/***
!Source Code
***/
//{{{
(function(){

if (!version.extensions.IntelliTaggerPlugin)
    throw Error(&quot;IntelliTagsEditCommandPlugin requires the IntelliTaggerPlugin (http://tiddlywiki.abego-software.de/#IntelliTaggerPlugin)&quot;);

if (config.commands.intelliTagsEdit) 
    return;

config.commands.intelliTagsEdit = {
	text: &quot;tags&quot;,
	tooltip: &quot;edit the tags&quot;
};

config.commands.intelliTagsEdit.handler = function(event,src,title) {
	var button = abego.IntelliTagger.createEditTagsButton(title, null, &quot;tags&quot;, &quot;edit the tags&quot;);
	button.onclick(event);
	return false;
};

})();
//}}}</pre>
</div>
<div title="JohnRouillard" modifier="JohnRouillard" created="200903151828" modified="200910111855" tags="content">
<pre>John Rouillard has been working in system administration since the early 90's. His involvement with SEC started at version 1 in the early 2000's. His comments and needs drove a number of the features in the modern SEC. He presented a paper on using SEC at the LISA 2004 conference that has been referenced by people developing commercial correlation software. He continues to use SEC as a supplemental correlation engine for Nagios and is an active member of the SEC mailing list.

His homepage can be found at http://www.cs.umb.edu/~rouilj.

Email for &lt;&lt;tiddler &quot;Credits::Author&quot;&gt;&gt;.</pre>
</div>
<div title="LeftGradientImageBlue" modifier="JohnRouillard" created="200908210252" modified="200909030423" tags="attachment excludeMissing structure excludeOrphans InstructorOnly">
<pre>!usage
{{{[img[LeftGradientImageBlue]]}}}
[img[LeftGradientImageBlue]]
!notes
Blue left hand gradient for instructor mode slides.
!type
image/png
!file
./images_inst/left_gradient_blue.png
!url
http://www.cs.umb.edu/~rouilj/classes/SEC_intermediate/images/left_gradient_blue.png
!data
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAABCAIAAACnuZzqAAAAMklEQVQYlWPk513GxMTIyMjIxMTIxMQAYzAiMRgwRBiZmBgwREhVjM8uqppJjgOwagcA1sECY552w9cAAAAASUVORK5CYII=</pre>
</div>
<div title="Live Book/Errata" modifier="YourName" created="201007251902" modified="201007270210" tags="slide content">
<pre>{{col2a{[img(100%,)[rss-icon.png]]}}}
{{col2b{
&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
{{overlay1{Errata}}}
{{overlay2{Editing time}}}
{{overlay3{RSS feed}}}
{{overlay4{Embedded rss viewer}}}
{{overlay5{One click update}}}
}}}

{{nocol comment{
* update content tiddlers to fix errata
* editing was falling behind so I knew there would be changes between submission time and class
* rss feed on changes to see what's new. Embedded feed reader for student to use.
* one click updating of content
}}}</pre>
</div>
<div title="LoadRemoteFileThroughProxy" modifier="YourName" created="200703202229" modified="201007300138" tags="systemConfig">
<pre>/***
|''Name:''|LoadRemoteFileThroughProxy (previous LoadRemoteFileHijack)|
|''Description:''|When the TiddlyWiki file is located on the web (view over http) the content of [[SiteProxy]] tiddler is added in front of the file url. If [[SiteProxy]] does not exist &quot;/proxy/&quot; is added. |
|''Version:''|1.1.0|
|''Date:''|mar 17, 2007|
|''Source:''|http://tiddlywiki.bidix.info/#LoadRemoteFileHijack|
|''Author:''|BidiX (BidiX (at) bidix (dot) info)|
|''License:''|[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D ]]|
|''~CoreVersion:''|2.2.0|
***/
//{{{
version.extensions.LoadRemoteFileThroughProxy = {
 major: 1, minor: 1, revision: 0, 
 date: new Date(&quot;mar 17, 2007&quot;), 
 source: &quot;http://tiddlywiki.bidix.info/#LoadRemoteFileThroughProxy&quot;};

if (!window.bidix) window.bidix = {}; // bidix namespace
if (!bidix.core) bidix.core = {};

bidix.core.loadRemoteFile = loadRemoteFile;
loadRemoteFile = function(url,callback,params)
{
 if ((document.location.toString().substr(0,4) == &quot;http&quot;) &amp;&amp; (url.substr(0,4) == &quot;http&quot;)){ 
 url = store.getTiddlerText(&quot;SiteProxy&quot;, &quot;/proxy/&quot;) + url;
 }
 return bidix.core.loadRemoteFile(url,callback,params);
}
//}}}
</pre>
</div>
<div title="LoadTiddlersPlugin" modifier="ELSDesignStudios" created="200703220614" modified="200910070458" tags="ImportExportPackage systemConfig">
<pre>/***
|Name|LoadTiddlersPlugin|
|Source|http://www.TiddlyTools.com/#LoadTiddlersPlugin|
|Documentation|http://www.TiddlyTools.com/#LoadTiddlersPluginInfo|
|Version|3.8.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Description|macro for automated updates or one-click installations of tiddlers from remote sources|
!!!!!Documentation
&gt;see [[LoadTiddlersPluginInfo]]
!!!!!Configuration
&lt;&lt;&lt;
&lt;&lt;option chkLoadTiddlersShowReport&gt;&gt;after loading tiddlers, automatically display [[ImportedTiddlers]] (if created)
__password-protected server settings //(optional, if needed)//:__
&gt;username: &lt;&lt;option txtRemoteUsername&gt;&gt; password: &lt;&lt;option txtRemotePassword&gt;&gt;
&gt;{{{usage: &lt;&lt;option txtRemoteUsername&gt;&gt; &lt;&lt;option txtRemotePassword&gt;&gt;}}}
&gt;''note: these settings are also used by [[ExternalTiddlersPlugin]] and [[ImportTiddlersPlugin]]''
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.10.08 3.8.1 removed switchTheme() from doImport()... causes an INFINITE cycle of imports!
|please see [[LoadTiddlersPluginInfo]] for additional revision details|
2005.07.20 1.0.0 Initial Release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.LoadTiddlersPlugin= {major: 3, minor: 8, revision: 1, date: new Date(2009,10,8)};

if (config.options.chkLoadTiddlersShowReport===undefined)
	config.options.chkLoadTiddlersShowReport=true;

config.macros.loadTiddlers = {
	label: '',
	tip: &quot;add/update tiddlers from '%0'&quot;,
	lockedTag: 'noReload',	// if existing tiddler has this tag value, don't overwrite it, even if inbound tiddler is newer
	askMsg: 'Please enter a local path/filename or a remote URL',
	openMsg: 'Opening %0',
	openErrMsg: 'Could not open %0 - error=%1',
	readMsg: 'Read %0 bytes from %1',
	foundMsg: 'Found %0 tiddlers in %1',
	nochangeMsg: &quot;'%0' is up-to-date... skipped.&quot;,
	lockedMsg: &quot;'%0' is tagged '%1'... skipped.&quot;,
	skippedMsg: 'skipped (cancelled by user)',
	loadedMsg: 'Loaded %0 of %1 tiddlers from %2',
	reportTitle: 'ImportedTiddlers',
	warning: &quot;Warning!!  Processing '%0' as a systemConfig (plugin) tiddler may produce unexpected results! Are you sure you want to proceed?&quot;,
	handler: function(place,macroName,params) {
		var label=(params[0] &amp;&amp; params[0].substr(0,6)=='label:')?params.shift().substr(6):this.label;
		var tip=(params[0] &amp;&amp; params[0].substr(0,7)=='prompt:')?params.shift().substr(7):this.tip;
		var filter='updates';
		if (params[0] &amp;&amp; (params[0]=='all' || params[0]=='new' || params[0]=='changes' || params[0]=='updates'
			|| params[0].substr(0,8)=='tiddler:' || params[0].substr(0,4)=='tag:'))
			filter=params.shift();
		var src=params.shift(); if (!src || !src.length) return; // filename is required
		var quiet=(params[0]=='quiet'); if (quiet) params.shift();
		var ask=(params[0]=='confirm'); if (ask) params.shift();
		var force=(params[0]=='force'); if (force) params.shift();
		var init=(params[0]=='init'); if (init) params.shift();
		var nodirty=(params[0]=='nodirty'); if (nodirty) params.shift();
		var norefresh=(params[0]=='norefresh'); if (norefresh) params.shift();
		var noreport=(params[0]=='noreport'); if (noreport) params.shift();
		this.newTags=[]; if (params[0]) this.newTags=params; // any remaining params are used as 'autotags'
		if (label.trim().length) {
			// link triggers load tiddlers from another file/URL and then applies filtering rules to add/replace tiddlers in the store
			createTiddlyButton(place,label.format([src.replace(/%20/g,' ')]),tip.format([src.replace(/%20/g,' ')]), function() {
				if (src=='ask') src=prompt(this.askMsg);
				config.macros.loadTiddlers.loadFile(src,config.macros.loadTiddlers.doImport,{quiet:quiet,ask:ask,filter:filter,force:force,init:init,noreport:noreport});
				return false;
			})
		}
		else {
			// load tiddlers from another file/URL and then apply filtering rules to add/replace tiddlers in the store
			if (src=='ask') src=prompt(this.askMsg);
			config.macros.loadTiddlers.loadFile(src,config.macros.loadTiddlers.doImport,{quiet:quiet,ask:ask,filter:filter,force:force,init:init,nodirty:nodirty,norefresh:norefresh,noreport:noreport});
		}
	},
	loadFile: function(src,callback,params) {
		var quiet=params.quiet;
		if (src==undefined || !src.length) return null; // filename is required
		if (!quiet) clearMessage();
		if (!quiet) displayMessage(this.openMsg.format([src.replace(/%20/g,' ')]));
		// if working locally and src is not a URL, read from local filesystem
		if (document.location.protocol=='file:' &amp;&amp; src.substr(0,5)!='http:' &amp;&amp; src.substr(0,5)!='file:') {
			var txt=loadFile(src);
			if (!txt) { // file didn't load, might be relative path.. try fixup
				var pathPrefix=document.location.href;  // get current document path and trim off filename
				var slashpos=pathPrefix.lastIndexOf('/'); if (slashpos==-1) slashpos=pathPrefix.lastIndexOf('\\'); 
				if (slashpos!=-1 &amp;&amp; slashpos!=pathPrefix.length-1) pathPrefix=pathPrefix.substr(0,slashpos+1);
				src=pathPrefix+src;
				if (pathPrefix.substr(0,5)!='http:') src=getLocalPath(src);
				var txt=loadFile(src);
			}
			if (!txt) { // file still didn't load, report error
				if (!quiet) displayMessage(this.openErrMsg.format([src.replace(/%20/g,' '),'(unknown)']));
			} else {
				if (!quiet) displayMessage(this.readMsg.format([txt.length,src.replace(/%20/g,' ')]));
				if (version.major+version.minor*.1+version.revision*.01!=2.52)
					txt=convertUTF8ToUnicode(txt);
				if (callback) callback(true,params,txt,src,null);
			}
		} else { // use XMLHttpRequest
			doHttp('GET',src,null,null,config.options.txtRemoteUsername,config.options.txtRemotePassword,callback,params,null);
		}
	},
	readTiddlersFromHTML: function(html) {
		// for TW2.2+
		if (TiddlyWiki.prototype.importTiddlyWiki!=undefined) {
			var remoteStore=new TiddlyWiki();
			remoteStore.importTiddlyWiki(html);
			return remoteStore.getTiddlers('title');	
		}
	},
	readTiddlersFromCSV: function(CSV) {
		var remoteStore=new TiddlyWiki();
		// GET NAMES
		var lines=CSV.replace(/\r/g,'').split('\n');
		var names=lines.shift().replace(/&quot;/g,'').split(',');
		CSV=lines.join('\n');
		// ENCODE commas and newlines within quoted values
		var comma='!~comma~!'; var commaRE=new RegExp(comma,'g');
		var newline='!~newline~!'; var newlineRE=new RegExp(newline,'g');
		CSV=CSV.replace(/&quot;([^&quot;]*?)&quot;/g,
			function(x){ return x.replace(/\,/g,comma).replace(/\n/g,newline); });
		// PARSE lines
		var lines=CSV.split('\n');
		for (var i=0; i&lt;lines.length; i++) { if (!lines[i].length) continue;
			var values=lines[i].split(',');
			// DECODE commas, newlines, and doubled-quotes, and remove enclosing quotes (if any)
			for (var v=0; v&lt;values.length; v++)
				values[v]=values[v].replace(commaRE,',').replace(newlineRE,'\n')
					.replace(/^&quot;|&quot;$/g,'').replace(/&quot;&quot;/g,'&quot;');
			// EXTRACT tiddler values
			var title=''; var text=''; var tags=[]; var fields={};
			var created=null; var when=new Date(); var who=config.options.txtUserName;
			for (var v=0; v&lt;values.length; v++) { var val=values[v];
				if (names[v]) switch(names[v].toLowerCase()) {
					case 'title':	title=val.replace(/\[\]\|/g,'_'); break;
					case 'created': created=new Date(val); break;
					case 'modified':when=new Date(val); break;
					case 'modifier':who=val; break;
					case 'text':	text=val; break;
					case 'tags':	tags=val.readBracketedList(); break;
					default:	fields[names[v].toLowerCase()]=val; break;
				}
			}
			// CREATE tiddler in temporary store
			if (title.length)
				remoteStore.saveTiddler(title,title,text,who,when,tags,fields,true,created||when);
		}
		return remoteStore.getTiddlers('title');	
	},
	createTiddlerFromFile: function(src,txt) {
		var t=new Tiddler();
		var pos=src.lastIndexOf(&quot;/&quot;); if (pos==-1) pos=src.lastIndexOf(&quot;\\&quot;);
		t.title=pos==-1?src:src.substr(pos+1);
		t.text=txt; 
		t.created=t.modified=new Date();
		t.modifier=config.options.txtUserName;
		if (src.substr(src.length-3,3)=='.js') t.tags=['systemConfig'];
		return [t];
	},
	doImport: function(status,params,html,src,xhr) {
		var cml=config.macros.loadTiddlers; // abbrev
		src=src.split('?')[0]; // strip off &quot;?nocache=...&quot;
		if (!status) {
			displayMessage(cml.openErrMsg.format([src.replace(/%20/g,' '),xhr.status]));
			return false;
		}
		var quiet=params.quiet;
		var ask=params.ask;
		var filter=params.filter;
		var force=params.force;
		var init=params.init;
		var nodirty=params.nodirty;
		var norefresh=params.norefresh;
		var noreport=params.noreport;
		var tiddlers = cml.readTiddlersFromHTML(html);
		if (!tiddlers||!tiddlers.length) tiddlers=cml.readTiddlersFromCSV(html);
		if (!tiddlers||!tiddlers.length) tiddlers=cml.createTiddlerFromFile(src,html);
		var count=tiddlers?tiddlers.length:0;
		if (!quiet) displayMessage(cml.foundMsg.format([count,src.replace(/%20/g,' ')]));
		var wasDirty=store.isDirty();
		store.suspendNotifications();
		var count=0;
		if (tiddlers) for (var t=0;t&lt;tiddlers.length;t++) {
			var inbound = tiddlers[t];
			var theExisting = store.getTiddler(inbound.title);
			if (inbound.title==cml.reportTitle)
				continue; // skip 'ImportedTiddlers' history from the other document...
			if (theExisting &amp;&amp; theExisting.tags.contains(cml.lockedTag)) {
				if (!quiet) displayMessage(cml.lockedMsg.format([theExisting.title,cml.lockedTag]));
				continue; // skip existing tiddler if tagged with 'noReload'
			}
			// apply the all/new/changes/updates filter (if any)
			if (filter &amp;&amp; filter!='all') {
				if ((filter=='new') &amp;&amp; theExisting) // skip existing tiddlers
					continue;
				if ((filter=='changes') &amp;&amp; !theExisting) // skip new tiddlers
					continue;
				if ((filter.substr(0,4)=='tag:') &amp;&amp; inbound.tags.indexOf(filter.substr(4))==-1) // must match specific tag value
					continue;
				if ((filter.substr(0,8)=='tiddler:') &amp;&amp; inbound.title!=filter.substr(8)) // must match specific tiddler name
					continue;
				if (!force &amp;&amp; store.tiddlerExists(inbound.title) &amp;&amp; ((theExisting.modified.getTime()-inbound.modified.getTime())&gt;=0)) {
					var msg=cml.nochangeMsg;
					if (!quiet&amp;&amp;msg.length) displayMessage(msg.format([inbound.title]));
					continue;
				}
			}
			// get confirmation if required
			var msg=(theExisting?'Update':'Add')+&quot; tiddler '&quot;+inbound.title+&quot;'\n&quot;
				+'from '+src.replace(/%20/g,' ')+'\n\nOK to proceed?';
			if (ask &amp;&amp; !confirm(msg))
				{ tiddlers[t].status=cml.skippedMsg; continue; }
			// DO IT!
			var tags=new Array().concat(inbound.tags,cml.newTags);
	                store.saveTiddler(inbound.title, inbound.title, inbound.text, inbound.modifier,
				inbound.modified, tags, inbound.fields, true, inbound.created);
			// force creation date to imported value - needed for TW2.1.3 or earlier
	                store.fetchTiddler(inbound.title).created = inbound.created;
			tiddlers[t].status=theExisting?'updated':'added'
			if (init &amp;&amp; tags.contains('systemConfig') &amp;&amp; !tags.contains('systemConfigDisable')) {
				var ok=true;
				if (ask||!quiet) ok=confirm(cml.warning.format([inbound.title]))
				if (ok) { // run the plugin
					try { window.eval(inbound.text); tiddlers[t].status+=' (plugin initialized)'; }
					catch(ex) { displayMessage(config.messages.pluginError.format([exceptionText(ex)])); }
				}
			}
			count++;
		}
		store.resumeNotifications();
		if (count) {
			// set/clear 'unsaved changes' flag, refresh page display, and generate a report
			store.setDirty(wasDirty||!nodirty);
			if (!norefresh) {
				story.forEachTiddler(function(t,e){
					if(!story.isDirty(t))story.refreshTiddler(t,null,true)
				});
				store.notifyAll();
			}
			if (!noreport) cml.report(src,tiddlers,count,quiet);
		}
		// show message whenver tiddlers are actually loaded
		if (!quiet||count)
			displayMessage(cml.loadedMsg.format([count,tiddlers.length,src.replace(/%20/g,' ')]));
	},
	showReport: true,
	report: function(src,tiddlers,count,quiet) {
		var cml=config.macros.loadTiddlers; // abbrev
		// format the new report content
		var newText = 'On '+(new Date()).toLocaleString()+', ';
		newText += config.options.txtUserName+' loaded '+count+' tiddlers ';
		newText += 'from\n[['+src+'|'+src+']]:\n';
		newText += '&lt;&lt;&lt;\n';
		for (var t=0; t&lt;tiddlers.length; t++)
			if (tiddlers[t].status)
				newText += '#[['+tiddlers[t].title+']] - '+tiddlers[t].status+'\n';
		newText += '&lt;&lt;&lt;\n';
		var title=cml.reportTitle;
		var currText='';
		var t=store.getTiddler(title);
		if (t) currText=(t.text.length?'\n----\n':'')+t.text;
		store.saveTiddler(title, title, newText+currText,
			config.options.txtUserName, new Date(),	t?t.tags:null, t?t.fields:null);
		if (!quiet) {
			if (config.options.chkLoadTiddlersShowReport)
				story.displayTiddler(null,title);
			story.refreshTiddler(title,null,true);
		}
	}
}
//}}}</pre>
</div>
<div title="LoadTiddlersPlugin w/ noreportshow functionality" modifier="JohnRouillard" created="200703220614" modified="200909041342" tags="ImportExportPackage systemConfigDisable InstructorOnly excludeMissing">
<pre>/***
|Name|LoadTiddlersPlugin|
|Source|http://www.TiddlyTools.com/#LoadTiddlersPlugin|
|Documentation|http://www.TiddlyTools.com/#LoadTiddlersPluginInfo|
|Version|3.7.5|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides||
|Options|##Configuration|
|Description|macro for automated updates or one-click installations of tiddlers from remote sources|
!!!!!Documentation
&gt;see [[LoadTiddlersPluginInfo]]
!!!!!Configuration
&lt;&lt;&lt;
__password-protected server settings //(optional, if needed)//:__
&gt;username: &lt;&lt;option txtRemoteUsername&gt;&gt; password: &lt;&lt;option txtRemotePassword&gt;&gt;
&gt;{{{usage: &lt;&lt;option txtRemoteUsername&gt;&gt; &lt;&lt;option txtRemotePassword&gt;&gt;}}}
&gt;''note: these settings are also used by [[ExternalTiddlersPlugin]] and [[ImportTiddlersPlugin]]''
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.08.30 [3.7.5] in doImport(), check status and report error, if any
|please see [[LoadTiddlersPluginInfo]] for additional revision details|
2005.07.20 [1.0.0] Initial Release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.LoadTiddlersPlugin= {major: 3, minor: 7, revision: 5, date: new Date(2009,8,30)};

config.macros.loadTiddlers = {
	label: '',
	tip: &quot;add/update tiddlers from '%0'&quot;,
	lockedTag: 'noReload',	// if existing tiddler has this tag value, don't overwrite it, even if inbound tiddler is newer
	askMsg: 'Please enter a local path/filename or a remote URL',
	openMsg: 'Opening %0',
	openErrMsg: 'Could not open %0 - error=%1',
	readMsg: 'Read %0 bytes from %1',
	foundMsg: 'Found %0 tiddlers in %1',
	nochangeMsg: &quot;'%0' is up-to-date... skipped.&quot;,
	lockedMsg: &quot;'%0' is tagged '%1'... skipped.&quot;,
	skippedMsg: 'skipped (cancelled by user)',
	loadedMsg: 'Loaded %0 of %1 tiddlers from %2',
	reportTitle: 'ImportedTiddlers',
	warning: &quot;Warning!!  Processing '%0' as a systemConfig (plugin) tiddler may produce unexpected results! Are you sure you want to proceed?&quot;,
	handler: function(place,macroName,params) {
		var label=(params[0] &amp;&amp; params[0].substr(0,6)=='label:')?params.shift().substr(6):this.label;
		var tip=(params[0] &amp;&amp; params[0].substr(0,7)=='prompt:')?params.shift().substr(7):this.tip;
		var filter='updates';
		if (params[0] &amp;&amp; (params[0]=='all' || params[0]=='new' || params[0]=='changes' || params[0]=='updates'
			|| params[0].substr(0,8)=='tiddler:' || params[0].substr(0,4)=='tag:'))
			filter=params.shift();
		var src=params.shift(); if (!src || !src.length) return; // filename is required
		var quiet=(params[0]=='quiet'); if (quiet) params.shift();
		var ask=(params[0]=='confirm'); if (ask) params.shift();
		var force=(params[0]=='force'); if (force) params.shift();
		var init=(params[0]=='init'); if (init) params.shift();
		var nodirty=(params[0]=='nodirty'); if (nodirty) params.shift();
		var norefresh=(params[0]=='norefresh'); if (norefresh) params.shift();
		var noreport=(params[0]=='noreport'); if (noreport) params.shift();
		var noreportshow=(params[0]=='noreportshow'); if (noreportshow) params.shift();

		this.newTags=[]; if (params[0]) this.newTags=params; // any remaining params are used as 'autotags'
		if (label.trim().length) {
			// link triggers load tiddlers from another file/URL and then applies filtering rules to add/replace tiddlers in the store
			createTiddlyButton(place,label.format([src.replace(/%20/g,' ')]),tip.format([src.replace(/%20/g,' ')]), function() {
				if (src=='ask') src=prompt(this.askMsg);
				config.macros.loadTiddlers.loadFile(src,config.macros.loadTiddlers.doImport,{quiet:quiet,ask:ask,filter:filter,force:force,init:init,noreport:noreport,noreportshow:noreportshow});
				return false;
			})
		}
		else {
			// load tiddlers from another file/URL and then apply filtering rules to add/replace tiddlers in the store
			if (src=='ask') src=prompt(this.askMsg);
			config.macros.loadTiddlers.loadFile(src,config.macros.loadTiddlers.doImport,{quiet:quiet,ask:ask,filter:filter,force:force,init:init,nodirty:nodirty,norefresh:norefresh,noreport:noreport,noreportshow:noreportshow});
		}
	},
	loadFile: function(src,callback,params) {
		var quiet=params.quiet;
		if (src==undefined || !src.length) return null; // filename is required
		if (!quiet) clearMessage();
		if (!quiet) displayMessage(this.openMsg.format([src.replace(/%20/g,' ')]));
		// if working locally and src is not a URL, read from local filesystem
		if (document.location.protocol=='file:' &amp;&amp; src.substr(0,5)!='http:' &amp;&amp; src.substr(0,5)!='file:') {
			var txt=loadFile(src);
			if (!txt) { // file didn't load, might be relative path.. try fixup
				var pathPrefix=document.location.href;  // get current document path and trim off filename
				var slashpos=pathPrefix.lastIndexOf('/'); if (slashpos==-1) slashpos=pathPrefix.lastIndexOf('\\'); 
				if (slashpos!=-1 &amp;&amp; slashpos!=pathPrefix.length-1) pathPrefix=pathPrefix.substr(0,slashpos+1);
				src=pathPrefix+src;
				if (pathPrefix.substr(0,5)!='http:') src=getLocalPath(src);
				var txt=loadFile(src);
			}
			if (!txt) { // file still didn't load, report error
				if (!quiet) displayMessage(this.openErrMsg.format([src.replace(/%20/g,' '),'(unknown)']));
			} else {
				if (!quiet) displayMessage(this.readMsg.format([txt.length,src.replace(/%20/g,' ')]));
				if (version.major+version.minor*.1+version.revision*.01!=2.52)
					txt=convertUTF8ToUnicode(txt);
				if (callback) callback(true,params,txt,src,null);
			}
		} else { // use XMLHttpRequest
			doHttp('GET',src,null,null,config.options.txtRemoteUsername,config.options.txtRemotePassword,callback,params,null);
		}
	},
	readTiddlersFromHTML: function(html) {
		// for TW2.2+
		if (TiddlyWiki.prototype.importTiddlyWiki!=undefined) {
			var remoteStore=new TiddlyWiki();
			remoteStore.importTiddlyWiki(html);
			return remoteStore.getTiddlers('title');	
		}
	},
	readTiddlersFromCSV: function(CSV) {
		var remoteStore=new TiddlyWiki();
		var lines=CSV.split('\n'); var names=lines[0].split(','); CSV=lines.join('\n')
		// ENCODE commas and newlines within quoted values
		var comma='!~comma~!'; var commaRE=new RegExp(comma,'g');
		var newline='!~newline~!'; var newlineRE=new RegExp(newline,'g');
		CSV=CSV.replace(/\x22((?:[^\x22]|\x22\x22)*?)\x22/g,
			function(x){ return x.substr(1,x.length-2).replace(/\,/g,comma).replace(/\n/g,newline); });
		// PARSE lines
		var lines=CSV.split('\n');
		for (var i=1; i&lt;lines.length; i++) { if (!lines[i].length) continue;
			var values=lines[i].split(',');
			// DECODE commas, newlines and doubled-quotes within quoted values
			for (var v=0; v&lt;values.length; v++)
				values[v]=values[v].replace(commaRE,',').replace(newlineRE,'\n').replace(/\x22\x22/g,'\x22');
			// EXTRACT tiddler values
			var title=''; var text=''; var tags=[]; var fields={};
			var created=null; var when=new Date(); var who=config.options.txtUserName;
			for (var v=0; v&lt;values.length; v++) { var val=values[v];
				if (names[v]) switch(names[v].toLowerCase()) {
					case 'title':	title=val.replace(/\[\]\|/g,'_'); break;
					case 'created': created=new Date(val); break;
					case 'modified':when=new Date(val); break;
					case 'modifier':who=val; break;
					case 'text':	text=val; break;
					case 'tags':	tags=val.readBracketedList(); break;
					default:	fields[names[v].toLowerCase()]=val; break;
				}
			}
			// CREATE tiddler in temporary store
			if (title.length) remoteStore.saveTiddler(title,title,text,who,when,tags,fields,true,created||when);
		}
		return remoteStore.getTiddlers('title');	
	},
	doImport: function(status,params,html,src,xhr) {
		var cml=config.macros.loadTiddlers; // abbrev
		src=src.split('?')[0]; // strip off &quot;?nocache=...&quot;
		if (!status) {
			displayMessage(cml.openErrMsg.format([src.replace(/%20/g,' '),xhr.status]));
			return false;
		}
		var quiet=params.quiet;
		var ask=params.ask;
		var filter=params.filter;
		var force=params.force;
		var init=params.init;
		var nodirty=params.nodirty;
		var norefresh=params.norefresh;
		var noreport=params.noreport;
		var noreportshow=params.noreportshow;
		var tiddlers = cml.readTiddlersFromHTML(html);
		if (!tiddlers||!tiddlers.length) tiddlers=cml.readTiddlersFromCSV(html);
		var count=tiddlers?tiddlers.length:0;
		if (!quiet) displayMessage(cml.foundMsg.format([count,src.replace(/%20/g,' ')]));
		var wasDirty=store.isDirty();
		store.suspendNotifications();
		var count=0;
		if (tiddlers) for (var t=0;t&lt;tiddlers.length;t++) {
			var inbound = tiddlers[t];
			var theExisting = store.getTiddler(inbound.title);
			if (inbound.title==cml.reportTitle)
				continue; // skip 'ImportedTiddlers' history from the other document...
			if (theExisting &amp;&amp; theExisting.tags.contains(cml.lockedTag)) {
				if (!quiet) displayMessage(cml.lockedMsg.format([theExisting.title,cml.lockedTag]));
				continue; // skip existing tiddler if tagged with 'noReload'
			}
			// apply the all/new/changes/updates filter (if any)
			if (filter &amp;&amp; filter!='all') {
				if ((filter=='new') &amp;&amp; theExisting) // skip existing tiddlers
					continue;
				if ((filter=='changes') &amp;&amp; !theExisting) // skip new tiddlers
					continue;
				if ((filter.substr(0,4)=='tag:') &amp;&amp; inbound.tags.indexOf(filter.substr(4))==-1) // must match specific tag value
					continue;
				if ((filter.substr(0,8)=='tiddler:') &amp;&amp; inbound.title!=filter.substr(8)) // must match specific tiddler name
					continue;
				if (!force &amp;&amp; store.tiddlerExists(inbound.title) &amp;&amp; ((theExisting.modified.getTime()-inbound.modified.getTime())&gt;=0)) {
					var msg=cml.nochangeMsg;
					if (!quiet&amp;&amp;msg.length) displayMessage(msg.format([inbound.title]));
					continue;
				}
			}
			// get confirmation if required
			if (ask &amp;&amp; !confirm((theExisting?'Update':'Add')+&quot; tiddler '&quot;+inbound.title+&quot;'\nfrom &quot;+src.replace(/%20/g,' ')+'\n\nOK to proceed?'))
				{ tiddlers[t].status=cml.skippedMsg; continue; }
			// DO IT!
			var tags=new Array().concat(inbound.tags,cml.newTags);
	                store.saveTiddler(inbound.title, inbound.title, inbound.text, inbound.modifier, inbound.modified, tags, inbound.fields, true, inbound.created);
	                store.fetchTiddler(inbound.title).created = inbound.created; // force creation date to imported value - needed for TW2.1.3 or earlier
			tiddlers[t].status=theExisting?'updated':'added'
			if (init &amp;&amp; tags.contains('systemConfig') &amp;&amp; !tags.contains('systemConfigDisable')) {
				var ok=true;
				if (ask||!quiet) ok=confirm(cml.warning.format([inbound.title]))
				if (ok) { // run the plugin
					try { window.eval(inbound.text); tiddlers[t].status+=' (plugin initialized)'; }
					catch(ex) { displayMessage(config.messages.pluginError.format([exceptionText(ex)])); }
				}
			}
			count++;
		}
		store.resumeNotifications();
		if (count) {
			// optionally: set/clear 'unsaved changes' flag, refresh page display, and generate a report
			store.setDirty(wasDirty||!nodirty);
			if (!norefresh) {
				story.forEachTiddler(function(t,e){if(!story.isDirty(t))story.refreshTiddler(t,null,true)});
				store.notifyAll();
			}
			if (!noreport) cml.report(src,tiddlers,count,quiet,noreportshow);
		}
		// always show final message when tiddlers were actually loaded
		if (!quiet||count) displayMessage(cml.loadedMsg.format([count,tiddlers.length,src.replace(/%20/g,' ')]));
	},
	report: function(src,tiddlers,count,quiet,noreportshow) {
		// format the new report content
		var newText = 'On '+(new Date()).toLocaleString()+', ';
		newText += config.options.txtUserName+' loaded '+count+' tiddlers ';
		newText += 'from\n[['+src+'|'+src+']]:\n';
		newText += '&lt;&lt;&lt;\n';
		for (var t=0; t&lt;tiddlers.length; t++)
			if (tiddlers[t].status)
				newText += '#[['+tiddlers[t].title+']] - '+tiddlers[t].status+'\n';
		newText += '&lt;&lt;&lt;\n';
		// get current report (if any)
		var title=config.macros.loadTiddlers.reportTitle;
		var currText='';
		var theReport = store.getTiddler(title);
		if (theReport) currText=((theReport.text!='')?'\n----\n':'')+theReport.text;
		// update the ImportedTiddlers content and show the tiddler
		store.saveTiddler(title, title, newText+currText, config.options.txtUserName, new Date(), theReport?theReport.tags:null, theReport?theReport.fields:null);
		if (!(quiet || noreportshow) ) { story.displayTiddler(null,title,1,null,null,false); story.refreshTiddler(title,1,true); }
	}
}
//}}}</pre>
</div>
<div title="LoadTiddlersPluginInfo" modifier="ELSDesignStudios" created="200801090050" modified="200910070455" tags="pluginInfo ImportExportPackage excludeMissing">
<pre>/***
|Name|LoadTiddlersPluginInfo|
|Source|http://www.TiddlyTools.com/#LoadTiddlersPlugin|
|Documentation|http://www.TiddlyTools.com/#LoadTiddlersPluginInfo|
|Version|3.8.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|documentation|
|Description|documentation for LoadTiddlersPlugin|
!!!!!Usage
&lt;&lt;&lt;
Syntax:
{{{&lt;&lt;loadTiddlers label:text prompt:text filter source quiet confirm force init noreport tag tag tag...&gt;&gt;}}}

Example:
{{{&lt;&lt;loadTiddlers &quot;label:load tiddlers from %0&quot; example.html confirm temporary&gt;&gt;}}}
&lt;&lt;loadTiddlers &quot;label:load tiddlers from %0&quot; example.html confirm temporary&gt;&gt;

Where:
''&quot;&quot;&quot;label:text&quot;&quot;&quot;'' and ''&quot;&quot;&quot;prompt:text&quot;&quot;&quot;''
&gt;defines link text and tooltip (prompt) that can be clicked to trigger the load tiddler processing.  If a label is NOT provided, then no link is created and the loadTiddlers function is performed whenever the containing tiddler is rendered.
''filter'' (optional) determines which tiddlers will be automatically selected for importing.  Use one of the following keywords:
&gt;''&quot;all&quot;'' retrieves ALL tiddlers from the import source document, even if they have not been changed.
&gt;''&quot;new&quot;'' retrieves only tiddlers that are found in the import source document, but do not yet exist in the destination document
&gt;''&quot;changes&quot;'' retrieves only tiddlers that exist in both documents for which the import source tiddler is newer than the existing tiddler
&gt;''&quot;updates&quot;'' retrieves both ''new'' and ''changed'' tiddlers (this is the default action when none is specified)
&gt;''&quot;&quot;&quot;&quot;tiddler:TiddlerName&quot;&quot;&quot;&quot;'' retrieves only the specific tiddler named in the parameter.
&gt;''&quot;&quot;&quot;&quot;tag:text&quot;&quot;&quot;&quot;'' retrieves only the tiddlers tagged with the indicated text.
&gt;&gt; Note: ''if an existing tiddler is tagged with 'noReload', then it will not be overwritten'', even if the inbound tiddler has been selected by the filtering process.  This allows you to make local changes to imported tiddlers while ensuring that those changes won't be lost due to automatic tiddler updates retrieved from the import source document.
''source'' (required) is the location of the imported document.  It can be either a local document path/filename in whatever format your system requires, or a remote web location (starting with &quot;http://&quot; or &quot;https://&quot;)
&gt;use the keyword ''ask'' to prompt for a source location whenever the macro is invoked
''&quot;quiet&quot;'' (optional)
&gt;supresses all status message during the import processing (e.g., &quot;opening local file...&quot;, &quot;found NN tiddlers...&quot; etc).  Note that if ANY tiddlers are actualy imported, a final information message will still be displayed (along with the ImportedTiddlers report), even when 'quiet' is specified.  This ensures that changes to your document cannot occur without any visible indication at all.
''&quot;confirm&quot;'' (optional)
&gt;adds interactive confirmation.  A browser message box (OK/Cancel) is displayed for each tiddler that will be imported, so that you can manually bypass any tiddlers that you do not want to import.
''&quot;init&quot;'' (optional)
&gt;invoke tiddlers tagged with &lt;&lt;tag systemConfig&gt;&gt; as plugins as soon as they are imported, without requiring a save-and-reload action first.  For safety, a browser message box (OK/Cancel) is displayed for each imported plugin, so that you can manually bypass any plugins that you do not want to invoke.  Note, however, that those tiddlers are still //imported// into your document and therefore will still take effect the next time you save-and-reload the document.
''&quot;force&quot;'' (optional)
&gt;import all matching tiddlers, even if unchanged
''&quot;noreport&quot;'' (optional)
&gt;suppress generation of [[ImportedTiddlers]] report
''&quot;tag tag tag...&quot;'' (optional)
&gt;any remaining parameters are used as tag values to be added to each imported tiddler (i.e., &quot;tag-on-import&quot;)
&lt;&lt;&lt;
!!!!!Configuration
&lt;&lt;&lt;
&lt;&lt;option chkLoadTiddlersShowReport&gt;&gt;after loading tiddlers, automatically display [[ImportedTiddlers]] (if created)
__password-protected server settings //(optional, if needed)//:__
&gt;username: &lt;&lt;option txtRemoteUsername&gt;&gt; password: &lt;&lt;option txtRemotePassword&gt;&gt;
&gt;{{{usage: &lt;&lt;option txtRemoteUsername&gt;&gt; &lt;&lt;option txtRemotePassword&gt;&gt;}}}
&gt;''note: these settings are also used by [[ExternalTiddlersPlugin]] and [[ImportTiddlersPlugin]]''
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.10.08 3.8.1 removed switchTheme() from doImport()... causes an INFINITE cycle of imports!
2009.10.06 3.8.0 added createTiddlerFromFile (import text files)
2009.10.04 3.7.8 in doImport(), call switchTheme() after loading tiddlers
2009.09.27 3.7.7 in readTiddlersFromCSV(), strip \r from input and fixed handling for quoted values
2009.09.01 3.7.6 added config.options.chkLoadTiddlersShowReport (default=true)
2009.09.01 3.7.6 added config.options.chkLoadTiddlersShowReport (default=true)
2009.08.30 3.7.5 in doImport(), check status and report error, if any
2009.08.29 3.7.4 in handler(), added 'return false' in button function (fixes IE page transition)
2009.08.19 3.7.3 in doImport(), fixed 'init' handling
2009.08.16 3.7.2 in doImport(), corrected check for tiddlers returned by readTiddlersFromHTML();
2009.07.03 3.7.1 fixups for TW252: doHttp() doesn't return XHR and convertUTF8ToUnicode() not needed for local I/O
2009.05.04 3.7.0 read CSV file format
2008.11.14 3.6.4 in loadFile(), force use of XMLHttpRequest if not viewing a local document (supports use of relative file references when online)
2008.10.27 3.6.3 in doImport(), fixed Safari bug by replacing static Array.concat(...) with new Array().concat(...)
2008.08.05 3.6.2 rewrote loadFile() to eliminate use of platform-specific fileExists() test
2008.08.03 3.6.1 in handler(), changed variable 'prompt' to 'tip' to avoid conflict with prompt() function
2008.01.07 3.6.0 added 'init' option to automatically invoke plugin tiddlers as soon as they are loaded (without needing save/reload)
2008.01.03 3.5.0 in loadFile(), use lower-level doHttp() instead of loadRemoteFile() in order to support username/password access to remote server
2007.12.04 *.*.* update for TW2.3.0: replaced deprecated core functions, regexps, and macros
2007.06.27 3.4.8 added missing 'fields' params to saveTiddler() call. Fixes problem where importing tiddlers would lose the custom fields.
2007.06.25 3.4.7 add calls to store.suspendNotifications() and store.resumeNotifications() to eliminate redisplay overhead DURING import activities.
2007.05.27 3.4.6 in handler(), loadRemoteFile() and doImport(), added 'noreport' flag to suppress generation of ImportedTiddlers
2007.05.27 3.4.5 in handler(), initialize 'newTags' to [] (empty array) instead of null... fixes fatal error when loading tiddler without autotagging.
2007.04.22 3.4.4 in readTiddlersFromHTML(), for TW2.2 and above, use importTiddlyWiki() (new core functionality) to get tiddlers from remote file content.  Also, copied updated TW21Loader.prototype.internalizeTiddler() definition from TW2.2b5 so plugin can read tiddlers from TW2.2+ even when running under TW2.1.x
2007.04.05 3.4.3 in doImport(), changed this.readTiddlersFromHTML(html) to config.macros.loadTiddlers.readTiddlersFromHTML(html).
2007.03.26 3.4.2 renamed import() to doImport() to fix IE load-time error (&quot;identifier expected&quot;).  &quot;import&quot; is a reserved word in some browsers...
2007.03.22 3.4.1 code cleanup: moved all functions inside object def'n, re-wrote report function
2007.03.21 3.4.0 split ImportTiddlersPlugin and LoadTiddlersPlugin into separate plugins
|please see [[ImportTiddlersPluginInfo]] for additional revision details|
2005.07.20 1.0.0 Initial Release
&lt;&lt;&lt;</pre>
</div>
<div title="MainMenu" modifier="JohnRouillard" created="200903151820" modified="201007312147" tags="structure">
<pre>[[Welcome]]
[[ContentChanges]]
--------
&lt;&lt;tiddler ShowPopup with: [[BookmarkList]] &quot;Bookmarks&quot; &quot;User's list of bookmarked tiddlers.&quot; &gt;&gt; @@font-size: smaller;[[(open)|BookmarkList]]@@
--------
&lt;&lt;toggleSideBar &quot;Toggle Right Bar&quot; '' show&gt;&gt;
--------
&lt;&lt;tiddler InstructorMainMenu&gt;&gt;
!Presentations
&lt;&lt;openStory list &quot;story and presentation&quot; &gt;&gt;
&lt;&lt;tiddler PresentationList&gt;&gt;
!Chapters
&lt;&lt;openStory list &quot;story and chapter&quot; &gt;&gt;
&lt;&lt;tiddler ChapterList&gt;&gt;
!Quizzes
&lt;&lt;tiddler QuizList&gt;&gt;</pre>
</div>
<div title="MatchTagsPlugin" modifier="ELSDesignStudios" created="200802290709" modified="201003012349" tags="systemConfig excludeMissing">
<pre>/***
|Name|MatchTagsPlugin|
|Source|http://www.TiddlyTools.com/#MatchTagsPlugin|
|Documentation|http://www.TiddlyTools.com/#MatchTagsPluginInfo|
|Version|2.0.3|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Description|'tag matching' with full boolean expressions (AND, OR, NOT, and nested parentheses)|
!!!!!Documentation
&gt; see [[MatchTagsPluginInfo]]
!!!!!Revisions
&lt;&lt;&lt;
2010.03.02 2.0.3 added %6 format (tags)
| please see [[MatchTagsPluginInfo]] for additional revision details |
2008.02.28 1.0.0 initial release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.MatchTagsPlugin= {major: 2, minor: 0, revision: 3, date: new Date(2010,3,2)};

// store.getMatchingTiddlers() processes boolean expressions for tag matching
//    sortfield (optional) sets sort order for tiddlers - default=title
//    tiddlers (optional) use alternative set of tiddlers (instead of current store)
TiddlyWiki.prototype.getMatchingTiddlers = function(tagexpr,sortfield,tiddlers) {

	var debug=config.options.chkDebug; // abbreviation
	var cmm=config.macros.matchTags; // abbreviation
	var r=[]; // results are an array of tiddlers
	var tids=tiddlers||store.getTiddlers(sortfield||&quot;title&quot;);
	if (tiddlers &amp;&amp; sortfield) store.sortTiddlers(tids,sortfield);
	if (debug) displayMessage(cmm.msg1.format([tids.length]));

	// try simple lookup to quickly find single tags or tags that
	// contain boolean operators as literals, e.g. &quot;foo and bar&quot;
	for (var t=0; t&lt;tids.length; t++)
		if (tids[t].isTagged(tagexpr)) r.pushUnique(tids[t]);
	if (r.length) {
		if (debug) displayMessage(cmm.msg4.format([r.length,tagexpr]));
		return r;
	}
	
	// convert expression into javascript code with regexp tests,
	// so that &quot;tag1 AND ( tag2 OR NOT tag3 )&quot; becomes
	// &quot;/\~tag1\~/.test(...) &amp;&amp; ( /\~tag2\~/.test(...) || ! /\~tag3\~/.test(...) )&quot;

	// normalize whitespace, tokenize operators, delimit with &quot;~&quot;
	var c=tagexpr.trim(); // remove leading/trailing spaces
	c = c.replace(/\s+/ig,&quot; &quot;); // reduce multiple spaces to single spaces
	c = c.replace(/\(\s?/ig,&quot;~(~&quot;); // open parens
	c = c.replace(/\s?\)/ig,&quot;~)~&quot;); // close parens
	c = c.replace(/(\s|~)?&amp;&amp;(\s|~)?/ig,&quot;~&amp;&amp;~&quot;); // &amp;&amp;
	c = c.replace(/(\s|~)AND(\s|~)/ig,&quot;~&amp;&amp;~&quot;); // AND
	c = c.replace(/(\s|~)?\|\|(\s|~)?/ig,&quot;~||~&quot;); // ||
	c = c.replace(/(\s|~)OR(\s|~)/ig,&quot;~||~&quot;); // OR
	c = c.replace(/(\s|~)?!(\s|~)?/ig,&quot;~!~&quot;); // !
	c = c.replace(/(^|~|\s)NOT(\s|~)/ig,&quot;~!~&quot;); // NOT
	c = c.replace(/(^|~|\s)NOT~\(/ig,&quot;~!~(&quot;); // NOT(
	// change tag terms to regexp tests
	var terms=c.split(&quot;~&quot;); for (var i=0; i&lt;terms.length; i++) { var t=terms[i];
		if (/(&amp;&amp;)|(\|\|)|[!\(\)]/.test(t) || t==&quot;&quot;) continue; // skip operators/parens/spaces
		if (t==config.macros.matchTags.untaggedKeyword)
			terms[i]=&quot;tiddlertags=='~~'&quot;; // 'untagged' tiddlers
		else
			terms[i]=&quot;/\\~&quot;+t+&quot;\\~/.test(tiddlertags)&quot;;
	}
	c=terms.join(&quot; &quot;);
	if (debug) { displayMessage(cmm.msg2.format([tagexpr])); displayMessage(cmm.msg3.format([c])); }

	// scan tiddlers for matches
	for (var t=0; t&lt;tids.length; t++) {
	 	// assemble tags from tiddler into string &quot;~tag1~tag2~tag3~&quot;
		var tiddlertags = &quot;~&quot;+tids[t].tags.join(&quot;~&quot;)+&quot;~&quot;;
		try { if(eval(c)) r.push(tids[t]); } // test tags
		catch(e) { // error in test
			displayMessage(cmm.msg2.format([tagexpr]));
			displayMessage(cmm.msg3.format([c]));
			displayMessage(e.toString());
			break; // skip remaining tiddlers
		}
	}
	if (debug) displayMessage(cmm.msg4.format([r.length,tagexpr]));
	return r;
}
//}}}
//{{{
config.macros.matchTags = {
	msg1: &quot;scanning %0 input tiddlers&quot;,
	msg2: &quot;looking for '%0'&quot;,
	msg3: &quot;using expression: '%0'&quot;,
	msg4: &quot;found %0 tiddlers matching '%1'&quot;,
	noMatch: &quot;no matching tiddlers&quot;,
	untaggedKeyword: &quot;-&quot;,
	untaggedLabel: &quot;no tags&quot;,
	untaggedPrompt: &quot;show tiddlers with no tags&quot;,
	defTiddler: &quot;MatchingTiddlers&quot;,
	defTags: &quot;&quot;,
	defFormat: &quot;[[%0]]&quot;,
	defSeparator: &quot;\n&quot;,
	reportHeading: &quot;Found %0 tiddlers tagged with: '{{{%1}}}'\n----\n&quot;,
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		var mode=params[0]?params[0].toLowerCase():'';
		if (mode==&quot;inline&quot;)
			params.shift();
		if (mode==&quot;report&quot; || mode==&quot;panel&quot;) {
			params.shift();
			var target=params.shift()||this.defTiddler;
		}
		if (mode==&quot;popup&quot;) {
			params.shift();
			if (params[0]&amp;&amp;params[0].substr(0,6)==&quot;label:&quot;) var label=params.shift().substr(6);
			if (params[0]&amp;&amp;params[0].substr(0,7)==&quot;prompt:&quot;) var prompt=params.shift().substr(7);
		} else {
			var fmt=(params.shift()||this.defFormat).unescapeLineBreaks();
			var sep=(params.shift()||this.defSeparator).unescapeLineBreaks();
		}
		var sortBy=&quot;+title&quot;;
		if (params[0]&amp;&amp;params[0].substr(0,5)==&quot;sort:&quot;) sortBy=params.shift().substr(5);
		var expr = params.join(&quot; &quot;);
		if (mode!=&quot;panel&quot; &amp;&amp; (!expr||!expr.trim().length)) return;
		if (expr==this.untaggedKeyword)
			{ var label=this.untaggedLabel; var prompt=this.untaggedPrompt };
		switch (mode) {
			case &quot;popup&quot;: this.createPopup(place,label,expr,prompt,sortBy); break;
			case &quot;panel&quot;: this.createPanel(place,expr,fmt,sep,sortBy,target); break;
			case &quot;report&quot;: this.createReport(target,this.defTags,expr,fmt,sep,sortBy); break;
			case &quot;inline&quot;: default: this.createInline(place,expr,fmt,sep,sortBy); break;
		}
	},
	formatList: function(tids,fmt,sep) {
		var out=[];
		for (var i=0; i&lt;tids.length; i++) { var t=tids[i];
			var title=t.title;
			var who=t.modifier;
			var when=t.modified.toLocaleString();
			var text=t.text;
			var first=t.text.split(&quot;\n&quot;)[0];
			var desc=store.getTiddlerSlice(t.title,&quot;description&quot;);
			desc=desc||store.getTiddlerSlice(t.title,&quot;Description&quot;);
			desc=desc||store.getTiddlerText(t.title+&quot;##description&quot;);
			desc=desc||store.getTiddlerText(t.title+&quot;##Description&quot;);
			var tags=t.tags.length?'[['+t.tags.join(']] [[')+']]':'';
			out.push(fmt.format([title,who,when,text,first,desc,tags]));
		}
		return out.join(sep);
	},
	createInline: function(place,expr,fmt,sep,sortBy) {
		wikify(this.formatList(store.sortTiddlers(store.getMatchingTiddlers(expr),sortBy),fmt,sep),place);
	},
	createPopup: function(place,label,expr,prompt,sortBy) {
		var btn=createTiddlyButton(place,
			(label||expr).format([expr]),
			(prompt||config.views.wikified.tag.tooltip).format([expr]),
			function(ev){ return config.macros.matchTags.showPopup(this,ev||window.event); });
		btn.setAttribute(&quot;sortBy&quot;,sortBy);
		btn.setAttribute(&quot;expr&quot;,expr);
	},
	showPopup: function(here,ev) {
		var p=Popup.create(here); if (!p) return false;
		var tids=store.getMatchingTiddlers(here.getAttribute(&quot;expr&quot;));
		store.sortTiddlers(tids,here.getAttribute(&quot;sortBy&quot;));
		var list=[]; for (var t=0; t&lt;tids.length; t++) list.push(tids[t].title);
		if (!list.length) createTiddlyText(p,this.noMatch);
		else {
			var b=createTiddlyButton(createTiddlyElement(p,&quot;li&quot;),
				config.views.wikified.tag.openAllText,
				config.views.wikified.tag.openAllTooltip,
				function() {
					var list=this.getAttribute(&quot;list&quot;).readBracketedList();
					story.displayTiddlers(null,tids);
				});
			b.setAttribute(&quot;list&quot;,&quot;[[&quot;+list.join(&quot;]] [[&quot;)+&quot;]]&quot;);
			createTiddlyElement(p,&quot;hr&quot;);
		}
		var out=this.formatList(tids,&quot; &amp;nbsp;[[%0]]&amp;nbsp; &quot;,&quot;\n&quot;); wikify(out,p);
		Popup.show();
		ev.cancelBubble=true;
		if(ev.stopPropagation) ev.stopPropagation();
		return false;
	},
	createReport: function(target,tags,expr,fmt,sep,sortBy) {
		var tids=store.sortTiddlers(store.getMatchingTiddlers(expr),sortBy);
		if (!tids.length) { displayMessage('no matches for: '+expr); return false; }
		var msg=config.messages.overwriteWarning.format([target]);
		if (store.tiddlerExists(target) &amp;&amp; !confirm(msg)) return false;
		var out=this.reportHeading.format([tids.length,expr])
		out+=this.formatList(tids,fmt,sep);
		store.saveTiddler(target,target,out,config.options.txtUserName,new Date(),tags,{});
		story.closeTiddler(target); story.displayTiddler(null,target);
	},
	createPanel: function(place,expr,fmt,sep,sortBy,tid) {
		var s=createTiddlyElement(place,&quot;span&quot;); s.innerHTML=store.getTiddlerText(&quot;MatchTagsPlugin##html&quot;);
		var f=s.getElementsByTagName(&quot;form&quot;)[0];
		f.expr.value=expr; f.fmt.value=fmt; f.sep.value=sep.escapeLineBreaks();
		f.tid.value=tid; f.tags.value=this.defTags;
	}
};
//}}}
/***
//{{{
!html
&lt;form style='display:inline;white-space:nowrap'&gt;
&lt;input type='text'    name='expr' style='width:50%' title='tag expression'&gt;&lt;!--
--&gt;&lt;input type='text'    name='fmt'  style='width:10%' title='list item format'&gt;&lt;!--
--&gt;&lt;input type='text'    name='sep'  style='width:5%'  title='list item separator'&gt;&lt;!--
--&gt;&lt;input type='text'    name='tid'  style='width:12%' title='target tiddler title'&gt;&lt;!--
--&gt;&lt;input type='text'    name='tags' style='width:10%' title='target tiddler tags'&gt;&lt;!--
--&gt;&lt;input type='button'  name='go'   style='width:8%'  value='go' onclick=&quot;
	var expr=this.form.expr.value;
	if (!expr.length) { alert('Enter a boolean tag expression'); return false; }
	var fmt=this.form.fmt.value;
	if (!fmt.length) { alert('Enter the list item output format'); return false; }
	var sep=this.form.sep.value.unescapeLineBreaks();
	var tid=this.form.tid.value;
	if (!tid.length) { alert('Enter a target tiddler title'); return false; }
	var tags=this.form.tags.value;
	config.macros.matchTags.createReport(tid,tags,expr,fmt,sep,'title');
	return false;&quot;&gt;
&lt;/form&gt;
!end
//}}}
***/
//{{{
// SHADOW TIDDLER for displaying default panel input form
config.shadowTiddlers.MatchTags=&quot;&lt;&lt;matchTags panel&gt;&gt;&quot;;
//}}}
//{{{
// TWEAK core filterTiddlers() for enhanced boolean matching in [tag[...]] syntax:
// use getMatchingTiddlers instead getTaggedTiddlers
var fn=TiddlyWiki.prototype.filterTiddlers;
fn=fn.toString().replace(/getTaggedTiddlers/g,&quot;getMatchingTiddlers&quot;);
eval(&quot;TiddlyWiki.prototype.filterTiddlers=&quot;+fn);
//}}}
//{{{
// REDEFINE core handler for enhanced boolean matching in tag:&quot;...&quot; paramifier
// use filterTiddlers() instead of getTaggedTiddlers() to get list of tiddlers.
config.paramifiers.tag = {
	onstart: function(v) {
		var tagged = store.filterTiddlers(&quot;[tag[&quot;+v+&quot;]]&quot;);
		story.displayTiddlers(null,tagged,null,false,null);
	}
};
//}}}</pre>
</div>
<div title="MatchTagsPluginInfo" modifier="ELSDesignStudios" created="200802290757" modified="201003012348" tags="pluginInfo excludeMissing">
<pre>/***
|Name|MatchTagsPluginInfo|
|Source|http://www.TiddlyTools.com/#MatchTagsPlugin|
|Documentation|http://www.TiddlyTools.com/#MatchTagsPluginInfo|
|Version|2.0.3|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|documentation|
|Description|documentation for MatchTagsPlugin|
!!!!!Usage
&lt;&lt;&lt;
This plugin extends the {{{[tag[tagname]]}}} macro parameter syntax used by the TiddlyWiki core {{{&lt;&lt;list&gt;&gt;}}} macro so that, instead of a simple tagname value, you can specify a complex combination of tagname values using a //boolean expression// containing AND, OR, and NOT operators, enclosed in nested parentheses if needed.
{{{
&lt;&lt;list filter &quot;[tag[expression]]&quot;&gt;&gt;
}}}
In addition, the plugin defines a new macro, {{{&lt;&lt;matchTags ...&gt;&gt;}}} that can be used instead of the core {{{&lt;&lt;list&gt;&gt;}}} macro to output a list of matching tiddlers //using a custom 'item format' and 'separator'//.  You can also use this macro to create a command link that displays the matching tiddlers within a popup list, similar to the standard {{{&lt;&lt;tag tagName&gt;&gt;}}} macro, but matching a combination of tag values rather than a single tag value.
{{{
&lt;&lt;matchTags inline &quot;format&quot; &quot;separator&quot; sort:fieldname tag expression&gt;&gt;
&lt;&lt;matchTags popup &quot;label:...&quot; &quot;prompt:...&quot; sort:fieldname tag expression&gt;&gt;
&lt;&lt;matchTags report TiddlerName &quot;format&quot; &quot;separator&quot; sort:fieldname tag expression&gt;&gt;
&lt;&lt;matchTags panel  Tiddlername &quot;format&quot; &quot;separator&quot; sort:fieldname tag expression&gt;&gt;
}}}
where:
* ''inline'', ''report'', ''panel'', and ''popup''&lt;br&gt;are keywords that indicate the type of output that the macro should produce:
** ''inline'' //(default)// - displays a list of matching tiddlers embedded directly in tiddler content
** ''popup'' - embeds a command button that, when clicked, lists matching tiddlers in a ~TiddlyWiki popup display
** ''report'' - generates a list of matching tiddler in a separate [[MatchingTiddlers]] report tiddler
** ''panel'' - displays an interactive form for generating a [[MatchingTiddlers]] report
* ''format''&lt;br&gt;defines the wiki-syntax for rendering list items.  The following //substitution markers// can be used to insert tiddler-specific information for each matched tiddler:
** {{{%0}}} - title
** {{{%1}}} - modifier (author)
** {{{%2}}} - modified (date of last change)
** {{{%3}}} - text (all tiddler content)
** {{{%4}}} - firstline (tiddler content up to the first newline)
** {{{%5}}} - description (tiddler slice or section content named &quot;description&quot; or &quot;Description&quot;)
** {{{%6}}} - tags (space-separated, bracketed list)
* ''separator''&lt;br&gt;defines the wiki-syntax to use //between// each matching title (e.g., &quot;, &quot; creates a comma-separated list, while &quot;\n&quot; displays one tiddler per line).
* ''sort:fieldname'' (optional)&lt;br&gt;specifies the sort order for the resulting list of tiddlers.  You can specify any tiddler field name (standard or custom-defined).  Standard tiddler fieldnames include: //title, created, modified, modifier//.  If not specified, tiddlers are sorted by title.  You can prefix the fieldname with &quot;+&quot; or &quot;-&quot; to indicate ascending or descending order, respectively.
* ''tag expression''&lt;br&gt;the remaining parameter(s) are joined together to define the boolean expression to be matched.
When using the ''popup'' option, there are two additional (and optional) parameters you can specify:
* ''&quot;label:...&quot;''(optional)&lt;br&gt; indicates the text for the popup command link.  The default is to display the specified tag expression itself.
* ''&quot;prompt:...&quot;'' (optional)&lt;br&gt;indicates the mouseover 'tooltip' for the popup command link.
When using the ''report'' or ''panel'' option, an additional parameter may be provided:
* ''~TiddlerName''&lt;br&gt;specifies the target tiddler into which the output will be generated (default: [[MatchingTiddlers]])
Notes:
*A tag expression can use any combination of text operators: ''AND'', ''OR'', ''NOT'' (or their equivalent javascript operators: ''&amp;&amp;'', ''||'', ''!''), contained in nested parentheses as needed.
*Operators should be delimited by spaces or parentheses.
*Before matching, leading/trailing spaces are automatically trimmed and multiple spaces are reduced to single spaces.
*Tag values containing embedded spaces do //not// have to be enclosed in {{{[[...]]}}}.
*Tag values that contain boolean operators as ''literal text'' (e.g., {{{&quot;foo and bar&quot;}}} or {{{&quot;foo &amp;&amp; bar&quot;}}} cannot be used within a compound boolean expression, but //can// be matched if specified by themselves, without any other tag values or operators.
*To match tiddlers that are untagged, use &quot;-&quot; as a special tag value within the expression.
*You can match &quot;wildcard&quot; tags  by using //regular expression// (i.e., &quot;text pattern&quot;) syntax within a tag value, e.g. {{{[Tt]agvalue.*}}}
&lt;&lt;&lt;
!!!!!Examples:
&lt;&lt;&lt;
display a popup list:
{{{
&lt;&lt;matchTags popup sample OR (settings AND systemConfig)&gt;&gt;
}}}
&gt;&lt;&lt;matchTags popup sample OR (settings AND systemConfig)&gt;&gt;
display a popup list with custom label:
{{{
&lt;&lt;matchTags popup &quot;label:samples and settings&quot; sample OR (settings AND systemConfig)&gt;&gt;
}}}
&gt;&lt;&lt;matchTags popup &quot;label:samples and settings&quot; sample OR (settings AND systemConfig)&gt;&gt;
display a popup list of untagged tiddlers:
{{{
&lt;&lt;matchTags popup -&gt;&gt;
}}}
&gt;&lt;&lt;matchTags popup -&gt;&gt;
generate a report using interactive form control panel
{{{
&lt;&lt;matchTags panel &quot;MatchingTiddlers&quot; &quot;[[%0]]&quot; &quot;\n&quot; sample OR (settings AND systemConfig)&gt;&gt;
}}}
&gt;{{smallform{&lt;&lt;matchTags panel &quot;MatchingTiddlers&quot; &quot;[[%0]]&quot; &quot;\n&quot; sample OR (settings AND systemConfig)&gt;&gt;}}}
comma-separated list:
{{{
&lt;&lt;matchTags &quot;[[%0]]&quot; &quot;, &quot; sample OR (settings AND systemConfig)&gt;&gt;
}}}
&gt;&lt;&lt;matchTags &quot;[[%0]]&quot; &quot;, &quot; sample OR (settings AND systemConfig)&gt;&gt;
numbered list (sorted by modification date, most recent first):
{{{
&lt;&lt;matchTags &quot;#[[%0]] (%2)&lt;br&gt;^^%5^^&quot; &quot;\n&quot; sort:-modified sample OR (settings AND systemConfig)&gt;&gt;
}}}
&gt;&lt;&lt;matchTags &quot;#[[%0]] (%2)&lt;br&gt;^^%5^^&quot; &quot;\n&quot; sort:-modified sample OR (settings AND systemConfig)&gt;&gt;
bullet-item list (using the TiddlyWiki core {{{&lt;&lt;list filter ...&gt;&gt;}}} macro):
//(Note: when using the core {{{&lt;&lt;list&gt;&gt;}}} macro, you should always enclose the entire tag filter parameter within quotes)//
{{{
&lt;&lt;list filter &quot;[tag[sample OR (settings AND systemConfig)]]&quot;&gt;&gt;
}}}
&gt;&lt;&lt;list filter &quot;[tag[sample OR (settings AND systemConfig)]]&quot;&gt;&gt;
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2010.03.02 2.0.3 added %6 format (tags)
2010.03.01 2.0.2 in formatList(), don't automatically put '[[' and ']]' around title (%0) in formatted output
2009.08.29 2.0.1 added support for {{{config.macros.matchTags.defTags}}} to auto-tag [[MatchingTiddlers]] output
2008.09.04 2.0.0 added &quot;report&quot; and &quot;panel&quot; options to generate formatted results and store in a tiddler.  Also, added config.macros.matchTags.formatList(place,fmt,sep) API to return formatted output for use with other plugins/scripts
2008.09.01 1.9.2 fixed return value from popup button handler so IE doesn't attempt to leave the page
2008.08.31 1.9.1 improved expression conversion handling to permit use of regular expressions for &quot;wildcard&quot; matching within tag values
2008.06.12 1.9.0 added support for formatted output of: title, who, when, text, firstline, description (slice or section)
2008.06.05 1.8.0 in getMatchingTiddlers(), added optional sortfield and tiddlers params to support use of alternative set of tiddlers instead of using current store content (provides filtering support for ImportTiddlersPlugin)
2008.06.04 1.7.1 in getMatchingTiddlers(), reworked conversion of expression for more robust parsing of whitespace, parentheses and javascript operators and allow use of &quot;-&quot; (untagged) //within// expressions
2008.05.19 1.7.0 in getMatchingTiddlers(), use reverseLookup() instead of forEachTiddler() to permit access to tiddlers included via [[IncludePlugin|http://tiddlywiki.abego-software.de/#IncludePlugin]]
2008.05.17 1.6.0 in getMatchingTiddlers(), rewrote expression conversion to handle tags with spaces tag values that are substrings of other tag values.
2008.05.16 1.5.0 added special case using &quot;-&quot; to find UNTAGGED tiddlers
2008.05.15 1.4.0 added &quot;popup&quot; output option
2008.05.14 1.3.4 instead of hijacking getTaggedTiddlers(), added tweak of filterTiddlers() prototype to replace getTaggedTiddlers() with getMatchingTiddler() so that core use of getTaggedTiddlers() does not perform boolean processing of tiddler titles such as [[To Be or not To Be]].  Also, improved &quot;filter error&quot; messages in getMatchingTiddlers() to report tag expression in addition to actual eval error.
2008.04.25 1.3.3 in getTaggedTiddlers(), fixed handling for &quot;not&quot; embedded within a tag
2008.04.21 1.3.2 in getTaggedTiddlers(), fixed handling for initial &quot;NOT&quot; and &quot;NOT(expr)&quot; syntax
2008.04.20 1.3.1 in getTaggedTiddlers(), corrected check for boolean expression to avoid excess processing of tags containing spaces.  Also, improved handling for non-existing tags that contain text of existing tags
2008.04.19 1.3.0 in filterTiddlers(), use getTaggedTiddlers() instead of matchTags(), and then hijack getTaggedTiddlers() to add matchTags() handling
2008.04.19 [*.*.*] plugin size reduction: moved documentation to [[MatchTagsPluginInfo]]
2008.03.25 1.2.0 added optional &quot;sort:fieldname&quot; parameter
2008.03.20 1.1.2 in handler(), replace 'encodeTiddlyLink' with explicit [[...]] brackets to ensure that one-word tiddler titles are properly rendered as TiddlyLinks
2008.02.29 1.1.1 in matchTags(), added handling to skip remaining tiddlers if expression has an error
2008.02.29 1.1.0 refactored to define store.matchTags() and extend store.filterTiddlers()
2008.02.28 1.0.0 initial release
&lt;&lt;&lt;</pre>
</div>
<div title="MatchTagsPluginTweaks" modifier="JohnRouillard" created="200909012359" modified="200909020334" tags="systemConfig excludeMissing InstructorOnly excludeOrphans">
<pre>/***
! Make MatchingTiddlers tiddler temporary

Don't want to save the report of the MatchTags tiddler.
***/

//{{{
config.macros.matchTags.defTags=&quot;temporary&quot;;
//}}}</pre>
</div>
<div title="NestedSlidersPlugin" modifier="ELSDesignStudios" created="200512161202" modified="200811160623" tags="DiscoveryPackage TaskPackage TidIDEPackage systemConfig excludeMissing">
<pre>/***
|Name|NestedSlidersPlugin|
|Source|http://www.TiddlyTools.com/#NestedSlidersPlugin|
|Documentation|http://www.TiddlyTools.com/#NestedSlidersPluginInfo|
|Version|2.4.9|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides||
|Options|##Configuration|
|Description|show content in nest-able sliding/floating panels, without creating separate tiddlers for each panel's content|
!!!!!Documentation
&gt;see [[NestedSlidersPluginInfo]]
!!!!!Configuration
&lt;&lt;&lt;
&lt;&lt;option chkFloatingSlidersAnimate&gt;&gt; allow floating sliders to animate when opening/closing
&gt;Note: This setting can cause 'clipping' problems in some versions of InternetExplorer.
&gt;In addition, for floating slider animation to occur you must also allow animation in general (see [[AdvancedOptions]]).
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2008.11.15 - 2.4.9 in adjustNestedSlider(), don't make adjustments if panel is marked as 'undocked' (CSS class).  In onClickNestedSlider(), SHIFT-CLICK docks panel (see [[MoveablePanelPlugin]])
|please see [[NestedSlidersPluginInfo]] for additional revision details|
2005.11.03 - 1.0.0 initial public release.  Thanks to RodneyGomes, GeoffSlocock, and PaulPetterson for suggestions and experiments.
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.NestedSlidersPlugin= {major: 2, minor: 4, revision: 9, date: new Date(2008,11,15)};

// options for deferred rendering of sliders that are not initially displayed
if (config.options.chkFloatingSlidersAnimate===undefined)
	config.options.chkFloatingSlidersAnimate=false; // avoid clipping problems in IE

// default styles for 'floating' class
setStylesheet(&quot;.floatingPanel { position:absolute; z-index:10; padding:0.5em; margin:0em; \
	background-color:#eee; color:#000; border:1px solid #000; text-align:left; }&quot;,&quot;floatingPanelStylesheet&quot;);

// if removeCookie() function is not defined by TW core, define it here.
if (window.removeCookie===undefined) {
	window.removeCookie=function(name) {
		document.cookie = name+'=; expires=Thu, 01-Jan-1970 00:00:01 UTC; path=/;'; 
	}
}

config.formatters.push( {
	name: &quot;nestedSliders&quot;,
	match: &quot;\\n?\\+{3}&quot;,
	terminator: &quot;\\s*\\={3}\\n?&quot;,
	lookahead: &quot;\\n?\\+{3}(\\+)?(\\([^\\)]*\\))?(\\!*)?(\\^(?:[^\\^\\*\\@\\[\\&gt;]*\\^)?)?(\\*)?(\\@)?(?:\\{\\{([\\w]+[\\s\\w]*)\\{)?(\\[[^\\]]*\\])?(\\[[^\\]]*\\])?(?:\\}{3})?(\\#[^:]*\\:)?(\\&gt;)?(\\.\\.\\.)?\\s*&quot;,
	handler: function(w)
		{
			lookaheadRegExp = new RegExp(this.lookahead,&quot;mg&quot;);
			lookaheadRegExp.lastIndex = w.matchStart;
			var lookaheadMatch = lookaheadRegExp.exec(w.source)
			if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart)
			{
				var defopen=lookaheadMatch[1];
				var cookiename=lookaheadMatch[2];
				var header=lookaheadMatch[3];
				var panelwidth=lookaheadMatch[4];
				var transient=lookaheadMatch[5];
				var hover=lookaheadMatch[6];
				var buttonClass=lookaheadMatch[7];
				var label=lookaheadMatch[8];
				var openlabel=lookaheadMatch[9];
				var panelID=lookaheadMatch[10];
				var blockquote=lookaheadMatch[11];
				var deferred=lookaheadMatch[12];

				// location for rendering button and panel
				var place=w.output;

				// default to closed, no cookie, no accesskey, no alternate text/tip
				var show=&quot;none&quot;; var cookie=&quot;&quot;; var key=&quot;&quot;;
				var closedtext=&quot;&gt;&quot;; var closedtip=&quot;&quot;;
				var openedtext=&quot;&lt;&quot;; var openedtip=&quot;&quot;;

				// extra &quot;+&quot;, default to open
				if (defopen) show=&quot;block&quot;;

				// cookie, use saved open/closed state
				if (cookiename) {
					cookie=cookiename.trim().slice(1,-1);
					cookie=&quot;chkSlider&quot;+cookie;
					if (config.options[cookie]==undefined)
						{ config.options[cookie] = (show==&quot;block&quot;) }
					show=config.options[cookie]?&quot;block&quot;:&quot;none&quot;;
				}

				// parse label/tooltip/accesskey: [label=X|tooltip]
				if (label) {
					var parts=label.trim().slice(1,-1).split(&quot;|&quot;);
					closedtext=parts.shift();
					if (closedtext.substr(closedtext.length-2,1)==&quot;=&quot;)	
						{ key=closedtext.substr(closedtext.length-1,1); closedtext=closedtext.slice(0,-2); }
					openedtext=closedtext;
					if (parts.length) closedtip=openedtip=parts.join(&quot;|&quot;);
					else { closedtip=&quot;show &quot;+closedtext; openedtip=&quot;hide &quot;+closedtext; }
				}

				// parse alternate label/tooltip: [label|tooltip]
				if (openlabel) {
					var parts=openlabel.trim().slice(1,-1).split(&quot;|&quot;);
					openedtext=parts.shift();
					if (parts.length) openedtip=parts.join(&quot;|&quot;);
					else openedtip=&quot;hide &quot;+openedtext;
				}

				var title=show=='block'?openedtext:closedtext;
				var tooltip=show=='block'?openedtip:closedtip;

				// create the button
				if (header) { // use &quot;Hn&quot; header format instead of button/link
					var lvl=(header.length&gt;5)?5:header.length;
					var btn = createTiddlyElement(createTiddlyElement(place,&quot;h&quot;+lvl,null,null,null),&quot;a&quot;,null,buttonClass,title);
					btn.onclick=onClickNestedSlider;
					btn.setAttribute(&quot;href&quot;,&quot;javascript:;&quot;);
					btn.setAttribute(&quot;title&quot;,tooltip);
				}
				else
					var btn = createTiddlyButton(place,title,tooltip,onClickNestedSlider,buttonClass);
				btn.innerHTML=title; // enables use of HTML entities in label

				// set extra button attributes
				btn.setAttribute(&quot;closedtext&quot;,closedtext);
				btn.setAttribute(&quot;closedtip&quot;,closedtip);
				btn.setAttribute(&quot;openedtext&quot;,openedtext);
				btn.setAttribute(&quot;openedtip&quot;,openedtip);
				btn.sliderCookie = cookie; // save the cookiename (if any) in the button object
				btn.defOpen=defopen!=null; // save default open/closed state (boolean)
				btn.keyparam=key; // save the access key letter (&quot;&quot; if none)
				if (key.length) {
					btn.setAttribute(&quot;accessKey&quot;,key); // init access key
					btn.onfocus=function(){this.setAttribute(&quot;accessKey&quot;,this.keyparam);}; // **reclaim** access key on focus
				}
				btn.setAttribute(&quot;hover&quot;,hover?&quot;true&quot;:&quot;false&quot;);
				btn.onmouseover=function(ev) {
					// optional 'open on hover' handling
					if (this.getAttribute(&quot;hover&quot;)==&quot;true&quot; &amp;&amp; this.sliderPanel.style.display=='none') {
						document.onclick.call(document,ev); // close transients
						onClickNestedSlider(ev); // open this slider
					}
					// mouseover on button aligns floater position with button
					if (window.adjustSliderPos) window.adjustSliderPos(this.parentNode,this,this.sliderPanel);
				}

				// create slider panel
				var panelClass=panelwidth?&quot;floatingPanel&quot;:&quot;sliderPanel&quot;;
				if (panelID) panelID=panelID.slice(1,-1); // trim off delimiters
				var panel=createTiddlyElement(place,&quot;div&quot;,panelID,panelClass,null);
				panel.button = btn; // so the slider panel know which button it belongs to
				btn.sliderPanel=panel; // so the button knows which slider panel it belongs to
				panel.defaultPanelWidth=(panelwidth &amp;&amp; panelwidth.length&gt;2)?panelwidth.slice(1,-1):&quot;&quot;;
				panel.setAttribute(&quot;transient&quot;,transient==&quot;*&quot;?&quot;true&quot;:&quot;false&quot;);
				panel.style.display = show;
				panel.style.width=panel.defaultPanelWidth;
				panel.onmouseover=function(event) // mouseover on panel aligns floater position with button
					{ if (window.adjustSliderPos) window.adjustSliderPos(this.parentNode,this.button,this); }

				// render slider (or defer until shown) 
				w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
				if ((show==&quot;block&quot;)||!deferred) {
					// render now if panel is supposed to be shown or NOT deferred rendering
					w.subWikify(blockquote?createTiddlyElement(panel,&quot;blockquote&quot;):panel,this.terminator);
					// align floater position with button
					if (window.adjustSliderPos) window.adjustSliderPos(place,btn,panel);
				}
				else {
					var src = w.source.substr(w.nextMatch);
					var endpos=findMatchingDelimiter(src,&quot;+++&quot;,&quot;===&quot;);
					panel.setAttribute(&quot;raw&quot;,src.substr(0,endpos));
					panel.setAttribute(&quot;blockquote&quot;,blockquote?&quot;true&quot;:&quot;false&quot;);
					panel.setAttribute(&quot;rendered&quot;,&quot;false&quot;);
					w.nextMatch += endpos+3;
					if (w.source.substr(w.nextMatch,1)==&quot;\n&quot;) w.nextMatch++;
				}
			}
		}
	}
)

function findMatchingDelimiter(src,starttext,endtext) {
	var startpos = 0;
	var endpos = src.indexOf(endtext);
	// check for nested delimiters
	while (src.substring(startpos,endpos-1).indexOf(starttext)!=-1) {
		// count number of nested 'starts'
		var startcount=0;
		var temp = src.substring(startpos,endpos-1);
		var pos=temp.indexOf(starttext);
		while (pos!=-1)  { startcount++; pos=temp.indexOf(starttext,pos+starttext.length); }
		// set up to check for additional 'starts' after adjusting endpos
		startpos=endpos+endtext.length;
		// find endpos for corresponding number of matching 'ends'
		while (startcount &amp;&amp; endpos!=-1) {
			endpos = src.indexOf(endtext,endpos+endtext.length);
			startcount--;
		}
	}
	return (endpos==-1)?src.length:endpos;
}
//}}}
//{{{
window.onClickNestedSlider=function(e)
{
	if (!e) var e = window.event;
	var theTarget = resolveTarget(e);
	while (theTarget &amp;&amp; theTarget.sliderPanel==undefined) theTarget=theTarget.parentNode;
	if (!theTarget) return false;
	var theSlider = theTarget.sliderPanel;
	var isOpen = theSlider.style.display!=&quot;none&quot;;

	// if SHIFT-CLICK, dock panel first (see [[MoveablePanelPlugin]])
	if (e.shiftKey &amp;&amp; config.macros.moveablePanel) config.macros.moveablePanel.dock(theSlider,e);

	// toggle label
	theTarget.innerHTML=isOpen?theTarget.getAttribute(&quot;closedText&quot;):theTarget.getAttribute(&quot;openedText&quot;);
	// toggle tooltip
	theTarget.setAttribute(&quot;title&quot;,isOpen?theTarget.getAttribute(&quot;closedTip&quot;):theTarget.getAttribute(&quot;openedTip&quot;));

	// deferred rendering (if needed)
	if (theSlider.getAttribute(&quot;rendered&quot;)==&quot;false&quot;) {
		var place=theSlider;
		if (theSlider.getAttribute(&quot;blockquote&quot;)==&quot;true&quot;)
			place=createTiddlyElement(place,&quot;blockquote&quot;);
		wikify(theSlider.getAttribute(&quot;raw&quot;),place);
		theSlider.setAttribute(&quot;rendered&quot;,&quot;true&quot;);
	}

	// show/hide the slider
	if(config.options.chkAnimate &amp;&amp; (!hasClass(theSlider,'floatingPanel') || config.options.chkFloatingSlidersAnimate))
		anim.startAnimating(new Slider(theSlider,!isOpen,e.shiftKey || e.altKey,&quot;none&quot;));
	else
		theSlider.style.display = isOpen ? &quot;none&quot; : &quot;block&quot;;

	// reset to default width (might have been changed via plugin code)
	theSlider.style.width=theSlider.defaultPanelWidth;

	// align floater panel position with target button
	if (!isOpen &amp;&amp; window.adjustSliderPos) window.adjustSliderPos(theSlider.parentNode,theTarget,theSlider);

	// if showing panel, set focus to first 'focus-able' element in panel
	if (theSlider.style.display!=&quot;none&quot;) {
		var ctrls=theSlider.getElementsByTagName(&quot;*&quot;);
		for (var c=0; c&lt;ctrls.length; c++) {
			var t=ctrls[c].tagName.toLowerCase();
			if ((t==&quot;input&quot; &amp;&amp; ctrls[c].type!=&quot;hidden&quot;) || t==&quot;textarea&quot; || t==&quot;select&quot;)
				{ try{ ctrls[c].focus(); } catch(err){;} break; }
		}
	}
	var cookie=theTarget.sliderCookie;
	if (cookie &amp;&amp; cookie.length) {
		config.options[cookie]=!isOpen;
		if (config.options[cookie]!=theTarget.defOpen) window.saveOptionCookie(cookie);
		else window.removeCookie(cookie); // remove cookie if slider is in default display state
	}

	// prevent SHIFT-CLICK from being processed by browser (opens blank window... yuck!)
	// prevent clicks *within* a slider button from being processed by browser
	// but allow plain click to bubble up to page background (to close transients, if any)
	if (e.shiftKey || theTarget!=resolveTarget(e))
		{ e.cancelBubble=true; if (e.stopPropagation) e.stopPropagation(); }
	Popup.remove(); // close open popup (if any)
	return false;
}
//}}}
//{{{
// click in document background closes transient panels 
document.nestedSliders_savedOnClick=document.onclick;
document.onclick=function(ev) { if (!ev) var ev=window.event; var target=resolveTarget(ev);

	if (document.nestedSliders_savedOnClick)
		var retval=document.nestedSliders_savedOnClick.apply(this,arguments);
	// if click was inside a popup... leave transient panels alone
	var p=target; while (p) if (hasClass(p,&quot;popup&quot;)) break; else p=p.parentNode;
	if (p) return retval;
	// if click was inside transient panel (or something contained by a transient panel), leave it alone
	var p=target; while (p) {
		if ((hasClass(p,&quot;floatingPanel&quot;)||hasClass(p,&quot;sliderPanel&quot;))&amp;&amp;p.getAttribute(&quot;transient&quot;)==&quot;true&quot;) break;
		p=p.parentNode;
	}
	if (p) return retval;
	// otherwise, find and close all transient panels...
	var all=document.all?document.all:document.getElementsByTagName(&quot;DIV&quot;);
	for (var i=0; i&lt;all.length; i++) {
		 // if it is not a transient panel, or the click was on the button that opened this panel, don't close it.
		if (all[i].getAttribute(&quot;transient&quot;)!=&quot;true&quot; || all[i].button==target) continue;
		// otherwise, if the panel is currently visible, close it by clicking it's button
		if (all[i].style.display!=&quot;none&quot;) window.onClickNestedSlider({target:all[i].button})
		if (!hasClass(all[i],&quot;floatingPanel&quot;)&amp;&amp;!hasClass(all[i],&quot;sliderPanel&quot;)) all[i].style.display=&quot;none&quot;;
	}
	return retval;
};
//}}}
//{{{
// adjust floating panel position based on button position
if (window.adjustSliderPos==undefined) window.adjustSliderPos=function(place,btn,panel) {
	if (hasClass(panel,&quot;floatingPanel&quot;) &amp;&amp; !hasClass(panel,&quot;undocked&quot;)) {
		// see [[MoveablePanelPlugin]] for use of 'undocked'
		var rightEdge=document.body.offsetWidth-1;
		var panelWidth=panel.offsetWidth;
		var left=0;
		var top=btn.offsetHeight; 
		if (place.style.position==&quot;relative&quot; &amp;&amp; findPosX(btn)+panelWidth&gt;rightEdge) {
			left-=findPosX(btn)+panelWidth-rightEdge; // shift panel relative to button
			if (findPosX(btn)+left&lt;0) left=-findPosX(btn); // stay within left edge
		}
		if (place.style.position!=&quot;relative&quot;) {
			var left=findPosX(btn);
			var top=findPosY(btn)+btn.offsetHeight;
			var p=place; while (p &amp;&amp; !hasClass(p,'floatingPanel')) p=p.parentNode;
			if (p) { left-=findPosX(p); top-=findPosY(p); }
			if (left+panelWidth&gt;rightEdge) left=rightEdge-panelWidth;
			if (left&lt;0) left=0;
		}
		panel.style.left=left+&quot;px&quot;; panel.style.top=top+&quot;px&quot;;
	}
}
//}}}
//{{{
// TW2.1 and earlier:
// hijack Slider stop handler so overflow is visible after animation has completed
Slider.prototype.coreStop = Slider.prototype.stop;
Slider.prototype.stop = function()
	{ this.coreStop.apply(this,arguments); this.element.style.overflow = &quot;visible&quot;; }

// TW2.2+
// hijack Morpher stop handler so sliderPanel/floatingPanel overflow is visible after animation has completed
if (version.major+.1*version.minor+.01*version.revision&gt;=2.2) {
	Morpher.prototype.coreStop = Morpher.prototype.stop;
	Morpher.prototype.stop = function() {
		this.coreStop.apply(this,arguments);
		var e=this.element;
		if (hasClass(e,&quot;sliderPanel&quot;)||hasClass(e,&quot;floatingPanel&quot;)) {
			// adjust panel overflow and position after animation
			e.style.overflow = &quot;visible&quot;;
			if (window.adjustSliderPos) window.adjustSliderPos(e.parentNode,e.button,e);
		}
	};
}
//}}}</pre>
</div>
<div title="NestedSlidersPluginInfo" modifier="ELSDesignStudios" created="200801081313" modified="200811160622" tags="pluginInfo excludeMissing">
<pre>/***
|Name|NestedSlidersPluginInfo|
|Source|http://www.TiddlyTools.com/#NestedSlidersPlugin|
|Documentation|http://www.TiddlyTools.com/#NestedSlidersPluginInfo|
|Version|2.4.9|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.1|
|Type|documentation|
|Requires||
|Overrides||
|Description|documentation for NestedSlidersPlugin|
This plugin adds new wiki syntax for embedding 'slider' panels directly into tiddler content.
!!!!!Usage
&lt;&lt;&lt;
Use {{{+++}}} and {{{===}}} to delimit the slider content.  You can also 'nest' these sliders as deep as you like (see complex nesting example below), so that expandable 'tree-like' hierarchical displays can be created.  This is most useful when converting existing in-line text content to create in-line annotations, footnotes, context-sensitive help, or other subordinate information displays.

Additional optional syntax elements let you specify
*default to open
*cookiename
*heading level
*floater (with optional CSS width value)
*transient display (clicking elsewhere closes panel)
*open on hover (without needing to click)
*custom class/label/tooltip/accesskey
*alternate label/tooltip (displayed when panel is open)
*panelID (for later use with {{{&lt;&lt;DOM&gt;&gt;}}} macro.  See [[DOMTweaksPlugin]])
*automatic blockquote style on panel
*deferred rendering of panel content
The complete syntax, using all options, is:
//{{{
++++(cookiename)!!!!!^width^*@{{class{[label=key|tooltip][altlabel|alttooltip]}}}#panelID:&gt;...
content goes here
===
//}}}
where:
* ''&quot;&quot;&quot;+++&quot;&quot;&quot; (or &quot;&quot;&quot;++++&quot;&quot;&quot;) and &quot;&quot;&quot;===&quot;&quot;&quot;''&lt;br&gt;marks the start and end of the slider definition, respectively.  When the extra {{{+}}} is used, the slider will be open when initially displayed.
* ''&quot;&quot;&quot;(cookiename)&quot;&quot;&quot;''&lt;br&gt;saves the slider opened/closed state, and restores this state whenever the slider is re-rendered.
* ''&quot;&quot;&quot;! through !!!!!&quot;&quot;&quot;''&lt;br&gt;displays the slider label using a formatted headline (Hn) style instead of a button/link style
* ''&quot;&quot;&quot;^width^ (or just ^)&quot;&quot;&quot;''&lt;br&gt;makes the slider 'float' on top of other content rather than shifting that content downward.  'width' must be a valid CSS value (e.g., &quot;30em&quot;, &quot;180px&quot;, &quot;50%&quot;, etc.).  If omitted, the default width is &quot;auto&quot; (i.e., fit to content)
* ''&quot;&quot;&quot;*&quot;&quot;&quot;''&lt;br&gt;denotes &quot;transient display&quot;: when a click occurs elsewhere in the document, the slider/floating panel will be automatically closed.  This is useful for creating 'pulldown menus' that automatically go away after they are used.  //Note: using SHIFT-click on a slider label will open/close that slider without triggering the automatic closing of any transient slider panels that are currently displayed, permitting ''temporary'' display of several transient panels at once.//
* ''&quot;&quot;&quot;@&quot;&quot;&quot;''&lt;br&gt;denotes &quot;open on hover&quot;: the slider/floating panel will be automatically opened as soon as the mouse moves over the slider label, without requiring a click.
* ''&quot;&quot;&quot;{{class{[label=key|tooltip][altlabel|alttooltip]}}}&quot;&quot;&quot;''&lt;br&gt;uses label/tooltip/accesskey.  &quot;&quot;&quot;{{class{...}}}&quot;&quot;&quot;, &quot;&quot;&quot;=key&quot;&quot;&quot;, &quot;&quot;&quot;|tooltip&quot;&quot;&quot; and &quot;&quot;&quot;[altlabel|alttooltip]&quot;&quot;&quot; are optional.  'class' is any valid CSS class name, used to style the slider label text.  'key' must be a ''single letter only''.  altlabel/alttooltip specify alternative label/tooltip for use when slider/floating panel is displayed.  //Note: you can use HTML syntax within the label text to include HTML entities (e.g., {{{&amp;raquo;}}} (&amp;raquo;) or {{{&amp;#x25ba;}}} (&amp;#x25ba;), or even embedded images (e.g., {{{&lt;img src=&quot;images/eric3.gif&quot;&gt;}}}).//
* ''&quot;&quot;&quot;#panelID:&quot;&quot;&quot;''&lt;br&gt;defines a unique DOM element ID that is assigned to the panel element used to display the slider content.  This ID can then be used later to reposition the panel using the {{{&lt;&lt;DOM move id&gt;&gt;}}} macro (see [[DOMTweaksPlugin]]), or to access/modify the panel element through use of {{{document.getElementById(...)}}}) javascript code in a plugin or inline script.
* ''&quot;&quot;&quot;&gt;&quot;&quot;&quot;''&lt;br&gt;automatically adds blockquote formatting to slider content
* ''&quot;&quot;&quot;...&quot;&quot;&quot;''&lt;br&gt;defers rendering of closed sliders until the first time they are opened.  //Note: deferred rendering may produce unexpected results in some cases.  Use with care.//

//Note: to make slider definitions easier to read and recognize when editing a tiddler, newlines immediately following the {{{+++}}} 'start slider' or preceding the {{{===}}} 'end slider' sequence are automatically supressed so that excess whitespace is eliminated from the output.//
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
simple in-line slider: 
{{{
+++
   content
===
}}}
+++
   content
===
----
use a custom label and tooltip: 
{{{
+++[label|tooltip]
   content
===
}}}
+++[label|tooltip]
   content
===
----
content automatically blockquoted: 
{{{
+++&gt;
   content
===
}}}
+++&gt;
   content
===
----
all options (except cookie) //(default open, heading, sized floater, transient, open on hover, class, label/tooltip/key, blockquoted, deferred)//
{{{
++++!!!^30em^*@{{big{[label=Z|click or press Alt-Z to open]}}}&gt;...
   content
===
}}}
++++!!!^30em^*@{{big{[label=Z|click or press Alt-Z to open]}}}&gt;...
   content
===
----
complex nesting example:
{{{
+++[get info...=I|click for information or press Alt-I]
	put some general information here,
	plus a floating panel with more specific info:
	+++^10em^[view details...|click for details]
		put some detail here, which could in turn contain a transient panel,
		perhaps with a +++^25em^*[glossary definition]explaining technical terms===
	===
===
}}}
+++[get info...=I|click for information or press Alt-I]
	put some general information here,
	plus a floating panel with more specific info:
	+++^10em^[view details...|click for details]
		put some detail here, which could in turn contain a transient panel,
		perhaps with a +++^25em^*[glossary definition]explaining technical terms===
	===
===
----
embedded image as slider button
{{{
+++[&lt;img src=images/eric3.gif&gt;|click me!]&gt;
	{{big{OUCH!}}}
===
}}}
+++[&lt;img src=images/eric3.gif&gt;|click me!]&gt;
	{{big{OUCH!}}}
===
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2008.11.15 - 2.4.9 in adjustNestedSlider(), don't make adjustments if panel is marked as 'undocked' (CSS class).  In onClickNestedSlider(), SHIFT-CLICK docks panel (see [[MoveablePanelPlugin]])
2008.11.13 - 2.4.8 in document.onclick(), if transient panel is not a sliderPanel or floatingPanel, hide it via CSS
2008.10.05 - 2.4.7 in onClickNestedSlider(), added try/catch around focus() call to prevent IE error if input field being focused on is currently not visible.
2008.09.07 - 2.4.6 added removeCookie() function for compatibility with [[CookieManagerPlugin]]
2008.06.07 - 2.4.5 in 'onmouseover' handler for 'open on hover' slider buttons, use call() method when invoking document.onclick function (avoids error in IE)
2008.06.07 - 2.4.4 changed default for chkFloatingSlidersAnimate to FALSE to avoid clipping problem on some browsers (IE).  Updated Morpher hijack (again) to adjust regular sliderPanel styles as well as floatingPanel styles.
2008.05.07 - 2.4.3 updated Morpher hijack to adjust floatingPanel styles after animation without affecting other animated elements (i.e. popups).  Also, updated adjustSliderPos() to account for scrollwidth and use core findWindowWidth().
2008.04.02 - 2.4.2 in onClickNestedSlider, handle clicks on elements contained //within// slider buttons (e.g., when using HTML to display an image as a slider button).
2008.04.01 - 2.4.1 open on hover also triggers document.onclick to close other transient sliders
2008.04.01 - 2.4.0 re-introduced 'open on hover' feature using &quot;@&quot; symbol
2008.03.26 - 2.3.5 in document.onclick(), if click is in popup, don't dismiss transient panel (if any)
2008.01.08 - [*.*.*] plugin size reduction: documentation moved to ...Info tiddler
2007.12.28 - 2.3.4 added hijack for Animator.prototype.startAnimating().  Previously, the plugin code simply set the overflow to &quot;visible&quot; after animation.  This code tweak corrects handling of elements that were styled with overflow=hidden/auto/scroll before animation by saving the overflow style and then restoring it after animation has completed.
2007.12.17 - 2.3.3 use hasClass() instead of direct comparison to test for &quot;floatingPanel&quot; class.  Allows floating panels to have additional classes assigned to them (i.e., by AnimationEffectsPlugin).
2007.11.14 - 2.3.2 in onClickNestedSlider(), prevent SHIFT-click events from opening a new, empty browser window by setting &quot;cancelBubble=true&quot; and calling &quot;stopPropagation()&quot;.  Note: SHIFT-click is still processed as a normal click (i.e., it toggles the slider panel display).  Also, using SHIFT-click will prevent 'transient' sliders from being automatically closed when another slider is opened, allowing you to *temporarily* display several transient sliders at once.
2007.07.26 - 2.3.1 in document.onclick(), propagate return value from hijacked core click handler to consume OR bubble up click as needed.  Fixes &quot;IE click disease&quot;, whereby nearly every mouse click causes a page transition.
2007.07.20 - 2.3.0 added syntax for setting panel ID (#panelID:).  This allows individual slider panels to be repositioned within tiddler content simply by giving them a unique ID and then moving them to the desired location using the {{{&lt;&lt;DOM move id&gt;&gt;}}} macro.
2007.07.19 - 2.2.0 added syntax for alttext and alttip (button label and tooltip to be displayed when panel is open)
2007.07.14 - 2.1.2 corrected use of 'transient' attribute in IE to prevent (non-recursive) infinite loop
2007.07.12 - 2.1.0 replaced use of &quot;*&quot; for 'open/close on rollover' (which didn't work too well).  &quot;*&quot; now indicates 'transient' panels that are automatically closed if a click occurs somewhere else in the document.  This permits use of nested sliders to create nested &quot;pulldown menus&quot; that automatically disappear after interaction with them has been completed.  Also, in onClickNestedSlider(), use &quot;theTarget.sliderCookie&quot;, instead of &quot;this.sliderCookie&quot; to correct cookie state tracking when automatically dismissing transient panels.
2007.06.10 - 2.0.5 add check to ensure that window.adjustSliderPanel() is defined before calling it (prevents error on shutdown when mouse event handlers are still defined)
2007.05.31 - 2.0.4 add handling to invoke adjustSliderPanel() for onmouseover events on slider button and panel.  This allows the panel position to be re-synced when the button position shifts due to changes in unrelated content above it on the page.  (thanks to Harsha for bug report)
2007.03.30 - 2.0.3 added chkFloatingSlidersAnimate (default to FALSE), so that slider animation can be disabled independent of the overall document animation setting (avoids strange rendering and focus problems in floating panels)
2007.03.01 - 2.0.2 for TW2.2+, hijack Morpher.prototype.stop so that &quot;overflow:hidden&quot; can be reset to &quot;overflow:visible&quot; after animation ends
2007.03.01 - 2.0.1 in hijack for Slider.prototype.stop, use apply() to pass params to core function
2006.07.28 - 2.0.0 added custom class syntax around label/tip/key syntax: {{{{{classname{[label=key|tip]}}}}}}
2006.07.25 - 1.9.3 when parsing slider, save default open/closed state in button element, then in onClickNestedSlider(), if slider state matches saved default, instead of saving cookie, delete it.  Significantly reduces the 'cookie overhead' when default slider states are used.
2006.06.29 - 1.9.2 in onClickNestedSlider(), when setting focus to first control, skip over type=&quot;hidden&quot;
2006.06.22 - 1.9.1 added panel.defaultPanelWidth to save requested panel width, even after resizing has changed the style value
2006.05.11 - 1.9.0 added optional '^width^' syntax for floating sliders and '=key' syntax for setting an access key on a slider label
2006.05.09 - 1.8.0 in onClickNestedSlider(), when showing panel, set focus to first child input/textarea/select element
2006.04.24 - 1.7.8 in adjustSliderPos(), if floating panel is contained inside another floating panel, subtract offset of containing panel to find correct position
2006.02.16 - 1.7.7 corrected deferred rendering to account for use-case where show/hide state is tracked in a cookie
2006.02.15 - 1.7.6 in adjustSliderPos(), ensure that floating panel is positioned completely within the browser window (i.e., does not go beyond the right edge of the browser window)
2006.02.04 - 1.7.5 add 'var' to unintended global variable declarations to avoid FireFox 1.5.0.1 crash bug when assigning to globals
2006.01.18 - 1.7.4 only define adjustSliderPos() function if it has not already been provided by another plugin.  This lets other plugins 'hijack' the function even when they are loaded first.
2006.01.16 - 1.7.3 added adjustSliderPos(place,btn,panel,panelClass) function to permit specialized logic for placement of floating panels.  While it provides improved placement for many uses of floating panels, it exhibits a relative offset positioning error when used within *nested* floating panels.  Short-term workaround is to only adjust the position for 'top-level' floaters.
2006.01.16 - 1.7.2 added button property to slider panel elements so that slider panel can tell which button it belongs to.  Also, re-activated and corrected animation handling so that nested sliders aren't clipped by hijacking Slider.prototype.stop so that &quot;overflow:hidden&quot; can be reset to &quot;overflow:visible&quot; after animation ends
2006.01.14 - 1.7.1 added optional &quot;^&quot; syntax for floating panels.  Defines new CSS class, &quot;.floatingPanel&quot;, as an alternative for standard in-line &quot;.sliderPanel&quot; styles.
2006.01.14 - 1.7.0 added optional &quot;*&quot; syntax for rollover handling to show/hide slider without requiring a click (Based on a suggestion by tw4efl)
2006.01.03 - 1.6.2 When using optional &quot;!&quot; heading style, instead of creating a clickable &quot;Hn&quot; element, create an &quot;A&quot; element inside the &quot;Hn&quot; element.  (allows click-through in SlideShowPlugin, which captures nearly all click events, except for hyperlinks)
2005.12.15 - 1.6.1 added optional &quot;...&quot; syntax to invoke deferred ('lazy') rendering for initially hidden sliders
removed checkbox option for 'global' application of lazy sliders
2005.11.25 - 1.6.0 added optional handling for 'lazy sliders' (deferred rendering for initially hidden sliders)
2005.11.21 - 1.5.1 revised regular expressions: if present, a single newline //preceding// and/or //following// a slider definition will be suppressed so start/end syntax can be place on separate lines in the tiddler 'source' for improved readability.  Similarly, any whitespace (newlines, tabs, spaces, etc.) trailing the 'start slider' syntax or preceding the 'end slider' syntax is also suppressed.
2005.11.20 - 1.5.0 added (cookiename) syntax for optional tracking and restoring of slider open/close state
2005.11.11 - 1.4.0 added !!!!! syntax to render slider label as a header (Hn) style instead of a button/link style
2005.11.07 - 1.3.0 removed alternative syntax {{{(((}}} and {{{)))}}} (so they can be used by other formatting extensions) and simplified/improved regular expressions to trim multiple excess newlines
2005.11.05 - 1.2.1 changed name to NestedSlidersPlugin
2005.11.04 - 1.2.0 added alternative character-mode syntax {{{(((}}} and {{{)))}}}
tweaked &quot;eat newlines&quot; logic for line-mode {{{+++}}} and {{{===}}} syntax
2005.11.03 - 1.1.1 fixed toggling of default tooltips (&quot;more...&quot; and &quot;less...&quot;) when a non-default button label is used.  code cleanup, added documentation
2005.11.03 - 1.1.0 changed delimiter syntax from {{{(((}}} and {{{)))}}} to {{{+++}}} and {{{===}}}.  changed name to EasySlidersPlugin
2005.11.03 - 1.0.0 initial public release
&lt;&lt;&lt;</pre>
</div>
<div title="Notebook" modifier="JohnRouillard" created="201007251900" modified="201007310716" tags="slide content">
<pre>&lt;&lt;tiddler SlideSubstyle##levelTwo&gt;&gt;
{{comment{
picture notebook/pen possible student

* Allow students to annotate content tiddlers (slides, chapter elements)
** during presentation
** while using textbook (c.f. margin notes)
* Students should have singe click access to modify all notes on a tiddler
* Notes should not be lost when upgrading the Coursebook.
}}}</pre>
</div>
<div title="Online after class" modifier="YourName" created="201007251910" modified="201007251914" tags="slide content">
<pre>* references
* chapters
* presentations and notes
* per student bookmarks
* search
* related tiddlers

{{comment{
There are multiple plugins for related tiddlers from touchgraph to tag based lists.
Choosing the right mechanism is still an open issue.
}}}
</pre>
</div>
<div title="Online after class-Notes" modifier="YourName" created="201007251917" tags="Notes excludeLists noReload">
<pre>*  references
**            separate chapters/index for quick access
*        chapters
**            full treatment of topic.
**            1:1 more or less with presentations maybe not a good idea but
*        presentations and notes
**            if student took notes during talk, they can review instructor notes on slides link to chapters/reference material
*        per student bookmarks
*  link at top of tiddler append to bookmark list in main menu. Edit link for bookmarks allows student to reorder/format for access
* search
** search works like google searh, terms in quotes, +/- to add subtract matched terms plus can search in titles, text or tags
* related tiddlers
** a few ways to visualize. Still in progress what mechanism to use. Allows students to investigate other topics of interest, find info outside of a chapter tiddler. Make better associations between concepts.

</pre>
</div>
<div title="Online during class" modifier="YourName" created="201007251908" modified="201007251909" tags="slide content">
<pre>Follow along with presentations
* student view includes instructor notes and notebook area
* students follow along and with slide show and annotate slides as needed
* students can also read instructor notes with background material or important points from slide reenforcing the goal of the slide.
</pre>
</div>
<div title="OpenStoryButton" modifier="JohnRouillard" created="200908300007" modified="200909080032" tags="structure excludeStory">
<pre>/% {{ &quot;$1&quot; != &quot;$&quot; + &quot;1&quot; ? &quot;$1&quot;  : &quot;Open links in %0&quot;}} 
    computed param when called as: &lt;&lt;tiddler OpenStoryButton with: &quot;button label&quot; &quot;tooltip&quot; &gt; &gt;
    $1  is set to &quot;button label&quot; and $2 is set to &quot;tooltip&quot; if no params are specified, $1 and $2 are
    not substituted. So the computed param checks to see if $1 was replaced (by concatenating
    $ and 1 so I don't have the obviously false &quot;$1&quot; != &quot;$1&quot;) and if it was uses it. If it wasn't use
    the alternate string with %1 being the name of the parent tiddler.

   No return after the % and / so no newline is rendered when included.
%/{{openStoryButton{
&lt;&lt;openStory {{tiddler.title}} {{ &quot;$1&quot; != &quot;$&quot; + &quot;1&quot; ? &quot;$1&quot;  : &quot;Open links in %0&quot;}} {{ &quot;$2&quot; != &quot;$&quot; + &quot;2&quot; ? &quot;$2&quot;  : &quot;Open all of the links in %0 according to the check boxes&quot;}}&gt;&gt;
''The first/topmost checked box determines how tidders are opened''
&lt;&lt;option chkStoryClose&gt;&gt; close other tiddlers when opening
&lt;&lt;option chkStoryBottom&gt;&gt; open tiddlers at bottom of story column
&lt;&lt;option chkStoryTop&gt;&gt; open tiddlers at top of story column
}}}</pre>
</div>
<div title="Opening a Chapter" modifier="JohnRouillard" created="201007311901" modified="201007312146" tags="content">
<pre>Once you have created content, you want to be able to view it. There are three ways to open a chapter:
# use the title link in the Chapter section of the MainMenu
# use the dropdown select box in the Chapter section of the MainMenu to have more control over how the chapter opens, and use it to open multiple chapters
# use the chapter control tiddler (accessed with the open link next to the chapter title links) to change viewing options and open the entire chapter or select a specific tiddler in the chapter to open).

!! Using the Title Link

Simply click on the title link for the chapter and the story column will be replaced (except for tiddlers being edited) by the content of the chapter.
Depending on the [[configuration settings|StorySaverPluginInfo##Configuration]] for stories you can prevent the chapter from taking over
the story column, but it may be easier to use the pulldown select box if you want to open multiple chapters, or keep your current tiddlers displayed.

!! Using the Selection Pulldown

The selection pulldown is directly below the Chapter heading in the MainMenu. At the end of the selection menu are the viewing options that can be selected to:
* Close tiddlers currently in the story column (except those being edited) and open the chapter's tiddlers
* Open the chapters tiddlers at the top of the story column (keeping currently displayed tiddlers)
* Open the chapters tiddlers at the end of the story column  (keeping currently displayed tiddlers)

Selecting &quot;close other tiddlers&quot; hides the other two options. Both open at top and open at bottom can be selected, open at top has priority.

Once you have chosen your viewing options, you can select chapters from the dropdown box and they will open as you have specified

!! Opening a Chapter Using .the Control Tiddler

A third way of opening a chapter is to use the chapter's control tiddler. To access the control tiddler, use the {{{(open)}}} link net to the title link in the Chapter section of the MainMenu. Once you open the control tiddler, you can see all the tiddlers that are part of that chapter and you can select an individual tiddler for editing or disply by clicking on the link. If you want to open the entire chapter, you can select the viewing options and click on the button to open the chapter.

</pre>
</div>
<div title="Opening a Presentation" modifier="JohnRouillard" created="201007182012" modified="201008012159" tags="content">
<pre>To display a presentation (slides)  for editing/printing
* Choose the presentation from the pulldown list under the presentation header (for multi-tiddler presentations)
This will display all the tiddlers in the multi-tiddler presentation. Then you can edit them normally, or use your browsers print function to print the list of tiddlers, slide notes and notebooks. 

* Choose the {{{(open)}}} link next to the presentation title (for single tiddler presentations)
This will display the control tiddler for the presentation that also contains the slide elements.

Using the {{{(open)}}} link for multi-tiddler presentations will display the control tiddler for the presentation. In this control tiddler you can
* edit the tiddler to add/remove slides
</pre>
</div>
<div title="Opening the Coursebook" modifier="JohnRouillard" created="200910241858" modified="201008020330" tags="InstructorOnly slide">
<pre>To open to coursebook you can use: ~FireFox, Internet Explorer, Safari (Safari users, see the instructor first)
# Find the coursebook on the usb stick at:  ''\training\S2\coursebook\coursebook.html''
# Open the coursebook on the usb stick  or copy the material to your hard drive and open the coursebook from there
# Allow javascript execution for the coursebook

You should see something like:
@@display: block;text-align: center;[img(50%,)[Frontscreen.png]]@@
If you don't please see the instructor.
{{overlay1{}}}{{overlay2{}}}{{overlay3{}}}{{overlay4{}}}{{overlay5{}}}{{overlay6{}}}</pre>
</div>
<div title="OtherToolbarCommands" modifier="JohnRouillard" created="200903300226" modified="201007170516" tags="structure">
<pre>! Toolbar command for tiddlers tagged with content.

|~ContentViewToolbar|AddTiddlerToBookmarks closeTiddler closeOthers editTiddler refresh jump &gt;  fields permalink references &lt; |
</pre>
</div>
<div title="PDFCreator" modifier="JohnRouillard" created="200910101552" modified="200910102135" tags="InstructorOnly">
<pre>http://www.pdfforge.org/</pre>
</div>
<div title="PageTemplate" modifier="JohnRouillard" created="200908250054" modified="200908260245" tags="structure">
<pre>&lt;!--{{{--&gt;
&lt;div class='header' macro='gradient vert [[ColorPalette::PrimaryLight]] [[ColorPalette::PrimaryMid]]'&gt;
&lt;div class='headerShadow'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;div class='headerForeground'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id='mainMenu' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;
&lt;div id='sidebar'&gt;
&lt;div id='sidebarOptions' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;
&lt;div id='sidebarTabs' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id='displayArea'&gt;
&lt;div id='messageArea'&gt;&lt;/div&gt;
&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;span style='display:none' macro='tiddler SiteStartup'&gt;&lt;/span&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="PartTiddlerPlugin" modifier="JohnRouillard" created="200601251216" modified="200903220536" tags="systemConfig PatchedPlugin excludeMissing">
<pre>/***
|&lt;html&gt;&lt;a name=&quot;Top&quot;/&gt;&lt;/html&gt;''Name:''|PartTiddlerPlugin|
|''Version:''|1.0.9 (2007-07-14)|
|''Source:''|http://tiddlywiki.abego-software.de/#PartTiddlerPlugin|
|''Author:''|UdoBorkowski (ub [at] abego-software [dot] de)|
|''Licence:''|[[BSD open source license]]|
|''CoreVersion:''|2.1.3|
|''Browser:''|Firefox 1.0.4+; InternetExplorer 6.0|
!Table of Content&lt;html&gt;&lt;a name=&quot;TOC&quot;/&gt;&lt;/html&gt;
* &lt;html&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Description',null, event)&quot;&gt;Description, Syntax&lt;/a&gt;&lt;/html&gt;
* &lt;html&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Applications',null, event)&quot;&gt;Applications&lt;/a&gt;&lt;/html&gt;
** &lt;html&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('LongTiddler',null, event)&quot;&gt;Refering to Paragraphs of a Longer Tiddler&lt;/a&gt;&lt;/html&gt;
** &lt;html&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Citation',null, event)&quot;&gt;Citation Index&lt;/a&gt;&lt;/html&gt;
** &lt;html&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('TableCells',null, event)&quot;&gt;Creating &quot;multi-line&quot; Table Cells&lt;/a&gt;&lt;/html&gt;
** &lt;html&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Tabs',null, event)&quot;&gt;Creating Tabs&lt;/a&gt;&lt;/html&gt;
** &lt;html&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Sliders',null, event)&quot;&gt;Using Sliders&lt;/a&gt;&lt;/html&gt;
* &lt;html&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Revisions',null, event)&quot;&gt;Revision History&lt;/a&gt;&lt;/html&gt;
* &lt;html&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Code',null, event)&quot;&gt;Code&lt;/a&gt;&lt;/html&gt;
!Description&lt;html&gt;&lt;a name=&quot;Description&quot;/&gt;&lt;/html&gt;
With the {{{&lt;part aPartName&gt; ... &lt;/part&gt;}}} feature you can structure your tiddler text into separate (named) parts. 
Each part can be referenced as a &quot;normal&quot; tiddler, using the &quot;//tiddlerName//''/''//partName//&quot; syntax (e.g. &quot;About/Features&quot;).  E.g. you may create links to the parts (e.g. {{{[[Quotes/BAX95]]}}} or {{{[[Hobbies|AboutMe/Hobbies]]}}}), use it in {{{&lt;&lt;tiddler...&gt;&gt;}}} or {{{&lt;&lt;tabs...&gt;&gt;}}} macros etc.


''Syntax:'' 
|&gt;|''&lt;part'' //partName// [''hidden''] ''&gt;'' //any tiddler content// ''&lt;/part&gt;''|
|//partName//|The name of the part. You may reference a part tiddler with the combined tiddler name &quot;//nameOfContainerTidder//''/''//partName//. &lt;br /&gt;If you use a partName containing spaces you need to quote it (e.g. {{{&quot;Major Overview&quot;}}} or {{{[[Shortcut List]]}}}).|
|''hidden''|When defined the content of the part is not displayed in the container tiddler. But when the part is explicitly referenced (e.g. in a {{{&lt;&lt;tiddler...&gt;&gt;}}} macro or in a link) the part's content is displayed.|
|&lt;html&gt;&lt;i&gt;any&amp;nbsp;tiddler&amp;nbsp;content&lt;/i&gt;&lt;/html&gt;|&lt;html&gt;The content of the part.&lt;br&gt;A part can have any content that a &quot;normal&quot; tiddler may have, e.g. you may use all the formattings and macros defined.&lt;/html&gt;|
|&gt;|~~Syntax formatting: Keywords in ''bold'', optional parts in [...]. 'or' means that exactly one of the two alternatives must exist.~~|
&lt;html&gt;&lt;sub&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Top',null, event)&quot;&gt;[Top]&lt;/sub&gt;&lt;/a&gt;&lt;/html&gt;

!Applications&lt;html&gt;&lt;a name=&quot;Applications&quot;/&gt;&lt;/html&gt;
!!Refering to Paragraphs of a Longer Tiddler&lt;html&gt;&lt;a name=&quot;LongTiddler&quot;/&gt;&lt;/html&gt;
Assume you have written a long description in a tiddler and now you want to refer to the content of a certain paragraph in that tiddler (e.g. some definition.) Just wrap the text with a ''part'' block, give it a nice name, create a &quot;pretty link&quot; (like {{{[[Discussion Groups|Introduction/DiscussionGroups]]}}}) and you are done.

Notice this complements the approach to first writing a lot of small tiddlers and combine these tiddlers to one larger tiddler in a second step (e.g. using the {{{&lt;&lt;tiddler...&gt;&gt;}}} macro). Using the ''part'' feature you can first write a &quot;classic&quot; (longer) text that can be read &quot;from top to bottom&quot; and later &quot;reuse&quot; parts of this text for some more &quot;non-linear&quot; reading.

&lt;html&gt;&lt;sub&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Top',null, event)&quot;&gt;[Top]&lt;/sub&gt;&lt;/a&gt;&lt;/html&gt;

!!Citation Index&lt;html&gt;&lt;a name=&quot;Citation&quot;/&gt;&lt;/html&gt;
Create a tiddler &quot;Citations&quot; that contains your &quot;citations&quot;. 
Wrap every citation with a part and a proper name. 

''Example''
{{{
&lt;part BAX98&gt;Baxter, Ira D. et al: //Clone Detection Using Abstract Syntax Trees.// 
in //Proc. ICSM//, 1998.&lt;/part&gt;

&lt;part BEL02&gt;Bellon, Stefan: //Vergleich von Techniken zur Erkennung duplizierten Quellcodes.// 
Thesis, Uni Stuttgart, 2002.&lt;/part&gt;

&lt;part DUC99&gt;Ducasse, Stfane et al: //A Language Independent Approach for Detecting Duplicated Code.// 
in //Proc. ICSM//, 1999.&lt;/part&gt;
}}}

You may now &quot;cite&quot; them just by using a pretty link like {{{[[Citations/BAX98]]}}} or even more pretty, like this {{{[[BAX98|Citations/BAX98]]}}}.

&lt;html&gt;&lt;sub&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Top',null, event)&quot;&gt;[Top]&lt;/sub&gt;&lt;/a&gt;&lt;/html&gt;

!!Creating &quot;multi-line&quot; Table Cells&lt;html&gt;&lt;a name=&quot;TableCells&quot;/&gt;&lt;/html&gt;
You may have noticed that it is hard to create table cells with &quot;multi-line&quot; content. E.g. if you want to create a bullet list inside a table cell you cannot just write the bullet list
{{{
* Item 1
* Item 2
* Item 3
}}}
into a table cell (i.e. between the | ... | bars) because every bullet item must start in a new line but all cells of a table row must be in one line.

Using the ''part'' feature this problem can be solved. Just create a hidden part that contains the cells content and use a {{{&lt;&lt;tiddler &gt;&gt;}}} macro to include its content in the table's cell.

''Example''
{{{
|!Subject|!Items|
|subject1|&lt;&lt;tiddler ./Cell1&gt;&gt;|
|subject2|&lt;&lt;tiddler ./Cell2&gt;&gt;|

&lt;part Cell1 hidden&gt;
* Item 1
* Item 2
* Item 3
&lt;/part&gt;
...
}}}

Notice that inside the {{{&lt;&lt;tiddler ...&gt;&gt;}}} macro you may refer to the &quot;current tiddler&quot; using the &quot;.&quot;.

BTW: The same approach can be used to create bullet lists with items that contain more than one line.

&lt;html&gt;&lt;sub&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Top',null, event)&quot;&gt;[Top]&lt;/sub&gt;&lt;/a&gt;&lt;/html&gt;

!!Creating Tabs&lt;html&gt;&lt;a name=&quot;Tabs&quot;/&gt;&lt;/html&gt;
The build-in {{{&lt;&lt;tabs ...&gt;&gt;}}} macro requires that you defined an additional tiddler for every tab it displays. When you want to have &quot;nested&quot; tabs you need to define a tiddler for the &quot;main tab&quot; and one for every tab it contains. I.e. the definition of a set of tabs that is visually displayed at one place is distributed across multiple tiddlers.

With the ''part'' feature you can put the complete definition in one tiddler, making it easier to keep an overview and maintain the tab sets.

''Example''
The standard tabs at the sidebar are defined by the following eight tiddlers:
* SideBarTabs
* TabAll
* TabMore
* TabMoreMissing
* TabMoreOrphans
* TabMoreShadowed
* TabTags
* TabTimeline

Instead of these eight tiddlers one could define the following SideBarTabs tiddler that uses the ''part'' feature:
{{{
&lt;&lt;tabs txtMainTab 
    Timeline Timeline SideBarTabs/Timeline 
    All 'All tiddlers' SideBarTabs/All 
    Tags 'All tags' SideBarTabs/Tags 
    More 'More lists' SideBarTabs/More&gt;&gt;
&lt;part Timeline hidden&gt;&lt;&lt;timeline&gt;&gt;&lt;/part&gt;
&lt;part All hidden&gt;&lt;&lt;list all&gt;&gt;&lt;/part&gt;
&lt;part Tags hidden&gt;&lt;&lt;allTags&gt;&gt;&lt;/part&gt;
&lt;part More hidden&gt;&lt;&lt;tabs txtMoreTab 
    Missing 'Missing tiddlers' SideBarTabs/Missing 
    Orphans 'Orphaned tiddlers' SideBarTabs/Orphans 
    Shadowed 'Shadowed tiddlers' SideBarTabs/Shadowed&gt;&gt;&lt;/part&gt;
&lt;part Missing hidden&gt;&lt;&lt;list missing&gt;&gt;&lt;/part&gt;
&lt;part Orphans hidden&gt;&lt;&lt;list orphans&gt;&gt;&lt;/part&gt;
&lt;part Shadowed hidden&gt;&lt;&lt;list shadowed&gt;&gt;&lt;/part&gt;
}}}

Notice that you can easily &quot;overwrite&quot; individual parts in separate tiddlers that have the full name of the part.

E.g. if you don't like the classic timeline tab but only want to see the 100 most recent tiddlers you could create a tiddler &quot;~SideBarTabs/Timeline&quot; with the following content:
{{{
&lt;&lt;forEachTiddler 
		sortBy 'tiddler.modified' descending 
		write '(index &lt; 100) ? &quot;* [[&quot;+tiddler.title+&quot;]]\n&quot;:&quot;&quot;'&gt;&gt;
}}}
&lt;html&gt;&lt;sub&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Top',null, event)&quot;&gt;[Top]&lt;/sub&gt;&lt;/a&gt;&lt;/html&gt;

!!Using Sliders&lt;html&gt;&lt;a name=&quot;Sliders&quot;/&gt;&lt;/html&gt;
Very similar to the build-in {{{&lt;&lt;tabs ...&gt;&gt;}}} macro (see above) the {{{&lt;&lt;slider ...&gt;&gt;}}} macro requires that you defined an additional tiddler that holds the content &quot;to be slid&quot;. You can avoid creating this extra tiddler by using the ''part'' feature

''Example''
In a tiddler &quot;About&quot; we may use the slider to show some details that are documented in the tiddler's &quot;Details&quot; part.
{{{
...
&lt;&lt;slider chkAboutDetails About/Details details &quot;Click here to see more details&quot;&gt;&gt;
&lt;part Details hidden&gt;
To give you a better overview ...
&lt;/part&gt;
...
}}}

Notice that putting the content of the slider into the slider's tiddler also has an extra benefit: When you decide you need to edit the content of the slider you can just doubleclick the content, the tiddler opens for editing and you can directly start editing the content (in the part section). In the &quot;old&quot; approach you would doubleclick the tiddler, see that the slider is using tiddler X, have to look for the tiddler X and can finally open it for editing. So using the ''part'' approach results in a much short workflow.

&lt;html&gt;&lt;sub&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Top',null, event)&quot;&gt;[Top]&lt;/sub&gt;&lt;/a&gt;&lt;/html&gt;

!Revision history&lt;html&gt;&lt;a name=&quot;Revisions&quot;/&gt;&lt;/html&gt;
* v1.0.9 (2007-07-14)
** Bugfix: Error when using the SideBarTabs example and switching between &quot;More&quot; and &quot;Shadow&quot;. Thanks to cmari for reporting the issue.
* v1.0.8 (2007-06-16)
** Speeding up display of tiddlers containing multiple pard definitions. Thanks to Paco Rivire for reporting the issue.
** Support &quot;./partName&quot; syntax inside &lt;&lt;tabs ...&gt;&gt; macro
* v1.0.7 (2007-03-07)
** Bugfix: &lt;&lt;tiddler &quot;./partName&quot;&gt;&gt; does not always render correctly after a refresh (e.g. like it happens when using the &quot;Include&quot; plugin). Thanks to Morris Gray for reporting the bug.
* v1.0.6 (2006-11-07)
** Bugfix: cannot edit tiddler when UploadPlugin by Bidix is installed. Thanks to Jos Luis Gonzlez Castro for reporting the bug.
* v1.0.5 (2006-03-02)
** Bugfix: Example with multi-line table cells does not work in IE6. Thanks to Paulo Soares for reporting the bug.
* v1.0.4 (2006-02-28)
** Bugfix: Shadow tiddlers cannot be edited (in TW 2.0.6). Thanks to Torsten Vanek for reporting the bug.
* v1.0.3 (2006-02-26)
** Adapt code to newly introduced Tiddler.prototype.isReadOnly() function (in TW 2.0.6). Thanks to Paulo Soares for reporting the problem.
* v1.0.2 (2006-02-05)
** Also allow other macros than the &quot;tiddler&quot; macro use the &quot;.&quot; in the part reference (to refer to &quot;this&quot; tiddler)
* v1.0.1 (2006-01-27)
** Added Table of Content for plugin documentation. Thanks to RichCarrillo for suggesting.
** Bugfix: newReminder plugin does not work when PartTiddler is installed. Thanks to PauloSoares for reporting.
* v1.0.0 (2006-01-25)
** initial version
&lt;html&gt;&lt;sub&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Top',null, event)&quot;&gt;[Top]&lt;/sub&gt;&lt;/a&gt;&lt;/html&gt;

!Code&lt;html&gt;&lt;a name=&quot;Code&quot;/&gt;&lt;/html&gt;
&lt;html&gt;&lt;sub&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;window.scrollAnchorVisible('Top',null, event)&quot;&gt;[Top]&lt;/sub&gt;&lt;/a&gt;&lt;/html&gt;
***/
//{{{
//============================================================================
//                           PartTiddlerPlugin

// Ensure that the PartTiddler Plugin is only installed once.
//
if (!version.extensions.PartTiddlerPlugin) {



version.extensions.PartTiddlerPlugin = {
    major: 1, minor: 0, revision: 9,
    date: new Date(2007, 6, 14), 
    type: 'plugin',
    source: &quot;http://tiddlywiki.abego-software.de/#PartTiddlerPlugin&quot;
};

if (!window.abego) window.abego = {};
if (version.major &lt; 2) alertAndThrow(&quot;PartTiddlerPlugin requires TiddlyWiki 2.0 or newer.&quot;);

//============================================================================
// Common Helpers

// Looks for the next newline, starting at the index-th char of text. 
//
// If there are only whitespaces between index and the newline 
// the index behind the newline is returned, 
// otherwise (or when no newline is found) index is returned.
//
var skipEmptyEndOfLine = function(text, index) {
	var re = /(\n|[^\s])/g;
	re.lastIndex = index;
	var result = re.exec(text);
	return (result &amp;&amp; text.charAt(result.index) == '\n') 
			? result.index+1
			: index;
}


//============================================================================
// Constants

var partEndOrStartTagRE = /(&lt;\/part&gt;)|(&lt;part(?:\s+)((?:[^&gt;])+)&gt;)/mg;
var partEndTagREString = &quot;&lt;\\/part&gt;&quot;;
var partEndTagString = &quot;&lt;/part&gt;&quot;;

//============================================================================
// Plugin Specific Helpers

// Parse the parameters inside a &lt;part ...&gt; tag and return the result.
//
// @return [may be null] {partName: ..., isHidden: ...}
//
var parseStartTagParams = function(paramText) {
	var params = paramText.readMacroParams();
	if (params.length == 0 || params[0].length == 0) return null;
	
	var name = params[0];
	var paramsIndex = 1;
	var hidden = false;
	if (paramsIndex &lt; params.length) {
		hidden = params[paramsIndex] == &quot;hidden&quot;;
		paramsIndex++;
	}
	
	return {
		partName: name, 
		isHidden: hidden
	};
}

// Returns the match to the next (end or start) part tag in the text, 
// starting the search at startIndex.
// 
// When no such tag is found null is returned, otherwise a &quot;Match&quot; is returned:
// [0]: full match
// [1]: matched &quot;end&quot; tag (or null when no end tag match)
// [2]: matched &quot;start&quot; tag (or null when no start tag match)
// [3]: content of start tag (or null if no start tag match)
//
var findNextPartEndOrStartTagMatch = function(text, startIndex) {
	var re = new RegExp(partEndOrStartTagRE);
	re.lastIndex = startIndex;
	var match = re.exec(text);
	return match;
}

//============================================================================
// Formatter

// Process the &lt;part ...&gt; ... &lt;/part&gt; starting at (w.source, w.matchStart) for formatting.
//
// @return true if a complete part section (including the end tag) could be processed, false otherwise.
//
var handlePartSection = function(w) {
	var tagMatch = findNextPartEndOrStartTagMatch(w.source, w.matchStart);
	if (!tagMatch) return false;
	if (tagMatch.index != w.matchStart || !tagMatch[2]) return false;

	// Parse the start tag parameters
	var arguments = parseStartTagParams(tagMatch[3]);
	if (!arguments) return false;
	
	// Continue processing
	var startTagEndIndex = skipEmptyEndOfLine(w.source, tagMatch.index + tagMatch[0].length);
	var endMatch = findNextPartEndOrStartTagMatch(w.source, startTagEndIndex);
	if (endMatch &amp;&amp; endMatch[1]) {
		if (!arguments.isHidden) {
			w.nextMatch = startTagEndIndex;
			w.subWikify(w.output,partEndTagREString);
		}
		w.nextMatch = skipEmptyEndOfLine(w.source, endMatch.index + endMatch[0].length);
		
		return true;
	}
	return false;
}

config.formatters.push( {
    name: &quot;part&quot;,
    match: &quot;&lt;part\\s+[^&gt;]+&gt;&quot;,
	
	handler: function(w) {
		if (!handlePartSection(w)) {
			w.outputText(w.output,w.matchStart,w.matchStart+w.matchLength);
		}
	}
} )

//============================================================================
// Extend &quot;fetchTiddler&quot; functionality to also recognize &quot;part&quot;s of tiddlers 
// as tiddlers.

var currentParent = null; // used for the &quot;.&quot; parent (e.g. in the &quot;tiddler&quot; macro)

// Return the match to the first &lt;part ...&gt; tag of the text that has the
// requrest partName.
//
// @return [may be null]
//
var findPartStartTagByName = function(text, partName) {
	var i = 0;
	
	while (true) {
		var tagMatch = findNextPartEndOrStartTagMatch(text, i);
		if (!tagMatch) return null;

		if (tagMatch[2]) {
			// Is start tag
	
			// Check the name
			var arguments = parseStartTagParams(tagMatch[3]);
			if (arguments &amp;&amp; arguments.partName == partName) {
				return tagMatch;
			}
		}
		i = tagMatch.index+tagMatch[0].length;
	}
}

// Return the part &quot;partName&quot; of the given parentTiddler as a &quot;readOnly&quot; Tiddler 
// object, using fullName as the Tiddler's title. 
//
// All remaining properties of the new Tiddler (tags etc.) are inherited from 
// the parentTiddler.
// 
// @return [may be null]
//
var getPart = function(parentTiddler, partName, fullName) {
	var text = parentTiddler.text;
	var startTag = findPartStartTagByName(text, partName);
	if (!startTag) return null;
	
	var endIndexOfStartTag = skipEmptyEndOfLine(text, startTag.index+startTag[0].length);
	var indexOfEndTag = text.indexOf(partEndTagString, endIndexOfStartTag);

	if (indexOfEndTag &gt;= 0) {
		var partTiddlerText = text.substring(endIndexOfStartTag,indexOfEndTag);
		var partTiddler = new Tiddler();
		partTiddler.set(
						fullName,
						partTiddlerText,
						parentTiddler.modifier,
						parentTiddler.modified,
						parentTiddler.tags,
						parentTiddler.created);
		partTiddler.abegoIsPartTiddler = true;
		return partTiddler;
	}
	
	return null;
}

// Hijack the store.fetchTiddler to recognize the &quot;part&quot; addresses.
//
var hijackFetchTiddler = function() {
	var oldFetchTiddler = store.fetchTiddler ;
	store.fetchTiddler = function(title) {
		var result = oldFetchTiddler.apply(this, arguments);
		if (!result &amp;&amp; title) {
			var i = title.lastIndexOf('/');
			if (i &gt; 0) {
				var parentName = title.substring(0, i);
				var partName = title.substring(i+1);
				var parent = (parentName == &quot;.&quot;) 
						? store.resolveTiddler(currentParent)
						: oldFetchTiddler.apply(this, [parentName]);
				if (parent) {
					return getPart(parent, partName, parent.title+&quot;/&quot;+partName);
				}
			}
		}
		return result;	
	};
};

// for debugging the plugin is not loaded through the systemConfig mechanism but via a script tag. 
// At that point in the &quot;store&quot; is not yet defined. In that case hijackFetchTiddler through the restart function.
// Otherwise hijack now.
if (!store) {
	var oldRestartFunc = restart;
	window.restart = function() {
		hijackFetchTiddler();
		oldRestartFunc.apply(this,arguments);
	};
} else
	hijackFetchTiddler();




// The user must not edit a readOnly/partTiddler
//

config.commands.editTiddler.oldIsReadOnlyFunction = Tiddler.prototype.isReadOnly;

Tiddler.prototype.isReadOnly = function() {
	// Tiddler.isReadOnly was introduced with TW 2.0.6.
	// For older version we explicitly check the global readOnly flag
	if (config.commands.editTiddler.oldIsReadOnlyFunction) {
		if (config.commands.editTiddler.oldIsReadOnlyFunction.apply(this, arguments)) return true;
	} else {
		if (readOnly) return true;
	}

	return this.abegoIsPartTiddler;
}

config.commands.editTiddler.handler = function(event,src,title)
{
	var t = store.getTiddler(title);
	// Edit the tiddler if it either is not a tiddler (but a shadowTiddler)
	// or the tiddler is not readOnly
	if(!t || !t.abegoIsPartTiddler)
		{
		clearMessage();
		story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE);
		story.focusTiddler(title,&quot;text&quot;);
		return false;
		}
}

// To allow the &quot;./partName&quot; syntax in macros we need to hijack 
// the invokeMacro to define the &quot;currentParent&quot; while it is running.
// 
var oldInvokeMacro = window.invokeMacro;
function myInvokeMacro(place,macro,params,wikifier,tiddler) {
	var oldCurrentParent = currentParent;
	if (tiddler) currentParent = tiddler;
	try {
		oldInvokeMacro.apply(this, arguments);
	} finally {
		currentParent = oldCurrentParent;
	}
}
window.invokeMacro = myInvokeMacro;

// To correctly support the &quot;./partName&quot; syntax while refreshing we need to hijack 
// the config.refreshers.tiddlers to define the &quot;currentParent&quot; while it is running.
// 
(function() {
	var oldTiddlerRefresher= config.refreshers.tiddler;
	config.refreshers.tiddler = function(e,changeList) {
		var oldCurrentParent = currentParent;
		try {
			currentParent = e.getAttribute(&quot;tiddler&quot;);
			return oldTiddlerRefresher.apply(this,arguments);
		} finally {
			currentParent = oldCurrentParent;
		}
	};
})();

// Support &quot;./partName&quot; syntax inside &lt;&lt;tabs ...&gt;&gt; macro
(function() {
	var extendRelativeNames = function(e, title) {
		var nodes = e.getElementsByTagName(&quot;a&quot;);
		for(var i=0; i&lt;nodes.length; i++) {
			var node = nodes[i];
			var s = node.getAttribute(&quot;content&quot;);
			if (s &amp;&amp; s.indexOf(&quot;./&quot;) == 0)
				node.setAttribute(&quot;content&quot;,title+s.substr(1));
		}
	};
	var oldHandler = config.macros.tabs.handler;
	config.macros.tabs.handler = function(place,macroName,params,wikifier,paramString,tiddler) {
		var result = oldHandler.apply(this,arguments);
		if (tiddler)
			extendRelativeNames(place, tiddler.title);
		return result;
	};
})();

// Scroll the anchor anchorName in the viewer of the given tiddler visible.
// When no tiddler is defined use the tiddler of the target given event is used.
window.scrollAnchorVisible = function(anchorName, tiddler, evt) {
	var tiddlerElem = null;
	if (tiddler) {
		tiddlerElem = document.getElementById(story.idPrefix + tiddler);
	}
	if (!tiddlerElem &amp;&amp; evt) {
		var target = resolveTarget(evt);
		tiddlerElem = story.findContainingTiddler(target);
	}
	if (!tiddlerElem) return;

	var children = tiddlerElem.getElementsByTagName(&quot;a&quot;);
	for (var i = 0; i &lt; children.length; i++) {
		var child = children[i];
		var name = child.getAttribute(&quot;name&quot;);
		if (name == anchorName) {
			var y = findPosY(child);
			window.scrollTo(0,y);
			return;
		}
	}
}

} // of &quot;install only once&quot;
//}}}

/***
&lt;html&gt;&lt;sub&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;scrollAnchorVisible('Top',null, event)&quot;&gt;[Top]&lt;/sub&gt;&lt;/a&gt;&lt;/html&gt;

!Licence and Copyright
Copyright (c) abego Software ~GmbH, 2006 ([[www.abego-software.de|http://www.abego-software.de]])

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.

Neither the name of abego Software nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.

&lt;html&gt;&lt;sub&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;scrollAnchorVisible('Top',null, event)&quot;&gt;[Top]&lt;/sub&gt;&lt;/a&gt;&lt;/html&gt;
***/</pre>
</div>
<div title="PasswordOptionsPlugin" modifier="YourName" created="200704220851" modified="201007300138" tags="systemConfig">
<pre>/***
|''Name:''|PasswordOptionPlugin|
|''Description:''|Extends TiddlyWiki options with non encrypted password option.|
|''Version:''|1.0.2|
|''Date:''|Apr 19, 2007|
|''Source:''|http://tiddlywiki.bidix.info/#PasswordOptionPlugin|
|''Author:''|BidiX (BidiX (at) bidix (dot) info)|
|''License:''|[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D ]]|
|''~CoreVersion:''|2.2.0 (Beta 5)|
***/
//{{{
version.extensions.PasswordOptionPlugin = {
	major: 1, minor: 0, revision: 2, 
	date: new Date(&quot;Apr 19, 2007&quot;),
	source: 'http://tiddlywiki.bidix.info/#PasswordOptionPlugin',
	author: 'BidiX (BidiX (at) bidix (dot) info',
	license: '[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D]]',
	coreVersion: '2.2.0 (Beta 5)'
};

config.macros.option.passwordCheckboxLabel = &quot;Save this password on this computer&quot;;
config.macros.option.passwordInputType = &quot;password&quot;; // password | text
setStylesheet(&quot;.pasOptionInput {width: 11em;}\n&quot;,&quot;passwordInputTypeStyle&quot;);

merge(config.macros.option.types, {
	'pas': {
		elementType: &quot;input&quot;,
		valueField: &quot;value&quot;,
		eventName: &quot;onkeyup&quot;,
		className: &quot;pasOptionInput&quot;,
		typeValue: config.macros.option.passwordInputType,
		create: function(place,type,opt,className,desc) {
			// password field
			config.macros.option.genericCreate(place,'pas',opt,className,desc);
			// checkbox linked with this password &quot;save this password on this computer&quot;
			config.macros.option.genericCreate(place,'chk','chk'+opt,className,desc);			
			// text savePasswordCheckboxLabel
			place.appendChild(document.createTextNode(config.macros.option.passwordCheckboxLabel));
		},
		onChange: config.macros.option.genericOnChange
	}
});

merge(config.optionHandlers['chk'], {
	get: function(name) {
		// is there an option linked with this chk ?
		var opt = name.substr(3);
		if (config.options[opt]) 
			saveOptionCookie(opt);
		return config.options[name] ? &quot;true&quot; : &quot;false&quot;;
	}
});

merge(config.optionHandlers, {
	'pas': {
 		get: function(name) {
			if (config.options[&quot;chk&quot;+name]) {
				return encodeCookie(config.options[name].toString());
			} else {
				return &quot;&quot;;
			}
		},
		set: function(name,value) {config.options[name] = decodeCookie(value);}
	}
});

// need to reload options to load passwordOptions
loadOptionsCookie();

/*
if (!config.options['pasPassword'])
	config.options['pasPassword'] = '';

merge(config.optionsDesc,{
		pasPassword: &quot;Test password&quot;
	});
*/
//}}}</pre>
</div>
<div title="PatchedPlugin" modifier="JohnRouillard" created="200903151936" modified="201007190237" tags="structure">
<pre>{{nocol{}}}

This describes the changes made to the plugins that are tagged with PatchedPlugin. These plugins should not be redistributed outside of the coursebook. The following plugins have been patched:

{{sectionTOC{}}}

! AnnotationsPlugin

Fixed usage comments from:

{{{
((text to annotate(annotation goes here)
}}}

to

{{{
((text to annotate(annotation goes here)))
}}}

in both places.

! FootnotesPlugin

Fix for issues when rendered as part of saving rss feed. It tries to add itself to the containing tiddler as though it was being rendered in the story column. But for RSS there is no story and it errors. Added:

{{{
 if (!story.findContainingTiddler(place)) return;
}}}

at the top of the handler function.

Also fixed a mising check to see if tiddler was defined:
{{{
Story.prototype.refreshTiddler = function(title,template,force)
{
    var tiddler = old_footnotes_refreshTiddler.apply(this,arguments);
	if (tiddler &amp;&amp; tiddler.notes &amp;&amp; tiddler.notes.length)
	{ ...
}}}
prepended the &quot;{{{tiddler &amp;&amp;}}}&quot; to the if statement in case the refresh returns null (was causing an error in IE 7).

! PartTiddlerPlugin

Change {{{&lt;&lt;br&gt;&gt;}}} to {{{&lt;br /&gt;}}}.

! QuizzerPlugin

Added {{{return false;}}} at the end of checkOut to prevent IE from alerting about leaving the web page.

! SlideShowPlugin -- changes merged to upstream. No longer modified.

Added
{{{
return false;
}}}
at the end of all the functions that are called by ~createTiddlyButton. This prevents IE from popping up a
window asking if you want to navigate away from the page that makes the slide show mode pretty useless.

Also there is an onclick inline function assigned to the var onclick in config.macros.slideShow.handler that needed a return false at the end and I added one to the line:
{{{
if(this.nSlides==0) return false;
}}}
in confg.macros.slideShow.onClick.

! SyncFromSourcePlugin

change ~FileAdaptor.minHostName to ~AdaptorBase.minHostName to get it to work with newer tiddlywikis.

!TableSortingPlugin

From: http://groups.google.com/group/TiddlyWiki/browse_thread/thread/cced75d513e00a21

{{{
The fix is to use a more precise conditional by changing these two
lines:
        if(!x &amp;&amp; hasClass(h,&quot;autosort&quot;)) {
        if(x)
to:
        if(x===null &amp;&amp; hasClass(h,&quot;autosort&quot;)) {
        if(x!==null)

That should do it. 
}}}

! TiddlerNotesPlugin

From discussion in:

http://groups.google.com/group/TiddlyWiki/browse_thread/thread/c70af7be67524685/770b706c64529caa?#770b706c64529caa

Well guess I answered my own question. I started firebug and reloaded the tw. Then I switched to the script tab and enabled &quot;break on all errors&quot;. Then I opened the import tab, switched to web and clicked on select a server and that resulted in:
{{{
77 if(attribs){
78     for(var n in attribs){
79            e.setAttribute(n,attribs[n]);
80     }
81 }
}}}
the error it reports is:
{{{
    e is not defined
}}}
this code is inside the function:
{{{
 function createTiddlyButton
(theParent,theText,theTooltip,theAction,theClass,theId,theAccessKey,attribs)
}}}
Looking at the function: {{{function createTiddlyElement (theParent,theElement,theID,theClass,theText,attribs)}}}
it uses the variable e in a similar way, however in createTiddlyButton the variable is:
{{{
  var theButton = document.createElement(&quot;a&quot;);
}}}
could it be that e.setAttribute should be theButton.setAttribute? 

Yes it should be.

!! Enhancement to allow printing of notes without empty notes blocks

When printing the story column, the notes block were taking up a lot of room and if they were empty, they were just wasted space.
I could turn off printing of the notes block, but I wanted to print them if the notes blocks had content. I patched the TiddlerNotesPlugin
to add the class ~TiddlerNotesExists to the notes blocks where there is a notes tiddler (indicating useful information). The patch replaced:
{{{
		var box = createTiddlyElement(place,&quot;div&quot;,&quot;notesContainer&quot;+tiddler.title,&quot;TiddlerNotes&quot;,null,{&quot;source&quot;:tiddler.title,params:paramString,heading:heading,tag:tag,suffix:suffix});
}}}
in the notes handler with:
{{{
                // rouilj add a class for notes that have contents in a tiddler.
                var notesTiddlerExists = store.tiddlerExists(tiddler.title+&quot;-&quot;+suffix);
		var box = createTiddlyElement(place,&quot;div&quot;,&quot;notesContainer&quot;+tiddler.title,&quot;TiddlerNotes&quot;  + (notesTiddlerExists?&quot; TiddlerNotesExists&quot;:&quot;&quot;),null,{&quot;source&quot;:tiddler.title,params:paramString,heading:heading,tag:tag,suffix:suffix});
}}}
note the space between the &quot; and ~TiddlerNotesExists. It must be there so that ~TiddlerNotes has a space after it otherwise the class names aren't correct.

Then the stylesheet was changed to not display the class ~TiddlerNotes but to display ~TiddlerNotesExists when printing. Also the edit notes button was hidden for printing.

&lt;&lt;sectionTOC&gt;&gt;</pre>
</div>
<div title="Presentation" modifier="JohnRouillard" created="200909071902" modified="200909080042" tags="InstructorOnly excludeOrphans">
<pre>{{nocol{}}}
&lt;&lt;tiddler OpenStoryButton with: &quot;Open all presentations&quot;&gt;&gt;
</pre>
</div>
<div title="Presentation  0 - Basic Coursebook Concepts" modifier="YourName" created="200907181732" modified="201007120119" tags="presentation story content excludeOrphans">
<pre>Intro to the coursebook and tiddlywiki in general
[[Slide Welcome]]
[[What is a TiddlyWiki]]
[[Tiddler Types in This Coursebook]]

[[Coursebook Orientation]]

[[Using Notebook]]

The parts of this coursebook:
   * Chapters
   * Presentations (shows)
   * Quizzes

[[Course Structure]]
[[Using Presentations]]
[[Using Chapters]]</pre>
</div>
<div title="Presentation  1 - Introducing the Coursebook" modifier="YourName" created="201007251847" modified="201007252119" tags="presentation content story">
<pre>[[Goals]]
[[Presentations]]
[[Textbook]]
[[Quizzes]]
[[Notebook]]
[[Live Book/Errata]]
</pre>
</div>
<div title="Presentation  2 - Student Use" modifier="YourName" created="201007251905" modified="201007251917" tags="presentation content story">
<pre>[[Online during class]]
[[Online after class]]
[[Printed documentation]]
</pre>
</div>
<div title="Presentation  3 - Instructor Use" modifier="YourName" created="201007251939" modified="201007251959" tags="presentation content story">
<pre>[[Creating the Student's Coursebook]]
[[Differences between student and instructor books]]
       [[Instructor has tools for improving editing/creation]]
            Tool for mass editing of tiddlers, tags
            Tool for maintaining different versions of tiddlers
            Tools for embedding/attaching files inside tw document
            Tool for showing relations between tiddlers
            Tool for easier tag management
            Configuration that displays missing tiddlers rather then replacing with nothing
            Double click to edit a tiddler is enabled
        [[Instructor tiddlywiki has themes for presentations]]
            student book has a stripped down content and navigation/note taking interface
        [[Student is a read-mostly config]]
            Only notes are easy to edit
            Content editing must be invoked by a menu, double clicking doesn't work
            Content can be overwritten during sync
        [[Instructor book can publish documents]]
            Student book without contents (framework)
                Meant to be portable for multiple classes.
            Student content to be imported
                Imported into framework to allow separation of framework updates from content updates
                Content updates are smaller than the whole tiddlywiki
            rss feed of content changes
    [[Presentation modes]]
    [[Presentation modes - Instructor]]
    instructor
            example slide
            No notes displayed
    [[Presentation modes - Student]]
        student
            example slide
            Instructor annotations
            Student notes
       [[Presentation modes - Print]]
        print
            example slide
                print display controlled by css. each slide on new page to allow for hand printed notes
       [[Presentation modes - Story]]

    [[Chapter creation]]
        sequence of tiddlers
            story makes up a linear chapter
            because tiddlers are stand alone entities (and are the unit of notetaking for the students) flow of prose is somewhat tricky. References to other tiddler content is tricky because this maybe the only tiddler shown.
    [[Printing]]
        Slides to pdf or paper
        content/chapters to pdf
            may still miss some tiddlers.
                Check orphaned tiddler list
</pre>
</div>
<div title="Presentation  4 - Improvements" modifier="YourName" created="201007252122" modified="201007252213" tags="presentation content story">
<pre>[[Areas for Improvement]]
[[Any Questions?]]
[[This is the End]]</pre>
</div>
<div title="Presentation  4 - Improvements-Notes" modifier="YourName" created="201007252114" modified="201007252215" tags="Notes excludeLists noReload">
<pre>;tags underused
: tagging provides more semantic info and provides linkages between tiddlers using tagclouds or other linkage tools. See {{exclude{[[Content Bugs##Possible tag taxonomy for content]]}}} for one sample. It's possible the tag taxonomy may be different for each course and a single taxonomy is not possible.
;more flexibility with themes
: I often have three levels of slides: &lt;&lt;tiddler &quot;Presentation  4 - Improvements-Notes##slideLevels&quot;&gt;&gt; where the layout of the slides is different. E.G. the primary slide may be a picture with overlayed text. So the normal border etc of a standard presentation should be suppressed for this slide. While the third level slides may have a different color, border or dividing line to indicate that this slide is not as important as the second or primary slides. This also allows me to skip quickly through third level slides by sight when I am running short of time or audience interest in a particular secondary point is lagging.

;discovering relations between tiddlers
: This is something that I played with originally. There are a number of plugins from [[hypergraphs|http://project.dahukanna.net/tiddlywiki/twextensions.htm]], To ~TiddlyGraph: http://ideia.tiddlyspot.com/, to ~RelatedTiddlersPlugin: http://www.tiddlytools.com/#RelatedTiddlersPlugin, to using match tags to find all tiddlers with similar sets of tags. I haven't found a good solution yet that is cross browser, simple to interpret/use.

;edit cycle with multiple users
:when I was producing my first coursebook, my editor was in california and she got emails with the tiddlywiki in it to review. Ideally she would have been able to add her own notes (notebook) in a separate namespace and then send the tiddlywiki back to me. Then I could import her notes into my tiddlywiki an respond to them. However the notes plugin doesn't quite work that way, so we were stuck having to use manual notes and context clues to handle the edits. Using an online collaborative platform like tiddlyspot may be a good way around that, but... Also the revisions plugin allows multiple revisions so in theiry she could edit it and I could compare, but frankly the comparison/revision mchanism is kind of clunky.

/%
!slideLevels
* Primary topic/graphic
* Secondary topic
* Supporting
!end
%/</pre>
</div>
<div title="Presentation Tips" modifier="YourName" created="201007182041" modified="201007270353" tags="content">
<pre>By default every presentation gets:
* start instructor show button
* start student show button
* print mode button
displayed at the top of the control tiddler for the presentation
&lt;&lt;&lt;
@@vertical-align:bottom;[img(24px,)[warning-icon.png]]@@ If these buttons are missing, make sure {{{presentation}}} is the first tag on the tiddler.
&lt;&lt;&lt;
You can add a different  {{{&lt;&lt;slideShow&gt;&gt;}}} macro calls to get a looping slide show button, or other execution type. See [[SlideShowPluginDoc##Options]] for a description of the modes that the slide show can operate in. Make sure to include the macro call it inside of a  {{exclude{  ...  }}} block so it's arguments (to style/theme tiddlers ...) aren't displayed as part of the presentation. If you are using  a single tiddler presentation see [[Creating a Presentation]] for the proper [[class syntax|http://www.tiddlywiki.com/#CustomCssClass]] to hide the display of the slideshow start button during the presentation.

To add instructor notes for the students to view, add the instructor notes inside of a {{comment{ ... }}} class block. These will be displayed on a colored background to the student, but are not displayed on the screen.

To learn how to add overlays see [[SlideShowPluginDoc##Incremental display]].
* Advancing a slide when a slide has overlays just displays the next overlay set
* Student view has overlays disabled, all the overlayed sections are displayed when the student displays the slide. This makes it easier for the student to stay in sync with the instructor as slide changes are obvious, but overlay reveals can be missed by the student.

When generating a looping slideshow, set the slide display time to a standard base increment that most of your slides will use.
Then add &lt;html&gt;&lt;pre&gt;{{overlay1{}}}, {{overlay2{}}} ...&lt;/pre&gt;&lt;/html&gt; to make a given slide display for an additional increment for each empty overlay.

You can add links on the [[presentation control tiddler|Glossary/presentationControlTiddler]] to other tiddlers that are not part of the slide show by enclosing the links inside of an exclude class block.  &lt;&lt;tiddler [[Presentation Tips##excludeClass]]&gt;&gt; Also you will want to tag that referenced tiddler with the *excludeStory* tag.

Presentations can also be tagged with story to allow all the tiddlers in the presentation to be opened in order in the story column. This is a fast way of displaying the entire presentation for review/editing or [[printing|Printing Slide Set]].

/%
!excludeClass
&lt;html&gt;&lt;pre&gt;
{{exclude{ [[other tiddler reference]] }}}
&lt;/pre&gt;&lt;/html&gt;
!end
%/</pre>
</div>
<div title="Presentation modes" modifier="YourName" created="201007251959" modified="201007251959" tags="slide content">
<pre>* Instructor
* Student
* Print
* Story</pre>
</div>
<div title="Presentation modes - Instructor" modifier="YourName" created="201007251955" modified="201007251957" tags="slide content">
<pre>* instructor
example slide
{{comment{
Note that no instructor notes are displayed
}}}
</pre>
</div>
<div title="Presentation modes - Print" modifier="YourName" created="201007252003" modified="201007252009" tags="slide content">
<pre>fixme example slide

{{comment{
Each slide by default prints at the top of a new page. So you can create 2, 4, 8 up pages
using your printer's mechanism for putting multiple pages on a single sheet of paper.
}}}</pre>
</div>
<div title="Presentation modes - Story" modifier="YourName" created="201007252007" modified="201007252009" tags="slide content">
<pre>FIXME example slide

{{comment{
This isn't a presentation mode supplied by the SlideShowPlugin. Instead it treats the slideshow as a list of tiddlers to display in presentation order in the story column. This allows printing of notebooks for the tiddlers (which the print presentation mode doesn't).

This is as close to a storyboard as I could get and is the mode I print off to use as my guide during presentations. Note that each tiddler and it's associated notebook is printed on a new page again allowing multi-up printing using the standard printer driver.
}}}</pre>
</div>
<div title="Presentation modes - Student" modifier="YourName" created="201007252001" modified="201007252030" tags="slide content">
<pre>example slide FIXME
{{comment{
Note the instructor annotations that are highlighted at the bottom of the slide.
Also the notebook for the student is available.
}}}</pre>
</div>
<div title="PresentationList" modifier="YourName" created="200903212321" modified="201007120128" tags="structure TOC">
<pre>&lt;&lt;matchTags inline {{if (store.getTiddlerText(&quot;InstructorSlideShowStyleSheet&quot;)) {displayargs=&quot;theme:InstructorSlideShowStyleSheet toc:titles noClicks footer:'copyright&amp;copy; 2010&lt;br /&gt;John Rouillard' clock:+ tooltip:'Start %0 slideshow in instructor projection mode' &quot;} else {displayargs=&quot;noClicks noKeyboard noOverlays toc:titles tooltip:'Start %0 slideshow in student mode' &quot;}; &quot;* &lt;&lt;slideShow tiddler:'%0' label:'%0' &quot; + displayargs + &quot;&gt;&quot; + &quot;&gt; @@font-size: smaller;([[open|%0]])@@&quot;}} &quot;\n&quot; sort:title presentation&gt;&gt;
@@display:none; use sort order to override default title based ordering. Anything with an explicit order will be sorted before the title sorted section. @@</pre>
</div>
<div title="Presentations" modifier="JohnRouillard" created="201007251853" modified="201007310455" tags="slide content">
<pre>&lt;&lt;tiddler SlideSubstyle##levelTwo&gt;&gt;

{{comment{
presentation picture

* Have multiple slide shows corresponding to a single lesson/chapter in document.
* Support overlays for presentation (but not in student copy).
* Provide instructor notes for students to view (but not in presentation)
* Allow students to take their own notes on slides
* Automatic presentations for class breaks, before class etc
}}}</pre>
</div>
<div title="Printed documentation" modifier="YourName" created="201007251920" modified="201007251934" tags="slide content">
<pre>* slide shows
* chapters
* student notes

{{comment{
If you are going to be printing content, some care is required with the use of [[dynamic content|Dynamic Content]].
Choose dynamic content mechanisms that are printable, or do not put required information into dynamic content since it may not be printable.

While you can print to PDF, this is good for little more than printing a hard copy of the document. Hyperlinks and other active content in the TiddlyWiki are not active in the pdf. Bookmarks can be added to the pdf afterwards that allow the user to jump to the target of links, but this is time consuming and prone to error.
}}}</pre>
</div>
<div title="Printing" modifier="JohnRouillard" created="201007252019" modified="201008072007" tags="slide content">
<pre>! People still like paper
* Start of chapters print on new page
* Each slide in a presentation prints on new page
* Best with linear content, paper doesn't work well for non-linear content
* Can print to pdf using printer driver but no active content of the TiddlyWiki survives

{{comment{
Chapters and presentations are linear and the best candiates for printing. Printing reference pages may
also be useful. However there are probably going to be tiddlers that are not displayed in a linear context.
TiddlyWiki provides the [[orphaned tiddler list]] to help identify tiddlers that are not linked or [[transcluded|Glossary/transcluded]] into other tiddlers.
}}}</pre>
</div>
<div title="Printing Chapters" modifier="JohnRouillard" created="201007311841" modified="201008072010" tags="content">
<pre>Reading material on a computer is still not as easy as reading it printed on paper. Printing a chapter is a matter of displaying the chapter(s) tiddlers in order in the story column and using the browser's print function to print the story. A [[style sheet with instructions for printing|StyleSheet]] (search for {{{@media print }}} to find the printing section) is included in the coursebook. Directions for making some basic changes can be found in [[Changing the Style Sheet]].

!! Setting up the Story Column
To print:
* Select the chapter from pull the down box, or click on the title link for the chapter in the left hand MainMenu.
** This prints the chapter content and any personal notes.

You can open multiple chapters by opening the chapters in order, but you need to set/change the story display options.
* In the chapter pulldown:
## select &quot;close other tiddlers&quot; under viewing options
## select the first chapter you want to display
## select only: &quot;open at bottom&quot; under viewing options
## select additional chapters in the order you want them displayed
* print using the browsers print mechanism

Note that each chapter should print starting on a new page if
{{{
&lt;&lt;tiddler ChapterStart&gt;&gt;
}}}
is prepended to the first line of the first tiddler in the chapter. See [[Changing the Style Sheet]] if you want to modfiy this.
</pre>
</div>
<div title="Printing Slide Set" modifier="JohnRouillard" created="201007182041" modified="201008071939" tags="content">
<pre>Before printing the slide set you will probably want to set the title of the Coursebook to reflect the particular presentation you are printing. The title is used
in the page header and possibly other places depending on your output mode. You can use the &quot;change title&quot; link in the instructor slider in the right sidebar to set a title. Usually it is the presentation name. Note this is also used for the file naming with PDFCreator if you set it to use auto filename, it must be unique in the first 10 or so characters or one print file will overwrite another.

There are two printing modes you can do from the Instructor Coursebook:
* print instructor slides including instructor notes, comments for the students etc. This mode does not look like the presentation slides.
* the slides as presented on the screen (think powerpoint slide print).

To print something suitable as a handout to the presentation attendees that includes the notes to the attendees (SlideShowPlugin print mode):
* Select the @@open@@ link next to the presentation title from presentation menu
** In the control tiddler, choose print mode to display the slide content as it would be shown on the screen. Note that all overlays are displayed for printing. These slides can be printed 2-up on a sheet of paper (using the print settings dialog box) and are suitable for use as handouts for the students.
** Use the browser's menu to start the print process.
** Pressing any key on the keyboard will end the print mode.

To print the instructor slides/notes etc
* Select the presentation from the drop down select box:
** This opens all the slide tiddlers in the story column. When printed it shows: slide content, instructor notes (inside of comment blocks), and personal notes (notebook). It is not formatted like a slide. Text is smaller and other settings appropriate to a slide show presentation are not applied.

In both cases every slide tidder prints on a new page. If you want to change this, you need to edit the PrintingSlideShowStyleSheet as described in [[Changing Slide Printing|Changing the Style Sheet##Changing Slide Printing]]</pre>
</div>
<div title="PrintingSlideShowStyleSheet" modifier="JohnRouillard" created="200903251837" modified="200909081623" tags="structure excludeStory">
<pre>/*{{{*/
/* Default style sheet settings for printing */
#contentWrapper.slideShowMode #displayArea{
 font-size: 150%;
 margin: 1em 15.5em 0em 1em !important;
}

h1,h2,h3 {margin-top:0.3em}

.slideFooterOff #navigator{
 display: none;
}

#controlBar{
 display: none;
}

@media print {
.tiddler{
 page-break-after: always;
 border: 2px solid blue;
 margin: 1em 0 1em 0;
 padding: 0.5em
}
.viewer pre { background-color: transparent; }

#contentWrapper.slideShowMode .comment{
 background-color: transparent;
}
}

.notes {
display: none;
}

.comment{
 border: 1pt dashed;
 padding: 0.5em;
}

#contentWrapper.slideShowMode  #displayArea {margin: 1em 0em 0em 0em !important;}
}
/*}}}*/</pre>
</div>
<div title="QuickEditPlugin" modifier="JohnRouillard" created="200801120132" modified="200908250416" tags="systemConfig QuickEditPackage InstructorOnly">
<pre>/***
|Name|QuickEditPlugin|
|Source|http://www.TiddlyTools.com/#QuickEditPlugin|
|Documentation|http://www.TiddlyTools.com/#QuickEditPlugin|
|Version|2.4.3|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 3.0 License|http://creativecommons.org/licenses/by-sa/3.0/]]|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides||
|Description|Support functions for ~QuickEdit package: styles, utility functions, and 'toggleQuickEdit' command|
!!!!!Revisions
&lt;&lt;&lt;
2009.06.11 [2.4.3] added keyup() function to abbreviate listbox handling for CR and ESC
2009.05.07 [2.4.2] added processed() function to abbreviate event handler code
2008.09.07 [2.4.1] added removeCookie() function for compatibility with [[CookieManagerPlugin]]
2008.05.17 [2.4.0] copied code from StickyPopupPlugin to remove dependency
2008.05.12 [2.3.0] added &quot;toggleQuickEdit&quot; command handler (replaces inline script command)
2008.01.11 [2.2.0] converted from inline script
2007.03.29 [1.0.0] initial release (as inline script)
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.QuickEditPlugin= {major: 2, minor: 4, revision: 3, date: new Date(2009,6,11)};

// SET STYLESHEET
setStylesheet(&quot;\
.quickEdit a { border:2px outset ButtonFace; padding:0px 3px !important; \
	-moz-border-radius:.5em; -webkit-border-radius:.5em; \
	-moz-appearance:button !important; -webkit-appearance:push-button !important; \
	background-color:ButtonFace; color:ButtonText !important;  \
	line-height:200%; font-weight:normal; } \
.quickEdit a:hover { border: 2px inset ButtonFace; background-color:ButtonFace; }\
&quot;, &quot;quickEditStyles&quot;);

// REMOVE COOKIE
if (window.removeCookie===undefined) {
	window.removeCookie=function(name) {
		document.cookie = name+'=; expires=Thu, 01-Jan-1970 00:00:01 UTC; path=/;'; 
	}
}

// UTILITY FUNCTIONS
config.quickEdit = {
	processed: function(ev) { ev=ev||window.event;
		ev.cancelBubble=true;
		if(ev.stopPropagation) ev.stopPropagation();
		return false;
	},
	keyup: function(ev){ var k=(ev||window.event).keyCode;
		if (k==13) this.onclick();
		if (k==27) Popup.remove();
	},
	getField: function(where) {
		var here=story.findContainingTiddler(where); if (!here) return null;
		var e=story.getTiddlerField(here.getAttribute(&quot;tiddler&quot;),&quot;text&quot;);
		if (e&amp;&amp;e.getAttribute(&quot;edit&quot;)==&quot;text&quot;) return e;
		return null;
	},
	setSelection: function(where,newtext) {
		var e=this.getField(where); if (!e) return false;
		e.focus(); replaceSelection(e,newtext);
		return false;
	},
	wrapSelection: function(where,before,after) {
		var e=this.getField(where); if (!e) return false;
		e.focus(); replaceSelection(e,before+config.quickEdit.getSelection(e)+after);
		return false;
	},
	getSelection: function(e) {
		var seltext=&quot;&quot;;
		if (e&amp;&amp;e.setSelectionRange)
			seltext=e.value.substr(e.selectionStart,e.selectionEnd-e.selectionStart);
		else if (document.selection) {
			var range = document.selection.createRange();
			if (range.parentElement()==e) seltext=range.text
		}
		return seltext;
	},
	promptForFilename: function(msg,path,file) {
		if(window.Components) { // moz
			try {
				netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
				var nsIFilePicker = window.Components.interfaces.nsIFilePicker;
				var picker = Components.classes['@mozilla.org/filepicker;1'].createInstance(nsIFilePicker);
				picker.init(window, msg, nsIFilePicker.modeOpen);
				var thispath = Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);
				thispath.initWithPath(path);
				picker.displayDirectory=thispath;
				picker.defaultExtension='jpg';
				picker.defaultString=file;
				picker.appendFilters(nsIFilePicker.filterAll|nsIFilePicker.filterImages);
				if (picker.show()!=nsIFilePicker.returnCancel)
					var result=&quot;file:///&quot;+picker.file.persistentDescriptor.replace(/\\/g,'/');
			}
			catch(e) { alert('error during local file access: '+e.toString()) }
		}
		else { // IE
			try { // XP only
				var s = new ActiveXObject('UserAccounts.CommonDialog');
				s.Filter='All files|*.*|JPG files|*.jpg|GIF files|*.gif|PNG files|*.png|';
				s.FilterIndex=1; // default to JPG
				s.InitialDir=path;
				s.FileName=file;
				if (s.showOpen()) var result=s.FileName;
			}
			catch(e) { var result=prompt(msg,path+file); } // fallback for non-XP IE
		}
		return result;
	}
}
//}}}

//{{{
if (config.options.chkShowQuickEdit===undefined) config.options.chkShowQuickEdit=false;
config.commands.toggleQuickEdit = {
	hideReadOnly: true,
	getText: function() { return config.options.chkShowQuickEdit?'\u221Aquickedit':'quickedit'; },

	tooltip: 'show QuickEdit toolbar buttons',
	handler: function(event,src,title) {
		config.options.chkShowQuickEdit=!config.options.chkShowQuickEdit;
		config.macros.option.propagateOption(&quot;chkShowQuickEdit&quot;,&quot;checked&quot;, config.options.chkShowQuickEdit,&quot;input&quot;);
		if (config.options.chkShowQuickEdit) saveOptionCookie(&quot;chkShowQuickEdit&quot;);
		else removeCookie(&quot;chkShowQuickEdit&quot;);
		src.innerHTML=config.commands.toggleQuickEdit.getText();
		story.forEachTiddler(function(t,e){if (story.isDirty(t)) refreshElements(e);});
		return false;
	}
};
//}}}

// // COPIED FROM [[StickyPopupPlugin]] TO ELIMINATE PLUGIN DEPENDENCY
//{{{
if (config.options.chkStickyPopups==undefined) config.options.chkStickyPopups=false;
Popup.stickyPopup_onDocumentClick = function(ev)
{
	// if click is in a sticky popup, ignore it so popup will remain visible
	var e = ev ? ev : window.event; var target = resolveTarget(e);
	var p=target; while (p) {
		if (hasClass(p,&quot;popup&quot;) &amp;&amp; (hasClass(p,&quot;sticky&quot;)||config.options.chkStickyPopups)) break;
		else p=p.parentNode;
	}
	if (!p) // not in sticky popup (or sticky popups disabled)... use normal click handling
		Popup.onDocumentClick(ev);
	return true;
};
try{removeEvent(document,&quot;click&quot;,Popup.onDocumentClick);}catch(e){};
try{addEvent(document,&quot;click&quot;,Popup.stickyPopup_onDocumentClick);}catch(e){};
//}}}</pre>
</div>
<div title="QuickEdit_convert" modifier="JohnRouillard" created="200809080351" modified="200908250022" tags="QuickEditPackage InstructorOnly">
<pre>/%
|Name|QuickEdit_convert|
|Source|http://www.TiddlyTools.com/#QuickEdit_convert|
|Version|2.4.3|
|Author|Eric Shulman|
|License|see http://www.TiddlyTools.com/#QuickEditPlugin|
|Type|html|
|Requires|QuickEditPlugin|
|Description|quickedit - convert between comma/tab-separated and TW table format|

Usage: see  http://www.TiddlyTools.com/#QuickEditToolbar

%/&lt;html&gt;&lt;hide linebreaks&gt;&lt;a href=&quot;javascript:;&quot; class=&quot;tiddlyLink&quot; tabindex=&quot;-1&quot; 
title=&quot;convert between comma/tab-separated and TW table format&quot;
onclick=&quot;var e=config.quickEdit.getField(this);
	if (e) e.focus(); var txt=config.quickEdit.getSelection(e);
	if (txt.indexOf(',')+txt.indexOf('\t')+txt.indexOf('|')==-3) {
		alert('Please select text containing tabs, commas, or TiddlyWiki table syntax.');
		return false;
	}
	var p=Popup.create(this); if (!p) return false; p.className+=' sticky smallform';
	var s=createTiddlyElement(p,'select'); s.button=this;
	s.options[0]=new Option('select a converter...','');
	if (txt.indexOf(',')!=-1) {
		s.options[s.length]=new Option('commas -&gt; table','commasToTable');
		s.options[s.length]=new Option('commas -&gt; tabs','commasToTabs');
	}
	if (txt.indexOf('\t')!=-1) {
		s.options[s.length]=new Option('tabs -&gt; table','tabsToTable');
		s.options[s.length]=new Option('tabs -&gt; commas','tabsToCommas');
	}
	if (txt.indexOf('|')!=-1) {
		s.options[s.length]=new Option('table -&gt; tabs','tableToTabs');
		s.options[s.length]=new Option('table -&gt; commas','tableToCommas');
	}
	s.size=s.length;
	s.onclick=function(){ if (!this.value.length) return;
	        var e=config.quickEdit.getField(this.button); if (!e) return false;
		e.focus(); var txt=config.quickEdit.getSelection(e);
		switch(this.value) {
			case 'tabsToTable':
				txt=txt.replace(/\t/g,'|').replace(/^|$/g,'|');
				txt=txt.replace(/\n/g,'|\n|').replace(/^\|$/g,'');
				break;
			case 'tableToTabs':
				txt=txt.replace(/\t/g,' ').replace(/\|/g,'\t');
				txt=txt.replace(/^\t/g,'').replace(/\t$/g,'');
				txt=txt.replace(/\n\t/g,'\n').replace(/\t\n/g,'\n');
				break;
			case 'commasToTable':
				txt=txt.replace(/,/g,'|').replace(/^|$/g,'|');
				txt=txt.replace(/\n/g,'|\n|').replace(/^\|$/g,''); 
				break;
			case 'tableToCommas':
				txt=txt.replace(/,/g,' ').replace(/\|/g,',');
				txt=txt.replace(/^,/g,'').replace(/,$/g,''); 
				txt=txt.replace(/\n,/g,'\n').replace(/,\n/g,'\n'); 
				break;
			case 'tabsToCommas':
				txt=txt.replace(/\t/g,',');
				break;
			case 'commasToTabs':
				txt=txt.replace(/,/g,'\t');
				break;
		}
		replaceSelection(e,txt);
		Popup.remove(); return false;
	};
	s.onkeyup=config.quickEdit.keyup;
	Popup.show();
	s.focus();
	return config.quickEdit.processed(event);&quot;
&gt;convert&lt;/a&gt;&lt;/html&gt;</pre>
</div>
<div title="QuizList" modifier="JohnRouillard" created="200907050237" modified="201007312148" tags="structure TOC">
<pre>&lt;&lt;matchTags inline &quot;* [[%0]]&quot; &quot;\n&quot; sort:title quiz&gt;&gt; @@display:none; use sort order to override default title based ordering. Anything with an explicit order will be sorted before the title sorted section. @@</pre>
</div>
<div title="QuizzerPlugin" modifier="JohnRouillard" created="200704020828" modified="200909040305" tags="systemConfig myPlugin plugin excludeMissing PatchedPlugin">
<pre>/***
|''Name:''|QuizzerPlugin|
|''Description:''|Makes quizzes with optional grades|
|''Version:''|1.0.2|
|''Date:''|Nov 11, 2008|
|''Source:''|http://www.math.ist.utl.pt/~psoares/addons.html|
|''Documentation:''|[[QuizzerPlugin Documentation|QuizzerPluginDoc]]|
|''Author:''|Paulo Soares|
|''License:''|[[Creative Commons Attribution-Share Alike 3.0 License|http://creativecommons.org/licenses/by-sa/3.0/]]|
|''~CoreVersion:''|2.1.0|
***/
//{{{
config.macros.quiz = {
	wrongAnswer: &quot;Incorrect answer. Please think again.&quot;,
	rightAnswer: &quot;That's right!&quot;,
	trueValue: &quot;True&quot;,
	falseValue: &quot;False&quot;,
	handler: function(place,macroName,params,wikifier,paramString){
		var par = paramString.parseParams(&quot;list&quot;,null,true);
		var type = getParam(par,&quot;type&quot;,&quot;M&quot;);
		var panelType = (type.length&gt;1) ? type.charAt(1) : &quot;&quot;;
		type = type.charAt(0);
		var id = getParam(par,&quot;id&quot;,&quot;&quot;);
		if(id==&quot;&quot; &amp;&amp; type!=&quot;M&quot;) return; // not sure about this
		var value = getParam(par,&quot;value&quot;,false);
		var tiddler = getParam(par,&quot;tiddler&quot;,&quot;&quot;);
		var score = parseFloat(getParam(par,&quot;score&quot;,0));
		var toolTip = &quot;&quot;;
		if(type==&quot;T&quot;){
			toolTip = this.trueValue;
			if(value==false){
				var tempTiddler=tiddler;
				tiddler=&quot;&quot;;
				var tempScore=score;
				score=0;
			}
		}
		this.createAnswer(place, type, toolTip, true, panelType, tiddler, value, score, id);
		if(type==&quot;T&quot;){
			tiddler=(value==false)?tempTiddler:&quot;&quot;;
			score=(value==false)?tempScore:0;
			toolTip = this.falseValue;
			this.createAnswer(place, type, toolTip, false, panelType, tiddler, !value, score, id);
		}
	},
	createAnswer: function(place, type, toolTip, correction, panelType, tiddler, value, score, id){
		var checked=false;
		if(correction){
			var correct = createTiddlyElement(place,&quot;span&quot;,&quot;&quot;,&quot;correction&quot;,&quot;&quot;);
			correct.style.display='none';
			correct.style.fontWeight='bold';
			checked=true;
		}
		if(type==&quot;M&quot;){
			var btn = createTiddlyCheckbox(place,&quot;&quot;,false,this.onClickAnswer);
		} else {
			var btn = createTiddlyRadiobox(place,&quot;&quot;,checked,this.onClickAnswer,id);
		}
		btn.className = &quot;answerItem&quot;;
		btn.value=score;
		if(toolTip!=&quot;&quot;) btn.title=toolTip;
		var panelClass = (panelType==&quot;=&quot;) ? &quot;sliderPanel&quot; : &quot;floatingPanel&quot;; //default to floating
		var text = (tiddler!=&quot;&quot;) ? store.getTiddlerText(tiddler) : &quot;&quot;; 
		if(text==&quot;&quot;){text = (value) ? this.rightAnswer : this.wrongAnswer;}
		var panel = createTiddlyElement(null,&quot;div&quot;,&quot;&quot;,panelClass);
		panel.style.display = &quot;none&quot;; //default to closed
		panel.onclick=function(){this.style.display=&quot;none&quot;;};
		place.appendChild(panel);
		wikify(text,panel,null);
	},
	onClickAnswer: function(e){
		if(!e) var e = window.event;
		var panel = this.nextSibling;
		if(this.checked){
			var validated = 1;
			var visiblePanel=document.getElementById('visiblePanel');
			var sC = Story.prototype.findContainingTiddler(this).id.substr(7)+'_scoreCard';
			var scoreCard=document.getElementById(sC);
			if(visiblePanel){
				visiblePanel.style.display=&quot;none&quot;;
				visiblePanel.id=&quot;&quot;;
			}
			if(scoreCard){validated = scoreCard.value;}
			if(validated==1){
				panel.style.display = &quot;block&quot;;
				panel.id=&quot;visiblePanel&quot;;
				var left= e.clientX +10;
				panel.style.left = left + &quot;px&quot;;
			}
		} else {
			panel.style.display = &quot;none&quot;;
			panel.id=&quot;&quot;;
		}
	}
};

config.macros.score= {
	trueSymbol: &quot;&quot;,
	falseSymbol: &quot;&quot;,
	label: &quot;Score &quot;,
	handler: function(place,macroName,params,wikifier,paramString,tiddler){
		var btn = createTiddlyButton(place,this.label,&quot;&quot;,this.checkOut);
		btn.id=tiddler.title+&quot;_scoreCard&quot;;
		btn.value=0;
	},
	checkOut: function(e){
		if(this.value==1) return;
		var total=score=points=0;
		var answers=getElementsByClass(&quot;answerItem&quot;,document.getElementById('viewer'));
		var answersLen=answers.length;
		for(var i=0; i&lt;answersLen; i++) {
			points=parseFloat(answers[i].value);
			score+=answers[i].checked*points;
			if(points&gt;0)total+=points;
			var correct=answers[i].previousSibling;
			if(correct.className==&quot;correction&quot;){
				if(answers[i].checked == (points&gt;0)){
					correct.firstChild.data=config.macros.score.trueSymbol;
					correct.style.color = '#0f0';
				} else {
					correct.firstChild.data=config.macros.score.falseSymbol;
					correct.style.color = '#f00';
				}
				correct.style.display='inline';
			}
		}
		var text = &quot; &quot; + score+&quot;/&quot;+total;
		createTiddlyElement(this,&quot;span&quot;,&quot;&quot;,&quot;&quot;,text);
		this.value=1;
                return false;
	}
};

function getElementsByClass(searchClass,node,tag) {
	var classElements = new Array();
	if ( node == null ) node = document;
	if ( tag == null ) tag = '*';
	var els = node.getElementsByTagName(tag);
	var elsLen = els.length;
	var pattern = new RegExp(&quot;(^|\\s)&quot;+searchClass+&quot;(\\s|$)&quot;);
	for (var i = 0; i &lt; elsLen; i++) {
		if ( pattern.test(els[i].className) ) {classElements.push(els[i]);}
	}
	return classElements;
}

function createTiddlyRadiobox(theParent,caption,checked,onChange,id){
	var cb = document.createElement(&quot;input&quot;);
	cb.type = &quot;radio&quot;;
	cb.name = id;
	cb.onclick = onChange;
	theParent.appendChild(cb);
	cb.checked = checked;
	cb.className = &quot;chkOptionInput&quot;;
	if(caption) wikify(caption,theParent);
	return cb;
}

setStylesheet(&quot;/*{{{*/\n.floatingPanel {\n color: black;\n;position: absolute;\nz-index: 10;\npadding: 0.5em;\nbackground-color: #eee;\nborder: 1px solid #333;\ncursor: crosshair}\n\n.sliderPanel {padding: 0.5em;\nborder: 1px dotted #333;\nwidth: auto;\ncursor: crosshair}\n\n/*}}}*/&quot;,&quot;AnswerPanelStyles&quot;);

config.shadowTiddlers.QuizzerPluginDoc=&quot;The documentation is missing. It is available [[here|http://www.math.ist.utl.pt/~psoares/addons.html#QuizzerPluginDoc]].&quot;;
//}}}</pre>
</div>
<div title="QuizzerPluginDoc" modifier="JohnRouillard" created="200704011306" modified="200909061930" tags="docs">
<pre>!!!!Syntax
The QuizzerPlugin has five parameters; most are optional:
//{{{
&lt;&lt;quiz [type:type[=]] [id:id] [tiddler:tiddler] [value:value] [score:score]&gt;&gt;
//}}}
Parameters:
*type (string)
**&quot;M&quot; (multiple answer checkbox) (default)
**&quot;S&quot; (single-answer radio button group)
**&quot;T&quot; (true/false question)
***append &quot;=&quot; for sliding panel (e.g., T=, S=, M=) 
*id (string)
**required for types S  and T only
***for type S value must be unique across a group of questions
***for type T value must be unique for each question 
*tiddler (string, //optional//)
**display text from tiddler in the panel
**default is config.macros.answer.wrongAnswer or config.macros.answer.rightAnswer according to the value of the next parameter
*value
**use {{{value:true}}} to indicate that the true answer is right
**should be omitted otherwise
*score (number)
**sets the score for an answer
** default is 0</pre>
</div>
<div title="Quizzes" modifier="JohnRouillard" created="201007251856" modified="201007310716" tags="slide content">
<pre>&lt;&lt;tiddler SlideSubstyle##levelThree&gt;&gt;
Yes there must be quizzes.
{{comment{
picture quiz/exam

* Scored multiple choice, true/false, single answer
* Support essay/example questions
}}}</pre>
</div>
<div title="RSSReaderPlugin" modifier="BidiX" created="200704132044" modified="200809022025" tags="systemConfig excludeMissing">
<pre>/***
|''Name:''|RSSReaderPlugin|
|''Description:''|This plugin provides a RSSReader for TiddlyWiki|
|''Version:''|1.1.2|
|''Date:''|2008-09-02|
|''Source:''|http://tiddlywiki.bidix.info/#RSSReaderPlugin|
|''Documentation:''|http://tiddlywiki.bidix.info/#RSSReaderPluginDoc|
|''Author:''|BidiX (BidiX (at) bidix (dot) info)|
|''Credit:''|BramChen for RssNewsMacro|
|''[[License]]:''|[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D ]]|
|''~CoreVersion:''|2.2.0|
|''OptionalRequires:''|http://www.tiddlytools.com/#NestedSlidersPlugin|
***/
//{{{
version.extensions.RSSReaderPlugin = {
	major: 1, minor: 1, revision: 2,
	date: new Date(&quot;2008-09-02&quot;),
	source: &quot;http://TiddlyWiki.bidix.info/#RSSReaderPlugin&quot;,
	author: &quot;BidiX&quot;,
	coreVersion: '2.2.0'
};

config.macros.rssReader = {
	dateFormat: &quot;DDD, DD MMM YYYY&quot;,
	itemStyle: &quot;display: block;border: 1px solid black;padding: 5px;margin: 5px;&quot;, //useed  '@@'+itemStyle+itemText+'@@'
	msg:{
		permissionDenied: &quot;Permission to read preferences was denied.&quot;,
		noRSSFeed: &quot;No RSS Feed at this address %0&quot;,
		urlNotAccessible: &quot; Access to %0 is not allowed&quot;
	},
	cache: [], 	// url =&gt; XMLHttpRequest.responseXML
	desc: &quot;noDesc&quot;,
	
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		var desc = params[0];
		var feedURL = params[1];
		var toFilter = (params[2] ? true : false);
		var filterString = (toFilter?(params[2].substr(0,1) == ' '? tiddler.title:params[2]):'');
		var place = createTiddlyElement(place, &quot;div&quot;, &quot;RSSReader&quot;);
		wikify(&quot;^^&lt;&lt;rssFeedUpdate &quot;+feedURL+&quot; [[&quot; + tiddler.title + &quot;]]&gt;&gt;^^\n&quot;,place);
		if (this.cache[feedURL]) {
			this.displayRssFeed(this.cache[feedURL], feedURL, place, desc, toFilter, filterString);
		}
		else {
			var r = loadRemoteFile(feedURL,config.macros.rssReader.processResponse, [place, desc, toFilter, filterString]);
			if (typeof r == &quot;string&quot;)
				displayMessage(r);
		}
		
	},

	// callback for loadRemoteFile 
	// params : [place, desc, toFilter, filterString]
	processResponse: function(status, params, responseText, url, xhr) { // feedURL, place, desc, toFilter, filterString) {	
		if (window.netscape){
			try {
				if (document.location.protocol.indexOf(&quot;http&quot;) == -1) {
					netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalBrowserRead&quot;);
				}
			}
			catch (e) { displayMessage(e.description?e.description:e.toString()); }
		}
		if (xhr.status == 404)
		 {
			displayMessage(config.macros.rssReader.noRSSFeed.format([url]));
			return;
		}
		if (!status)
		 {
			displayMessage(config.macros.rssReader.noRSSFeed.format([url]));
			return;
		}
		if (xhr.responseXML) {
			// response is interpreted as XML
			config.macros.rssReader.cache[url] = xhr.responseXML;
			config.macros.rssReader.displayRssFeed(xhr.responseXML, params[0], url, params[1], params[2], params[3]);
		}
		else {
			if (responseText.substr(0,5) == &quot;&lt;?xml&quot;) {
				// response exists but not return as XML -&gt; try to parse it 
				var dom = (new DOMParser()).parseFromString(responseText, &quot;text/xml&quot;); 
				if (dom) {
					// parsing successful so use it
					config.macros.rssReader.cache[url] = dom;
					config.macros.rssReader.displayRssFeed(dom, params[0], url, params[1], params[2], params[3]);
					return;
				}
			}
			// no XML display as html 
			wikify(&quot;&lt;html&gt;&quot; + responseText + &quot;&lt;/html&gt;&quot;, params[0]);
			displayMessage(config.macros.rssReader.msg.noRSSFeed.format([url]));
		}
	},

	// explore down the DOM tree
	displayRssFeed: function(xml, place, feedURL, desc, toFilter, filterString){
		// Channel
		var chanelNode = xml.getElementsByTagName('channel').item(0);
		var chanelTitleElement = (chanelNode ? chanelNode.getElementsByTagName('title').item(0) : null);
		var chanelTitle = &quot;&quot;;
		if ((chanelTitleElement) &amp;&amp; (chanelTitleElement.firstChild)) 
			chanelTitle = chanelTitleElement.firstChild.nodeValue;
		var chanelLinkElement = (chanelNode ? chanelNode.getElementsByTagName('link').item(0) : null);
		var chanelLink = &quot;&quot;;
		if (chanelLinkElement) 
			chanelLink = chanelLinkElement.firstChild.nodeValue;
		var titleTxt = &quot;!![[&quot;+chanelTitle+&quot;|&quot;+chanelLink+&quot;]]\n&quot;;
		var title = createTiddlyElement(place,&quot;div&quot;,null,&quot;ChanelTitle&quot;,null);
		wikify(titleTxt,title);
		// ItemList
		var itemList = xml.getElementsByTagName('item');
		var article = createTiddlyElement(place,&quot;ul&quot;,null,null,null);
		var lastDate;
		var re;
		if (toFilter) 
			re = new RegExp(filterString.escapeRegExp());
		for (var i=0; i&lt;itemList.length; i++){
			var titleElm = itemList[i].getElementsByTagName('title').item(0);
			var titleText = (titleElm ? titleElm.firstChild.nodeValue : '');
			if (toFilter &amp;&amp; ! titleText.match(re)) {
				continue;
			}
			var descText = '';
			descElem = itemList[i].getElementsByTagName('description').item(0);
			if (descElem){
				try{
					for (var ii=0; ii&lt;descElem.childNodes.length; ii++) {
						descText += descElem.childNodes[ii].nodeValue;
					}
				}
				catch(e){}
				descText = descText.replace(/&lt;br \/&gt;/g,'\n');
				if (desc == &quot;asHtml&quot;)
					descText = &quot;&lt;html&gt;&quot;+descText+&quot;&lt;/html&gt;&quot;;
			}
			var linkElm = itemList[i].getElementsByTagName(&quot;link&quot;).item(0);
			var linkURL = linkElm.firstChild.nodeValue;
			var pubElm = itemList[i].getElementsByTagName('pubDate').item(0);
			var pubDate;
			if (!pubElm) {
				pubElm = itemList[i].getElementsByTagName('date').item(0); // for del.icio.us
				if (pubElm) {
					pubDate = pubElm.firstChild.nodeValue;
					pubDate = this.formatDateString(this.dateFormat, pubDate);
					}
					else {
						pubDate = '0';
					}
				}
			else {
				pubDate = (pubElm ? pubElm.firstChild.nodeValue : 0);
				pubDate = this.formatDate(this.dateFormat, pubDate);
			}
			titleText = titleText.replace(/\[|\]/g,'');
			var rssText = '*'+'[[' + titleText + '|' + linkURL + ']]' + '' ;
			if ((desc != &quot;noDesc&quot;) &amp;&amp; descText){
				rssText = rssText.replace(/\n/g,' ');
				descText = '@@'+this.itemStyle+descText + '@@\n';				
				if (version.extensions.nestedSliders){
					descText = '+++[...]' + descText + '===';
				}
				rssText = rssText + descText;
			}
			var story;
			if ((lastDate != pubDate) &amp;&amp; ( pubDate != '0')) {
				story = createTiddlyElement(article,&quot;li&quot;,null,&quot;RSSItem&quot;,pubDate);
				lastDate = pubDate;
			}
			else {
				lastDate = pubDate;
			}
			story = createTiddlyElement(article,&quot;div&quot;,null,&quot;RSSItem&quot;,null);
			wikify(rssText,story);
		}
	},
	
	formatDate: function(template, date){
		var dateString = new Date(date);
		// template = template.replace(/hh|mm|ss/g,'');
		return dateString.formatString(template);
	},
	
	formatDateString: function(template, date){
		var dateString = new Date(date.substr(0,4), date.substr(5,2) - 1, date.substr(8,2)
			);
		return dateString.formatString(template);
	}
	
};

config.macros.rssFeedUpdate = {
	label: &quot;Update&quot;,
	prompt: &quot;Clear the cache and redisplay this RssFeed&quot;,
	handler: function(place,macroName,params) {
		var feedURL = params[0];
		var tiddlerTitle = params[1];
		createTiddlyButton(place, this.label, this.prompt, 
			function () {
				if (config.macros.rssReader.cache[feedURL]) {
					config.macros.rssReader.cache[feedURL] = null; 
			}
			story.refreshTiddler(tiddlerTitle,null, true);
		return false;});
	}
};

//}}}</pre>
</div>
<div title="RSSReaderPluginDescription" modifier="JohnRouillard" created="200704132145" modified="200909040246" tags="RSSReader Doc excludeMissing InstructorOnly">
<pre>This plugin provides a RSSReader for TiddlyWiki. If TiddlyWiki is viewed over HTTP, RSSReaderPlugin requires a ProxyService.

See examples : &lt;&lt;tag RSSFeed&gt;&gt;.
See documentation : RSSReaderPluginDoc

if NestedSlidersPlugin is available, item contents are folded. </pre>
</div>
<div title="RSSReaderPluginDoc" modifier="BidiX" created="200704132051" modified="200704220857" tags="Doc RSSReader excludeMissing">
<pre>//last update: RSSReaderPlugin v 1.1.1//

!Description
This plugin provides a RSSReader for TiddlyWiki
* It accesses asynchronously an RSSFeed
*Depending on the chanel item format, each item could be written as :
**simple text wikified
**html

!Usage
{{{
&lt;&lt;rssReader noDesc|asHtml|asText rssUrl ['filtering string']&gt;&gt;
	noDesc: only title of item is printed

	asHtml: if you know that description contain html (links, img ...), 
		the text is enclosed with &lt;html&gt; &lt;/html&gt; tags

 	asText: if the description should not be interpreted as html the 
		description is wikified

	rssUrl: the rssFeed url that could be accessed. 
	
	'filtering string': if present, the rssfeed item title must contained 
		this string to be displayed. 
		If 'filering string' contained space characters only, the tiddler 
		title is used for filtering.

}}}

For security reasons, if the TiddlyWiki is accessed from http, a ProxyService should be used to access an rssFeed from an other site.

!examples
| !reader | !RSSFeed type | !working from |
| BidiXTWRSS | Description asHtml | file: or tiddlywiki.bidix.info |
| [[Le Monde]] | Description asText | file: or tiddlywiki.bidix.info using proxy |
| YahooNewsSport | Description asHtml | file: or tiddlywiki.bidix.info using proxy |
| TiddlyWikiRSS | Description asHtml | file: or tiddlywiki.bidix.info using proxy |
| [[Libration]] | noDesc | file: or tiddlywiki.bidix.info using proxy |
| [[TestComment]] | asText and filters | file: or tiddlywiki.bidix.info using proxy |
see : &lt;&lt;tag RSSFeed&gt;&gt; for the full list.

!Revision history
* V1.1.0 (2207/04/13)
**No more import functions
* V1.0.0 (2006/11/11)
**refactoring using core loadRemoteFile function
**import using new tiddlywiki:tiddler element
**import and presentation preserved without EricShulman's NestedSliderPlugin
**better display of items 
* v0.3.0 (24/08/2006)
** Filter on RSS item title
** Place to display redefined for asynchronous processing
* v0.2.2 (22/08/2006)
**Haloscan feed has no pubDate.
* v0.2.1 (08/05/2006)
* v0.2.0 (01/05/2006)
**Small adapations for del.icio.us feed
* v0.1.1 (28/04/2006)
**Bug : Channel without title 
* v0.1.0 (24/04/2006)
** initial release</pre>
</div>
<div title="Random Factoid" modifier="YourName" created="200910120223" modified="201007112331" tags="InstructorOnly slide">
<pre>! Did you know:
&lt;&lt;wikify {{var items=store.getTiddlerText(&quot;Factoids&quot;,'').split(&quot;\n----\n&quot;); items[Math.floor(Math.random()*items.length)];}}&gt;&gt;</pre>
</div>
<div title="RandomContent" modifier="JohnRouillard" created="201007240050" modified="201007240104" tags="InstructorOnly Experiment">
<pre>insert content from random content tiddler:

&lt;&lt;tiddler {{tids=store.getMatchingTiddlers(&quot;content&quot;); tids[Math.floor(Math.random()*tids.length)].title;}}&gt;&gt;</pre>
</div>
<div title="RandomURL" modifier="JohnRouillard" created="200909050614" modified="200910250009" tags="InstructorOnly">
<pre>&lt;&lt;loadTiddlers &quot;label:Import new content from %0&quot; updates {{var items=store.getTiddlerText(&quot;AllUrls&quot;,'').split(&quot;\n----\n&quot;); items[Math.floor(Math.random()*items.length)];}}&gt;&gt;

See also AllUrls.
</pre>
</div>
<div title="ReadMe" modifier="JohnRouillard" created="200903281857" modified="201008081723" tags="InstructorOnly directions fixme">
<pre>{{sectionTOC{}}}

!The instructor tiddlywiki

This topic exists only in the instructor tiddlywiki. It is not exported to the student tw's.

! Creating Content

To create content, click on the new content link in the right hand column. It will start a new tiddler tagged with the word &quot;content&quot;. All of the content you create for the class must have the content tag otherwise it won't be published to the students. Also the content tiddlers are shown with  special view template that allows the students to record and view notes on a separate tiddler that is associated with the content tiddler.

In addition to content you can also tag tiddlers with the tag &quot;structure&quot;. These are also exported, but unlike the content tiddlers, thie structure tag is designed to tag things like style sheets or themes that are needed for the student tiddlywiki to operate as opposed to things
that the student will read.

To edit content, click on the edit link at the top right of the tiddler. Because it is a content tiddler, using double mouse click to edit the tiddler is disabled to prevent the students from accidentally editing the tiddler and it also makes using double click to select text work better for the student.

It is suggested that you group your content into chapters and list them in order in the ChapterList which is displayed in the MainMenu.
The tiddler macro can be used to display the tiddler content into a single readable chapter while still retaining multiple content tiddlers that are reusable.

Chapters can be created as single tiddlers and later split into multiple tiddlers based on section headings.
[[Splitting Chapters]]

! Creating Presentations

To create a presentation, start a new content tiddler then add links to tiddlers that contain the slide contents. Add:
{{{
   &lt;&lt;slideshow theme:InstructorSlideShowStyleSheet &gt;&gt;
}}}
and any other options you want to use (e.g. clock etc) as documented in SlideShowPluginDoc.

When this button/macro is clicked in the Instructor book, a slide show will start that allows keyboard navigation (using the space bar, arrow keys and pageup/down keys) as well as the navigation buttons and table of contents menu (obtained by clicking on the slide number in the lower right). Overlays are revealed as you move through the presentation and comments on the slides are not displayed.

When this button/macro is clicked on in the studentbook, the InstructorSlideShowStyleSheet will be missing (as it is tagged InstructorOnly) and the default theme defined by: SlideShowStyleSheet will provide a student view of the slide show as you present yours on the screen. This default theme displays all overlays and comments to the student so you can add additional reference material. Also there is a place for the students to record their notes as you progress through the presentation.

It is suggested that you list your presentations in order PresentationList which is displayed in the MainMenu.

!! Creating  a Slide

A slide tiddler is pretty much the same as a regular tiddler except that you can use overlays and other styling. See SlideShowPluginDoc for details on creating a slide tiddler.

Note that in student view mode, overlays and comments are displayed.

! Special Tags

As you saw above tiddler tags control what happens to the tiddlers.
&lt;part taglist&gt;
|sortable|k
|Tag  &lt;&lt;autosort&gt;&gt;           |Description         |h
|attachment  |A tiddler that has an attached file with the AttachFilePlugin. Because the data feed apparently doesn't work with IE, it is a good idea to also embed the file inside a [[preformatted block|FormattingCheatSheet##Preformatted Text]] to allow users to cut/paste it. |
|chapter        |A tiddler defining a chapter    |
|content       |A tiddler that is going to be published to the students and makes up the content of the coursebook.    |
|DeletedTiddler   |A marker for tiddlers that have been replaced. The tiddler marked DeletedTiddler is a place holder that overwrites the tidder with that name in the student's coursebook. They can later clean up the deleted tiddlers.  |
|directions    |A descriptive tiddler that has directions on using the tiddlywiki rather than content on the material being presented. |
|examples    |A descriptive tag for a tiddler that walks the student through an example. It can be used to gather all examples into an example TOC.  |
|excludeStory |Any tiddler that shows up in a story is opened when the story is displayed unless that tiddler is tagged with excludeStory.  This is used to prevent naviagation tiddlers, or links to other tiddlers in the chapter tiddlers that act as a table of contents/outline for a chapter from being displayed.  |
|fixme          |A descriptive tiddler indicating that something is incorrect in the tagged tiddler.                                                   |
|InstructorOnly  |Tiddler that has meaning only for the instructor ~TiddlyWiki (e.g. this tiddler). It is not published for the students.    |
|~KeepRevisions  |A tiddler tagged with this will have the old version saved when a change is made.    |
|nopublish    |This tiddler will not be published even if it has a content or structure tag. Use for tagging incomplete tiddlers that are in the process of being finished.   |
|noReload   |A tiddler tagged with noReload will not be overwritten by the LoadTiddlersPlugin. It is usually applied to notes to make sure that a publishing error that publishes notes won't replace the notes in a student's coursebook.  |
|Notes         |A tag used by the TiddlerNotesPlugin to identify tiddlers that should be shown as notes. Notes are never published from the instructor book.|
|PatchedPlugin  |A plugin tiddler that has been patched from the released version   |
|presentation     |A tiddler defining a presentation    |
|quiz            |A descriptive tag for finding quizzes in the document, it has no operational meaning, but could be used for a TOC of quizzes.  |
|Revisions     |An older version of a tiddler tagged with the ~KeepRevisions tag    |
|scripts        |A tag indicating that the tiddler is an inline script/program providing functionality to the coursebook.  |
|slide           |A descriptive tag for identifying all the tiddlers that are going to be displayed as slides using the SlideShowPlugin. It has no operational meaning but can be used to generate a TOC of all the slide tidders.  |
|spellchecked  |Marks the tiddler where spell checking was left off. Start from first tiddler in all tiddler listing.    |
|story                |A tiddler that contains links to other tiddlers and can be used to open all the linked tiddlers (in order) in the story column    |
|structure     |A tiddler that is going to be published to the student but provides things like style sheets or themes for use in the student book.   |
|temporary    |A tiddler tagged with this will not be saved. Useful for scratch tiddlers.       |
|TOC                 |A table of contents tiddler that lists all the chapters, quizzes or presentations.    |
&lt;/part&gt;

! Publishing for Students and others.
On the right hand side you will see a slider marked instructor. This has five items in it defined in the tiddler InstructorSidebarFunctions:

&lt;&lt;tiddler InstructorSidebarFunctions&gt;&gt;

The first link lets you change the title of the page. The page title shows up when printing from your browser and is intended to be used to allow a useful header on printouts. Clicking on the link displays a popup where you can type in your new title. Clicking cancel keeps the current title and typing {{{default}}} into the box will set the title to the default one for the tiddlywiki.

The second link allows you to configure the coursebook with different urls. For example you may want to run different courses off the same tiddlywiki (e.g. fall and spring semester or am and pm classes). This allows swapping the content of the GettingStarted tiddler that contains the key url's for the coursebook in hidden [[slices|Glossary/slice]].
FIXME consider removing this, or providing a pulldown/type box to enter the replacement tiddler.

The third link @@save studentbook@@ saves a copy of the studentbook that the students can download then then import the saved content to get a working studentbook. It does not export items tagged with InstructorOnly.

The fourth link @@save content@@ saves the content and structure tiddlers in a purestore format (without the tiddlywiki javascript code). The url in SiteUrl  should be changed to the location where this purestore file is published.

The fifth link @@save rss for content@@ generates an rss feed for content/structure tiddlers. The url for the rssReader macro in ContentChanges should be modified to point to the location where this file is published.

At some point there may be a link to save a blank instructor book. But for now you just have to manually [[export (using the backstage link|Using the Backstage Link]] all tiddlers not marked with content to get a blank instructor book.

! Important Tiddlers

*PatchedPlugin - a tiddler page that records which tiddlers have been patched. Going to that tiddler will also list all the plugins tagged with the PatchedPlugin tag.

! Plugins

There are a number of plugins used in this ~TiddlyWiki

!! Content Creation Plugins

This table documents useful plugins/macros for creating content.

|sortable|k
|&lt;&lt;autosort&gt;&gt; Plugin   | Docs                          | Feature                                                             |h
|AnnotationsPlugin   |in plugin topic     |adds a popup when rolling over a word or term  |
|AttachFilePlugin         |AttachFilePluginInfo  |Allows embedding supporting files in the tiddlywiki. May not work well with IE.  |
|FootnotesPlugin         |in plugin topic   |Creates numbered footnotes at the end of the tiddler. |
|NestedSlidersPlugin    |NestedSlidersPluginInfo   |Allows creation of folded content. PartTiddlerPlugin is useful with this as well. Can be useful to allow additional info to be recorded without overloading the user initially.   Also use for exercises. Have solution be a slider so it's exposed when the user want's to check the answers |
|PartTiddlerPlugin         |in plugin topic     |Allows using sections of a larger tiddler for annotations/popups and tiddler transclusion. Doesn't allow parts to be nested within each other however.   |
|QuizzerPlugin |QuizzerPluginDoc  |Allows creation of quizzes within tiddlers.  |
|SectionLinksPlugin|in plugin topic |Allows links to sections within another tiddler. Also allows use of {{{ {{sectionTOC{...}}} }}} to add a table of contents to a tiddler  |
|SlideShowPlugin         |SlideShowPluginDoc    |Mechanism for creating presentations                   |
|SparklinePlugin  |in plugin topic   |Allows simple area graphs inline with the text.  |
|StorySaverPlugin |StorySaverPluginInfo |Allows saving/displaying a set of tiddlers as a unit. Compose chapters from seperate tiddlers.  |
|TableSortingPlugin  |in plugin topic     |Allows dynamic sorting of tables       |


!! Functionality Plugins

This table documents useful plugins/macros that allow enhanced functionality of this ~TiddlyWiki.

|sortable|k
|Plugin &lt;&lt;autosort&gt;&gt;   | Docs                          | Feature                                                             |h
|FIXME |    |    |
|GotoPlugin   |GotoPluginInfo   |Provides the goto box to jump to a specific tiddler   |
|IntelliTaggerPlugin  |http://tiddlywiki.abego-software.de/doc/IntelliTagger.pdf  |Provides autocompletion of tags when editing them  |
|IntelliTagsEditCommandPlugin  |in plugin topic   |Provides edit mode for changing tags  |
|RedirectMacro    |in plugin topic      |Allows aliasing of words/terms to tiddlers without any special markup    |
|RSSReaderPlugin  |RSSReaderPluginDoc   |Provides an rss feed display for changes to the coursebook published by the author   |
|ShowPopup     |in plugin topic   |Display a tiddler as a popup. Good for reference panels.     |
|TemporaryTiddlersPlugin|in plugin topic  |Do not save any tiddlers tagged with {{{temporary}}}                               |
|TiddlerNotesPlugin      |in plugin topic              |Allows students to record notes into seperate tiddlers so content tiddlers can be updated at will without losing the student's notes.   |
|UnsavedChangesPlugin  |in plugin topic |Adds a menu item to the right sidebar when there are unsaved tiddlers.   |
|YourSearchPlugin       |[[YourSearch Help]]     |Enhanced searching capabilities.                         |

! Other tiddlers tagged with systemConfig

indicating they are actively modify operation of the TW.

CompareTiddlersPlugin
CopyTiddlerPlugin
CoreTweaksLocal
ExportTiddlersPlugin
FieldsEditorPlugin
FootnotesPlugin
ImagePathList
ImagePathPlugin
ImageSizePlugin
ImportTiddlersPlugin
InlineJavascriptPlugin
LoadTiddlersPlugin
MatchTagsPlugin
RefreshCommand
RevisionsPlugin
SaveAsPlugin
SectionLinksPlugin
SlideShowPlugin
SparklinePlugin
StorySaverPlugin
TableSortingPlugin
TaggedTemplateTweak
TemporaryTiddlersPlugin
TiddlerNotesPlugin
TiddlerTweakerPlugin
TiddlyLockPlugin
ToggleSideBarMacro
UnsavedChangesPlugin
YourSearchPlugin
zzLocalSettings

&lt;&lt;sectionTOC&gt;&gt;
</pre>
</div>
<div title="RedirectMacro" modifier="ClintChecketts" created="200601261332" modified="200609070401" tags="systemConfig Plugins excludeMissing">
<pre>/***
|Macro|redirect (alias)|
|Author|[[Clint Checketts]] and Paul Petterson|
|Version|1.1 Jan 26, 2006|
|Location|http://checkettsweb.com/styles/themes.htm#RedirectMacro|
|Description|This macro tells TW to find all instances of a word and makes it point to a different link. For example, whenever I put the word 'Clint' in a tiddler I want TiddlyWiki to turn it into a link that points to a tiddler titled 'Clint Checketts' Or the word 'TW' could point to a tiddler called 'TiddlyWiki' It even matches clint (which is lowercase) [[Clint]] leet lEEt LEET|
|Usage|{{{&lt;&lt;redirect TW TiddlyWiki&gt;&gt;}}} |
|Example|&lt;&lt;redirect TW &quot;TiddlyWiki&quot;&gt;&gt; &lt;&lt;redirect Clint &quot;Clint Checketts&quot;&gt;&gt; (Nothing should appear, its just setting it all up)&lt;&lt;redirectExact lEEt Elite&gt;&gt;|

!Revisions
1.1- Fixed tiddler refresh so a tiddler declaring a redirect will also render the redirect
1.0- Updated to work with TiddlyWiki 2.0 (thanks to Udo Borkowski)
0.9- Original release October 2005

!Code
***/
//{{{
version.extensions.redirectExact = {major: 1, minor: 2, revision: 0, date: new Date(2005,10,24)};
config.macros.redirectExact = {label: &quot;Pickles Rock!&quot;};
config.macros.redirectExact.handler = function(place,macroName,params,wikifier,paramString,tiddler){
 config.macros.redirect.handler(place,macroName,params,wikifier,paramString,tiddler);
}

version.extensions.redirect = {major: 1, minor: 2, revision: 0, date: new Date(2005,10,24)};
config.macros.redirect = {label: &quot;Pickles Rock!&quot;};

config.macros.redirect.handler = function(place,macroName,params,wikifier,paramString,tiddler){

var redirectExists = false
// Check to see if the wikifier exists
for (var i=0;i&lt;config.formatters.length;i++)
 if (config.formatters[i].name == &quot;redirect&quot;+params[0])
 redirectExists = true;

//If it doesn't exist, add it!
if (!redirectExists){
 for( var i=0; i&lt;config.formatters.length; i++ )
 if ( config.formatters[i].name=='wikiLink') break ;

 if ( i &gt;= config.formatters.length ) {
 var e = &quot;Can't find formatter for wikiLink!&quot; ;
 displayMessage( e ) ;
 throw( e ) ;
 }

var pattern;
 if (macroName == 'redirect'){pattern=params[0].escapeRegExp().replace(/([A-Z])/img, function($1) {return(&quot;[&quot;+$1.toUpperCase()+$1.toLowerCase()+&quot;]&quot;);});
 } else {
 pattern=params[0].escapeRegExp();
 }

 config.formatters.splice( i, 0, {
 name: &quot;redirect&quot;+params[0],
 match: &quot;(?:\\b)(?:\\[\\[)?&quot;+pattern+&quot;(?:\\]\\])?(?:\\b)&quot;,
 subst: params[1],
 handler: function(w) {
 var link = createTiddlyLink(w.output,this.subst,false);
 w.outputText(link,w.matchStart,w.nextMatch);
 }
 });
 formatter = new Formatter(config.formatters); //update the tiddler
 if(tiddler) story.refreshTiddler(tiddler.title,null,true); //refresh tiddler so the new rule is applied
} // End if
}
//}}}</pre>
</div>
<div title="Reference Appendix 1 - TiddlyWiki Page Layout" modifier="JohnRouillard" created="201008011900" modified="201008081840" tags="content">
<pre>[img[pageLayout.png]] @@fixme missing image pageLayout.png@@

The normal view of the tiddlywiki coursebook shown above (as opposed to presentation view, full screen view etc) of the coursebook TiddlyWiki consists of three columns topped by a title bar which displays the contents of SiteTitle and SiteSubtitle (and the [[backstage|Using the Backstage Link]] link). The three columns in left to right order are called:
# [[main menu|MainMenu]]
# story
# [[sidebar|SideBarOptions]]

!! The Main Menu column
In the left hand column, you have the MainMenu which provides links to:
;[[Welcome]]
:The welcome page displayed when the TiddlyWiki is first opened. In the instructor coursebook the ReadMe tiddler is also displayed by default. You can add more links by editing the MainMenu.
;ContentChanges
: This links to the embedded rss feed reader and allows the student to view changes that have occurred in the coursebook. The setting for the rss feed is controlled by the slices at the bottom of GetingStarted.
; [[Bookmarks|BookmarkList]] (open)
: Clicking on [[Bookmarks|BookmarkList]] in the MainMenu opens a popup display of the [[BookmarkList]] tiddler. This is a normal tiddler that can be edited using [[tiddlywiki markup|FormattingCheatSheet]]. All content tiddlers include a ''bookmark'' link in their toolbar. Clicking on that link will automatically add a link to the tidder to the Bookmark tiddler. This makes it easy for students to bookmark a tiddler and later rearrange the bookmark links. The @@(open)@@ link next to Bookmarks opens the Bookmarks tiddler in the story column to allow the student to edit the list of bookmarks.
;Toggle Right Bar 
:Clicking on this link makes the side bar on the right disappear/reappear. This allows more of the available display screen to be used for the story column.
&lt;&lt;tiddler [[TiddlyWiki Page Layout (Instructor)##mainMenu]]&gt;&gt;
Below these links is the ChapterList that provides access to the coursebook content in multiple ways. Use of this is discussed in [[Using the Main Menu]].

!! The Story Column
This column is where most of the work in a TiddlyWiki will occur. It has a list of open tiddlers (story table of contents or STOC, not to be confused with a table of contents within a tiddler) at the top of the story column and below that are all of the tiddlers that are open. In [[Working with Tiddlers]] the two modes (view and edit) of the tiddler is discussed as is how to generate new info, change tags, titles etc.

!! The Sidebar Column
This column has controls associated with administering the tiddlywiki. The links are:
;goto
:The box labeled goto allows you to type in the name of a tiddler and after three characters are entered (or return is pressed) it will display tiddlers whose title matches what you are typing. This is a fast way of jumping to a tiddler. Note that some browsers (Internet Explorer for example) don't display the tiddlers below the search box. Instead they display the matching box off to the right of the search box, so you have to scroll to see the matching tiddlers. See also [[Bugs And Feature Requests|Bugs And Feature Requests##GotoPlugin]].
;search
:&lt;&lt;tiddler [[Reference Appendix 1 - TiddlyWiki Page Layout##search]] /% this content moved to end because of advanced formatting requirements including lists %/
;close all
:closes all tiddlers in the story column except tiddlers in edit mode.
; permaview
:Changed the url of the current page to include all of the currently open tiddlers. This url can be bookmarked using the browser's bookmark function. When the bookmark is opened, the same tiddlers will be opened in the story column.
;new tiddler
: Start editing a new tiddler.
&lt;&lt;tiddler [[TiddlyWiki Page Layout (Instructor)##newTiddlers]] &gt;&gt;
These links relate to saving TiddlyWiki content
;There are 5 unsaved tiddlers...
: this link shows up *only* when there is modified content in the TiddlyWiki. It can be used to display the modified tiddlers in the story column or save the tiddlers in the same way that the @@save changes@@ link does.
;save changes
: this links saves the tiddlers manually. Usually you would use the link above, But this is a standard link for tiddlywikis, so it is being kept even though there is another mechanism. &lt;&lt;tiddler [[TiddlyWiki Page Layout (Instructor)##saveChanges]] &gt;&gt;
&lt;&lt;tiddler [[TiddlyWiki Page Layout (Instructor)##instructorMenu]] &gt;&gt;
The last set of links deals with customizing and finding out useful info in the tiddlywiki.
;options 
:The options submenu controls a number of features of TiddlyWiki as well as letting you change other options. These setting are stored in your browser, so they will change if you use a different browser or access the TiddlyWiki on a different computer.
; tabs for {{{Off Timeline All Tags More}}}
:&lt;&lt;tiddler [[Reference Appendix 1 - TiddlyWiki Page Layout##optionTabs]] &gt;&gt; /% content moved to hidden section below due to formatting requirements %/

/%
! Outline
uses the ChapterList
        Use anatomy picture pointing out:
            Header
                Site Title
                Site Subtitle
            MainMenu (left)
                actions
                Presentations
                Chapters
                Quizzes
            Story column (center)
                TOC
                tiddlers in view/edit mode
            Sidebar (right)
                Actions
                Tabset
!search
This is the YourSearchPlugin search box that allows you to search for words/phrases in:
* tiddler content
* just in titles (when the search term is started with a ! (think section header)
* just in tags (when the search term is started with a #)
so: {{{#slide &quot;link to&quot; !edit}}} typed into the box will display a list of tiddlers that are:
* tagged with slide (because of #slide)
* has the phrase &quot;link to&quot; in the content (phrases are surrounded by quotes)
* has the word edit in the title (because of !edit)
Full details on the syntax and capabilities of the search box can be found at [[YourSearch Help]].
!optionTabs
Rendering these tabs can slow down TiddlyWiki on page refreshes, so by default the {{{Off}}} tab is selected.. However there are some useful features to be found here.
;Timeline
: Provides a list of tiddlers that have been changed grouped by the date of change
; All
: lists all the tiddlers in the coursebook
; Tags
: Lists all the tags used in the coursebook/TiddlyWiki. Allows display of the tagged tiddlers
; More
: provides access to the following tabs&lt;part missingTab &gt;
;;Missing
:: tiddlers that are referenced but do not exist. Clicking on the missing tiddler opens it and the @@references@@ link in the expanded toolbar can be used to find the tiddlers that have references to the missing tiddler. This can be used to find obsolete references after changing a tiddler title. The tab sometimes lists tiddlers that exist because of the way it scans for links to tiddlers. These existing tiddlers show up in bold faced type and not italics.&lt;/part&gt;
;; Orphans
:: A list of tiddlers that are not linked to from other tiddlers.
;; Shadowed
:: A list of tiddlers where the default value for the tiddler has been overridden.
!end
%/</pre>
</div>
<div title="Reference Appendix 1 - Working with a TiddlyWiki" modifier="JohnRouillard" created="201008011819" modified="201008072018" tags="chapter content story">
<pre>[[Reference Appendix 1 - TiddlyWiki Page Layout]]
[[Working with Tiddlers]]
[[Using the Content Links in the Main Menu]]
[[Using the Backstage Link]]

</pre>
</div>
<div title="RefreshCommand" modifier="Simon" created="200601160255" modified="200607122217" tags="systemConfig Plugins excludeMissing">
<pre>/***
***/

//{{{

config.commands.refresh = {
 text: 'refresh',
 tooltip: 'Refresh this tiddler',
 handler: function(e,src,title) {
  clearMessage();
  story.refreshTiddler(title,false,true); // force=true
  return false;
 }
};

//}}}</pre>
</div>
<div title="RelatedTiddlersPlugin" modifier="ELSDesignStudios" created="200706292320" modified="200909300659" tags="DiscoveryPackage systemConfig InstructorOnly">
<pre>/***
|Name|RelatedTiddlersPlugin|
|Source|http://www.TiddlyTools.com/#RelatedTiddlersPlugin|
|Version|1.1.8|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Requires|InlineJavascriptPlugin, NestedSlidersPlugin, StyleSheetShortcuts|
|Description|starting from a selected tiddler, display a list and/or tree of linked or transcluded tiddlers|
!!!!!Usage
&lt;&lt;&lt;
Starting from a specified tiddler (default=current tiddler), {{{&lt;&lt;relatedTiddlers&gt;&gt;}}} recursively follows the internal links[] data to find all other tiddlers that are related to it by linking (e.g., {{{[[TiddlerName]]}}}) or used as macro parameter (e.g., {{{&lt;&lt;tiddler TiddlerName&gt;&gt;}}}).

The results can be displayed as a simple flat list of related tiddler titles, or as an indented tree diagram that shows the specific connections between the related tiddlers, and can be helpful for identifying clusters of interdependent tiddlers or simply generating an on-the-fly site map for quick discovery and navigation through complex or unfamiliar document content. 
//{{{
&lt;&lt;relatedTiddlers TiddlerName hideform &quot;exclude list&quot;&gt;&gt;
//}}}
*''TiddlerName'' (optional)&lt;br&gt;specifies the starting tiddler (and hides the 'select a tiddler' form controls).  Use keyword ''here'' to specify the current tiddler.
*''hideform'' (optional)&lt;br&gt;when present, suppress display of 'select tiddler' droplist and buttons.
*''&quot;exclude list&quot;'' (optional)&lt;br&gt;space-separated list of tiddlers whose links should not be followed.  Use quotes or double-square brackets to ensure list is processed as a single parameter.
The plugin also defines two functions that can be called externally (from other plugins or scripts) to generate and retrieve either a list of links or a formatted &quot;tree view&quot;:
&gt;{{{var list=config.macros.relatedTiddlers.getList(start,exclude,callback);}}}
&gt;{{{var tree=config.macros.relatedTiddlers.getTree(start,exclude,callback);}}}
where ''start'' and 'exclude'' are the same as the macro parameters described above, plus an optional reference to a callback function that allows you to generate an alternative list/tree, based on application-specific data (such tiddler references contained in tags or custom fields), rather than using the default &quot;links&quot; list, like this:
&gt;{{block{
{{{
window.myCallback=function(tiddler) {
	var list=[];
	// ... fill the list based on the specified tiddler ...
	return list;
}
}}}
}}}
The function takes a tiddler object as input, and returns a list of tiddler titles that are //directly// linked (or otherwise related) to that specific tiddler.  {{{getList()}}} and {{{getTree()}}} then use this information to find all the //indirect// connections between tiddlers to produce the list or tree output.
&lt;&lt;&lt;
!!!!!Configuration
&lt;&lt;&lt;
&lt;&lt;option chkRelatedTiddlersShowList&gt;&gt; show list display
&lt;&lt;option chkRelatedTiddlersShowTree&gt;&gt; show tree display
&lt;&lt;option chkRelatedTiddlersZoom&gt;&gt; enable autosizing of tree display //(aka, &quot;zoom&quot; or &quot;shrink-and-grow&quot;)//
don't follow links contained in these tiddlers: &lt;&lt;option txtRelatedTiddlersExclude&gt;&gt;
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
{{smallform{&lt;&lt;relatedTiddlers&gt;&gt;}}}

Using getList()/getTree() public API from other scripts/plugins:
&gt;&lt;script show&gt;
	var start=&quot;About&quot;;
	var exclude=config.options.txtRelatedTiddlersExclude.readBracketedList();
	var callback=null;
	var list=config.macros.relatedTiddlers.getList(start,exclude,callback);
	var tree=config.macros.relatedTiddlers.getTree(start,exclude,callback);
	return &quot;There are &quot;+list.length+&quot; tiddlers related to [[&quot;+start+&quot;]]...\n&quot;+tree;
&lt;/script&gt;
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.09.29 [1.1.8] in findRelatedTiddlers(), fixed recursion when using non-null callback
2007.11.11 [1.1.7] in findRelatedTiddlers(), refactored into separate getlinks(),&lt;br&gt;and added param for optional callback function that can be used to return an alternative set of links.&lt;br&gt;Also added API functions, getTree() and getList() for use by other scripts
2007.07.13 [1.1.6] performance optimizations, more code cleanup
2007.07.10 [1.1.5] extensive code cleanup
2007.07.08 [1.1.0] converted from inline script
2007.06.29 [1.0.0] started (as inline script)
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.RelatedTiddlersPlugin={major: 1, minor: 1, revision: 8, date: new Date(2009,9,29)};

// initialize 'autozoom' and 'exclude' tree options (defaults are not to zoom, and to follow all links)
if (config.options.chkRelatedTiddlersZoom===undefined)
	config.options.chkRelatedTiddlersZoom=false;
if (config.options.txtRelatedTiddlersExclude===undefined)
	config.options.txtRelatedTiddlersExclude='GettingStarted DefaultTiddlers';
if (config.options.chkRelatedTiddlersShowList===undefined)
	config.options.chkRelatedTiddlersShowList=true;
if (config.options.chkRelatedTiddlersShowTree===undefined)
	config.options.chkRelatedTiddlersShowTree=false;

config.macros.relatedTiddlers={
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {

		// create form with unique DOM element ID (using current timestamp)... permits multiple form instances
		var now=new Date().getTime();
		var span=createTiddlyElement(place,&quot;span&quot;);
		span.innerHTML=this.form.format([&quot;relatedTiddlers_form&quot;+now]);
		var form=span.getElementsByTagName(&quot;form&quot;)[0]; // find form that we just created
		var target=createTiddlyElement(span,&quot;div&quot;); // create target block in which generated output will be placed

		// initialize droplist contents (all tiddlers except hidden ones)
		var tids=store.getTiddlers('title','excludeLists');
		for (i=0; i&lt;tids.length; i++) form.list.options[form.list.options.length]=new Option(tids[i].title,tids[i].title,false,false);

		// initialize exclude field (space-separated list)
		if (config.options.txtRelatedTiddlersExclude) form.exclude.value=config.options.txtRelatedTiddlersExclude;

		// set starting tiddler, form display, and/or exclude list from macro params (if present) and then show the results!
		var root=&quot;&quot;;
		var hide=false;
		var exclude=config.options.txtRelatedTiddlersExclude;
		if (params[0]) root=params[0]; // TiddlerName
		if (params[1]) hide=(params[1].toLowerCase()==&quot;hideform&quot;); // keyword: &quot;hideform&quot; or &quot;showform&quot; (default)
		if (params[2]) exclude=params[2]; // list of tiddlers whose links should not be followed
		if (root==&quot;here&quot;) { var tid=story.findContainingTiddler(place); if (tid) root=tid.getAttribute(&quot;tiddler&quot;); }
		if (store.tiddlerExists(root)) {
			// NOTE:  don't hide form when running IE, where putting initial focus on hidden form creates an error
			if (!config.browser.isIE) form.style.display=hide?&quot;none&quot;:&quot;block&quot;; // show/hide the controls
			form.list.value=root; // set the root
			form.exclude.value=exclude; // set 'exclude' field
			form.get.click(); // DISPLAY INITIAL RESULTS (if tiddler is selected)
		}
	},
	form:
		&quot;&lt;form id='%0' action='javascript:;' style='display:inline;margin:0;padding:0;' onsubmit='return false'&gt;&lt;!-- \
		--&gt;&lt;span class='fine' style='float:left;vertical-align:bottom;width:39.5%;'&gt;&lt;i&gt;find all tiddlers related to:&lt;/i&gt;&lt;/span&gt;&lt;!-- \
		--&gt;&lt;span class='fine' style='float:left;vertical-align:bottom;'&gt;&lt;i&gt;exclude links contained in:&lt;/i&gt;&lt;/span&gt;&lt;!-- \
		--&gt;&lt;div style='clear:both'&gt;&lt;!-- \
		--&gt;&lt;select name=list size=1 style='width:39.5%' onchange='this.form.get.click()'&gt;&lt;!-- \
		--&gt;&lt;option value=''&gt;select a tiddler...&lt;/option&gt;&lt;!-- \
		--&gt;&lt;/select&gt;&lt;!-- \
		--&gt;&lt;input type='text' option='txtRelatedTiddlersExclude' name='exclude' value='' style='width:40%' \
			title='enter the names of tiddlers whose links should NOT be followed' \
			onkeyup='if (event.keyCode==13) { this.blur(); this.form.get.click(); }'  \
			onchange='config.options[this.getAttribute(\&quot;option\&quot;)]=this.value;saveOptionCookie(this.getAttribute(\&quot;option\&quot;));'&gt;&lt;!-- \
		--&gt;&lt;input type=button name=get value='get related' style='width:10%'  \
			onclick='config.macros.relatedTiddlers.show(this.form,this.form.nextSibling);'&gt;&lt;!-- \
		--&gt;&lt;input type=button name=done value='done' disabled style='width:10%'  \
			onclick='this.form.list.selectedIndex=0; this.form.get.click();'&gt;&lt;!-- \
		--&gt;&lt;/div&gt;&lt;!-- \
		--&gt;&lt;/form&gt;&quot;,
	styles:
		&quot;.relatedTiddlers blockquote \
			{ border-left:1px dotted #999; margin:0 25px; padding-left:.5em; font-size:%0%; line-height:115%; } \
		.relatedTiddlers .borderleft \
			{ margin:0; padding:0; margin-left:1em; border-left:1px dotted #999; padding-left:.5em; } \
		.relatedTiddlers .fourcolumns \
			{ display:block; -moz-column-count:4; -moz-column-gap:1em; -moz-column-width:25%} \
		.relatedTiddlers a \
			{ font-weight:normal; } \
		.relatedTiddlers .bold, .relatedTiddlers .bold a \
			{ font-weight:bold; } \
		.relatedTiddlers .floatright \
			{ float:right; } \
		.relatedTiddlers .clear \
			{ clear:both; }	&quot;,
	toggleform:
		&quot;{{floatright{&lt;html&gt;&lt;a href='javascript:;' class='button' title='show/hide tiddler selection droplist and buttons' \
		onclick='var here=story.findContainingTiddler(this); var tid=here?here.getAttribute(\&quot;tiddler\&quot;):\&quot;\&quot;; \
			var f=document.getElementById(\&quot;%0\&quot;); var hide=(f.style.display!=\&quot;none\&quot;); \
			f.style.display=hide?\&quot;none\&quot;:\&quot;inline\&quot;; this.innerHTML=hide?\&quot;show form\&quot;:\&quot;hide form\&quot;; return false;'&gt;%1&lt;/a&gt;&lt;/html&gt;}}}&quot;,
	treecheck:
		&quot;{{floatright{@@display:none;&lt;&lt;option chkRelatedTiddlersShowTree&gt;&gt;@@&lt;html&gt;&lt;a href='javascript:;' class='button' onclick='this.parentNode.previousSibling.firstChild.click(); return false;'&gt;tree view&lt;/a&gt;&lt;/html&gt;}}}&quot;,
	tree:
		&quot;{{clear{\n----\n}}} \
		{{floatright small{&lt;&lt;option chkRelatedTiddlersZoom&gt;&gt;autosize tree display}}} \
		{{fine{\n''tiddlers linked from or included by'' [[%0]]\n}}}%1&quot;,
	listcheck:
		&quot;{{floatright{@@display:none;&lt;&lt;option chkRelatedTiddlersShowList&gt;&gt;@@&lt;html&gt;&lt;a href='javascript:;' class='button' onclick='this.parentNode.previousSibling.firstChild.click(); return false;'&gt;list view&lt;/a&gt;&lt;/html&gt;}}}&quot;,
	list:
		&quot;{{clear{\n----\n}}} \
		{{fine{\n''tiddlers containing links to'' [[%0]]\n}}} \
		{{small fourcolumns borderleft{\n%1}}} \
		{{fine{\n''tiddlers linked from or included by'' [[%0]]\n}}} \
		{{borderleft{\n \
			{{fine{\n''bold''=//direct links//, plain=//indirect links//, ''...''=//links not followed//}}} \
			{{small fourcolumns{\n%2}}} \
		}}}&quot;,
	skipped:
		&quot;&lt;html&gt;&lt;span title='links from %0 have NOT been followed'&gt;...&lt;/span&gt;&lt;/html&gt;&quot;,
	mouseover: function(ev) {
		this.saveSize=this.style.fontSize;
		this.style.fontSize='100%';
		this.style.borderLeftStyle='solid';
	},
	mouseout: function(ev) {
		this.style.fontSize=this.saveSize;
		this.style.borderLeftStyle='dotted';
	},
	findRelatedTiddlers: function(tid,tids,treeout,level,exclude,callback) { 
		// recursively build list of related tids (links and includes FROM the root tiddler) and generate treeview output
		var t=store.getTiddler(tid);
		if (!t || tids.contains(tid)) return tids; // tiddler already in results (or missing tiddler)... just return current results
		tids.push(t.title); // add tiddler to results
		var skip=exclude &amp;&amp; exclude.contains(tid);
		treeout.text+=level+&quot;[[&quot;+tid+&quot;]]&quot;+(skip?this.skipped.format([tid]):&quot;&quot;)+&quot;\n&quot;;
		if (skip) return tids; // branch is pruned... don't follow links
		var links=callback?callback(t):this.getLinks(t);
		for (var i=0; i&lt;links.length; i++) tids=this.findRelatedTiddlers(links[i],tids,treeout,level+&quot;&gt;&quot;,exclude,callback);
		return tids;
	},
	getLinks: function(tiddler) {
		if (!tiddler.linksUpdated) tiddler.changed();
		return tiddler.links;
	},
	getTree: function(start,exclude,callback) {
		// get related tiddlers and generate blockquote-indented tree output
		var list=[]; var tree={text:&quot;&quot;}; var level=&quot;&quot;;
		list=this.findRelatedTiddlers(start,list,tree,level,exclude,callback);
		return tree.text;
	},
	getList: function(start,exclude,callback) {
		// get related tiddlers and generate blockquote-indented tree output
		var list=[]; var tree={text:&quot;&quot;}; var level=&quot;&quot;;
		list=this.findRelatedTiddlers(start,list,tree,level,exclude,callback);
		return list;
	},
	show: function(form,target) {
		removeChildren(target); form.done.disabled=true; // clear any existing output and disable 'done' button
		var start=form.list.value; if (!start.length) return; // get selected starting tiddler.  If blank value (heading), do nothing

		// get related tiddlers and generate blockquote-indented tree output
		var rels=[]; var treeview={text:&quot;&quot;}; var level=&quot;&quot;;
		var exclude=config.options.txtRelatedTiddlersExclude.readBracketedList();
		var rels=this.findRelatedTiddlers(start,rels,treeview,level,exclude);
		rels.shift(); // remove self from list
		rels.sort(); // sort titles alphabetically

		// generate list output
		var tid=store.getTiddler(start);
		var relsview=&quot;&quot;; for (t=0; t&lt;rels.length; t++) {
			relsview+=tid.links.contains(rels[t])?(&quot;{{bold{[[&quot;+rels[t]+&quot;]]}}}&quot;):(&quot;[[&quot;+rels[t]+&quot;]]&quot;);
			if (exclude &amp;&amp; exclude.contains(rels[t])) relsview+=this.skipped.format([rels[t]]);
			relsview+=&quot;\n&quot;;
		}
	
		// get references TO the root tiddler, add to related tiddlers and generate refsview output
		var refs=[]; var referers=store.getReferringTiddlers(start);
		for(var r=0; r&lt;referers.length; r++)
			if(referers[r].title!=start &amp;&amp; !referers[r].tags.contains(&quot;excludeLists&quot;)) refs.push(referers[r].title);
		var refcount=refs.length; var relcount=rels.length; // remember individual counts
		for (var r=0; r&lt;refs.length; r++) rels.pushUnique(refs[r]); // combine lists without duplicates
		var total=rels.length; // get combined total
		var refsview=&quot;[[&quot;+refs.sort().join(&quot;]]\n[[&quot;)+&quot;]]\n&quot;;
	
		// set custom blockquote styles for treeview
		setStylesheet(this.styles.format([config.options.chkRelatedTiddlersZoom?80:100]),'relatedTiddlers_styles');

		// assemble and render output
		var summary=(total?(total+&quot; tiddler&quot;+(total==1?&quot; is&quot;:&quot;s are&quot;)):&quot;There are no tiddlers&quot;)+&quot; related to: [[&quot;+start+&quot;]]&quot;;
		var list=this.list.format([start,refsview.length?refsview:&quot;//none//&quot;,relsview.length?relsview:&quot;//none//&quot;]);
		var tree=this.tree.format([start,treeview.text]);
		var toggle=this.toggleform.format([form.id,(form.style.display=='none'?'show form':'hide form')]);
		var sep=&quot;{{floatright{ | }}}&quot;;
		var showList=total &amp;&amp; config.options.chkRelatedTiddlersShowList;
		var showTree=relcount &amp;&amp; config.options.chkRelatedTiddlersShowTree;
		var out=&quot;{{relatedTiddlers{&quot;+toggle+(relcount?sep+this.treecheck:&quot;&quot;)+(total?sep+this.listcheck:&quot;&quot;)+summary+(showList?list:&quot;&quot;)+(showTree?tree:&quot;&quot;)+&quot;}}}&quot;;
		wikify(out,target);
		form.done.disabled=false; // enable 'done' button

		// add mouseover/mouseout handling to blockquotes (for autosizing)
		var blocks=target.getElementsByTagName(&quot;blockquote&quot;);
		for (var b=0; b&lt;blocks.length; b++)
			{ blocks[b].onmouseover=this.mouseover; blocks[b].onmouseout=this.mouseout; }

		// add side-effect to checkboxes so that display is refreshed when a checkbox state is changed
		var checks=target.getElementsByTagName(&quot;input&quot;);
		for (var c=0; c&lt;checks.length; c++) {
			if (checks[c].type.toLowerCase()!=&quot;checkbox&quot;) continue;
			checks[c].coreClick=checks[c].onclick; // save standard click handler
			checks[c].formID=form.id; // link checkbox with correponding form
			checks[c].onclick=function() { this.coreClick.apply(this,arguments); document.getElementById(this.formID).get.click(); }
		}
	}
}
//}}}</pre>
</div>
<div title="RescueStoreAreaCommand" modifier="YourName" created="200803312238" modified="201007120114" tags="script bookmarklet systemConfigDisable">
<pre>/%
|Name|RescueStoreAreaCommand|
|Source|http://www.TiddlyTools.com/#RescueStoreAreaCommand|
|Version|1.0.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|script bookmarklet|
|Requires|InlineJavascriptPlugin|
|Overrides||
|Description|rescue tiddler changes from online document when net goes down during editing|
%/&lt;script label=&quot;$1&quot; title=&quot;rescue tiddlers from current document storeArea&quot;&gt;
	if(typeof version==undefined||version.title!='TiddlyWiki')
		{alert(document.location.href+'\n\nis not a TiddlyWiki document');return false;}
	if (!confirm('Preparing to rescue storeArea contents... press OK to proceed')) return false;
	var sa=store.allTiddlersAsHtml().htmlEncode();
	var win=window.open();
	win.document.open();
	win.document['write']('&lt;html&gt;&lt;body&gt;&lt;pre&gt;'+sa+'&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;');
	win.document.close();
	alert('copy/paste the displayed storeArea content into a local text file');
	win.focus();
&lt;/script&gt;&lt;script&gt;
	if (&quot;$1&quot;==&quot;$&quot;+&quot;1&quot;) place.lastChild.innerHTML=&quot;Rescue current storeArea contents&quot;;
&lt;/script&gt;</pre>
</div>
<div title="Resources" modifier="JohnRouillard" created="200903220321" modified="201007182152" tags="content reference">
<pre>! ~TiddlyWiki resources

|tiddlywikiHomepage:|http://www.tiddlywiki.com  |
|tiddlywikiGoogleGroup:|http://groups.google.com/group/TiddlyWiki  |
|tiddlywikiMarkupCheatSheet:|http://tiddlywiki.org/wiki/TiddlyWiki_Markup  |

! Class resources

|classContent: | &lt;&lt;tiddler [[GettingStarted::courseHomeContent]]&gt;&gt; |
</pre>
</div>
<div title="RevisionsPlugin" modifier="WillyDelaCourt" created="200903270929" modified="200903270942" tags="systemConfig InstructorOnly excludeMissing">
<pre>/***
|Name|RevisionsPlugin|
|Source|http://www.linux-lovers.be/RevisionsPlugin/#RevisionsPlugin|
|Version|1.0.1|
|Author|Willy De la Court (willy [dot] delacourt [at] telenet [dot] be)|
|License|[[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.5|
|Type|plugin|
|Requires||
|Overrides|config.commands.saveTiddler|
|Description|Create revisions of a tiddler when changes are saved|
!!!Usage
&lt;&lt;&lt;
This plugin automatically updates the default (shadow) ToolbarCommands slice definitions to insert the ''revisions'' command.

When you select the ''revisions'' command, a drop down popup is shown with all the revisions of the current tiddler.

The plugin takes control of the ''saveTiddler'' command and check the tags of the current tiddler. If the current tiddler is taged with the &lt;&lt;tag KeepRevisions&gt;&gt; tag then the ''saveTiddler'' command automatically will create a new revision of the tiddler.

All revision tiddlers will be tagged with &lt;&lt;tag Revisions&gt;&gt;, &lt;&lt;tag excludeLists&gt;&gt; and &lt;&lt;tag excludeMissing&gt;&gt;.

Note: if you are already using customized toolbar definitions, you will need to manually add the ''revisions'' toolbar command to your existing ToolbarCommands tiddler, e.g.:
{{{
|EditToolbar|... revisions ... |
}}}
&lt;&lt;&lt;
!!!Revisions
&lt;&lt;&lt;
2009.03.27 [1.0.1] added some documentation
2009.03.23 [1.0.0] initial version
&lt;&lt;&lt;
!!!Code
***/
//{{{
version.extensions.RevisionsPlugin= {major: 1, minor: 0, revision: 0, date: new Date(2009,3,23)};

config.extensions.RevisionsPlugin = {};
config.extensions.RevisionsPlugin.core_saveTiddler_handler = config.commands.saveTiddler.handler;
merge(config.commands.saveTiddler,{
	zeroPad: 4,
	keepRevisonsTag: &quot;KeepRevisions&quot;,
	suffixText: &quot; Revision(%0)&quot;,
	newtags: [&quot;Revisions&quot;, &quot;excludeLists&quot;, &quot;excludeMissing&quot;],
	keepTags: false
	});

config.commands.saveTiddler.handler = function(event,src,title) {
	if(store.tiddlerExists(title) &amp;&amp; store.getTiddler(title).isTagged(this.keepRevisonsTag)) {
		// Not a new tiddler and tagged with keepRevisonsTag
		n = 1;
		var newTitle = title + this.suffixText.format([String.zeroPad(n, this.zeroPad)]);
		while (store.tiddlerExists(newTitle) || document.getElementById(story.idPrefix + newTitle)) {
			n++;
			newTitle = title + this.suffixText.format([String.zeroPad(n, this.zeroPad)]);
		}
		var text = store.getTiddlerText(title, '');
		var newtags = this.newtags;
		var newfields = {};
		var tid = store.getTiddler(title);
		if (tid) {
			if(this.keepTags)
				for (var t = 0; t &lt; tid.tags.length; t++) newtags.push(tid.tags[t]);
			store.forEachField(tid,
				function(t, f, v) {
					newfields[f] = v;
				},
			true);
		}
		store.saveTiddler(newTitle, newTitle, text, tid.modifier, tid.modified, newtags, newfields, false);
	}
	return config.extensions.RevisionsPlugin.core_saveTiddler_handler.apply(this,arguments);
}

config.commands.revisions = {
	type: &quot;popup&quot;,
	text: &quot;revisions&quot;,
	tooltip: &quot;Show revisions of this tiddler&quot;,
	shortSuffixText: &quot; Revision(&quot;
}

config.commands.revisions.handlePopup = function(popup,title) {
	var tiddlertitle = title;
	store.forEachTiddler(function(title,tiddler) {
		if(title.startsWith(tiddlertitle + config.commands.revisions.shortSuffixText))
			createTiddlyLink(createTiddlyElement(popup,&quot;li&quot;),title,true,null,false,null,true);
		});
};

config.shadowTiddlers.ToolbarCommands = config.shadowTiddlers.ToolbarCommands.replace(
	/jump/m,
	&quot;revisions jump&quot;);

//}}}</pre>
</div>
<div title="Sample Lunch Break Slide Show" modifier="JohnRouillard" created="200910120223" modified="201007182128" tags="InstructorOnly story fixme excludeOrphans presentation">
<pre>&lt;&lt;slideShow  theme:InstructorSlideShowStyleSheet2 toc:titles noClicks footer:&quot;copyright&amp;copy; 2010&lt;br /&gt;John Rouillard&quot; clock:-60 label:&quot;Start cycling show&quot; auto:15 cycle tooltip:&quot;Start slideshow in instructor projection mode&quot;'&gt;&gt;

This tiddler is to be displayed during a class lunch break. It auto-advances each slide after a 30 second interval and loops back to the beginning. It also display a 1 hour countdown timer that indicates when the class will resume.

[[Random Factoid]]

FIXME: need a style file that makes the title of this tiddler be large and centered so it shows prominently on each slide.
The slide titles for the default instructor theme are fine.</pre>
</div>
<div title="SaveAsPlugin" modifier="ELSDesignStudios" created="200602030909" modified="200910132031" tags="systemConfig ImportExportPackage excludeMissing InstructorOnly">
<pre>/***
|Name|SaveAsPlugin|
|Source|http://www.TiddlyTools.com/#SaveAsPlugin|
|Documentation|http://www.TiddlyTools.com/#SaveAsPluginInfo|
|Version|2.7.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Description|Save current document to another path/filename|
!!!!!Documentation
&lt;&lt;&lt;
see [[SaveAsPluginInfo]]
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.10.13 2.7.0 added 'here' param (saves current tiddler)
2009.08.16 2.6.2 fixed handling for backstage
| Please see [[SaveAsPluginInfo]] for additional revision details |
2006.02.03 1.0.0 Created
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.SaveAsPlugin= {major: 2, minor: 7, revision: 0, date: new Date(2009,10,13)};

config.macros.saveAs = {
	label: 'save as...',
	labelparam: 'label:',
	prompt: 'Save current document to a different path/file',
	promptparam: 'prompt:',
	filePrompt: 'Please select or enter a target path/filename',
	targetparam: 'target:',
	defaultFilename: 'new.html',
	filenameparam: 'filename:',
	currfilekeyword: 'here',
	typeparam: 'type:',
	type_TW: 'tw', type_PS: 'ps', type_TX: 'tx', type_CS: 'cs', type_NF: 'nf', // file type tokens
	type_map: {
		tiddlywiki:'tw', tw:'tw', wiki: 'tw',
		purestore: 'ps', ps:'ps', store:'ps',
		plaintext: 'tx', tx:'tx', text: 'tx',
		comma:     'cs', cs:'cs', csv:  'cs',
		newsfeed:  'nf', nf:'nf', xml:  'nf', rss:'nf'
	},
	limitparam: 'limit:',
	replaceparam: 'replace',
	mergeparam: 'merge',
	quietparam: 'quiet',
	openparam: 'open',
	askParam: 'ask',
	hereParam: 'here',
	askMsg: &quot;Enter a tag filter (use * for all tiddlers, 'none' for blank document)&quot;,
	hereMsg: 'Enter a tiddler title',
	emptyParam: 'none',
	confirmmsg: &quot;Found %0 tiddlers matching\n\n'%1'\n\nPress OK to proceed&quot;,
	mergeprompt: '%0\nalready contains tiddler definitions.\n'
		+'\nPress OK to add new/revised tiddlers to current file contents.'
		+'\nPress Cancel to completely replace file contents',
	mergestatus: 'Merged %0 new/revised tiddlers and %1 existing tiddlers',
	okmsg: '%0 tiddlers written to %1',
	failmsg: 'An error occurred while creating %1',
	filter: '',
	handler: function(place,macroName,params) {
		if ((params[0]||'').startsWith(this.labelparam))
			var label=params.shift().substr(this.labelparam.length);
		if ((params[0]||'').startsWith(this.promptparam))
			var prompt=params.shift().substr(this.promptparam.length);
		if ((params[0]||'').startsWith(this.targetparam))
			var target=params.shift().substr(this.targetparam.length);
		if ((params[0]||'').startsWith(this.filenameparam))
			var filename=params.shift().substr(this.filenameparam.length);
		if ((params[0]||'').startsWith(this.typeparam))
			var filetype=this.type_map[params.shift().substr(this.typeparam.length).toLowerCase()];
		if ((params[0]||'').startsWith(this.limitparam))
			var limit=params.shift().substr(this.limitparam.length);
		var q=((params[0]||'')==this.quietparam);   if (q) params.shift();
		var o=((params[0]||'')==this.replaceparam); if (o) params.shift();
		var m=((params[0]||'')==this.mergeparam);   if (m) params.shift();
		var a=((params[0]||'')==this.openparam);    if (a) params.shift();
		var btn=createTiddlyButton(place,label||this.label,prompt||this.prompt,
			function(){ config.macros.saveAs.go( this.getAttribute('target'),
				this.getAttribute('filename'), this.getAttribute('filetype'),
				this.getAttribute('filter'), this.getAttribute('limit'),
				this.getAttribute('quiet')=='true',
				this.getAttribute('overwrite')=='true',
				this.getAttribute('merge')=='true',
				this.getAttribute('autoopen')=='true',
				this);
				return false;
			});
		if (target) btn.setAttribute('target',target);
		if (filename) btn.setAttribute('filename',filename);
		btn.setAttribute('filetype',filetype||this.type_TW);
		btn.setAttribute('filter',params.join(' '));
		btn.setAttribute('limit',limit||0);
		btn.setAttribute('quiet',q?'true':'false');
		btn.setAttribute('overwrite',o?'true':'false');
		btn.setAttribute('merge',m?'true':'false');
		btn.setAttribute('autoopen',a?'true':'false');
	},
	go: function(target,filename,filetype,filter,limit,quiet,overwrite,merge,autoopen,here) {
		var cm=config.messages; // abbreviation
		var cms=config.macros.saveAs; // abbreviation
		if (window.location.protocol!='file:') // make sure we are local
			{ displayMessage(cm.notFileUrlError); return; }

		// get tidders, confirm filtered results
		var tids=cms.selectTiddlers(filter,here);
		if (tids===false) return; // cancelled by user
		if (cms.filter!=cms.emptyParam &amp;&amp; cms.filter.length &amp;&amp; !quiet)
			if (!confirm(cms.confirmmsg.format([tids.length,cms.filter]))) return;

		// get target path/filename
		if (!filetype) filetype=this.type_TW;
		target=target||cms.getTarget(filename,filetype==this.type_TX?'txt':filetype==this.type_CS?'csv':'html');
		if (!target) return; // cancelled by user

		var link='file:///'+target.replace(/\\/g,'/');
		var samefile=link==decodeURIComponent(window.location.href);
		var p=getLocalPath(document.location.href);
		if (samefile) {
			if (config.options.chkSaveBackups)
				{ var t=loadOriginal(p);if(t)saveBackup(p,t); }
			if (config.options.chkGenerateAnRssFeed &amp;&amp; saveRss instanceof Function)
				saveRss(p);
		}
		var notes='';
		var total={val:0};
		var out=this.assembleFile(target,filetype,tids,limit||0,notes,quiet,overwrite,merge,total);
		var ok=saveFile(target,out);
		if (ok &amp;&amp; autoopen) {
			if (!samefile) window.open(link).focus();
			else { store.setDirty(false); window.location.reload(); }
		}
		if (!quiet || !(ok &amp;&amp; autoopen))
			displayMessage((ok?this.okmsg:this.failmsg).format([total.val,target]),link);
	},
	selectTiddlers: function(filter,here) {
		var cms=config.macros.saveAs; // abbreviation
		var tids=[]; cms.filter=filter||'';
		if (filter==cms.emptyParam)
			return tids;
		if (filter==config.macros.saveAs.hereParam) {
			var here=story.findContainingTiddler(here);
			if (here) var tid=here.getAttribute('tiddler');
			else var tid=prompt(config.macros.saveAs.hereMsg,'');
			while (tid &amp;&amp; !store.tiddlerExists(tid)) {
				var err='&quot;'+tid+'&quot; not found.\nPlease try again.\n\n';
				var tid=prompt(err+config.macros.saveAs.hereMsg,tid);
			}
			if (!tid) return false;  // cancelled by user
			return [store.getTiddler(tid)];
		}
		if (filter==config.macros.saveAs.askParam) {
			filter=prompt(config.macros.saveAs.askMsg,'');
			if (!filter) return false;  // cancelled by user
			cms.filter=filter=='*'?'':filter;
		}
		if (!filter||!filter.length||filter=='*') tids=store.getTiddlers('title');
		else tids=store.filterTiddlers('[tag['+filter+']]');
		return tids;
	},
	getTarget: function(defName,defExt) {
		var cms=config.macros.saveAs; // abbreviation
		// get new target path/filename
		var newPath=getLocalPath(window.location.href);
		var slashpos=newPath.lastIndexOf('/'); if (slashpos==-1) slashpos=newPath.lastIndexOf('\\'); 
		if (slashpos!=-1) newPath=newPath.substr(0,slashpos+1); // trim filename
		if (!defName||!defName.length) { // use current filename as default
			var p=getLocalPath(window.location.href);
			var s=p.lastIndexOf('/'); if (s==-1) s=p.lastIndexOf('\\'); 
			if (s!=-1) defName=p.substr(s+1);
		}
		var defFilename=(defName||cms.defaultFilename).replace(/.html$/,'.'+defExt);
		var target=cms.askForFilename(cms.filePrompt,newPath,defFilename,defExt);
		if (!target) return; // cancelled by user
		// if specified file does not include a path, assemble fully qualified path and filename
		var slashpos=target.lastIndexOf('/'); if (slashpos==-1) slashpos=target.lastIndexOf('\\');
		if (slashpos==-1) target=target+(defName||cms.defaultFilename).replace(/.html$/,'.'+defExt);
		return target;
	},
	askForFilename: function(msg,path,file,defExt) {
		if(window.Components) { // moz
			try {
				netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
				var nsIFilePicker = window.Components.interfaces.nsIFilePicker;
				var picker = Components.classes['@mozilla.org/filepicker;1'].createInstance(nsIFilePicker);
				picker.init(window, msg, nsIFilePicker.modeSave);
				var thispath = Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);
				thispath.initWithPath(path);
				picker.displayDirectory=thispath;
				picker.defaultExtension=defExt||'html';
				picker.defaultString=file;
				picker.appendFilters(nsIFilePicker.filterAll|nsIFilePicker.filterText|nsIFilePicker.filterHTML);
				if (picker.show()!=nsIFilePicker.returnCancel) var result=picker.file.persistentDescriptor;
			}
			catch(e) { alert('error during local file access: '+e.toString()) }
		}
		else { // IE
			try { // XP/Vista only
				var s = new ActiveXObject('UserAccounts.CommonDialog');
				s.Filter='All files|*.*|Text files|*.txt|HTML files|*.htm;*.html|';
				s.FilterIndex=(defExt=='txt')?2:3; // default to HTML files;
				s.InitialDir=path;
				s.FileName=file;
				if (s.showOpen()) var result=s.FileName;
			}
			catch(e) { var result=prompt(msg,path+file); } // fallback for non-XP IE
		}
		return result;
	},
	plainTextHeader:
		 'Source:\n\t%0\n'
		+'Title:\n\t%1\n'
		+'Subtitle:\n\t%2\n'
		+'Created:\n\t%3 by %4\n'
		+'Application:\n\tTiddlyWiki %5 / %6 %7\n\n',
	plainTextTiddler:
		'- - - - - - - - - - - - - - -\n'
		+'|     title: %0\n'
		+'|   created: %1\n'
		+'|  modified: %2\n'
		+'| edited by: %3\n'
		+'|      tags: %4\n'
		+'- - - - - - - - - - - - - - -\n'
		+'%5\n',
	plainTextFooter:
		'',
	newsFeedHeader:
		 '&lt;'+'?xml version=&quot;1.0&quot;?'+'&gt;\n'
		+'&lt;rss version=&quot;2.0&quot;&gt;\n'
		+'&lt;channel&gt;\n'
		+'&lt;title&gt;%1&lt;/title&gt;\n'
		+'&lt;link&gt;%0&lt;/link&gt;\n'
		+'&lt;description&gt;%2&lt;/description&gt;\n'
		+'&lt;language&gt;en-us&lt;/language&gt;\n'
		+'&lt;copyright&gt;Copyright '+(new Date().getFullYear())+' %4&lt;/copyright&gt;\n'
		+'&lt;pubDate&gt;%3&lt;/pubDate&gt;\n'
		+'&lt;lastBuildDate&gt;%3&lt;/lastBuildDate&gt;\n'
		+'&lt;docs&gt;http://blogs.law.harvard.edu/tech/rss&lt;/docs&gt;\n'
		+'&lt;generator&gt;TiddlyWiki %5 / %6 %7&lt;/generator&gt;\n',
	newsFeedTiddler:
		'\n%0\n',
	newsFeedFooter:
		'&lt;/channel&gt;&lt;/rss&gt;',
	pureStoreHeader:
		 '&lt;html&gt;&lt;body&gt;'
		+'&lt;style type=&quot;text/css&quot;&gt;'
		+'	#storeArea {display:block;margin:1em;}'
		+'	#storeArea div {padding:0.5em;margin:1em;border:2px solid black;height:10em;overflow:auto;}'
		+'	#pureStoreHeading {width:100%;text-align:left;background-color:#eeeeee;padding:1em;}'
		+'&lt;/style&gt;'
		+'&lt;div id=&quot;pureStoreHeading&quot;&gt;'
		+'	TiddlyWiki &quot;PureStore&quot; export file&lt;br&gt;'
		+'	Source'+': &lt;b&gt;%0&lt;/b&gt;&lt;br&gt;'
		+'	Title: &lt;b&gt;%1&lt;/b&gt;&lt;br&gt;'
		+'	Subtitle: &lt;b&gt;%2&lt;/b&gt;&lt;br&gt;'
		+'	Created: &lt;b&gt;%3&lt;/b&gt; by &lt;b&gt;%4&lt;/b&gt;&lt;br&gt;'
		+'	TiddlyWiki %5 / %6 %7&lt;br&gt;'
		+'	Notes:&lt;hr&gt;&lt;pre&gt;%8&lt;/pre&gt;'
		+'&lt;/div&gt;'
		+'&lt;div id=&quot;storeArea&quot;&gt;',
	pureStoreTiddler:
		'%0\n%1',
	pureStoreFooter:
		'&lt;/div&gt;&lt;!--POST-BODY-START--&gt;\n&lt;!--POST-BODY-END--&gt;&lt;/body&gt;&lt;/html&gt;',
	assembleFile: function(target,filetype,tids,limit,notes,quiet,overwrite,merge,total) {
		var revised='';
		var now = new Date().toLocaleString();
		var src=convertUnicodeToUTF8(document.location.href);
		var title = convertUnicodeToUTF8(wikifyPlain('SiteTitle').htmlEncode());
		var subtitle = convertUnicodeToUTF8(wikifyPlain('SiteSubtitle').htmlEncode());
		var user = convertUnicodeToUTF8(config.options.txtUserName.htmlEncode());
		var twver = version.major+'.'+version.minor+'.'+version.revision;
		var v=version.extensions.SaveAsPlugin; var pver = v.major+'.'+v.minor+'.'+v.revision;
		var headerargs=[src,title,subtitle,now,user,twver,'SaveAsPlugin',pver,notes];
		switch (filetype) {
			case this.type_TX: // plain text
				var header=this.plainTextHeader.format(headerargs);
				var footer=this.plainTextFooter;
				break;
			case this.type_CS: // comma-separated
				var fields={};
				for (var i=0; i&lt;tids.length; i++) for (var f in tids[i].fields) fields[f]=f;
				var names=['title','created','modified','modifier','tags','text'];
				for (var f in fields) names.push(f);
				var header=names.join(',')+'\n';
				var footer='';
				break;
			case this.type_NF: // news feed (XML)
				headerargs[0]=store.getTiddlerText('SiteUrl','');
				var header=this.newsFeedHeader.format(headerargs);
				var footer=this.newsFeedFooter;
				tids=store.sortTiddlers(tids,'-modified');
				break;
			case this.type_PS: // PureStore (no code)
				var header=this.pureStoreHeader.format(headerargs);
				var footer=this.pureStoreFooter;
				break;
			case this.type_TW: // full TiddlyWiki
			default:
				var currPath=getLocalPath(window.location.href);
				var original=loadFile(currPath);
				if (!original) { alert(config.messages.cantSaveError); return; }
				var posDiv = locateStoreArea(original);
				if (!posDiv) { alert(config.messages.invalidFileError.format([currPath])); return; }
				var header = original.substr(0,posDiv[0]+startSaveArea.length)+'\n';
				var footer = '\n'+original.substr(posDiv[1]);
				break;
		}
		if (parseInt(limit)!=0) tids=tids.slice(0,limit);
		var out=this.getData(target,filetype,tids,quiet,overwrite,merge,fields);
		var revised = header+convertUnicodeToUTF8(out.join('\n'))+footer;
		// if full TW, insert page title and language attr, and reset MARKUP blocks as needed...
		if (filetype==this.type_TW) {
			var newSiteTitle=convertUnicodeToUTF8(getPageTitle()).htmlEncode();
			revised=revised.replaceChunk('&lt;title'+'&gt;','&lt;/title'+'&gt;',' ' + newSiteTitle + ' ');
			revised=updateLanguageAttribute(revised);
			var titles=[]; for (var i=0; i&lt;tids.length; i++) titles.push(tids[i].title);
			revised=updateMarkupBlock(revised,'PRE-HEAD',
				titles.contains('MarkupPreHead')? 'MarkupPreHead' :null);
			revised=updateMarkupBlock(revised,'POST-HEAD',
				titles.contains('MarkupPostHead')?'MarkupPostHead':null);
			revised=updateMarkupBlock(revised,'PRE-BODY',
				titles.contains('MarkupPreBody')? 'MarkupPreBody' :null);
			revised=updateMarkupBlock(revised,'POST-SCRIPT',
				titles.contains('MarkupPostBody')?'MarkupPostBody':null);
		}
		total.val=out.length;
		return revised;
	},
	getData: function(target,filetype,tids,quiet,overwrite,merge,fields) {
		// output selected tiddlers and gather list of titles (for use with merge)
		var out=[]; var titles=[];
		var url=store.getTiddlerText('SiteUrl','');
		for (var i=0; i&lt;tids.length; i++) {
			out.push(this.formatItem(store,filetype,tids[i],url,fields));
			titles.push(tids[i].title);
		}
		// if TW or PureStore format, ask to merge with existing tiddlers (if any)
		if (filetype==this.type_TW || filetype==this.type_PS) {
			if (overwrite) return out; // skip merge... forced overwrite
			var txt=loadFile(target);
			if (txt &amp;&amp; txt.length) {
				var remoteStore=new TiddlyWiki();
				if (version.major+version.minor*.1+version.revision*.01&lt;2.52) txt=convertUTF8ToUnicode(txt);
				if (remoteStore.importTiddlyWiki(txt) &amp;&amp; (merge||confirm(this.mergeprompt.format([target])))) {
					var existing=remoteStore.getTiddlers('title');
					for (var i=0; i&lt;existing.length; i++)
						if (!titles.contains(existing[i].title))
							out.push(this.formatItem(remoteStore,filetype,existing[i],url));
					if (!quiet) displayMessage(this.mergestatus.format([tids.length,out.length-tids.length]));
				}
			}
		}
		return out;
	},
	formatItem: function(s,f,t,u,fields) {
		if (f==this.type_TW)
			var r=s.getSaver().externalizeTiddler(s,t);
		if (f==this.type_PS)
			var r=this.pureStoreTiddler.format([t.title,s.getSaver().externalizeTiddler(s,t)]);
		if (f==this.type_NF)
			var r=this.newsFeedTiddler.format([t.saveToRss(u)]);
		if (f==this.type_TX)
			var r=this.plainTextTiddler.format([t.title, t.created.toLocaleString(), t.modified.toLocaleString(),
				t.modifier, String.encodeTiddlyLinkList(t.tags), t.text]);
		if (f==this.type_CS) {
			function toCSV(t) { return '&quot;'+t.replace(/&quot;/g,'&quot;&quot;')+'&quot;'; } // always encode CSV
			var out=[ toCSV(t.title), toCSV(t.created.toLocaleString()), toCSV(t.modified.toLocaleString()),
				toCSV(t.modifier), toCSV(String.encodeTiddlyLinkList(t.tags)), toCSV(t.text) ];
			for (var f in fields) out.push(toCSV(t.fields[f]||''));
			var r=out.join(',');
		}
		return r||'';
	}
};
//}}}
//{{{
// automatically add saveAs to backstage
config.tasks.saveAs = {
	text: 'saveAs',
	tooltip: config.macros.saveAs.prompt,
	action: function(){ clearMessage(); config.macros.saveAs.go(); }
}
config.backstageTasks.splice(config.backstageTasks.indexOf('save')+1,0,'saveAs');
//}}}</pre>
</div>
<div title="SaveAsPluginInfo" modifier="ELSDesignStudios" created="200801090109" modified="200910132029" tags="pluginInfo ImportExportPackage excludeMissing InstructorOnly">
<pre>|Name|SaveAsPluginInfo|
|Source|http://www.TiddlyTools.com/#SaveAsPlugin|
|Documentation|http://www.TiddlyTools.com/#SaveAsPluginInfo|
|Version|2.7.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|documentation|
|Description|Documentation for SaveAsPlugin|
&gt;//Note: This plugin replaces ''[[NewDocumentPlugin]]'' (except for the HTML+CSS &quot;snapshot&quot; features, which are now provided by [[SnapshotPlugin]].//
!!!!!Usage
&lt;&lt;&lt;
This plugin automatically adds a 'save as' command to the TiddlyWiki 'backstage' menu so you can quickly create an exact copy of the current TiddlyWiki document.  The plugin also defines a macro that you can use to place a &quot;save as...&quot; command link into your sidebar/mainmenu/any tiddler (or wherever you like).  When the command link is clicked, a system-specific dialog box will be displayed so you can select/enter the desired target path and filename.
{{{
&lt;&lt;saveAs &quot;label:...&quot; &quot;prompt:...&quot; &quot;filename:...&quot; &quot;type:...&quot; &quot;limit:...&quot;
	quiet replace merge open filter|ask|here|none&gt;&gt;
}}}
//(all parameters are optional)//
*''label:...''&lt;br&gt;custom link text (instead of &quot;save as...&quot;)
*''prompt:...''&lt;br&gt;custom tooltip text
*''filename:...''&lt;br&gt;default filename to be shown when asking for an output path/file
*''type:...''&lt;br&gt;a keyword, indicating one of the following output file formats:
**''~TiddlyWiki''&lt;br&gt;(or ''wiki'' or ''tw'') a TiddlyWiki HTML document 
**''~PureStore''&lt;br&gt;(or ''store'' or ''ps'') a TiddlyWiki &quot;PureStore&quot; HTML export file (just tiddlers, no core code)
**''~PlainText''&lt;br&gt;(or ''text'' or ''tx'') a plain text file listing of tiddler //source// content
**''Comma''&lt;br&gt;(or ''csv'' or ''cs'') a Comma-Separated Value (CSV) database/spreadsheet file
**''~NewsFeed''&lt;br&gt;(or ''xml'' or ''rss'' or ''nf'') an RSS ~NewsFeed XML file
*''limit:...''&lt;br&gt;output is limited to the specified number of tiddlers
*''quiet''&lt;br&gt;normally, when using filtering (see below), the number of matching tiddlers is reported and you are asked to confirm before saving those tiddlers to a new file.  Use the ''quiet'' keyword to suppress this confirmation step.
*''replace''&lt;br&gt;overwrites existing output file, if any, without confirmation.
*''merge''&lt;br&gt;merges with existing output file, if any, without confirmation.
*''open''&lt;br&gt;opens the newly created document file in a separate browser tab/window.
*''filter''&lt;br&gt;selects a subset of tiddlers to be written into the new document.  If omitted, all tiddlers in the document are written to the new file.  ''filter'' can either:
**a tag value&lt;br&gt;selects only tiddlers that are tagged with that value.  To select tiddlers based on a combination of tags, you can install [[MatchTagsPlugin]] to construct complex 'tag expressions' using full 'boolean' logic with AND, OR, and NOT operators, as well as nested parentheses.
**''ask''&lt;br&gt;prompts you to enter a tag (or tag expression) whenever you click on the 'save as...' command
**''here''&lt;br&gt;selects the current tiddler (if any).  If the command is not embedded within a tiddler, you will be prompted to enter a tiddler title.
**''none''&lt;br&gt;omits all tiddlers and creates a new //empty// document
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
save all tiddlers:
&gt;{{{&lt;&lt;saveAs&gt;&gt;}}}&lt;br&gt;try it: &lt;&lt;saveAs&gt;&gt;
save only tiddlers matching a single tag:
&gt;{{{&lt;&lt;saveAs &quot;label:create Import/Export starter&quot; &quot;filename:TW+ImportExport.html&quot; ImportExportPackage&gt;&gt;}}}
&gt;try it: &lt;&lt;saveAs &quot;label:create Import/Export starter&quot; &quot;filename:TW+ImportExport.html&quot; &quot;ImportExportPackage&gt;&gt;
save to a ~PureStore format:
&gt;{{{&lt;&lt;saveAs &quot;label:create Import/Export archive&quot; &quot;filename:ImportExportPackage.html&quot; type:PureStore open ImportExportPackage&gt;&gt;}}}
&gt;try it: &lt;&lt;saveAs &quot;label:create Import/Export archive&quot; &quot;filename:ImportExportPackage.html&quot; type:PureStore open ImportExportPackage&gt;&gt;
save to a ~PlainText format:
&gt;{{{&lt;&lt;saveAs &quot;label:create Import/Export source listing&quot; type:PlainText open ImportExportPackage&gt;&gt;}}}
&gt;try it: &lt;&lt;saveAs &quot;label:create Import/Export source listing&quot; type:PlainText open ImportExportPackage&gt;&gt;
save tiddlers matching a complex combination of tags (requires [[MatchTagsPlugin]]):
&gt;{{{&lt;&lt;saveAs (alpha or settings) and not systemConfig&gt;&gt;}}}
&gt;try it: &lt;&lt;saveAs (alpha or settings) and not systemConfig&gt;&gt;
prompt for tag or tag expression each time:
&gt;{{{&lt;&lt;saveAs &quot;label:custom save as...&quot; ask&gt;&gt;}}}
&gt;try it: &lt;&lt;saveAs &quot;label:custom save as...&quot; ask&gt;&gt;
save this tiddler:
&gt;{{{&lt;&lt;saveAs &quot;label:save this tiddler...&quot; {{&quot;filename:&quot;+tiddler.title}} quiet here&gt;&gt;}}}
&gt;try it: &lt;&lt;saveAs &quot;label:save this tiddler...&quot; {{&quot;filename:&quot;+tiddler.title}} quiet here&gt;&gt;
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.10.13 2.7.0 added 'here' param (saves current tiddler)
2009.08.16 2.6.2 fixed handling for backstage
2009.08.04 2.6.1 fixed handling when limit is omitted.
2009.08.03 2.6.0 added 'limit:nn' parameter.
2009.08.02 2.5.3 in getData(), if type=RSS, sort by modified (most recent first).
2009.07.03 2.5.2 TW252 fixup: don't call convertUTF8ToUnicode() for local loadFile() I/O
2009.04.30 2.5.1 custom fields in CSV output.
2009.04.19 2.5.0 added CSV format.
2008.09.29 2.4.3 in getData(), convert UTF8 to Unicode before merging (fixes international characters).
2008.09.28 2.4.2 in go(), fixed typo that prevented backstage SaveAs from working.
2008.09.24 2.4.1 if rewriting *current* file and chkSaveBackups and/or chkGenerateAnRssFeed is enabled, then write a backup file or RSS feed, respectively
2008.09.24 2.4.0 when 'open' param is used and file is saved to current location, reload() page instead of opening a new tab/window.  Added 'filename' param to specify default filename.  Added 'replace' and 'merge' keyword params to control file handling without asking user.  Improved use of 'quiet' flag to eliminate more unwanted messages
2008.09.19 2.3.2 fixed backstage SaveAs command (was defaulting to empty document).  in formatItem(), removed unnecessary convertUnicodeToUTF8() (was causing double-conversion!)
2008.09.16 2.3.1 fixed IE 'navigate away' error by returning false from button onclick handler
2008.09.11 2.3.0 added support for alternative file formats: ~PlainText (TX), ~PureStore (PS), or ~NewsFeed (XML) in addition to existing ~TiddlyWiki (TW) document format
2008.09.06 2.2.1 corrected handling of autoopen attribute so it only applies when &quot;open&quot; param is specified
2008.08.01 2.2.0 added &quot;open&quot; param to auto-open newly saved document
2008.07.20 2.1.3 added &quot;quiet&quot; param to bypass confirmation when using tag filter
2008.04.22 2.1.2 corrected use of getTarget() to check for &quot;user cancelled&quot;
2008.04.22 2.1.1 documentation fixes
2008.04.22 2.1.0 added support for tag filtering to completely replace [[NewDocumentPlugin]] (now retired)
2008.04.12 2.0.1 automatically add &quot;saveAs&quot; to backstage commands
2008.04.12 2.0.0 initial release based on [[NewDocumentPlugin]]

__Previous revisions from [[NewDocumentPlugin]]__
2008.04.20 1.8.0 added support for 'noCSS' and 'viewer' params for alternative snapshot output
2008.01.08 [*.*.*] plugin size reduction: documentation moved to ...Info tiddler
2007.12.04 [*.*.*] update for ~TW2.3.0: replaced deprecated core functions, regexps, and macros
2007.03.30 1.7.0 added support for &quot;print&quot; param as alternative for &quot;snap&quot;.  When &quot;print&quot; is used, the filename is ignored and ouput is directed to another browser tab/window, where the print dialog is then automatically triggered
2007.03.30 1.6.1 added support for &quot;here&quot; keyword for current tiddler elementID and &quot;prompt:text&quot; param for specifying tooltip text
2007.02.12 1.6.0 in onClickNewDocument(), reset HTML source 'markup'
2006.10.23 1.5.1 in onClickNewDocument(), get saved parameter value for snapID instead of using default &quot;contentWrapper&quot; (oops!)
2006.10.18 1.5.0 new optional param for 'snap'... specify alternative DOM element ID (default is still &quot;contentWrapper&quot;)
2006.08.03 1.4.3 in promptForFilename(), for IE (~WinXP only), added handling for ~UserAccounts.~CommonDialog
2006.07.29 1.4.2 in onClickNewDocument(), okmsg display is now linked to newly created file
2006.07.24 1.4.1 in promptForFilename(), check for nsIFilePicker.returnCancel to allow nsIFilePicker.returnOK **OR** nsIFilePicker.returnReplace to be processed
2006.05.23 1.4.0 due to very poor performance, support for tag *expressions* has been removed, in favor of a simpler &quot;containsAny()&quot; scan for tags
2006.04.09 1.3.6 in onClickNewDocument, added call to convertUnicodeToUTF8() to better handle international characters
2006.03.15 1.3.5 added nsIFilePicker() handler for selecting filename in moz-based browsers.  IE and other non-moz browsers still use simple prompt() dialog
2006.03.15 1.3.0 added &quot;label:text&quot; param for custom link text.  added special &quot;all&quot; filter parameter for &quot;save as...&quot; handling (writes all tiddlers to output file)
2006.03.09 1.2.0 added special &quot;snap&quot; filter parameter to generate and write &quot;snapshot&quot; files containing static HTML+CSS for currently rendered document
2006.02.24 1.1.2 Fix incompatiblity with TW 2.0.5 by removing custom definition of getLocalPath() (which is now part of TW core)
2006.02.03 1.1.1 concatentate 'extra' params so that tag expressions don't have to be quoted.   moved all text to 'formatted' string definitions for easier translation.
2006.02.03 1.1.0 added support for tag EXPRESSIONS.  plus improved documentation and code cleanup
2006.02.03 1.0.0 Created
&lt;&lt;&lt;</pre>
</div>
<div title="SaveToClipboard" modifier="YourName" created="201002252345" modified="201007120049" tags="structure transclusion bookmarklet">
<pre>/%
!info
|Name|SaveToClipboard|
|Source|http://www.TiddlyTools.com/#SaveToClipboard|
|Version|1.3.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|transclusion, bookmarklet|
|Description|save current document to clipboard|
|Browsers|FireFox, IE, Safari, Chrome, Opera (fallback)|
Usage
&lt;&lt;&lt;
{{{
&lt;&lt;tiddler SaveToClipboard&gt;&gt;
&lt;&lt;tiddler SaveToClipboard with: label&gt;&gt;
}}}
Some browsers lack direct file I/O functions and/or do not currently support use of the [[tiddlysaver.jar|http://www.tiddlywiki.com/#TiddlySaver]] Java extension, preventing use of the normal &lt;&lt;saveChanges&gt;&gt; command to update the stored document.  As a workaround, the &lt;&lt;tiddler SaveToClipboard##show with: &quot;save to clipboard&quot;&gt;&gt; command ''copies the source for the current document, including all tiddler changes, directly to the system clipboard'', so you can paste the clipboard contents into a new, empty file (using a text editor), save it to your local filesystem with an '.html' extension, and then open it in your browser to continue working locally.  

To construct the new file content, the previously saved file is first read in, and then merged with the current set of tiddlers (including all new/revised content).  If the saved file is not available (e.g., it was renamed/deleted after it was opened, or it is stored on a remote server that is not currently accessible), only the TiddlyWiki 'storeArea' is output to the clipboard (i.e., TiddlyWiki &quot;~PureStore&quot; format).  Tiddlers saved in PureStore-formatted files can be imported into an empty TiddlyWiki document using the ''backstage&gt;import'' feature (or TiddlyTools' [[ImportTiddlersPlugin|http://www.TiddlyTools.com#ImportTiddlersPlugin]]).  You can [[obtain an empty TiddlyWiki document from http://www.TiddlyWiki.com|http://www.TiddlyWiki.com/empty.html]].

Note: some browsers do not permit program-controlled access to the system clipboard.  In this case, the clipboard output is instead ''displayed as plain text in a new browser tab/window'', so you can manually select and copy that text to the clipboard before pasting it to a new, empty file as described above.
&lt;&lt;&lt;
Example
&lt;&lt;&lt;
{{{&lt;&lt;tiddler SaveToClipboard with: &quot;save to clipboard&quot;&gt;&gt;}}}
&lt;&lt;tiddler SaveToClipboard##show with: &quot;save to clipboard&quot;&gt;&gt;
^^Note: drag this command link to your browser toolbar to create an [[InstantBookmarklet|InstantBookmarklets]]^^
&lt;&lt;&lt;
&lt;&lt;tiddler SaveToClipboard##code with: {{store.getTiddlerText('SaveToClipboard##show')}}&gt;&gt;
!end
!code
Code
&lt;&lt;&lt;
{{{
$1
}}}
&lt;&lt;&lt;
!end
!show
&lt;html&gt;&lt;nowiki&gt;&lt;a href=&quot;javascript:;&quot; title=&quot;save current document to clipboard&quot;
onmouseover=&quot;
	this.href='javascript:void(eval(decodeURIComponent(%22(function(){try{('
	+encodeURIComponent(encodeURIComponent(this.onclick))
	+')()}catch(e){alert(e.description?e.description:e.toString())}})()%22)))';&quot;
onclick=&quot;
	if(typeof version==undefined||version.title!='TiddlyWiki')
		{alert(document.location.href+'\n\nis not a TiddlyWiki document');return false;}

	window.saveToClipboard=function(success,params,txt,url,xhr) {
		function copy(out) {
			if(window.Components) { // FIREFOX
				netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
				var id='@mozilla.org/widget/clipboardhelper;1';
				var clip=Components.classes[id].getService(Components.interfaces.nsIClipboardHelper);
				clip.copyString(out);
			} else if(window.clipboardData) { // IE
				window.clipboardData.setData('text',out);
			} else if(document.execCommand) { // CHROME, SAFARI, IE6
				var ta=document.createElement('textarea');
				ta.style.position='absolute';
				ta.style.left='-100%';
				document.body.appendChild(ta);
				ta.value=out; ta.select();
				document.execCommand('Copy',false,null);
				document.body.removeChild(ta);
			} else throw('cannot access clipboard');
		}
		var pos=locateStoreArea(txt||'');
		if(success&amp;&amp;pos) {
			displayMessage(txt.length+' bytes read, adding new/revised tiddlers...');
			var out=updateOriginal(txt,pos,url);
		} else {
			if (!confirm('cannot load source file.\ncopy tiddler \x22store area\x22 only?')) return;
			var pre='&lt;!--POST-SHADOWAREA--&gt;\n&lt;div id=\x22storeArea\x22&gt;\n';
			var post='&lt;/div&gt;/n&lt;!--POST-STOREAREA--&gt;\n';
			var out=pre+store.allTiddlersAsHtml()+post;
		}
		var msg=out.length+' bytes copied to ';
		try	 { copy(out); msg+='clipboard'; }
		catch(e) { // FALLBACK
			alert('Sorry, direct clipboard access is not currently available.\n\n'
				+'The output will be displayed in another browser tab/window.\n'
				+'Select the entire text there and copy/paste into a local file');
			var t='&lt;html&gt;&lt;body&gt;&lt;pre&gt;'+out.htmlEncode()+'&lt;/pre&gt;&lt;/body&gt;&lt;/'+'html&gt;';
			var w=window.open(); var d=w.document; d.open(); d.write(t); d.close();
			msg+='another tab/window';
		}
		displayMessage(msg);
	}
	var url=document.location.href;
	clearMessage(); displayMessage('loading TiddlyWiki code from'); displayMessage(url);
	if (document.location.protocol!='file:') loadRemoteFile(url, window.saveToClipboard);
	else window.saveToClipboard(true,null,loadOriginal(getLocalPath(url)),url,null);
 	return false;
&quot;&gt;$1&lt;/a&gt;&lt;/html&gt;
!end
%/&lt;&lt;tiddler {{var src='SaveToClipboard'; src+(tiddler&amp;&amp;tiddler.title==src?'##info':'##show')}}
	with: {{'$1'!='$'+'1'?'$1':'[+] - copy entire document to clipboard'}}&gt;&gt;</pre>
</div>
<div title="SectionLinksPlugin" modifier="ELSDesignStudios" created="200901061840" modified="200908230244" tags="systemConfig excludeMissing">
<pre>/***
|Name|SectionLinksPlugin|
|Source|http://www.TiddlyTools.com/#SectionLinksPlugin|
|Documentation|http://www.TiddlyTools.com/#SectionLinksPlugin|
|Version|1.3.4|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides||
|Description|allow tiddler sections in TiddlyLinks to be used as anchor points|
This plugin enhances the processing of section references so they can be used in links to auto-scroll to the indicated heading within a tiddler (i.e., similar to the 'anchor' behavior provided in HTML by {{{&lt;a name=&quot;foo&quot;&gt;}}} and {{{&lt;a href=&quot;#foo&quot;&gt;...&lt;/a&gt;}}})
!!!Usage
&lt;&lt;&lt;
!!!!!{{{&lt;&lt;tiddler&gt;&gt;}}} macro 
&gt;The {{{&lt;&lt;tiddler SomeTiddler##SomeSection&gt;&gt;}}} syntax has been extended so that when the tiddler title is omitted or the 'here' keyword is used (e.g., {{{&lt;&lt;tiddler ##SomeSection&gt;&gt;}}} or {{{&lt;&lt;tiddler here##SomeSection&gt;&gt;}}}), then the current containing tiddler is implied by default.
!!!!!~TiddlyLink syntax
&gt;the standard link syntax has been extended so that a section name can included in a tiddler link (e.g., {{{[[SomeTiddler##SomeSection]]}}}).  When clicked, the tiddler is displayed and the specified section heading will be automatically scrolled into view. If the tiddler title is omitted or the 'here' keyword is used (e.g., {{{[[##SomeSection]]}}} or {{{[[here##SomeSection]]&gt;&gt;}}}), then the current containing tiddler is implied by default.
!!!!!&quot;&quot;&quot;&lt;&lt;sectionTOC&gt;&gt;&quot;&quot;&quot; macro
&gt;This macro generates a 'Table of Contents'-style numbered-bullet list with links to all sections within the current tiddler.  Simply place the following macro at the //end of the tiddler content// (i.e., following all section headings):
{{{
&lt;&lt;sectionTOC&gt;&gt; or &lt;&lt;sectionTOC className&gt;&gt;
}}}
&gt;Note: The macro must occur at the end of the tiddler in order to locate the rendered section headings that precede it. In addition, to position the macro's //output// within the tiddler, you must create a special 'target element' that uses a specified classname (default='sectionTOC'), like this:
{{{
{{sectionTOC{}}}
}}}
&gt;When the {{{&lt;&lt;sectionTOC&gt;&gt;}}} macro is rendered, it will find the matching 'sectionTOC'-classed element and writes it's output there.  You can also add the macro and/or target elements directly to the [[ViewTemplate]] definition, so that every tiddler can automatically display the table of contents:
{{{
&lt;span class='sectionTOC'&gt;&lt;/span&gt; &lt;!-- target element --&gt;
...
&lt;span macro='sectionTOC'&gt;&lt;/span&gt; &lt;!-- must be at end of tiddler --&gt;
}}}
&lt;&lt;&lt;
!!!Revisions
&lt;&lt;&lt;
2009.08.21 [1.3.4] added handling to ignore leading/trailing whitespace in section references
2009.08.21 [1.3.3] in createTiddlyLink(), add tiddlyLinkNonExistingSection class if matching section is not found
2009.08.14 [1.3.2] in createTiddlyLink(), don't override core value for ~TiddlyLink attribute
2009.08.02 [1.3.1] in sectionTOC.handler(), trim leading/trailing whitespace from generated section links
2009.08.01 [1.3.0] in scrollToSection(), apply 3-tier section matching (exact, startsWith, contains)
2009.07.06 [1.2.2] fixed displayTiddler() hijack
2009.07.03 [1.2.1] in {{{&lt;&lt;sectionTOC&gt;&gt;}}}, suppress output if target is not found
2009.06.02 [1.2.0] added support for 'here' keyword in {{{[[here##section]]}}} links and {{{&lt;&lt;tiddler here##section&gt;&gt;}}} macro
2009.04.09 [1.1.1] in sectionTOC macro, make target visible when TOC is rendered.
2009.01.18 [1.1.0] added {{{&lt;&lt;sectionTOC&gt;&gt;}}} macro to generate numbered-bullet links to sections of current tiddler
2009.01.06 [1.0.0] converted to stand-alone plugin
2008.10.14 [0.0.0] initial release (as [[CoreTweaks]] #784 - http://trac.tiddlywiki.org/ticket/784)
&lt;&lt;&lt;
!!!Code
***/
//{{{
version.extensions.SectionLinksPlugin= {major: 1, minor: 3, revision: 4, date: new Date(2009,8,21)};

Story.prototype.scrollToSection = function(title,section) {
	if (!title||!section) return; var t=this.getTiddler(title); if (!t) return null;
	var elems=t.getElementsByTagName('*'); var heads=[];
	for (var i=0; i&lt;elems.length; i++)
		if (['H1','H2','H3','H4','H5'].contains(elems[i].nodeName)) heads.push(elems[i]);
	for (var i=0; i&lt;heads.length; i++)
		if (getPlainText(heads[i]).trim()==section) break;
	if (i==heads.length) for (var i=0; i&lt;heads.length; i++)
		if (getPlainText(heads[i]).trim().startsWith(section)) break;
	if (i==heads.length) for (var i=0; i&lt;heads.length; i++)
		if (getPlainText(heads[i]).trim().indexOf(section)!=-1) break;
	if (i&lt;heads.length) { var h=heads[i];
		// if section heading is collapsed, click to expand it - see [[FoldHeadingsPlugin]]
		if (hasClass(h,'foldable') &amp;&amp; h.nextSibling.style.display=='none') h.onclick();
		// scroll *after* tiddler animation
		var delay=config.options.chkAnimate?config.animDuration+100:0;
		setTimeout('window.scrollTo('+findPosX(h)+','+findPosY(h)+')',delay);
		return h;
	}
}
//}}}
/***
!!!!core hijacks
***/
/***
!!!!!createTiddlyLink
***/
//{{{
// [[tiddlername##section]] and [[##section]]
if (!window.createTiddlyLink_section)
	window.createTiddlyLink_section=window.createTiddlyLink;
window.createTiddlyLink=function(place,title) {
	var t=story.findContainingTiddler(place); var tid=t?t.getAttribute('tiddler'):'';
	var parts=title.split(config.textPrimitives.sectionSeparator);
	var title=parts[0]; var section=parts[1]; if (section) section=section.trim();
	if (!title.length || title.toLowerCase()=='here') title=tid;  // default=current tiddler
	arguments[1]=title;
	var btn=createTiddlyLink_section.apply(this,arguments);
	if (section) {
		btn.setAttribute('section',section);
		if (store.getTiddlerText(title+config.textPrimitives.sectionSeparator+section)===null)
			addClass(btn,'tiddlyLinkNonExistingSection');
	}
	return btn;
}
//}}}
/***
!!!!!onClickTiddlerLink
***/
//{{{
if (!window.onClickTiddlerLink_section)
	window.onClickTiddlerLink_section=window.onClickTiddlerLink;
window.onClickTiddlerLink=function(ev) {
	var e=ev||window.event;	var target=resolveTarget(e); var title=null;
	while (target!=null &amp;&amp; title==null) {
		title=target.getAttribute('tiddlyLink');
		section=target.getAttribute('section');
		target=target.parentNode;
	} 
	var t=story.findContainingTiddler(target); var tid=t?t.getAttribute('tiddler'):'';
	if (title!=tid||!section) // avoid excess scrolling for intra-tiddler links
		onClickTiddlerLink_section.apply(this,arguments);
	story.scrollToSection(title,section);
	return false;
}
//}}}
/***
!!!!! displayTiddler
***/
//{{{
if (!Story.prototype.displayTiddler_section)
	Story.prototype.displayTiddler_section=Story.prototype.displayTiddler;
Story.prototype.displayTiddler = function(srcElement,tiddler)
{
	var title=(tiddler instanceof Tiddler)?tiddler.title:tiddler;
	var parts=title.split(config.textPrimitives.sectionSeparator);
	var title=parts[0]; var section=parts[1]; if (section) section=section.trim();
	if (!title.length || title.toLowerCase()=='here') {
		var t=story.findContainingTiddler(place);
		title=t?t.getAttribute('tiddler'):'';
	}
	arguments[1]=title;  // default=current tiddler
	this.displayTiddler_section.apply(this,arguments);
	story.scrollToSection(title,section);
}
//}}}
/***
!!!!!isExternalLink
***/
//{{{
if (!config.formatterHelpers.isExternalLink_section)
	config.formatterHelpers.isExternalLink_section=config.formatterHelpers.isExternalLink;
config.formatterHelpers.isExternalLink=function(link) {
	if (link.indexOf(config.textPrimitives.sectionSeparator)!=-1) return false;
	return config.formatterHelpers.isExternalLink_section.apply(this,arguments);
}
//}}}
/***
!!!!!tiddler.handler
***/
//{{{
if (!config.macros.tiddler.handler_section)
	config.macros.tiddler.handler_section=config.macros.tiddler.handler;
config.macros.tiddler.handler=function(place,macroName,params,wikifier,paramString,tiddler)
{
	if (!params[0]) return;
	var sep=config.textPrimitives.sectionSeparator;
	var parts=params[0].split(sep); var tid=parts[0]; var sec=parts[1]; if (sec) sec=sec.trim();
	if ((tid.toLowerCase()=='here'||!tid.length) &amp;&amp; sec) { // fixup for 'here##section' and '##section'
		var here=story.findContainingTiddler(place)
		var tid=here?here.getAttribute('tiddler'):tiddler?tiddler.title:'';
		arguments[2][0]=tid+sep+sec;
		arguments[4]=paramString.replace(new RegExp('(here)?'+sep+sec),tid+sep+sec);
	}
	config.macros.tiddler.handler_section.apply(this,arguments);
}
//}}}
/***
!!!!sectionTOC macro
***/
//{{{
config.macros.sectionTOC = {
	targetClass: 'sectionTOC',
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		var out=[];
		var targetClass=params[0]||this.targetClass;
		var t=story.findContainingTiddler(place); if (!t) return;
		var elems=t.getElementsByTagName('*');
		var level=5; // topmost heading level
		for (var i=0; i&lt;elems.length; i++) {
			var txt=getPlainText(elems[i]).trim();
			var link='[['+txt+'|##'+txt+']]';
			switch(elems[i].nodeName) {
				case 'H1': out.push('#'+link);		level=1; break;
				case 'H2': out.push('##'+link);		level=level&lt;2?level:2; break;
				case 'H3': out.push('###'+link);	level=level&lt;3?level:3; break;
				case 'H4': out.push('####'+link);	level=level&lt;4?level:4; break;
				case 'H5': out.push('#####'+link);	level=level&lt;5?level:5; break;
				default: if (hasClass(elems[i],targetClass)) var target=elems[i];
			}
		}
		// trim excess bullet levels
		if (level&gt;1) for (var i=0; i&lt;out.length; i++) out[i]=out[i].substr(level-1);
		// show numbered list
		if (out.length &amp;&amp; target) {
			if (target.style.display=='none') target.style.display='block';
			wikify(out.join('\n'),target);
		}
	}
}
//}}}
/***
!!!Invoke macro
{{{
&lt;&lt;sectionTOC&gt;&gt;
}}}
***/
// //&lt;&lt;sectionTOC&gt;&gt;</pre>
</div>
<div title="ShamelessPlug" modifier="YourName" created="200908260147" modified="201007120222" tags="structure systemConfig excludeOrphans systemConfigDisable">
<pre>/***
! Notify the user that this is a partial coursebook and tell them how to get the full coursebook

If they find this and say 'magic words', they may get a full course book anyway as part of an e a s t e r   e g g   h u n t.
***/
//{{{
config.views.wikified.defaultText=&quot;The tiddler '%0' is not included in this coursebook sample. To receive the full coursebook, you can sign up for the S2 tutorial on Sunday November 1 at LISA 2009: http://www.usenix.org/events/lisa09/registration/&quot;; 
config.messages.undefinedTiddlerToolTip=&quot;Click to get information on getting the missing '%0' tiddler&quot;;
//}}}

/***
! Have the tiddler macro insert a shameless plug
***/
//{{{
// if local style changes aren't present in the tiddler macro, then we are not in the instructor book
// so we want to swap in the new code.

var newcode = 'if (params[0] &amp;&amp; tiddler &amp;&amp; !(store.getTiddlerText(params[0]) || store.isShadowTiddler(params[0]))) return  wikify(&quot;@@font-weight: bold;color: red;***The content of tiddler [[&quot;+params[0].replace(new RegExp(&quot;/[^/]+$&quot;), &quot;&quot;)+&quot;]] is not available. Click the link to find out why.***@@&quot;,place);';

var code=config.macros.tiddler.handler.toString();
if ( code.indexOf('&quot;@@' == -1) ) {
var pos=code.indexOf('{');
code = code.substr(0,pos+1)+newcode+code.substr(pos+1);
eval('config.macros.tiddler.handler='+code);
}
//}}}</pre>
</div>
<div title="ShowImage" modifier="ELSDesignStudios" created="200909082101" modified="200909102211" tags="transclusion">
<pre>/%
!info
|Name|ShowImage|
|Source|http://www.TiddlyTools.com/#ShowImage|
|Version|1.0.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|transclusion|
|Description|display attached tiddler image without supporting plugin|
Usage:
&lt;&lt;&lt;
# First, use [[AttachFilePlugin]] to create tiddlers containing base64-encoded image data with a fallback remote URL reference.
# You can then discard the plugin and associated supporting tiddlers ([[AttachFileMIMETypes]], [[AttachFilePluginFormatters]]), leaving only the attachment tiddlers (plus this tiddler, ShowImage, of course).
# Use the following syntax to display the attached images without any plugins:
{{{
&lt;&lt;tiddler ShowImage with: [[TiddlerName]] &quot;tooltip&quot; &quot;width&quot;&gt;&gt;
}}}
where:
*''~TiddlerName''&lt;br&gt;title of the attachment tiddler to be displayed
*''tooltip'' //(optional)//&lt;br&gt;mouseover help text for the image (default=attachment title)
*''width'' //(optional)//&lt;br&gt;CSS width measurement - resizes image height proportionally (default=auto)
Note: the fallback remote URL will be used if encoded data is not attached or you are using InternetExplorer, which does not currently support the data:// URI. 
&lt;&lt;&lt;
Example:
&lt;&lt;&lt;
{{{
&lt;&lt;tiddler ShowImage with: [[AttachFileSample]] &quot;meow!&quot; &quot;30px&quot;&gt;&gt;
}}}
&lt;&lt;tiddler ShowImage with: [[AttachFileSample]] &quot;meow!&quot; &quot;30px&quot;&gt;&gt;
&lt;&lt;&lt;
!end

!show
&lt;html&gt;&lt;img src=&quot;missing.jpg&quot; title=&quot;$2&quot; style=&quot;width:$3&quot; /&gt;&lt;/html&gt;&lt;&lt;tiddler {{
	var src=store.getTiddlerText(&quot;$1##data&quot;);
	if (!src||config.browser.isIE)
		src=store.getTiddlerText(&quot;$1##url&quot;,&quot;missing.jpg&quot;);
	place.lastChild.firstChild.src=src;
}}&gt;&gt;
!end

%/&lt;&lt;tiddler {{&quot;ShowImage##&quot;+(&quot;$1&quot;==&quot;$&quot;+&quot;1&quot;?&quot;info&quot;:&quot;show&quot;)}} with:
	[[$1]]
	{{&quot;$2&quot;==&quot;$&quot;+&quot;2&quot;?&quot;$1&quot;  :&quot;$2&quot;}}
	{{&quot;$3&quot;==&quot;$&quot;+&quot;3&quot;?&quot;auto&quot;:&quot;$3&quot;}}
&gt;&gt;</pre>
</div>
<div title="ShowPopup" modifier="ELSDesignStudios" created="200609091431" modified="200909102211" tags="html excludeMissing">
<pre>/%
!info
|Name|ShowPopup|
|Source|http://www.TiddlyTools.com/#ShowPopup|
|Version|1.2.0|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|transcluded html|
|Requires||
|Overrides||
|Description|display tiddler content in a TiddlyWiki popup panel|
Usage:
&lt;&lt;&lt;
{{{
&lt;&lt;tiddler ShowPopup with: TiddlerName label tooltip buttonClass width popupClass&gt;&gt;
}}}
where:
*''~TiddlerName''&lt;br&gt;title of the tiddler to be displayed
*''label''&lt;br&gt;text for the command link
*''tooltip''&lt;br&gt;mouseover help text for the link
*''buttonClass''&lt;br&gt;CSS classname applied to the command text (default=button)
*''width''&lt;br&gt;width of the popup (using CSS measurements, default=auto)
*''popupClass''&lt;br&gt;CSS classname applied to the popup panel (default=none).&lt;br&gt;Use 'sticky' for persistent popups (see StickyPopupPlugin)
&lt;&lt;&lt;
Example:
&lt;&lt;&lt;
{{{
&lt;&lt;tiddler ShowPopup with: ShowPopup [[Try this]] [[show this tiddler in a popup]]&gt;&gt;
}}}
&lt;&lt;tiddler ShowPopup with: ShowPopup [[Try this]] [[show this tiddler in a popup]]&gt;&gt;
&lt;&lt;&lt;
!end

!show
&lt;html&gt;&lt;hide linebreaks&gt;
&lt;a href=&quot;javascript:;&quot; class=&quot;$4&quot; title=&quot;$3&quot; onclick=&quot;
	var p=Popup.create(this); if(!p)return;
	p.className+='$6'!='$'+'6'?' $6':'';
	var d=createTiddlyElement(p,'div');
	var s=d.style;
	s.whiteSpace='normal';
	s.width='$5'!='$'+'5'?'$5':'auto';
	s.padding='2px';
	wikify(store.getTiddlerText('$1',''),d);
	Popup.show();
	event.cancelBubble=true;
	if(event.stopPropagation)event.stopPropagation();
	return(false);
&quot;&gt;$2&lt;/a&gt;&lt;/html&gt;
!end

%/&lt;&lt;tiddler {{'ShowPopup##'+('$1'=='$'+'1'?'info':'show')}} with: [[$1]] [[$2]] [[$3]] [[$4]] [[$5]] [[$6]]&gt;&gt;</pre>
</div>
<div title="SideBarOptions" modifier="JohnRouillard" created="200903151945" modified="201008011932" tags="InstructorOnly excludeOrphans">
<pre>{{button{goto}}}
&lt;&lt;gotoTiddler&gt;&gt;&lt;&lt;search&gt;&gt;&lt;&lt;closeAll&gt;&gt;&lt;&lt;permaview&gt;&gt;&lt;&lt;newTiddler prompt:&quot;Create a new tiddler.&quot;&gt;&gt;&lt;&lt;tiddler InstructorSidebarFunctions##newTiddlers&gt;&gt;&lt;&lt;unsavedChanges command&gt;&gt;&lt;&lt;saveChanges&gt;&gt;&lt;&lt;slider chkInstructorSidebarFunctions InstructorSidebarFunctions &quot;instructor &quot; &quot;save contents from instructor tw&quot;&gt;&gt;&lt;&lt;slider chkSliderOptionsPanel OptionsPanel &quot;options &quot; &quot;Change TiddlyWiki advanced options&quot;&gt;&gt;</pre>
</div>
<div title="SiteStartup" modifier="JohnRouillard" created="200908250055" modified="201007312313" tags="structure excludeOrphans excludeMissing">
<pre>&lt;&lt;tiddler InstructorSiteStartup&gt;&gt; Place things here that should be invoked once upon loading of the TiddlyWiki
E.G. aliases defined by the AliasPlugin, or redirects or redirectExact's defined using the RedirectMacro.
{{{
&lt;&lt;alias ul &quot;&lt;script&gt;place.style.borderLeft='thin solid black';&lt;/script&gt;&quot;&gt;&gt;
&lt;&lt;redirectExact Single [[Rule Type Reference##Single]]&gt;&gt;
}}}

/% make all occurences of the term WikiWords ro WikiWord link to the glossary entry %/
&lt;&lt;redirectExact WikiWords [[Glossary/wikiWord]]&gt;&gt;
&lt;&lt;redirectExact WikiWord [[Glossary/wikiWord]]&gt;&gt;

&lt;&lt;alias img {{&quot;\&lt;\&lt;wikify '[img(&quot; +  store.getTiddlerSlice('Slide Tips','defaultPercent') + &quot;, auto)[%0]]' &gt;\&gt;&quot;}} &gt;&gt;</pre>
</div>
<div title="SiteSubtitle" modifier="JohnRouillard" created="201007050047">
<pre>a textbook, notebook, quiz and presentation tool for a class</pre>
</div>
<div title="SiteTitle" modifier="JohnRouillard" created="200903151819" modified="201007050045" tags="structure excludeOrphans">
<pre>TiddlyWiki Coursebook</pre>
</div>
<div title="SiteUrl" modifier="JohnRouillard" created="200903152023" modified="200909040048" tags="structure">
<pre>http://www.cs.umb.edu/~rouilj/classes/SEC_LISA09/SEC_ps.html</pre>
</div>
<div title="Slide Tips" modifier="JohnRouillard" created="201007182052" modified="201007312325" tags="content">
<pre>!! Test the display at your projection resolution

Remember to test slide display in the resolution you will be displaying at so that the slide displays without scrolling in the  instrucor presentation mode. The students can scroll the slides, but you shouldn't scroll on screen.

The
{{{
#displayArea {
 font-size: 180%;
}
}}}
setting in the InstructorSlideShowStyleSheet can be used to adjust for different resolutions. When you use images, consider how they will scale at different resolutions. An image can be scaled using {{{[img(90%,)[image_file.png]]}}} to scale it at 90% of the size of it's containg element. See the ImageSizePlugin for other examples.
&lt;&lt;&lt;
[img(24px,)[tick-icon.png]] You can also use tiddler transclusion to set the percentage in one location and reference it everywhere. For example you can use a [[slice|Glossary/slice]] in a tiddler to set the size:
defaultPercent: 63%
Then you can reference it with: {{{&lt;&lt;wikify '[img(%0, auto)[%1]]' 'Slide Tips::defaultPercent' tick-icon.png&gt;&gt;}}} to get a really big (and ugly):
&lt;&lt;wikify '[img(%0, auto)[%1]]' 'Slide Tips::defaultPercent' tick-icon.png&gt;&gt;
at &lt;&lt;tiddler &quot;Slide Tips::defaultPercent&quot;&gt;&gt; of the width of the story column.
&lt;&lt;&lt;

This is encapsulated in the {{{&lt;&lt;img imagename.ext&gt;&gt;}}} that is defined in SiteStartup. Note if you change the defaultPercent display the SiteStartup tiddler to refresh the value. For example {{{&lt;&lt;img warning-icon.png&gt;&gt;}}} creates:
&lt;&lt;img warning-icon.png&gt;&gt;
using the embedded image [[warning-icon.png]]. You can also specify a local file or a url to an image.

!! Reusing content via [[transclusion|Glossary/transcluded]]

You can use the {{{&lt;&lt;tiddler&gt;&gt;}}} macro to include content from other tiddlers. Especially useful with the PartTiddlerPlugin to include examples from a section of a larger tiddler into a slide so you don't have to duplicate content.

!! Duplicating a slide in a single presentation

Sometimes you want to reuse a slide in a presentation. E.G. A slide that lays out important bullet points that you want to use to:
* tell them what you will tell them
* tell them what you told them
The underlying mechanisms for stories and presentations don't display the same tiddler twice
even if named. However there is a way around this. Create two tiddlers:
* Agenda
* Agenda - Recap
in the {{{Agenda - Recap}}} tiddler use {{{&lt;&lt;tiddler &quot;Agenda&quot;&gt;&gt;}}} to [[transclude|Glossary/transcluded]] the contents from the Agenda tiddler into the Agenda - Recap tiddler. Any changes that occur to the Agenda tiddler will be displayed in the Agenda - Recap tiddler.</pre>
</div>
<div title="Slide Welcome" modifier="JohnRouillard" created="200903222225" modified="200908260233" tags="slide content">
<pre>&lt;&lt;tiddler Welcome/coursebook&gt;&gt;</pre>
</div>
<div title="SlideShowPlugin" modifier="JohnRouillard" created="200903102244" modified="201007310649" tags="systemConfig excludeMissing">
<pre>/***
|''Name:''|SlideShowPlugin|
|''Description:''|Creates a slide show from any number of tiddlers|
|''Author:''|Paulo Soares|
|''Contributors:''|John P. Rouillard|
|''Version:''|2.2.4|
|''Date:''|2010-04-08|
|''Source:''|http://www.math.ist.utl.pt/~psoares/addons.html|
|''Documentation:''|[[SlideShowPlugin Documentation|SlideShowPluginDoc]]|
|''License:''|[[Creative Commons Attribution-Share Alike 3.0 License|http://creativecommons.org/licenses/by-sa/3.0/]]|
|''~CoreVersion:''|2.5.0|
***/
//{{{
if(!version.extensions.SlideShowPlugin) { //# ensure that the plugin is only installed once
version.extensions.SlideShowPlugin = {installed: true};

(function($) {
config.macros.slideShow = {maxTOCLength: 30, separator:'-s-'};

config.formatters.push( {
	name: &quot;SlideSeparator&quot;,
	match: &quot;^-s-+$\\n?&quot;,
	handler: function(w) {
		createTiddlyElement(w.output,&quot;hr&quot;,null,'slideSeparator');
	}
});

config.macros.slideShow.text = {
  label: &quot;slide show&quot;, tooltip: &quot;Start slide show&quot;,
  quit: {label: &quot;x&quot;, tooltip: &quot;Quit the slide show&quot;},
  firstSlide: {label: &quot;&lt;&lt;&quot;, tooltip: &quot;Go to first slide&quot;},
  previous: {label: &quot;&lt;&quot;, tooltip: &quot;Go back&quot;},
  next: {label: &quot;&gt;&quot;, tooltip: &quot;Advance&quot;},
  lastSlide: {label: &quot;&gt;&gt;&quot;, tooltip: &quot;Go to last slide&quot;},
  goto: {label: &quot;Go to slide:&quot;},
  resetClock: {tooltip: &quot;Reset the clock&quot;},
  overlay: &quot;overlay&quot;
};

config.macros.slideShow.handler = function(place,macroName,params,wikifier,paramString){
  var args = paramString.parseParams(null,null,false);
  this.label = getParam(args,&quot;label&quot;,this.text.label);
  this.tooltip = getParam(args,&quot;tooltip&quot;,this.text.tooltip);
  var onclick = function(){config.macros.slideShow.onClick(place,paramString); return false;};
  createTiddlyButton(place,this.label,this.tooltip,onclick);
  return false;
}

config.macros.slideShow.onClick = function(place,paramString) {
  var slide, cm = config.macros.slideShow;
  var title = story.findContainingTiddler(place);
  title = title ? title.getAttribute(&quot;tiddler&quot;) : null;
  var args = paramString.parseParams(null,null,false);
  title =  getParam(args,&quot;tiddler&quot;,title);
  var argsArray = paramString.readMacroParams();
  this.single = ($.inArray('single',argsArray) &gt; -1);
  this.clicks = ($.inArray('noClicks',argsArray) &lt; 0);
  this.keyboard = ($.inArray('noKeyboard',argsArray) &lt; 0);
  this.showAll = ($.inArray('showAll',argsArray) &gt; -1);
  this.cycle = ($.inArray('cycle',argsArray) &gt; -1);
  this.overlays = ($.inArray('noOverlays',argsArray) &lt; 0);
  this.theme = getParam(args,&quot;theme&quot;);
  this.tag = getParam(args,&quot;tag&quot;);
  this.toc = getParam(args,&quot;toc&quot;,&quot;headers&quot;);
  this.sort = getParam(args,&quot;sort&quot;);
  this.clockFormat = getParam(args,&quot;clockFormat&quot;,'0hh:0mm:0ss');
  this.auto = getParam(args,&quot;auto&quot;,0);
  this.header = getParam(args,&quot;header&quot;,title);
  this.footer = getParam(args,&quot;footer&quot;,&quot;&quot;);
  this.clock = getParam(args,&quot;clock&quot;);
  this.blocked = 0;
  if(this.clock){
    var startTime = new Date(0);
    this.clockCorrection=startTime.getTimezoneOffset()*60000;
    startTime = new Date();
    this.clockMultiplier = 1;
    this.clockInterval = 0;
    var clockType= parseFloat(this.clock);
    if(clockType &lt; 0) {
      this.clockMultiplier = -1;
      this.clockInterval = -clockType*60000;
    } else if(clockType == 0){
      this.clockCorrection = 0;
      startTime = new Date(0);
    }
    this.clockStartTime=startTime.getTime();
  }
  this.slides = [];
  this.openTiddlers = [];
  $(&quot;#tiddlerDisplay &gt; *&quot;).each(function(){cm.openTiddlers.push($(this).attr('tiddler'))});
  var count = 0;
  this.slideTOC=[];
  if(this.single){
    var newTiddler;
    var content = store.getTiddlerText(title).split(cm.separator);
    $.each(content, function(){
      count++;
      newTiddler = new Tiddler();
      newTiddler.title =&quot;TempSlide&quot; + count;
      newTiddler.tags[0] = &quot;excludeLists&quot;;
      newTiddler.tags[1] = &quot;temporarySlides&quot;;
      newTiddler.text = $.trim(this);
      store.addTiddler(newTiddler);
      cm.buildTOC(count,newTiddler.title);
      cm.slides.push(newTiddler.title);
    });
  } else {
    if(this.tag){
      var content = store.getTaggedTiddlers(this.tag,this.sort);
      $.each(content, function(){
        count++;
        cm.buildTOC(count,this.title);
        cm.slides.push(this.title);
      });
    } else {
      story.displayTiddler(null,title);
      var list = $('[tiddler='+title+']').children('.viewer').find('.tiddlyLinkExisting');
      $.each(list,function(){
        if(!$(this).parents().hasClass(&quot;exclude&quot;)){
          slide = $(this).attr('tiddlylink');
          count++;
          cm.buildTOC(count,slide);
          cm.slides.push(slide);
        }
      });
    }
  }
  this.nSlides = this.slides.length;
  if(this.nSlides==0) return false;
  clearMessage();
  this.toggleSlideStyles();
  if(!this.showAll){
    //Attach the key and mouse listeners
    if(this.keyboard &amp;&amp; !$(&quot;#tiddlerDisplay&quot;).hasClass(&quot;noKeyboard&quot;)) $(document).keyup(cm.keys);
    if(this.clicks){
      $(&quot;#displayArea&quot;).mouseup(cm.clicker);
      document.oncontextmenu = function(){return false;}
    }
    if(this.clock) this.slideClock=setInterval(this.setClock, 1000);
    if(this.auto&gt;0){
      this.autoAdvance=setInterval(cm.next, this.auto*1000);
    }
    this.showSlide(1);
  } else {
    story.closeAllTiddlers();
    story.displayTiddlers(null,this.slides);
    $(&quot;.tiddler&quot;).attr(&quot;ondblclick&quot;,null);
    $(document).keyup(cm.endSlideShow);
  }
  return false;
}

config.macros.slideShow.buildNavigator = function() {
  //Create the navigation bar
  var i, slidefooter = $(&quot;#controlBar&quot;)[0];
  if(!slidefooter) return;
  $(slidefooter).addClass(&quot;slideFooterOff noClicks&quot;);
  var navigator = createTiddlyElement(slidefooter,&quot;SPAN&quot;,&quot;navigator&quot;);
  var buttonBar = createTiddlyElement(navigator,&quot;SPAN&quot;,&quot;buttonBar&quot;);
  //Make it so that when the footer is hovered over the class will change to make it visible
  $(slidefooter).bind(&quot;mouseenter mouseleave&quot;, function(e){$(this).toggleClass(&quot;slideFooterOff&quot;);});
  //Create the control buttons for the navigation
 
  createTiddlyButton(buttonBar,this.text.firstSlide.label,this.text.firstSlide.tooltip,this.firstSlide,&quot;button&quot;);
  createTiddlyButton(buttonBar,this.text.previous.label,this.text.previous.tooltip,this.previous,&quot;button&quot;);
  createTiddlyButton(buttonBar,this.text.quit.label,this.text.quit.tooltip,this.endSlideShow,&quot;button&quot;);
  createTiddlyButton(buttonBar,this.text.next.label,this.text.next.tooltip,this.next,&quot;button&quot;);
  createTiddlyButton(buttonBar,this.text.lastSlide.label,this.text.lastSlide.tooltip,this.lastSlide,&quot;button&quot;);
  if(this.clock){
    if(this.clock == 0){
       createTiddlyElement(navigator,&quot;SPAN&quot;,&quot;slideClock&quot;);
    } else {
      createTiddlyButton(navigator,&quot; &quot;,this.text.resetClock.tooltip,this.resetClock,&quot;button&quot;,&quot;slideClock&quot;);
    }
    this.setClock();
  }
  var index = createTiddlyElement(slidefooter,&quot;SPAN&quot;,&quot;slideCounter&quot;);
  index.onclick = this.toggleTOC;
  var toc = createTiddlyElement(slidefooter,&quot;SPAN&quot;,&quot;toc&quot;);
  var tocLine;
  for(i=0; i&lt;this.slideTOC.length; i++){
    $(toc).append(this.slideTOC[i][2]);
    tocLine = toc.lastChild;
    $(tocLine).addClass(&quot;tocLevel&quot;+this.slideTOC[i][1]).css(&quot;cursor&quot;, &quot;pointer&quot;).hover(function () {
        $(this).addClass(&quot;highlight&quot;);}, function () {
        $(this).removeClass(&quot;highlight&quot;);});
    tocLine.setAttribute(&quot;slide&quot;,this.slideTOC[i][0]);
    $(tocLine).click(config.macros.slideShow.showSlideFromTOC);
  }
  //Input box to jump to specific slide
  var tocItem = createTiddlyElement(toc,&quot;DIV&quot;,&quot;jumpItem&quot;,null,this.text.goto.label);
  var tocJumpInput = createTiddlyElement(tocItem,&quot;INPUT&quot;,&quot;jumpInput&quot;);
  tocJumpInput.type=&quot;text&quot;;
  $(tocJumpInput).keyup(config.macros.slideShow.jumpToSlide);
}

//Used to shorten the TOC fields
config.macros.slideShow.abbreviate = function(label){
  if(label.length&gt;this.maxTOCLength) {
    var temp = new Array();
    temp = label.split(' ');
    label = temp[0];
    for(var j=1; j&lt;temp.length; j++){
      if((label.length+temp[j].length)&lt;=this.maxTOCLength){
        label += &quot; &quot; + temp[j];
      } else {
        label += &quot; ...&quot;;
        break;
      }
    }
  }
  return label;
}

config.macros.slideShow.buildTOC = function(count,title) {
  var level = 1, text;
  switch(this.toc){
  case &quot;headers&quot;:
    var frag = wikifyStatic(store.getTiddlerText(title));
    text = frag.replace(/&lt;div class=&quot;comment&quot;&gt;.*&lt;\/div&gt;/mg,&quot;&quot;);
    var matches =  text.match(/&lt;h[123456]&gt;.*?&lt;\/h[123456]&gt;/mgi);
    if(matches){
      for (var j=0; j&lt;matches.length; j++){
        level = matches[j].charAt(2);
        text = matches[j].replace(/&lt;\/?h[123456]&gt;/gi,&quot;&quot;);
        text = this.abbreviate(text);
        this.slideTOC.push([count,level,&quot;&lt;div&gt;&quot;+text+&quot;&lt;/div&gt;&quot;]);
      }
    }
    break;
  case &quot;titles&quot;:
    text = this.abbreviate(title);
    this.slideTOC.push([count,level,&quot;&lt;div&gt;&quot;+text+&quot;&lt;/div&gt;&quot;]);
  }
}

config.macros.slideShow.showSlideFromTOC = function(e) {
  var cm = config.macros.slideShow;
  var slide = parseInt(e.target.getAttribute('slide'));
  $(&quot;#toc&quot;).hide();
  cm.showSlide(slide);
  return false;
}

config.macros.slideShow.toggleTOC = function(){
  $(&quot;#toc&quot;).toggle();
  $(&quot;#jumpInput&quot;).focus().val('');
  return false;
}

config.macros.slideShow.isInteger = function(s){
  for (var i = 0; i &lt; s.length; i++){
    // Check that current character is number
    var c = s.charAt(i);
    if (((c &lt; &quot;0&quot;) || (c &gt; &quot;9&quot;))) return false;
  }
  // All characters are numbers
  return true;
}

config.macros.slideShow.jumpToSlide = function(e){
  var cm = config.macros.slideShow;
  if(e.which==13){
    var input= $(&quot;#jumpInput&quot;).val();
    if(cm.isInteger(input) &amp;&amp; input&gt;0 &amp;&amp; input&lt;=cm.nSlides){
      $(&quot;#toc&quot;).hide();
      cm.showSlide(input);
    } else  {$(&quot;#jumpInput&quot;).val('');}
  }
  return false;
}

config.macros.slideShow.toggleSlideStyles = function(){
  var contentWrapper = $('#contentWrapper');
  if(contentWrapper.hasClass(&quot;slideShowMode&quot;)){
    refreshPageTemplate();
    removeStyleSheet(&quot;SlideShowStyleSheet&quot;);
    if(this.theme) removeStyleSheet(this.theme);
    removeStyleSheet(&quot;SlideShowDynamicStyle&quot;); // rouilj for changable slide formats at runtime
    setStylesheet(store.getRecursiveTiddlerText(&quot;StyleSheet&quot;),&quot;StyleSheet&quot;);
  } else {
    $(&quot;#displayArea&quot;).prepend('&lt;div id=&quot;slideBlanker&quot; style=&quot;display:none&quot;&gt;&lt;/div&gt;&lt;div id=&quot;slideHeader&quot;&gt;'+this.header+'&lt;/div&gt;&lt;div id=&quot;slideFooter&quot;&gt;'+this.footer+'&lt;/div&gt;&lt;div id=&quot;controlBar&quot;&gt;&lt;/div&gt;');
    setStylesheet(store.getRecursiveTiddlerText(&quot;SlideShowStyleSheet&quot;),&quot;SlideShowStyleSheet&quot;);
    if(this.theme &amp;&amp; store.tiddlerExists(this.theme)){setStylesheet(store.getRecursiveTiddlerText(this.theme),this.theme);}
    setStylesheet(&quot;&quot;,&quot;SlideShowDynamicStyle&quot;); // rouilj for changable slide formats at runtime
    this.buildNavigator();
  }
  contentWrapper.toggleClass(&quot;slideShowMode&quot;);
  if (this.theme) { contentWrapper.toggleClass(this.theme) } else {  contentWrapper.toggleClass(&quot;SlideShowStyleSheet&quot;)}; // rouilj
   // for dynamic slide changes, allow the dynamic code to figure out what style sheet we are using to act differently in different modes.
  return false;
}

config.macros.slideShow.showSlide = function(n){
  if(this.cycle) {
    if(n&gt;this.nSlides) {
      n = 1;
    } else if(n&lt;1) {
      n = this.nSlides;
    }
  } else {
    if(n&gt;this.nSlides || n&lt;1) return;
  }
  story.closeAllTiddlers();
  if(this.clock=='-'){this.resetClock();}
  story.displayTiddler(null,String(this.slides[n-1]));
  $(&quot;.tiddler&quot;).attr(&quot;ondblclick&quot;,null);
  this.curSlide = n;
  $(&quot;#slideCounter&quot;).text(this.curSlide+&quot;/&quot;+this.nSlides);
  if(this.overlays){
    var contents = $(&quot;.viewer *&quot;);
    this.numOverlays = 1;
    while(1){
      if(contents.hasClass(this.text.overlay+this.numOverlays)){
        this.numOverlays++;
      } else {break;}
    }
    this.numOverlays--;
    this.showOverlay(0);
  }
  return false;
}

config.macros.slideShow.showOverlay = function(n){
  var i, set, cm = config.macros.slideShow;
  if(!cm.overlays || cm.numOverlays == 0 || n&lt;0 || n&gt;cm.numOverlays){return;}
  for(i=1; i&lt;n; i++){
    set = $(&quot;.viewer &quot;+&quot;.&quot;+cm.text.overlay+i);
    set.removeClass(&quot;currentOverlay nextOverlay&quot;);
    set.addClass(&quot;previousOverlay&quot;);
  }
  set = $(&quot;.viewer &quot;+&quot;.&quot;+cm.text.overlay+n);
  set.removeClass(&quot;previousOverlay nextOverlay&quot;);
  set.addClass(&quot;currentOverlay&quot;);
  for(i=n; i&lt;config.macros.slideShow.numOverlays; i++){
    set = $(&quot;.viewer &quot;+&quot;.&quot;+cm.text.overlay+(i+1));
    set.removeClass(&quot;previousOverlay currentOverlay&quot;);
    set.addClass(&quot;nextOverlay&quot;);
  }
  cm.curOverlay = n;
}

config.macros.slideShow.firstSlide = function(){
  config.macros.slideShow.showSlide(1);
  return false;
}

config.macros.slideShow.lastSlide = function(){
  config.macros.slideShow.showSlide(config.macros.slideShow.nSlides);
  return false;
}

config.macros.slideShow.next = function(){
  var cm = config.macros.slideShow;
  if(!cm.overlays || cm.numOverlays == 0 || cm.curOverlay == cm.numOverlays) {
    cm.showSlide(cm.curSlide+1);
  } else {
    cm.showOverlay(cm.curOverlay+1);
  }
  return false;
}

config.macros.slideShow.previous = function(){
  var cm = config.macros.slideShow;
  if(!cm.overlays || cm.numOverlays == 0 || cm.curOverlay == 0) {
    cm.showSlide(cm.curSlide-1);
    cm.showOverlay(cm.numOverlays);
  } else {
    cm.showOverlay(cm.curOverlay-1);
  }
  return false;
}

config.macros.slideShow.endSlideShow=function(){
  var cm = config.macros.slideShow;
  if(cm.autoAdvance) {clearInterval(cm.autoAdvance);}
  if(this.clock) clearInterval(this.slideClock);
  story.closeAllTiddlers();
  cm.toggleSlideStyles();
  story.displayTiddlers(null,cm.openTiddlers);
  $(document).unbind();
  document.oncontextmenu =  function(){};
  var content = store.getTaggedTiddlers('temporarySlides');
  $.each(content, function(){
    store.removeTiddler(this.title);
  });
  return false;
}

// 'keys' code adapted from S5 which in turn was adapted from MozPoint (http://mozpoint.mozdev.org/)
config.macros.slideShow.keys = function(key) {
  var cm = config.macros.slideShow;
  switch(key.which) {
  case 32: // spacebar
    if(cm.auto&gt;0 &amp;&amp; cm.blocked==0){
      if(cm.autoAdvance){
        clearInterval(cm.autoAdvance);
        cm.autoAdvance = null;
      } else {
        cm.autoAdvance=setInterval(cm.next, cm.auto*1000);
      }
    } else {
      if(cm.blocked==0) cm.next();
    }
    break;
  case 34: // page down
    if(cm.blocked==0) cm.showSlide(cm.curSlide+1);
    break;
  case 39: // rightkey
    if(cm.blocked==0) cm.next();
    break;
  case 40: // downkey
    if(cm.blocked==0) cm.showOverlay(cm.numOverlays);
    break;
  case 33: // page up
    if(cm.blocked==0) cm.showSlide(cm.curSlide-1);
    break;
  case 37: // leftkey
    if(cm.blocked==0) cm.previous();
    break;
  case 38: // upkey
    if(cm.blocked==0) cm.showOverlay(0);
    break;
  case 36: // home
    if(cm.blocked==0) cm.firstSlide();
    break;
  case 35: // end
    if(cm.blocked==0) cm.lastSlide();
    break;
  case 27: // escape
    cm.endSlideShow();
    break;
  case 66: // B
    $(&quot;#slideBlanker&quot;).toggle();
    cm.blocked = (cm.blocked +1)%2;
    break;
  }
  return false;
}

config.macros.slideShow.clicker = function(e) {
  var cm = config.macros.slideShow;
  if(cm.blocked==1 || $(e.target).attr('href') || $(e.target).parents().andSelf().hasClass('noClicks')){
    return true;
  }
  if($(&quot;#toc&quot;).is(':visible')){
    cm.toggleTOC();
  } else {
    if((!e.which &amp;&amp; e.button == 1) || e.which == 1) {
      cm.next();
    }
    if((!e.which &amp;&amp; e.button == 2) || e.which == 3) {
      cm.previous();
    }
  }
  return false;
}

config.macros.slideShow.setClock = function(){
  var cm = config.macros.slideShow;
  var actualTime = new Date();
  var newTime = actualTime.getTime() - cm.clockStartTime;
  newTime = cm.clockMultiplier*newTime+cm.clockInterval+cm.clockCorrection;
  actualTime.setTime(newTime);
  newTime = actualTime.formatString(cm.clockFormat);
  $(&quot;#slideClock&quot;).text(newTime);
  return false;
}

config.macros.slideShow.resetClock = function(){
  var cm = config.macros.slideShow;
  if(cm.clock == 0) return;
  var time = new Date(0);
  if(cm.clockStartTime&gt;time){
    var startTime = new Date();
    cm.clockStartTime=startTime.getTime();
  }
  return false;
}

config.shadowTiddlers.SlideShowStyleSheet=&quot;/*{{{*/\n.header, #mainMenu, #sidebar, #backstageButton, #backstageArea, .toolbar, .title, .subtitle, .tagging, .tagged, .tagClear, .comment{\n display:none !important\n}\n\n#slideBlanker{\n position: absolute;\n top: 0;\n left: 0;\n width: 100%;\n height: 100%;\n z-index: 90; \n background-color: #000;\n opacity: 0.9;\n filter: alpha(opacity=90)\n}\n\n.nextOverlay{\n visibility: hidden\n}\n\n.previousOverlay,.currentOverlay{\n visibility: visible\n}\n\n#displayArea{\n font-size: 250%;\n margin: 0 !important;\n padding: 0\n}\n\n#controlBar{\n position: fixed;\n bottom: 2px;\n right: 2px;\n width: 100%;\n text-align: right\n}\n\n#controlBar .button{\n margin: 0 0.25em;\n padding: 0 0.25em\n}\n\n#slideHeader{\n font-size: 200%;\n font-weight: bold\n}\n\n#slideFooter{\n position: fixed;\n bottom: 2px\n}\n\n.slideFooterOff #navigator{\n visibility: hidden\n}\n\n#slideClock{\n margin: 0 5px 0 5px\n}\n\n#slideCounter{\n cursor: pointer;\n color: #aaa\n}\n\n#toc{\n display: none;\n position: absolute;\n font-size: .75em;\n bottom: 2em;\n right: 0;\n background: #fff;\n border: 1px solid #000;\n text-align: left\n}\n\n#jumpItem{\n padding-left:0.25em\n}\n\n#jumpInput{\n margin-left: 0.25em;\n width: 3em\n}\n\n.tocLevel1{\n font-size: .8em\n}\n\n.tocLevel2{\n margin-left: 1em;\n font-size: .75em\n}\n\n.tocLevel3{\n margin-left: 2em;\n font-size: .7em\n}\n\n.tocLevel4{\n margin-left: 3em;\n font-size: .65em\n}\n\n.tocLevel5{\n margin-left: 4em;\n font-size: .6em\n}\n\n.tocLevel6{\n margin-left: 5em;\n font-size: .55em\n}\n/*}}}*/&quot;;

config.shadowTiddlers.SlideShowPluginDoc=&quot;The documentation is available [[here|http://www.math.ist.utl.pt/~psoares/addons.html#SlideShowPluginDoc]].&quot;;
})(jQuery)
}
//}}}</pre>
</div>
<div title="SlideShowPluginDoc" modifier="PauloSoares" created="200704202142" modified="201002032354" tags="docs excludeMissing">
<pre>!Description
This plugin turns any number of tiddlers into a slide show. A single macro provides a flexible way to present a set of tiddlers, including:
#a full screen presentation that hides the TiddlyWiki structure (header, sidebar, main menu);
#a way to navigate through a set of tiddlers keeping the TiddlyWiki structure (similar to the [[NavigationMacro|http://tw.lewcid.org/#NavigationMacro]] by Saq Imtiaz);
#a display of all the selected tiddlers ready to be printed.
!Main features
Most features that are usually found in presentation software are available. 
*Build a slide show from a list of tiddlers' titles or selecting a specific tag with optional sort
*Build a slide show from a single tiddler where slides are divided by a separator
*Fully customizable presentations (CSS knowledge required)
*Auto-advancing slide show (kiosk mode) and looping (circular mode)
*Incremental display (several overlays or layers in a slide)
*Optional clock with 4 different modes:
**local time
**elapsed time of presentation
**elapsed time for each slide
**countdown clock for a given period
*Screen blanking for pauses
!Installation
To install this plugin copy the tiddler SlideShowPlugin to your TiddlyWiki, label it with the ''systemConfig'' tag, save the TW and refresh the browser.
Optionally, you can also copy this documentation tiddler. If you don't, a link to the original one in my site is provided.  
!Quick start
The simplest way to make a slide show is to create a new tiddler with references to all the tiddlers you want to include in your presentation. Any reference or group of references to tiddlers that should be skipped must be wrapped in a {{{exclude}}} class as in the following example:
{{{
MissingSlide
[[First slide|SlideShowExample-1]] {{exclude{(the tiddler SlideShowPluginDoc will not be included in the presentation)}}}
SlideShowExample-2
SlideShowExample-3
SlideShowExample-4
}}}
Add {{{&lt;&lt;slideShow&gt;&gt;}}} anywhere in the tiddler, close the edit form, click the ''slide show'' button and there you are. Move forward/backward in the presentation with the mouse left/right button. If you move the mouse pointer over the bottom of the browser window you will see a few navigation buttons. Click the ''x'' button or press the ''Escape'' key to exit.
!Options
{{{
&lt;&lt;slideShow
  noClicks
  noKeyboard
  noOverlays
  cycle
  showAll
  single
  tiddler:tiddler
  label:string
  tooltip:string
  tag:tag
  sort:field
  theme:tiddler
  toc:string
  auto:time
  clock:type
  clockFormat:string
  header:string
  footer:string
&gt;&gt; 
}}}
''noClicks''
Disables navigation through mouse clicks on the tiddlers. This is useful when there are lots of clickable elements in the presentation.
If you want to keep using the mouse to move around the presentation and there are occasional elements that require mouse clicking, these can be formatted with a {{{noClicks}}} class (read more [[here|http://www.tiddlywiki.com/#CustomCssClass]]).

''noKeyboard''
Disables keyboard navigation.

''noOverlays''
Disables the incremental display of overlays.

''cycle''
The slide shows runs in a continuous loop. 

''showAll''
To print a presentation all the selected tiddlers are opened in the specified order. Press any key to return to the default TiddlyWiki layout.

''single''
Use this if a presentation is defined in a single tiddler.

''tiddler''
Use this option to indicate the tiddler where your slide show is defined when it is not the same one that contains the button that starts the presentation.

''label''
Text to replace the default text in the slide show button.

''tooltip''
Text to be shown when the mouse is over the slide show button.

''tag''
Use this option to create a slide show with the tiddlers with the provided tag instead of providing a list of tiddlers.

''sort''
If the ''tag'' option is used you can use this other option to sort the tiddlers according to a specific field. Valid values are: //created// (default), //modified//, //title// and //text//.

''theme''
A user provided tiddler containing CSS rules that define the style of the slide show. To redefine the default style, edit the SlideShowStyleSheet shadow tiddler. 

''toc''
Choose the type of table of contents. Possible values: ''titles'' will enable the use of the tiddlers titles, ''headers'' (default) to choose html headers (h1, h2,...), anything else will disable the table of contents.  

''auto''
The slide show auto advances after the defined number of seconds. The slide show can be paused by pressing the ''space bar''.

''clock''
Displays a clock near the navigation buttons at the bottom of the screen. Four types of clocks can be defined:
#''clock:0'' -- shows the local time.
#''clock:'+''' -- displays the elapsed time of the presentation. Click the clock display to reset the time.
#''clock:'-''' -- displays the elapsed for each slide. Click the clock display to reset the time.
#''clock:-20'' -- displays a countdown clock for the given (negative) number of minutes. Click the clock display to reset the time.
''clockFormat''
A string that defines the clock format. The default is '0hh:0mm:0ss' where the prefix '0' forces a leading zero. 

''header''
A string to be used as a permanent header for the slide show. By default it's used the title of tiddler that defines the slide show.

''footer''
A string to be used as a permanent footer for the slide show. By default the footer is empty.
!Incremental display
A succession of overlays (or layers) can be defined in each slide by marking blocks of text with
{{{
{{overlay1{...some text...}}}, {{overlay2{...some text...}}}, {{overlay3{...some text...}}}, ...
}}}
The default name of the classes (//overlay//) can be redefined with //config.macros.slideShow.text.overlay = &quot;layer&quot;//, for example. 
To costumize the way overlays are shown you can redefine the following CSS classes
*.previousOverlay 
*.currentOverlay 
*.nextOverlay 
in a ~StyleSheet. The default style simply hides the next overlays and shows the current and the previous ones as normal text.
!Slide show navigation
You can navigate through a slide show using the keyboard or the mouse. 
!!Mouse navigation
Left (right) clicking on a slide jumps to the next (previous) slide or overlay. To move to the first or last slides you must use the navigation bar at the bottom of the browser's window.
!!Keyboard
The following keys are defined:
*Home - first slide
*~PageUp - previous slide
*~PageDown - next slide
*End - last slide
*Escape - exit slide show
*Up arrow - first overlay
*Left arrow - previous overlay/slide
*Pause/Right arrow - next overlay/slide
*Down arrow - last overlay
*Spacebar - pause/resume slide show in auto advance mode, next overlay/slide otherwise
*B - blank screen and block the slide show
!Miscellaneous 
Any block of text marked as
{{{
{{comment{For my eyes only!}}}
}}}
will not be displayed in the slide show.

All translatable strings are defined in //config.macros.slideShow.text// parameter. See SlideShowPluginMsgPT with the portuguese translation as an example.</pre>
</div>
<div title="SlideShowStyleSheet" modifier="JohnRouillard" created="200904160425" modified="200908291501" tags="structure">
<pre>/*{{{*/
/* Default slide show style sheet settings */
.header, #mainMenu, #sidebar, #backstageButton, #backstageArea, .toolbar, .title, .subtitle, .tagging, .tagged, .tagClear, .comment{
 display:none !important
}

#slideBlanker{
 position: absolute;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
 z-index: 90; 
 background-color: #000;
 opacity: 0.9;
 filter: alpha(opacity=90)
}

.nextOverlay{
 visibility: hidden
}

.previousOverlay,.currentOverlay{
 visibility: visible
}

#displayArea{
 font-size: 250%;
 margin: 0 !important;
 padding: 0
}

#controlBar{
 position: fixed;
 bottom: 2px;
 right: 2px;
 width: 100%;
 text-align: right
}

#controlBar .button{
 margin: 0 0.25em;
 padding: 0 0.25em
}

#slideHeader{
 font-size: 200%;
 font-weight: bold
}

#slideFooter{
 position: fixed;
 bottom: 2px
}

.slideFooterOff #navigator{
 visibility: hidden
}

#slideClock{
 margin: 0 5px 0 5px
}

#slideCounter{
 cursor: pointer;
 color: #aaa
}

#toc{
 display: none;
 position: absolute;
 font-size: .75em;
 bottom: 2em;
 right: 0;
 background: #fff;
 border: 1px solid #000;
 text-align: left
}

#jumpItem{
 padding-left:0.25em
}

#jumpInput{
 margin-left: 0.25em;
 width: 3em
}

.tocLevel1{
 font-size: .8em
}

.tocLevel2{
 margin-left: 1em;
 font-size: .75em
}

.tocLevel3{
 margin-left: 2em;
 font-size: .7em
}

.tocLevel4{
 margin-left: 3em;
 font-size: .65em
}

.tocLevel5{
 margin-left: 4em;
 font-size: .6em
}

.tocLevel6{
 margin-left: 5em;
 font-size: .55em
}

/* local changes for coursebook */

/* Disable slide blanker */
#slideBlanker {
 opacity: 0.0;
 filter: alpha(opacity=0)
}

/* Don't do overlay displays, display whole thing at once. */
.nextOverlay{
 visibility: visible
}

/* navigator always visible, black text on white background */
.slideFooterOff #navigator{
 visibility: visible;
 background: #FFF;
 foreground: #000;
}

#displayArea{
 font-size: 130%;
}

.title {
display: block !important;
left-margin: 6em;
}

/* put control bar in top right of header */
#controlBar{
 position: relative;
 bottom: 2px;
 right: 2px;
 width: 100%;
 text-align: right;
}

#controlBar .button {
border: 2px solid #000;
border-style: outset;
}

/* put toc as drop down menu not drop up */
#toc{
 font-size: 1em;
 top: 2em;
 right: 0;
 background: #888;
}

/* display comments in student mode with sea green background  */
#contentWrapper.slideShowMode .comment{
 display: block !important;
 background: #FFCC00;
}
.notes {
display: block;
}

#openTiddlers { display: none !important }
/*}}}*/</pre>
</div>
<div title="SlideShowTheme" modifier="JohnRouillard" created="200903252300" modified="200903280248" tags="structure">
<pre>!PageTemplate
&lt;!--{{{--&gt;
&lt;div id='displayArea'&gt;
&lt;div id='slideBlanker' style='display:none'&gt;&lt;/div&gt;
&lt;div id='slideHeader'&gt;&lt;/div&gt;
&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;
&lt;div id='slideFooter'&gt;&lt;/div&gt;
&lt;div id='controlBar' class='slideFooterOff noClicks'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;
!ViewTemplate
&lt;!--{{{--&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;
!contentViewTemplate
&lt;!--{{{--&gt;
theme
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;
!StyleSheet
/*{{{*/
#slideBlanker{
 position:absolute;
 top: 0;
 left: 0;
 width: 100%;
 height: 100%;
 z-index: 90; 
 background-color: #000;
 opacity:.9;filter: alpha(opacity=90);
}

#backstageShow, #contentWrapper.slideShowMode .comment{
 display: none !important;
}

#contentWrapper.slideShowMode .nextOverlay{
 visibility: hidden;
}

#contentWrapper.slideShowMode .previousOverlay, #contentWrapper.slideShowMode .currentOverlay{
 visibility: visible;
}

#contentWrapper.slideShowMode #displayArea{
 font-size: 220%;
 margin: 0 !important;
 padding: 0;
}

#controlBar{
 position: fixed;
 bottom: 2px;
 right: 2px;
 width: 100%;
 text-align: right;
}

#controlBar .button{
 margin:0em 0.25em;
 padding:0em 0.25em;
}

#slideHeader{
 font-size: 200%;
 font-weight: bold;
}

#slideFooter{
 position: absolute;
 bottom: 2px;
 font-size: 50%;
}

.slideFooterOff #navigator{
 visibility: hidden;
}

#slideClock{
 margin: 0 5px 0 5px
}

#slideCounter{
 cursor: pointer;
}

#toc{
 display: none;
 position: absolute;
 font-size: .75em;
 bottom: 2em;
 right: 0;
 background: #fff;
 border: 1px solid #000;
 text-align: left;
}

.tocJumpItem input{
 margin-left: 1em;
 width: 3em
}

.tocLevel1{
 font-size: .8em;
}

.tocLevel2{
 margin-left: 1em;
 font-size: .75em;
}

.tocLevel3{
 margin-left: 2em;
 font-size: .7em;
}

.tocLevel4{
 margin-left: 3em;
 font-size: .65em;
}

.tocLevel5{
 margin-left: 4em;
 font-size: .6em;
}

.tocLevel6{
 margin-left: 5em;
 font-size: .55em;
}
/*}}}*/</pre>
</div>
<div title="SlideStyleLinks" modifier="JohnRouillard" created="200908060308" modified="201007051912" tags="structure excludeStory excludeOrphans excludeMissing">
<pre>These sections are used in presentations to provide the text before the buttons that start the slideshows (so the tiddlers mentioned aren't included in the slideshow). Make sure each section is only one line. No blank lines as they display as blank lines when used. The end section merely defines the end for the print section.

!Instructor
Instructor show with theme {{exclude{[[InstructorSlideShowStyleSheet]]}}}:
!Student
Student show with theme  {{exclude{SlideShowStyleSheet}}}:
!Print
Print show with theme {{exclude{[[PrintingSlideShowStyleSheet]]}}}:
!end</pre>
</div>
<div title="SlideSubstyle" modifier="JohnRouillard" created="201007252206" modified="201007311811">
<pre>This tiddler has jQuery scripts that can be included in side of slides to dynamically change the layout.
!levelOne
&lt;script&gt;
if ( jQuery(&quot;body .slideShowMode&quot;).length == 0) return;
// We are in slide show mode since the body has a slideShowMode class inside it
if ( jQuery(&quot;body .InstructorSlideShowStyleSheet&quot;).length == 0) return;
// We are running an instructor slide show so do all the bells and whistles

if ( '$1' == &quot;$&quot; + &quot;1&quot; ) {background=&quot;none&quot; } else {background = '$1';};
if ( typeof lastBackground == &quot;undefined&quot;) {
     // Assume levelOne will be used as the first substyle. So save the default bg and repeat setting in case
     // they are needed later.
     lastBackground=jQuery(&quot;body&quot;).css(&quot;background-image&quot;);
     lastBackgroundRepeat=jQuery(&quot;body&quot;).css(&quot;background-repeat&quot;);
}

// Empty existing style
jQuery(&quot;#SlideShowDynamicStyle&quot;).text(&quot;&quot;);

// set the style elements in the SlideShowDynamicStyle id'ed style element reserved for our use
jQuery(&quot;#SlideShowDynamicStyle&quot;).append(&quot;.slideShowMode .title {display: none !important}\n&quot;); // ditch the title
jQuery(&quot;#SlideShowDynamicStyle&quot;).append(&quot;body {background-image: &quot; + background + &quot;  }\n&quot; ); // set a background image from the argument
jQuery(&quot;#SlideShowDynamicStyle&quot;).append(&quot;body {background-repeat: no-repeat }\n&quot;); // no repeat
jQuery(&quot;#SlideShowDynamicStyle&quot;).append(&quot;body {-moz-background-size: 100%,auto }\n&quot;); // use firefox for display scale image 100% horiz.
&lt;/script&gt;
!levelTwo
&lt;script&gt;
if ( jQuery(&quot;body .slideShowMode&quot;).length == 0) return;
// We are in slide show mode since the body has a slideShowMode class inside it
/* revert to the basic style sheets either by undoing what was done above or .....
    if ( '$1' == &quot;$&quot; + &quot;1&quot; ) {background=lastBackground; bgrepeat=lastBackgroundRepeat} else {background = '$1'; bgrepeat=&quot;no-repeat&quot;;};
    jQuery(&quot;#SlideShowDynamicStyle&quot;).append(&quot;.slideShowMode .title {visibility: visible}\n&quot;)
    jQuery(&quot;#SlideShowDynamicStyle&quot;).append(&quot;.slideShowMode .title {display: block}\n&quot;);
    jQuery(&quot;#SlideShowDynamicStyle&quot;).append(&quot;body {background-image: &quot; + background + &quot; }\n&quot; );
    jQuery(&quot;#SlideShowDynamicStyle&quot;).append(&quot;body {background-repeat: &quot; + bgrepeat + &quot; }\n&quot;);
    jQuery(&quot;#SlideShowDynamicStyle&quot;).append(&quot;body {-moz-background-size: auto,auto }\n&quot;);
*/
// just empty the style that is reserved for our use.
jQuery(&quot;#SlideShowDynamicStyle&quot;).text(&quot;&quot;);
&lt;/script&gt;
!levelThree
&lt;script&gt;
if ( jQuery(&quot;body .slideShowMode&quot;).length == 0) return;
// We are in slide show mode since the body has a slideShowMode class inside it
if ( jQuery(&quot;body .InstructorSlideShowStyleSheet&quot;).length == 0) return;
// we are running an instructor slide show so do all the bells and whistles

// Empty existing style
jQuery(&quot;#SlideShowDynamicStyle&quot;).text(&quot;&quot;);

jQuery(&quot;#SlideShowDynamicStyle&quot;).append(&quot;.slideShowMode .title {background-color: #FF0000}\n&quot;);
&lt;/script&gt;
!end</pre>
</div>
<div title="SparklinePlugin" modifier="JohnRouillard" created="200804070000" modified="200909070218" tags="systemConfig InstructorOnly">
<pre>/***
|''Name''|SparklinePlugin|
|''Description''|provides support for [[sparklines|http://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0001OR&amp;topic_id=1]]|
|''Version''|1.0.0|
|''Status''|stable|
|''Source''|http://www.tiddlywiki.com/coreplugins.html#SparklinePlugin|
|''~CodeRepository:''|http://svn.tiddlywiki.org/Trunk/association/plugins/SparklinePlugin/SparklinePlugin.js |
|''License''|[[BSD open source license]]|
|''~CoreVersion''|2.3.0|
|''Feedback''|[[TiddlyWiki community|http://groups.google.com/group/TiddlyWiki]] |
|''Keywords''|visualization|
!Usage
{{{
&lt;&lt;sparkline numbers&gt;&gt;
}}}
The macro accepts space-separated numeric values as parameter.
!!Examples
Activity on http://www.tiddlywiki.com during the month of April 2005:
{{{&lt;&lt;sparkline 163 218 231 236 232 266 176 249 289 1041 1835 2285 3098 2101 1755 3283 3353 3335 2898 2224 1404 1354 1825 1839 2142 1942 1784 1145 979 1328 1611&gt;&gt;}}}
&lt;&lt;sparkline 163 218 231 236 232 266 176 249 289 1041 1835 2285 3098 2101 1755 3283 3353 3335 2898 2224 1404 1354 1825 1839 2142 1942 1784 1145 979 1328 1611&gt;&gt;
!Code
***/
//{{{
if(!version.extensions.SparklinePlugin) {
version.extensions.SparklinePlugin = {installed:true};

//--
//-- Sparklines
//--

config.macros.sparkline = {};
config.macros.sparkline.handler = function(place,macroName,params)
{
	var data = [];
	var min = 0;
	var max = 0;
	var v;
	for(var t=0; t&lt;params.length; t++) {
		v = parseInt(params[t]);
		if(v &lt; min)
			min = v;
		if(v &gt; max)
			max = v;
		data.push(v);
	}
	if(data.length &lt; 1)
		return;
	var box = createTiddlyElement(place,&quot;span&quot;,null,&quot;sparkline&quot;,String.fromCharCode(160));
	box.title = data.join(&quot;,&quot;);
	var w = box.offsetWidth;
	var h = box.offsetHeight;
	box.style.paddingRight = (data.length * 2 - w) + &quot;px&quot;;
	box.style.position = &quot;relative&quot;;
	for(var d=0; d&lt;data.length; d++) {
		var tick = document.createElement(&quot;img&quot;);
		tick.border = 0;
		tick.className = &quot;sparktick&quot;;
		tick.style.position = &quot;absolute&quot;;
		tick.src = &quot;data:image/gif,GIF89a%01%00%01%00%91%FF%00%FF%FF%FF%00%00%00%C0%C0%C0%00%00%00!%F9%04%01%00%00%02%00%2C%00%00%00%00%01%00%01%00%40%02%02T%01%00%3B&quot;;
		tick.style.left = d*2 + &quot;px&quot;;
		tick.style.width = &quot;2px&quot;;
		v = Math.floor(((data[d] - min)/(max-min)) * h);
		tick.style.top = (h-v) + &quot;px&quot;;
		tick.style.height = v + &quot;px&quot;;
		box.appendChild(tick);
	}
};


}
//}}}</pre>
</div>
<div title="SplitTiddler" modifier="ELSDesignStudios" created="200802180331" modified="201006110909" tags="html InstructorOnly">
<pre>/%
|Name|SplitTiddler|
|Source|http://www.TiddlyTools.com/#SplitTiddler|
|Version|1.9.5|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|html|
|Description|split tiddler contents into separate tiddlers|

%/&lt;html&gt;&lt;nowiki&gt;&lt;style&gt;
#tiddlerSplitTiddler .tagged { display:none; }
#tiddlerSplitTiddler .label { font-size:90%;font-style:italic;white-space:nowrap; }
#tiddlerSplitTiddler table, #tiddlerSplitTiddler tr, #tiddlerSplitTiddler td
	{ border:0; margin:0; padding:0; }
&lt;/style&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;form&gt;
&lt;table style='width:100%'&gt;&lt;tr&gt;&lt;td style='width:20%'&gt;
	&lt;div class='label'&gt;source tiddler:&lt;/div&gt;
	&lt;select name='src' value='' style='width:99%;padding:2px;margin:0'
		title='select a tiddler containing source material'&gt;
	&lt;option value=''&gt;select a tiddler...&lt;/option&gt;
	&lt;/select&gt;
&lt;/td&gt;&lt;td style='width:20%'&gt;
	&lt;div class='label'&gt;target title format:&lt;/div&gt;
	&lt;input name='titleformat' value='%0 - %1' style='width:99%'
		title='format for target tiddler titles'&gt;
&lt;/td&gt;&lt;td style='width:20%'&gt;
	&lt;div class='label'&gt;output format:&lt;/div&gt;
	&lt;input name='format' value='%4' style='width:99%'
		title='format for target tiddler content'&gt;
&lt;/td&gt;&lt;td style='width:20%'&gt;
	&lt;div class='label'&gt;target field:&lt;/div&gt;
	&lt;input name='fieldname' value='text' style='width:99%'
		title='field to hold content in target tiddler'&gt;
&lt;/td&gt;&lt;td style='width:20%'&gt;
	&lt;div class='label'&gt;add tags:&lt;/div&gt;
	&lt;input name='tags' value='' style='width:99%'
		title='tags for target tiddlers'&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;div style='font-size:80%;font-style:italic;text-align:center;color:gray'&gt;
%0=source title, %1=first line of item, %2=first word of item, %3=item number, %4=item content
&lt;/div&gt;
&lt;div style='float:left;margin-right:1em'&gt;
&lt;div class='label'&gt;split source content by:&lt;/div&gt;
&lt;div style='line-height:2.1em'&gt;
&lt;input type='radio' name='splitby' value='charcount'&gt;every
&lt;input name='charcount' value='1000' onfocus='this.select()' style='width:3em'
	title='split content every N characters'&gt; characters&lt;br&gt;
&lt;input type='radio' name='splitby' value='linecount'&gt;every
&lt;input name='linecount' value='20' onfocus='this.select()' style='width:3em'
	title='split content every N lines'&gt; lines&lt;br&gt;
&lt;input type='radio' name='splitby' value='match' CHECKED&gt;match
&lt;input name='sep' value='\n----\n' onfocus='this.select()' style='width:8em'
	title='match character sequence to split content'&gt;&lt;br&gt;
&amp;nbsp; &lt;input type='checkbox' name='regexp' title='match using regular expressions (text patterns)'&gt;use RegExp text pattern&lt;br&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div style='float:left;margin-right:1em'&gt;
&lt;div class='label'&gt;options:&lt;/div&gt;
&lt;input type='checkbox' name='warn' checked&gt;confirm overwrites&lt;br&gt;
&lt;input type='checkbox' name='show'&gt;show tiddlers when done&lt;br&gt;
&lt;input type='checkbox' name='limit'&gt;create only
&lt;input name='maxtids' value='8' style='width:2em'&gt; tiddlers&lt;br&gt;
&lt;input type='checkbox' name='index' checked&gt;create an index tiddler&lt;br&gt;
&amp;nbsp;&amp;nbsp; index item format:
&lt;input name='indexformat' value='&lt;&lt;tiddler [[%0 - %1]]&gt;&gt;' style='width:10em'
	title='%0=target tiddler title'&gt;
&lt;/div&gt;
&lt;input type='button' style='float:right;height:5em;margin-top:2.5em' value='split tiddler' onclick=&quot;
	var f=this.form;
	if (!f.src.value.length)
		{ alert('select a tiddler title'); f.src.focus(); return false; }
	if (!f.titleformat.value.length)
		{ alert('enter a target title format'); f.titleformat.focus(); return false; }
	if (!f.src.value.length)
		{ alert('enter an output item format'); f.format.focus(); return false; }
	var start=new Date().getTime();
	var src=store.getTiddlerText(f.src.value);
	if (!src) { displayMessage('\x27'+f.src.value+'\x27 not found'); return false; }
	var tags=f.tags.value;
	var parts=[];
	if (f.splitby[0].checked) { /* chars */
		for (var i=0; i&lt;src.length; i+=f.charcount.value)
			parts.push(src.substr(i,f.charcount.value));
	} else if (f.splitby[1].checked) { /* lines */
		var lines=src.split('\n');
		var t=''; var c=f.linecount.value;
		while (lines.length) {
			t+=lines.shift()+'\n'; c--;
			if (!c) { parts.push(t); var c=f.linecount.value; t=''; }
		}
	} else { /* match text/regexp */
		var sep=!f.regexp.checked?f.sep.value.unescapeLineBreaks():new RegExp(f.sep.value);
		var pieces=src.split(sep);
		for (var i=0; i&lt;pieces.length; i++) if (pieces[i].length) parts.push(pieces[i]);
	}
	var msg='Found '+parts.length+' items in \x27'+f.src.value+'\x27. OK to proceed?';
	if (!confirm(msg)) return false;
	if (parts.length) store.suspendNotifications();
	var pad=parts.length.toString().length;
	var tids=[]; var out=[];
	var srctitle=f.src.value;
	var fmt=f.format.value.unescapeLineBreaks();
	var titlefmt=f.titleformat.value.unescapeLineBreaks();
	var fieldname=f.fieldname.value.toLowerCase();
	var indexfmt=f.indexformat.value.unescapeLineBreaks();
	var max=f.limit.checked?f.maxtids.value:parts.length;
	var warn=f.warn.checked;
	for (var p=0; p&lt;max; p++) {
		var lines=parts[p].split('\n');
		var firstline=lines[0];
		var firstword=firstline.split(' ')[0];
		var itemnum=String.zeroPad(p+1,pad);
		if (titlefmt.indexOf('%2')!=-1) /* remove firstword if used in title */
			{ var words=lines[0].split(' '); words.shift(); lines[0]=words.join(' '); var discard=!words.length; }
		if (titlefmt.indexOf('%1')!=-1 || discard) /* remove firstline if used in title */
			lines.shift();
		var content=lines.join('\n');
		var args=[srctitle,firstline,firstword,itemnum,content];
		var tid=titlefmt.format(args).replace(/[\[\]\|]/g,'_');
		var txt=fmt.format(args);
		var fields={}; if (fieldname!='text')
			{ fields[fieldname]=txt; txt='&lt;&lt;view '+fieldname+' wikified&gt;&gt;'; }
		var tags=tags.format(args);
		if (warn &amp;&amp; store.tiddlerExists(tid) &amp;&amp; !confirm(config.messages.overwriteWarning.format([tid])))
			continue;
		store.saveTiddler(tid,tid,txt,config.options.txtUserName,new Date(),tags,fields);
		if (f.index.checked) out.push(indexfmt.format(args));
		tids.pushUnique(tid);
	}
	var elapsed=(new Date().getTime()-start)/1000;
	if (parts.length) store.resumeNotifications();
	if (tids.length) {
		if (f.index.checked) {
			var tid=f.src.value+'Index';
			if (!warn||!store.tiddlerExists(tid)||confirm(config.messages.overwriteWarning.format([tid])))
				store.saveTiddler(tid,tid,out.join('\n'),config.options.txtUserName,new Date(),[],{});
		}
		store.notifyAll();
		if (f.show.checked) story.displayTiddlers(story.findContainingTiddler(this),tids);
		displayMessage('created '+tids.length+' target tiddlers in '+elapsed+' seconds');
	}
&quot;&gt;&lt;div style='clear:both'&gt;&lt;/div&gt;
&lt;/form&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/html&gt;&lt;&lt;tiddler {{
	var list=place.lastChild.getElementsByTagName('form')[0].src;
	store.forEachTiddler(function(title,tiddler){
		list.options[list.length]=new Option(title,title);
	});
'';}}&gt;&gt;</pre>
</div>
<div title="Splitting Chapters" modifier="JohnRouillard" created="200908292029" modified="201007311949" tags="InstructorOnly directions">
<pre>Before splitting a tiddler:

# rename source tiddler to &quot;SOURCE Chapter ....&quot;
# add InstructorOnly tag to SOURCE tiddler

To split:

# Open SplitTiddler. In SplitTiddler:
## Select the SOURCE tiddler (may need to close/refresh to get updated list)
## Set target title format {{{Chapter  X - %1}}}
## Set output format: {{{%4}}}
## add the tag &quot;content&quot;
## split on section headings so: {{{^! |\n! }}} using match mechanism
## check use ~RegExp text pattern
## check:
*** Confirm overwrites
*** show tiddlers when done
*** create an index tiddler
# index item format: {{{[[Chapter  X - %1]]}}} to match the target title format

After split:
# delete any TOC only tiddlers
# Check the first tidder the %1 text can be the first line of the tiddler if there is no starting section header. Paste the text into the tiddler and create a section head.
# Look for new orphaned references to original tiddler as it is unlikely that the new story tiddler will be the best reference.
# Rename index tiddler to original SOURCE tiddler name
# remove the TOC tiddler from the index tiddler, add any created section head for the first tiddler, and add the index tiddler so it open as part of the story as a TOC.
# tag the index tiddler with &quot;chapter story excludeOrphans&quot; and bblisa if needed

Use the sequence:
{{{#chapter -#story -#InstructorOnly}}}
in the search box to list tiddlers tagged with chapter that are not tagged with stories or InstructorOnly. This should be the empty set if everything is done.

Now you need to view the missing tiddlers sequence since the names have changed and previously valid links may not longer be.</pre>
</div>
<div title="Start SingleTiddlerSlideshowTest" modifier="JohnRouillard" created="201007051958" modified="201007052000" tags="InstructorOnly">
<pre>&lt;&lt;slideShow  theme:InstructorSlideShowStyleSheet noClicks tod:headers footer:&quot;copyright&amp;copy; 2010&lt;br /&gt;John Rouillard&quot; clock:+ label:&quot;Instructor&quot; tooltip:&quot;Start slideshow in instructor projection mode&quot;' tiddler:SingleTiddlerSlideshowTest single&gt;&gt;
</pre>
</div>
<div title="StorySaverPlugin" modifier="ELSDesignStudios" created="200710051746" modified="200910201719" tags="systemConfig NavigationPackage">
<pre>/***
|Name|StorySaverPlugin|
|Source|http://www.TiddlyTools.com/#StorySaverPlugin|
|Documentation|http://www.TiddlyTools.com/#StorySaverPluginInfo|
|Version|1.8.3|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Requires|MarkupPostBody|
|Description|save/restore current tiddler view between browser sessions|
Automatically save a list of currently viewed tiddlers (the 'story') in a local cookie, {{{txtSavedStory}}} and then open those tiddlers when the document is reloaded, so you can resume working from the same place you left off!!  Also, use {{{&lt;&lt;saveStory&gt;&gt;}}} and {{{&lt;&lt;openStory&gt;&gt;}}} macros to quickly save/re-display stories stored in tiddlers, using a command link, droplist, or popup display.
!!!!!Documentation
&gt;see [[StorySaverPluginInfo]]
!!!!!Configuration
&lt;&lt;&lt;
&lt;&lt;option chkSaveStory&gt;&gt; use automatic story cookie (reopens tiddlers on startup)
&lt;&lt;option chkStoryAllowAdd&gt;&gt;include 'add a story' command in droplist/popup
&lt;&lt;option chkStoryFold&gt;&gt;fold story tiddlers when opening a story (see [[CollapseTiddlersPlugin]])
&lt;&lt;option chkStoryClose&gt;&gt;close other tiddlers when opening a story
&lt;&lt;option chkStoryTop&gt;&gt;open story tiddlers at top of column
&lt;&lt;option chkStoryBottom&gt;&gt;open story tiddlers at bottom of column
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.10.20 1.8.3 fix handling for 'add' item in popup menu
|please see [[StorySaverPluginInfo]] for additional revision details|
2007.10.05 1.0.0 initial release. Moved [[SetDefaultTiddlers]] inline script and rewrote as a {{{&lt;&lt;saveStory&gt;&gt;}}} macro.
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.StorySaverPlugin= {major: 1, minor: 8, revision: 3, date: new Date(2009,10,20)};

var defaults={
	chkSaveStory:		false,
	chkStoryFold:		true,
	chkStoryClose:		true,
	chkStoryAllowAdd:	true,
	chkStoryTop:		true,
	chkStoryBottom:		false
};
for (var id in defaults) if (config.options[id]===undefined)
	config.options[id]=defaults[id];

// if removeCookie() function is not defined by TW core, define it here.
if (window.removeCookie===undefined) {
	window.removeCookie=function(name) {
		document.cookie = name+'=; expires=Thu, 01-Jan-1970 00:00:01 UTC; path=/;'; 
	}
}

// save or clear story cookie on exit
if (window.coreTweaks_confirmExit==undefined) {
	window.coreTweaks_confirmExit=window.confirmExit;
	window.confirmExit=function() {
		if (config.options.chkSaveStory) { // save cookie
			var links=[];
			story.forEachTiddler(function(title,element){links.push('[['+title+']]');});
			config.options.txtSavedStory=links.join(' ');
			saveOptionCookie('txtSavedStory');
		} else removeCookie('txtSavedStory');
		return window.coreTweaks_confirmExit.apply(this,arguments);
	}
}
//}}}
/***
''apply saved story on startup:'' //important note: the following code is actually located in [[MarkupPostBody]].  This is because it needs to supercede the core's getParameters() function, which is called BEFORE plugins are loaded, preventing the normal plugin-based hijack method from working, while code loaded into [[MarkupPostBody]] will be processed as soon as the document is read, even before the TW main() function is invoked.//
&lt;&lt;tiddler MarkupPostBody&gt;&gt;
***/
//{{{
config.macros.saveStory = {
	label: 'set default tiddlers',
	defaultTiddler: 'DefaultTiddlers',
	prompt: 'store a list of currently displayed tiddlers in another tiddler',
	askMsg: 'Enter the name of a tiddler in which to save the current story:',
	tag: 'story',
	excludeTag: 'excludeStory',
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		var tid=params.shift()||'DefaultTiddlers';
		var label=params.shift()||this.label;
		var tip=params.shift()||this.prompt;
		var btn=createTiddlyButton(place,label,tip,this.setTiddler,'button');
		btn.setAttribute('tid',tid);
		btn.setAttribute('extratags','[['+params.join(']] [[')+']]');
	},
	setTiddler: function() {
		var cms=config.macros.saveStory; // abbrev
		// get list of current open tiddlers
		var tids=[];
		story.forEachTiddler(function(title,element){
			var t=store.getTiddler(title);
			if (!t || !t.isTagged(cms.excludeTag)) tids.push('[['+title+']]');
		});
		// get target tiddler
		var tid=this.getAttribute('tid');
		if (!tid || tid=='ask') {
			tid=prompt(cms.askMsg,cms.defaultTiddler);
			if (!tid || !tid.length) return false; // cancelled by user
		}
		if(store.tiddlerExists(tid) &amp;&amp; !confirm(config.messages.overwriteWarning.format([tid])))
			return false;
		tids=tids.join('\n');
		var t=store.getTiddler(tid); var tags=t?t.tags:[];
		var extratags=(this.getAttribute('extratags')||'').readBracketedList();
		for (var i=0; i&lt;extratags.length; i++) tags.pushUnique(extratags[i]);
		tags.pushUnique(cms.tag);
		store.saveTiddler(tid,tid,tids,config.options.txtUserName,new Date(),tags,t?t.fields:null);
		story.displayTiddler(null,tid);
		story.refreshTiddler(tid,null,true);
		displayMessage(tid+' has been '+(t?'updated':'created'));
		return false;
	}
}
//}}}
//{{{
config.macros.openStory = {
	label: 'open story: %0',
	prompt: 'open the set of tiddlers listed in: %0',
	popuplabel: 'stories',
	popupprompt: 'view a set of tiddlers',
	tag: 'story',
	selectprompt: 'select a story...',
	optionsprompt: 'viewing options...',
	foldcmd: '[%0] fold story',
	foldprompt: 'fold story tiddlers when opening a story',
	closecmd: '[%0] close others',
	closeprompt: 'close other tiddlers when opening a story',
	topcmd: '[%0] open at top',
	topprompt: 'open story tiddlers at top of column',
	bottomcmd: '[%0] open at bottom',
	bottomprompt: 'open story tiddlers at bottom of column',
	addcmd: 'add a story...',
	addprompt: 'create a new story',
	excludeTag: 'excludeStory',
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		if (params[0].toLowerCase()=='list') return this.createList(place,params);
		else if (params[0].toLowerCase()=='popup') return this.createPopup(place,params);
		else this.createButton(place,params);
	},
	showStory: function(tid,fold) {
		var co=config.options; // abbrev
		var tids=[];
		var t=store.getTiddler(tid);
		var tagged=store.getTaggedTiddlers(tid,'title');
		if (tagged.length) // if tiddler IS a tag, use tagged tiddlers as story
			for (var i=0; i&lt;tagged.length; i++) tids.push(tagged[i].title);
		else if (t) { // get tiddler list from content
			if (!t.linksUpdated) t.changed();
			for (var i=0; i&lt;t.links.length; i++) {
				var tid=store.getTiddler(t.links[i]);
				if (tid &amp;&amp; !tid.isTagged(this.excludeTag))
					tids.push(t.links[i]);
			}
		}
		var template=null;
		if (fold||co.chkStoryFold) template='CollapsedTemplate'; // see [[CollapseTiddlersPlugin]]
		if (!store.tiddlerExists('CollapsedTemplate')) template=null;
		if (co.chkStoryClose) story.closeAllTiddlers();
		var pos='top'; var first=tids[0];
		if (!story.isEmpty() &amp;&amp; co.chkStoryBottom) { pos='bottom'; tids=tids.reverse(); }
		story.displayTiddlers(pos,tids,template);
		var cmd='var t=story.getTiddler(&quot;'+first+'&quot;);if(t)window.scrollTo(0,t.offsetTop);';
		var delay=config.options.chkAnimate?config.animDuration+100:0;
		setTimeout(cmd,delay);
	},
	createButton: function(place,params) {
		var tid=params[0]||'';
		var label=params[1]||this.label; label=label.format([tid]);
		var tip=params[2]||this.prompt; tip=tip.format([tid]);
		var fold=(params[3]&amp;&amp;(params[3].toLowerCase()=='fold'))||config.options.chkStoryFold;
		var fn=function(){config.macros.openStory.showStory(this.getAttribute('tid'),this.getAttribute('fold')); return false; };
		var btn=createTiddlyButton(place,label,tip,fn,'button');
		btn.setAttribute('tid',tid);
		if (fold) btn.setAttribute('fold',fold);
	},
	createPopup: function(place,params) {
		params.shift(); // discard 'popup' keyword
		var label=params.shift()||this.popuplabel;
		var tip=params.shift()||this.popupprompt;
		var btn=createTiddlyButton(place,label,tip,this.showPopup,'button');
		btn.setAttribute('filter',params.shift()||config.macros.openStory.tag);
	},
	showPopup: function(ev) { var e=ev||window.event;
		var co=config.options; // abbrev
		var cmo=config.macros.openStory; // abbrev
		var indent='\xa0\xa0';
		var p=Popup.create(this); if (!p) return false;
		createTiddlyText(createTiddlyElement(p,'li'),cmo.selectprompt);
		var stories=store.filterTiddlers('[tag['+this.getAttribute('filter')+']]');
		for (var s=0; s&lt;stories.length; s++) {
			var label=indent+stories[s].title;
			var tip=cmo.prompt.format([stories[s].title]);
			var fn=function(){config.macros.openStory.showStory(this.getAttribute('tid'));return false;};
			var btn=createTiddlyButton(createTiddlyElement(p,'li'),label,tip,fn,'button');
			btn.setAttribute('tid',stories[s].title);
		}
		createTiddlyText(createTiddlyElement(p,'li'),cmo.optionsprompt);
		if (store.tiddlerExists('CollapsedTemplate')) {
			var label=indent+cmo.foldcmd.format([co.chkStoryFold?'x':'\xa0\xa0']);
			var tip=cmo.foldprompt;
			var fn=function(){ config.macros.option.propagateOption(
				'chkStoryFold','checked',!config.options.chkStoryFold,'input'); return false; };
			var btn=createTiddlyButton(createTiddlyElement(p,'li'),label,tip,fn,'button');
		}
		var label=indent+cmo.closecmd.format([co.chkStoryClose?'x':'\xa0\xa0']);
		var tip=indent+cmo.closeprompt;
		var fn=function(){ config.macros.option.propagateOption(
			'chkStoryClose','checked',!config.options.chkStoryClose,'input'); return false; };
		var btn=createTiddlyButton(createTiddlyElement(p,'li'),label,tip,fn,'button');
		if (!co.chkStoryClose) {
			var label=indent+cmo.topcmd.format([co.chkStoryTop?'x':'\xa0\xa0']);
			var tip=indent+cmo.topprompt;
			var fn=function(){
				config.macros.option.propagateOption(
					'chkStoryTop','checked',!config.options.chkStoryTop,'input');
				config.macros.option.propagateOption(
					'chkStoryBottom','checked',!config.options.chkStoryTop,'input');
				return false;
			};
			var btn=createTiddlyButton(createTiddlyElement(p,'li'),label,tip,fn,'button');
			var label=indent+cmo.bottomcmd.format([co.chkStoryBottom?'x':'\xa0\xa0']);
			var tip=indent+cmo.botprompt;
			var fn=function(){
				config.macros.option.propagateOption(
					'chkStoryBottom','checked',!config.options.chkStoryBottom,'input');
				config.macros.option.propagateOption(
					'chkStoryTop','checked',!config.options.chkStoryBottom,'input');
				return false;
			};
			var btn=createTiddlyButton(createTiddlyElement(p,'li'),label,tip,fn,'button');
		}
		if (!readOnly &amp;&amp; co.chkStoryAllowAdd) {
			var label=cmo.addcmd;
			var tip=cmo.addprompt;
			var fn=config.macros.saveStory.setTiddler;
			createTiddlyElement(createTiddlyElement(p,'li'),'hr');
			var btn=createTiddlyButton(createTiddlyElement(p,'li'),label,tip,fn,'button');
		}
		Popup.show();
		e.cancelBubble=true;if(e.stopPropagation)e.stopPropagation();
		return false;
	},
	createList: function(place,params) {
		var cmo=config.macros.openStory; // abbrev
		var s=createTiddlyElement(place,'select',null,'storyListbox');
		s.size=1;
		s.onchange=function() {
			if (this.value=='_fold') {
				config.macros.option.propagateOption('chkStoryFold','checked',
					!config.options.chkStoryFold,'input');
				cmo.refreshList();
			} else if (this.value=='_close') {
				config.macros.option.propagateOption('chkStoryClose','checked',
					!config.options.chkStoryClose,'input');
				cmo.refreshList();
			} else if (this.value=='_top') {
				config.macros.option.propagateOption('chkStoryTop','checked',
					!config.options.chkStoryTop,'input');
				cmo.refreshList();
			} else if (this.value=='_bottom') {
				config.macros.option.propagateOption('chkStoryBottom','checked',
					!config.options.chkStoryBottom,'input');
				cmo.refreshList();
			} else if (this.value=='_add')
				config.macros.saveStory.setTiddler.apply(this,arguments);
			else cmo.showStory(this.value);
		}
		params.shift(); // discard 'list' keyword
		s.setAttribute('filter',params.shift()||cmo.tag);
		setStylesheet('.storyListbox { width:100%; }', 'StorySaverStyles');
		store.addNotification(null,this.refreshList); this.refreshList();
		return;
	},
	refreshList: function() {
		var cmo=config.macros.openStory; // abbrev
		var indent='\xa0\xa0\xa0\xa0';
		var lists=document.getElementsByTagName('select');
		for (var i=0; i&lt;lists.length; i++) { if (lists[i].className!='storyListbox') continue;
			var here=lists[i];
			var stories=store.filterTiddlers('[tag['+here.getAttribute('filter')+']]');
			while (here.length) here.options[0]=null; // remove current list items
			here.options[here.length]=new Option(cmo.selectprompt,'',true,true);
			for (var s=0; s&lt;stories.length; s++)
				here.options[here.length]=new Option(indent+stories[s].title,stories[s].title);
			if (!readOnly &amp;&amp; config.options.chkStoryAllowAdd)
				here.options[here.length]=new Option(cmo.addcmd,'_add');
			here.options[here.length]=new Option(cmo.optionsprompt,'');
			if (store.tiddlerExists('CollapsedTemplate')) {
				var msg=cmo.foldcmd.format([config.options.chkStoryFold?'x':'\xa0\xa0']);
				here.options[here.length]=new Option(indent+msg,'_fold');
			}
			var msg=cmo.closecmd.format([config.options.chkStoryClose?'x':'\xa0\xa0']);
			here.options[here.length]=new Option(indent+msg,'_close',false,false);
			if (!config.options.chkStoryClose) {
				var msg=cmo.topcmd.format([config.options.chkStoryTop?'x':'\xa0\xa0']);
				here.options[here.length]=new Option(indent+msg,'_top',false,false);
				var msg=cmo.bottomcmd.format([config.options.chkStoryBottom?'x':'\xa0\xa0']);
				here.options[here.length]=new Option(indent+msg,'_bottom',false,false);
			}
		}
	}
}
//}}}</pre>
</div>
<div title="StorySaverPluginConfig" modifier="JohnRouillard" created="200907271324" modified="200908260247" tags="systemConfig structure">
<pre>/***
! StorySaverPlugin

Try to override text for the popup. Remove the word story add section.
***/
//{{{
config.macros.openStory.label = &quot;open: %0&quot;;
config.macros.openStory.popuplabel = &quot;section&quot;;
config.macros.openStory.selectprompt = &quot;select a section...&quot;;
config.macros.openStory.foldprompt = &quot;fold story tiddlers when opening a section&quot;;
config.macros.openStory.closeprompt = &quot;close other tiddlers when opening a section&quot;;

config.options.chkStoryAllowAdd = false;
//}}}</pre>
</div>
<div title="StorySaverPluginInfo" modifier="ELSDesignStudios" created="200710051746" modified="200910201719" tags="pluginInfo excludeMissing">
<pre>/***
|Name|StorySaverPlugin|
|Source|http://www.TiddlyTools.com/#StorySaverPlugin|
|Documentation|http://www.TiddlyTools.com/#StorySaverPluginInfo|
|Version|1.8.3|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|documentation|
|Requires|MarkupPostBody|
|Description|documentation for [[StorySaverPlugin]]|
Automatically saves a list of currently viewed tiddlers (the &quot;story&quot;) in a local cookie, {{{txtSavedStory}}} and then opens those tiddlers when the document is subsequently reloaded, allowing you to quickly resume working with the document from the same place you left off!! The plugin also defines {{{&lt;&lt;saveStory&gt;&gt;}}} and {{{&lt;&lt;openStory&gt;&gt;}}} macros that allow you to quickly save/re-display stories stored in tiddlers, using simple, one-click command links or droplists.
!!!!!Usage
&lt;&lt;&lt;
If a document URL does not contain a paramifier (i.e., a &quot;#...&quot; suffix), then the saved story cookie (if any) will be used //as if// it had been entered as a permaview (e.g., a &quot;#tiddler tiddler tiddler...&quot; suffix on the URL), bypassing the [[DefaultTiddlers]] definition.  This behavior is automatically applied whenever the plugin is installed in your document.  You can enable/disable the automatic cookie-based StorySaver feature by using the checkbox below:
&gt;&lt;&lt;option chkSaveStory&gt;&gt; enable StorySaverPlugin
&gt;//usage:// {{{&lt;&lt;option chkSaveStory&gt;&gt;}}}
You can also temporarily //bypass// the redisplay of a saved story ''without disabling the StorySaver cookie'' by including a trailing &quot;#&quot; at the end of the document URL.  This will cause your document to be loaded into the browser without displaying //any// initial tiddlers at all.  Alternatively, you can enter {{{#story:storyname}}} on the end of the URL (e.g., {{{#story:DefaultTiddlers}}}) to display any specific saved story, regardless of the value of the cookie-based saved story.

__''saveStory macro:''__
The {{{&lt;&lt;saveStory&gt;&gt;}}} macro lets you write the list of currently viewed tiddlers to a specified tiddler name (e.g., DefaultTiddlers, MyFavorites, etc.).  Tiddlers containing saved stories are automatically tagged with &lt;&lt;tag story&gt;&gt;, so that they can be recognized by the {{{&lt;&lt;storyViewer&gt;&gt;}}} macro (see [[StoryViewerPlugin]]).  The syntax for the {{{&lt;&lt;saveStory&gt;&gt;}}} macro is:
{{{
&lt;&lt;saveStory storyname label tooltip tag tag tag...&gt;&gt;
}}}
*''storyname''&lt;br&gt;is the target tiddler in which to save the current story.  If you use the keyword, ''ask'', in place of the tiddlername, you will be prompted to enter a tiddler title when saving the story (default: DefaultTiddlers).
*''label'' and ''tooltip''&lt;br&gt;are the link text and mouseover guide-text
*''tag tag tag...'' (optional)&lt;br&gt;are extra tags that are added when saving a story tiddler (in addition to the default&lt;&lt;tag story&gt;&gt;tag).

__''openStory macro:''__
To redisplay a saved story, the {{{&lt;&lt;openStory&gt;&gt;}}} macro can be used to embed either a droplist of all saved stories, or a link for a specified story.  Selecting from the droplist or clicking the link opens the corresponding set of tiddlers.  
{{{
&lt;&lt;openStory list tagValue&gt;&gt;
&lt;&lt;openStory popup label tooltip tagValue&gt;&gt;
&lt;&lt;openStory storyname label tooltip fold&gt;&gt;
}}}
*''list''&lt;br&gt;shows a droplist of all saved stories, plus additional commands/viewing options.  Selecting a story opens the corresponding tiddlers.
*''popup''&lt;br&gt;shows a popup display containing a list of all saved stories, plus additional commands/viewing options.  Selecting a story opens the corresponding tiddlers.  ''label'' and ''tooltip'' are optional and provide alternative display text and mouseover help text, respectively.
*''storyname''&lt;br&gt;is a tiddler containing a saved story.  //Note: You can also use a tag value as a storyname, in which case the story view will be composed of all tiddlers tagged with the specified tag value.//
*''label''&lt;br&gt;is the command link text (default: &quot;open story: %0&quot;, where %0 is replaced by the storyname).
*''tooltip''&lt;br&gt;is the command mouseover guide-text (default: &quot;open the set of tiddlers listed in: '%0'&quot;),
*''tagValue'' (optional, default='story')&lt;br&gt;specifies an alternative tag value to match when listing story tiddlers.  Note: if MatchTagsPlugin is installed, you can also use a compound //boolean tag expression//, enclosed within doubled square brackets.
*''fold''&lt;br&gt;If this optional keyword is present, the story tiddlers are initially 'folded' using [[CollapsedTemplate]] instead of the usual [[ViewTemplate]] (see [[CollapseTiddlersPlugin]]).

__''excludeStory tag:''__
Any tiddlers tagged with&lt;&lt;tag excludeStory&gt;&gt;will be automatically omitted when creating new story tiddlers with {{{&lt;&lt;saveStory&gt;&gt;}}}.  Similarly, if a tiddler that is part of a saved story is tagged with&lt;&lt;tag excludeStory&gt;&gt;, it will not be displayed when that story is opened via {{{&lt;&lt;openStory&gt;&gt;}}}.

__''PermaView command link enhancement:''__
In order to further aide in saving/restoring the list of tiddlers currently being viewed, the core {{{&lt;&lt;permaview&gt;&gt;}}} command has been enhanced, so its link value always includes the current story view tiddler list as a paramifier in the URL.  This let you quickly use the browser's right-click menu directly on the permalink command text to &quot;bookmark this link...&quot;.  Depending upon your system, you may also be able to drag the 'permaview' link directly from the page and drop it onto your desktop to create an instant permaview-bearing URL shortcut icon.
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
*{{{&lt;&lt;saveStory TestStory &quot;save a test story&quot;&gt;&gt;}}}&lt;br&gt;{{smallform{&lt;&lt;saveStory TestStory &quot;save a test story&quot;&gt;&gt;}}}
*{{{&lt;&lt;openStory TestStory&gt;&gt;}}}&lt;br&gt;&lt;&lt;openStory TestStory&gt;&gt;
*{{{&lt;&lt;openStory list&gt;&gt;}}}&lt;br&gt;{{smallform{&lt;&lt;openStory list&gt;&gt;}}}
*{{{&lt;&lt;openStory popup label tooltip&gt;&gt;}}}&lt;br&gt;{{smallform{&lt;&lt;openStory popup&gt;&gt;}}}
&lt;&lt;&lt;
!!!!!Configuration
&lt;&lt;&lt;
&lt;&lt;option chkSaveStory&gt;&gt; use automatic story cookie (reopens tiddlers on startup)
&lt;&lt;option chkStoryAllowAdd&gt;&gt;include 'add a story' command in droplist/popup
&lt;&lt;option chkStoryFold&gt;&gt;fold story tiddlers when opening a story (see [[CollapseTiddlersPlugin]])
&lt;&lt;option chkStoryClose&gt;&gt;close other tiddlers when opening a story
&lt;&lt;option chkStoryTop&gt;&gt;open story tiddlers at top of column
&lt;&lt;option chkStoryBottom&gt;&gt;open story tiddlers at bottom of column
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.10.20 1.8.3 fix handling for 'add' item in popup menu
2009.08.29 1.8.2 added 'return false' to all button handlers to fix IE page-transition error
2009.08.23 1.8.1 fixed 'excludeStory' handling for links to missing tiddlers
2009.08.20 1.8.0 added 'excludeStory' tag handling
2009.07.27 1.7.1 corrected test for {{{chkStoryAllowAdd}}} when rendering //list// output
2009.07.27 1.7.0 added options: {{{chkStoryAllowAdd=true}}}, {{{chkStoryTop=true}}}, and {{{chkStoryBottom=false}}}.  Also, autoscroll to first tiddler in story
2009.07.26 1.6.0 added optional 'extratags' param to {{{&lt;&lt;saveStory&gt;&gt;}}} and 'tagfilter' to {{{&lt;&lt;openStory&gt;&gt;}}}
2009.07.06 1.5.1 in setTiddler(), use pushUnique() to avoid double 'story' tag
2009.04.24 1.5.0 added optional 'fold' param to {{{&lt;&lt;openStory StoryName ...&gt;&gt;}}} macro
2008.09.07 1.4.3 added removeCookie() function for compatibility with [[CookieManagerPlugin]]
2008.07.11 1.4.2 in confirmExit(), corrected bracketing for titles containing spaces
2008.03.10 [*.*.*] plugin size reduction: documentation moved to [[StorySaverPluginInfo]]
2008.01.01 1.4.1 sort list of stories alphabetically
2008.01.01 1.4.0 added popup option
2007.12.31 1.3.1 instead of readBracketedList(), use internal tiddler.links[] to retrieve story list from tiddler content. Allows more flexible formatting of story tiddler content: anything content that is not a tiddler link is automatically filtered out of the list.
2007.10.23 1.3.0 split {{{&lt;&lt;storyViewer&gt;&gt;}}} macro definition into stand-alone [[StoryViewerPlugin]] to allow separate installation of story saving vs. story viewing features.
2007.10.21 1.2.0 added {{{&lt;&lt;openStory&gt;&gt;}}} and {{{&lt;&lt;storyViewer&gt;&gt;}}} macros.
2007.10.20 1.1.0 in setTiddler(), automatically add &quot;story&quot; tag to saved story tiddlers
2007.10.18 1.0.1 added default initialization for chkSaveStory option value.  Also, in setTiddler(), call displayTiddler() after saving story to ensure that altered tiddler is shown to the user.
2007.10.05 1.0.0 initial release.   Moved [[SetDefaultTiddlers]] inline script and rewrote as a {{{&lt;&lt;saveStory&gt;&gt;}}} macro.  Moved permaview &quot;mouseover HREF&quot; enhancement from [[CoreTweaks]].
&lt;&lt;&lt;</pre>
</div>
<div title="Student is a read-mostly config" modifier="YourName" created="201007251953" tags="slide content">
<pre>* Only notes are easy to edit:
** double-clicking on the notebook
** using the @@edit notes@@ button
* Content editing must be invoked by a menu, double clicking on a tiddler doesn't work
* This extra barrier inhibits student changes to content which can be overwritten during sync</pre>
</div>
<div title="StyleSheet" modifier="JohnRouillard" created="200904150141" modified="201007300135" tags="structure excludeMissing">
<pre>/*{{{*/

body {background-image: none }

/* Make the main menu fill from the left */
#mainMenu {text-align: left}
#mainMenu ul{margin-left: 0em; padding-left: 0.5em;}

/* insert a scroll bar in the message area if it gets too long say from loadTiddlers output */
#messageArea { max-height:25em; overflow:auto; }

/* custom styles for two parallel columns. Classes cola and colb */
.col2a {width:45%; float:left; margin-left:0.5em;}
.col2b {width:45%; float:left; margin-left:1.5em;}

/* custom syles for three column layout */
.col3a {width:30%; float:left; margin-left:0.5em;}
.col3b {width:30%; float:left; margin-left:1.5em;}
.col3c {width:30%; float:left; margin-left:1.5em;}

/* reset any column style */
.nocol{clear:both;display: block;}

/* used for slides with multicolumn where I don't want unordered list indented
    usually used with col2a/col2b */
.liflushleft ul{margin-left:0em !important;padding-left:0.5em !important;}

/* diagram support styles */
/* borderless tables for diagrams */
.viewer table.diagram, .viewer table.diagram * {
	border: 0;
        margin-left:auto;
        margin-right:auto;
}

/* some resizing of elements: reduce header size and space on main menu headers */
.headerForeground, .headerShadow{padding:2.5em 0 1em 1em} 
#mainMenu h1 {
margin-top: 5px;
}

/* increase width of annotation plugin popups */
.anno{max-width: 45%;}

@media print {
/* disable the stuff that is useful only online */
  /* opentiddlers index div across top of story */
#openTiddlers {display: none}

  /* remove: last changed by whom, list of tags on tiddler, table of contents,
     openstorybutton controls*/
.subtitle, .tagged, .sectionTOC, .openStoryButton {display: none}

  /* hide certain images when printing. Be nice to the environment with non-content images */
.noprintimage { display: none !important }

 /* hide empty notes when printing. With rouilj's patch to TiddlerNotesPlugin if the notes tiddler
     exists (indicating a non-empty note) the notes box also gets the TiddlerNotesExists class
     which is used to turn on printing for notes with contents while leaving empty notes blocks
     undisplayed. Controls of the box are undisplayed and for printing make the background of the
     notes box go away (transparent). Don't hide the .notes class as that also hides footnotes
     which are supposed to be printed. */
 .TiddlerNotes {display: none; background: transparent; }
 .editNotesButton {display: none}
 .TiddlerNotesExists {display: block}

/* when printing slides with comments use these styles */
div.comment {
 border: 1pt dashed;
 padding: 0.5em;
}

/* putting a box around comment spans doesn't work,
    it boxes every line so change color */
span.comment {
background: #efefef;
}

 /* slideViewTemplate is used for slides which are defined by having the slide tag as the first tag on the tiddler
     so this css rule makes every slide tiddler start on a new page. */

*[template=&quot;slideViewTemplate&quot;] {page-break-after: always}

/* try to prevent terms from being orphaned at the bottom of a page */
dt {page-break-after: avoid}

.breakhere {page-break-before:always}
}

/* Put the included style sheet here. If the style sheet doesn't exist and this include
   occurs before the @media print... above, then the print styles are used for video
   display when running IE 8 in IE 7 compatibility mode. */

[[InstructorStyleSheet]]

/*}}}*/</pre>
</div>
<div title="SwitchContent" modifier="YourName" created="200909030313" modified="201007050354" tags="InstructorOnly script excludeOrphans">
<pre>&lt;script label=&quot;$1&quot;&gt;
  /*
 &gt; This script is called with three arguments and copies the tiddler named by the
 &gt; second argument to the tiddler named by the third argument. The first argument
 &gt; is the name of the displayed button. This can be used to change tiddlers for
 &gt; different purposes. E.G. you may want to have two different copies of the
 &gt; student book. So you can use an instance of this to change the DefaultTidders
 &gt; tiddler before saving the student book.
 &gt;
  &gt; To use this inline 'onclick' script, embed the following in your
  &gt; tiddler content:
  &gt;    &lt;&lt;tiddler SwitchContent with:
  &gt;       &quot;instructor mode&quot;
  &gt;       &quot;InstructorSlideShowViewTemplate&quot;
  &gt;       &quot;SlideShowViewTemplate&quot;&gt;&gt;
  */
  if ( &quot;$2&quot; === &quot;&quot; ) { // allow shadow or other tiddler to come through
      store.deleteTiddler(&quot;$3&quot;);
  } else {
      var txt=store.getTiddlerText(&quot;$2&quot;);
      if (!txt) {displayMessage('&quot;$2&quot; not found'); return false; }
      var t=store.getTiddler('$3');
      if (!t) {displayMessage('&quot;$3&quot; not found, creating'); t = store.getTiddler('$2');}
      var who=config.options.txtUserName;
      var when=new Date();
      store.saveTiddler(&quot;$3&quot;,&quot;$3&quot;,txt,who,when,t.tags,t.fields);
      displayMessage('&quot;$2&quot; copied to &quot;$3&quot;');
   }
&lt;/script&gt;
</pre>
</div>
<div title="SyncFromSourcePlugin" modifier="JohnRouillard" created="200712211239" modified="200908021921" tags="Tools systemConfig VisualTW PatchedPlugin excludeMissing InstructorOnly systemConfigDisable" label="SyncFromSource">
<pre>/***
|''Name:''|SyncFromSourcePlugin|
|''Description:''|Synchronizes plugins from their original source (issued from plugin info) instead of imported url. So, plugins can be imported from any existing tiddlywiki and still be synchronized with their original source.|
|''Version:''|1.0.0|
|''Date:''|Dec 21,2007|
|''Source:''|http://visualtw.ouvaton.org/VisualTW.html|
|''Author:''|Pascal Collin|
|''License:''|[[BSD open source license|License]]|
|''~CoreVersion:''|2.2.0|
|''Browser:''|Firefox 1.5; InternetExplorer 6.0|
!Usage
#import the plugin, save and reload.
#a new column (source) is available in ''sync task'' from the ''backstage button''. If the plugin's source mismatches the plugin server.host (the place from which is was last imported), the source value is displayed.
#a new button is also available : ''reset source''. Click on this button applies plugin's ''source'' as server.host for the checked lines.
Look at this [[example|SyncFromSourceDemo]] on plugin [[homepage|http://visualtw.ouvaton.org/VisualTW.html]].
!Patch required for TiddlyWiki 2.3.0
A bug in TW2.3.0 requires [[SyncPatch]].
!Code
***/
//{{{
config.macros.sync.getSyncableTiddlersWithoutSource = config.macros.sync.getSyncableTiddlersWithoutSource ? config.macros.sync.getSyncableTiddlersWithoutSource : config.macros.sync.getSyncableTiddlers;

config.macros.sync.startSyncWithoutSource = config.macros.sync.startSyncWithoutSource ? config.macros.sync.startSyncWithoutSource : config.macros.sync.startSync;

config.macros.sync.getSyncableTiddlers = function(){
	var syncs = config.macros.sync.getSyncableTiddlersWithoutSource();
	for(var cpt=0;cpt&lt;syncs.length;cpt++){
		var s= getPluginInfo(syncs[cpt].tiddler).Source;
		if (s) {
			var source = AdaptorBase.minHostName(s);
			source = source.replace(/#[^#]*$/,&quot;&quot;).replace(/\/*$/,&quot;&quot;);
			syncs[cpt].source = (source==syncs[cpt].tiddler.fields[&quot;server.host&quot;]) ? &quot;&quot;: source;
		}
		else syncs[cpt].source = &quot;&quot;;
	}
	return syncs;
}

config.macros.sync.startSync = function(place) {
	config.macros.sync.startSyncWithoutSource(place);
	var w = new Wizard(place.getElementsByTagName(&quot;form&quot;)[0]);
	w.setButtons([
			{caption: this.syncLabel, tooltip: this.syncPrompt, onClick: this.doSync},
			{caption: this.syncSourceLabel, tooltip: this.syncSourcePrompt, onClick: this.doSyncSource}
		]);
}

merge(config.macros.sync,{
	syncSourceLabel : &quot;reset source&quot;,
	syncSourcePrompt : &quot;reset synchronization to plugin source, if available&quot;
})

config.macros.sync.doSyncSource = function(e)
{
	var rowNames = ListView.getSelectedRows(currSync.listView);
	for(var t=0; t&lt;currSync.syncList.length; t++) {
		var si = currSync.syncList[t];
		if((rowNames.indexOf(si.title) != -1)&amp;&amp;si.source) {
			si.tiddler.fields[&quot;server.host&quot;]=si.source;
			si.tiddler.fields[&quot;server.type&quot;]=&quot;file&quot;;
			store.setDirty(true);
		}
	}
	backstage.switchTab(null);
	return false;
};

config.macros.sync.listViewTemplate.columns.push({name: 'Source', field: 'source', title: &quot;Source&quot;, type: 'Link'});

//}}}</pre>
</div>
<div title="TabTimeline" modifier="JohnRouillard" created="200909100419" modified="200909122137" tags="InstructorOnly">
<pre>&lt;&lt;timeline &quot;&quot; 50&gt;&gt;</pre>
</div>
<div title="TableSortingPlugin" modifier="JohnRouillard" created="200711280917" modified="200903290101" tags="systemConfig PatchedPlugin excludeMissing">
<pre>/***
|''Name:''|TableSortingPlugin|
|''Description:''|Dynamically sort tables by clicking on column headers|
|''Author:''|Saq Imtiaz ( lewcid@gmail.com )|
|''Source:''|http://tw.lewcid.org/#TableSortingPlugin|
|''Code Repository:''|http://tw.lewcid.org/svn/plugins|
|''Version:''|2.02|
|''Date:''|25-01-2008|
|''License:''|[[Creative Commons Attribution-ShareAlike 3.0 License|http://creativecommons.org/licenses/by-sa/3.0/]]|
|''~CoreVersion:''|2.2.3|
!!Usage:
* Make sure your table has a header row
** {{{|Name|Phone Number|Address|h}}}&lt;br&gt; Note the /h/ that denote a header row 
* Give the table a class of 'sortable'
** {{{
|sortable|k }}}&lt;br /&gt;{{{
|Name|Phone Number|Address|h
}}}&lt;br /&gt;Note the /k/ that denotes a class name being assigned to the table.
* To disallow sorting by a column, place {{{&lt;&lt;nosort&gt;&gt;}}} in it's header
* To automatically sort a table by a column, place {{{&lt;&lt;autosort&gt;&gt;}}} in the header for that column
** Or to sort automatically but in reverse order, use {{{&lt;&lt;autosort reverse&gt;&gt;}}}

!!Example:
|sortable|k
|Name |Salary |Extension |Performance |File Size |Start date |h
|ZBloggs, Fred |$12000.00 |1353 |+1.2 |74.2Kb |Aug 19, 2003 21:34:00 |
|ABloggs, Fred |$12000.00 |1353 |1.2 |3350b |09/18/2003 |
|CBloggs, Fred |$12000 |1353 |1.200 |55.2Kb |August 18, 2003 |
|DBloggs, Fred |$12000.00 |1353 |1.2 |2100b |07/18/2003 |
|Bloggs, Fred |$12000.00 |1353 |01.20 |6.156Mb |08/17/2003 05:43 |
|Turvey, Kevin |$191200.00 |2342 |-33 |1b |02/05/1979 |
|Mbogo, Arnold |$32010.12 |2755 |-21.673 |1.2Gb |09/08/1998 |
|Shakespeare, Bill |122000.00|3211 |6 |33.22Gb |12/11/1961 |
|Shakespeare, Hamlet |9000 |9005 |-8 |3Gb |01/01/2002 |
|Fitz, Marvin |3300.30 |5554 |+5 |4Kb |05/22/1995 |

***/
// /%
//!BEGIN-PLUGIN-CODE
config.tableSorting = {
	
	darrow: &quot;\u2193&quot;,
	
	uarrow: &quot;\u2191&quot;,
	
	getText : function (o) {
		var p = o.cells[SORT_INDEX];
		return p.innerText || p.textContent || '';
	},
	
	sortTable : function (o,rev) {
		SORT_INDEX = o.getAttribute(&quot;index&quot;);
		var c = config.tableSorting;
		var T = findRelated(o.parentNode,&quot;TABLE&quot;);
		if(T.tBodies[0].rows.length&lt;=1) 
			return;
		var itm = &quot;&quot;;
		var i = 0;
		while (itm == &quot;&quot; &amp;&amp; i &lt; T.tBodies[0].rows.length) {
			itm = c.getText(T.tBodies[0].rows[i]).trim();
			i++;
		}
		if (itm == &quot;&quot;) 
			return; 	
		var r = [];
		var S = o.getElementsByTagName(&quot;span&quot;)[0];		
		c.fn = c.sortAlpha; 
		if(!isNaN(Date.parse(itm)))
			c.fn = c.sortDate; 
		else if(itm.match(/^[$|||\+|\-]{0,1}\d*\.{0,1}\d+$/)) 
			c.fn = c.sortNumber; 
		else if(itm.match(/^\d*\.{0,1}\d+[K|M|G]{0,1}b$/)) 
			c.fn = c.sortFile; 
		for(i=0; i&lt;T.tBodies[0].rows.length; i++) {
			 r[i]=T.tBodies[0].rows[i]; 
		} 
		r.sort(c.reSort);
		if(S.firstChild.nodeValue==c.darrow || rev) {
			r.reverse();
			S.firstChild.nodeValue=c.uarrow;
		} 
		else 
			S.firstChild.nodeValue=c.darrow;
		var thead = T.getElementsByTagName('thead')[0]; 
		var headers = thead.rows[thead.rows.length-1].cells;
		for(var k=0; k&lt;headers.length; k++) {
			if(!hasClass(headers[k],&quot;nosort&quot;))
				addClass(headers[k].getElementsByTagName(&quot;span&quot;)[0],&quot;hidden&quot;);
		}
		removeClass(S,&quot;hidden&quot;);
		for(i=0; i&lt;r.length; i++) { 
			T.tBodies[0].appendChild(r[i]);
			c.stripe(r[i],i);
			for(var j=0; j&lt;r[i].cells.length;j++){
				removeClass(r[i].cells[j],&quot;sortedCol&quot;);
			}
			addClass(r[i].cells[SORT_INDEX],&quot;sortedCol&quot;);
		}
	},
	
	stripe : function (e,i){
		var cl = [&quot;oddRow&quot;,&quot;evenRow&quot;];
		i&amp;1? cl.reverse() : cl;
		removeClass(e,cl[1]);
		addClass(e,cl[0]);
	},
	
	sortNumber : function(v) {
		var x = parseFloat(this.getText(v).replace(/[^0-9.-]/g,''));
		return isNaN(x)? 0: x;
	},
	
	sortDate : function(v) {
		return Date.parse(this.getText(v));
	},

	sortAlpha : function(v) {
		return this.getText(v).toLowerCase();
	},
	
	sortFile : function(v) { 		
		var j, q = config.messages.sizeTemplates, s = this.getText(v);
		for (var i=0; i&lt;q.length; i++) {
			if ((j = s.toLowerCase().indexOf(q[i].template.replace(&quot;%0\u00a0&quot;,&quot;&quot;).toLowerCase())) != -1)
				return q[i].unit * s.substr(0,j);
		}
		return parseFloat(s);
	},
	
	reSort : function(a,b){
		var c = config.tableSorting;
		var aa = c.fn(a);
		var bb = c.fn(b);
		return ((aa==bb)? 0 : ((aa&lt;bb)? -1:1));
	}
};

Story.prototype.tSort_refreshTiddler = Story.prototype.refreshTiddler;
Story.prototype.refreshTiddler = function(title,template,force,customFields,defaultText){
	var elem = this.tSort_refreshTiddler.apply(this,arguments);
	if(elem){
		var tables = elem.getElementsByTagName(&quot;TABLE&quot;);
		var c = config.tableSorting;
		for(var i=0; i&lt;tables.length; i++){
			if(hasClass(tables[i],&quot;sortable&quot;)){
				var x = null, rev, table = tables[i], thead = table.getElementsByTagName('thead')[0], headers = thead.rows[thead.rows.length-1].cells;
				for (var j=0; j&lt;headers.length; j++){
					var h = headers[j];
					if (hasClass(h,&quot;nosort&quot;))
						continue;
					h.setAttribute(&quot;index&quot;,j);
					h.onclick = function(){c.sortTable(this); return false;};
					h.ondblclick = stopEvent;
					if(h.getElementsByTagName(&quot;span&quot;).length == 0)
						createTiddlyElement(h,&quot;span&quot;,null,&quot;hidden&quot;,c.uarrow); 
					if(x==null &amp;&amp; hasClass(h,&quot;autosort&quot;)) {
						x = j;
						rev = hasClass(h,&quot;reverse&quot;);
					}
				}
				if(x!=null)
					c.sortTable(headers[x],rev);		
			}
		}
	}
	return elem; 
};

setStylesheet(&quot;table.sortable span.hidden {visibility:hidden;}\n&quot;+
	&quot;table.sortable thead {cursor:pointer;}\n&quot;+
	&quot;table.sortable .nosort {cursor:default;}\n&quot;+
	&quot;table.sortable td.sortedCol {background:#ffc;}&quot;,&quot;TableSortingPluginStyles&quot;);

function stopEvent(e){
	var ev = e? e : window.event;
	ev.cancelBubble = true;
	if (ev.stopPropagation) ev.stopPropagation();
	return false;	
}	

config.macros.nosort={
	handler : function(place){
		addClass(place,&quot;nosort&quot;);
	}	
};

config.macros.autosort={
	handler : function(place,m,p,w,pS){
		addClass(place,&quot;autosort&quot;+&quot; &quot;+pS);		
	}	
};
//!END-PLUGIN-CODE
// %/</pre>
</div>
<div title="TaggedTemplateTweak" modifier="ELSDesignStudios" created="200706181748" modified="200909020716" tags="systemConfig BookmarkPackage MediaPackage TaskPackage IFramePackage DiscussionPackage excludeMissing">
<pre>/***
|Name|TaggedTemplateTweak|
|Source|http://www.TiddlyTools.com/#TaggedTemplateTweak|
|Documentation|http://www.TiddlyTools.com/#TaggedTemplateTweakInfo|
|Version|1.6.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides|Story.prototype.chooseTemplateForTiddler()|
|Description|use alternative ViewTemplate/EditTemplate for specific tiddlers|
This plugin extends the core function, story.chooseTemplateForTiddler(), so that any given tiddler can be viewed and/or edited using alternatives to the standard tiddler templates.
!!!!!Documentation
&gt;see [[TaggedTemplateTweakInfo]]
!!!!!Revisions
&lt;&lt;&lt;
2009.09.02 [1.6.1] apply field-based template (if any) *before* tag-based template
| please see [[TaggedTemplateTweakInfo]] for previous revision details |
2007.06.11 [1.0.0] initial release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.TaggedTemplateTweak= {major: 1, minor: 6, revision: 1, date: new Date(2009,9,2)};

if (!config.options.txtTemplateTweakFieldname)	
	config.options.txtTemplateTweakFieldname='template';

Story.prototype.taggedTemplate_chooseTemplateForTiddler = Story.prototype.chooseTemplateForTiddler
Story.prototype.chooseTemplateForTiddler = function(title,template)
{
	// get core template and split into theme and template name
	var coreTemplate=this.taggedTemplate_chooseTemplateForTiddler.apply(this,arguments);
	var theme=&quot;&quot;; var template=coreTemplate;
	var parts=template.split(config.textPrimitives.sectionSeparator);
	if (parts[1]) { theme=parts[0]; template=parts[1]; }
	else theme=config.options.txtTheme||&quot;&quot;; // if theme is not specified
	theme+=config.textPrimitives.sectionSeparator;

	// look for template using title as prefix
	if (!store.getTaggedTiddlers(title).length) { // if tiddler is not a tag
		if (store.getTiddlerText(theme+title+template))
			{ return theme+title+template; } // theme##TitleTemplate
		if (store.getTiddlerText(title+template))
			{ return title+template; }	 // TitleTemplate
	}

	// look for templates using custom field value as prefix
	var v=store.getValue(title,config.options.txtTemplateTweakFieldname);
	if (store.getTiddlerText(theme+v+template))
		{ return theme+v+template; }	// theme##valueTemplate
	if (store.getTiddlerText(v+template))
		{ return v+template; }		// valueTemplate

	// look for template using tags as prefix
	var tiddler=store.getTiddler(title);
	if (!tiddler) return coreTemplate; // tiddler doesn't exist... use core result
	for (i=0; i&lt;tiddler.tags.length; i++) {
		var t=tiddler.tags[i]+template; // add tag prefix to template
		var c=t.substr(0,1).toUpperCase()+t.substr(1); // capitalized for WikiWord title
		if (store.getTiddlerText(theme+t))	{ return theme+t; } // theme##tagTemplate
		if (store.getTiddlerText(theme+c))	{ return theme+c; } // theme##TagTemplate
		if (store.getTiddlerText(t)) 		{ return t; }	    // tagTemplate
		if (store.getTiddlerText(c))		{ return c; }	    // TagTemplate
	}
	
	// no match... use core result
	return coreTemplate;
}
//}}}</pre>
</div>
<div title="TaggedTemplateTweakInfo" modifier="ELSDesignStudios" created="200801090247" modified="200909020716" tags="pluginInfo excludeMissing">
<pre>/***
|Name|TaggedTemplateTweakInfo|
|Source|http://www.TiddlyTools.com/#TaggedTemplateTweak|
|Documentation|http://www.TiddlyTools.com/#TaggedTemplateTweakInfo|
|Version|1.6.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|documentation|
|Requires||
|Overrides||
|Description|Documentation for TaggedTemplateTweak|
This plugin extends the core function, story.chooseTemplateForTiddler(), so that any given tiddler can be viewed and/or edited using alternatives to the standard tiddler templates.  To select alternative templates, a 'template prefix' is determined by using the tiddler's title or matching a tag value or using a value stored in a custom tiddler field.  
!!!!!Usage
&lt;&lt;&lt;
The plugin first attempts to use the tiddler's //title// as a prefix added to the standard TiddlyWiki template titles, [[ViewTemplate]] and [[EditTemplate]] (i.e., ''TiddlerNameViewTemplate'' and ''TiddlerNameEditTemplate'').  This allows you to associate a custom template with a specific tiddler, without needing to add any special tags or custom field values to that individual tiddler.  

You can also define a tiddler's template prefix by using a //custom tiddler field// named 'template'.  If no corresponding template was found using the tiddler's title, then the tiddler's 'template' field value, if present, will be used as a prefix (e.g., if template='SomeThing', then [[SomeThingViewTemplate]] will be applied).
*You can redefine the //name// of the custom field used to store the template prefix.  For example, to use the name of a TiddlyWeb server-side 'bag' as a prefix (so that tiddlers from separate bags can have different appearances), add the following to a tiddler tagged with&lt;&lt;tag systemConfig&gt;&gt;:

If no template is found using the either the title or 'template' field, then each of the tiddler's tags is tried as a template prefix, until a corresponding template, if any, is found.  For example, any tiddlers that are tagged with ''&lt;&lt;tag media&gt;&gt;'' could find alternative templates named [[mediaViewTemplate]] and [[mediaEditTemplate]].
*To permit use of templates that have proper WikiWord tiddler titles (e.g., [[MediaViewTemplate]] and [[MediaEditTemplate]]), the plugin also attempts to use a capitalized form of the tag value (e.g., ''Media'') as a prefix.  //This capitalization is for comparison purposes only and will not alter the actual tag values that are stored in the tiddler.//
*If you are applying a systemTheme definition, the plugin also tries prepending the currently selected theme (specified by {{{config.options.txtTheme}}}) plus the 'section separator' (##) to the template name (e.g. ''[[SomeTheme##MediaViewTemplate]]'') so that the alternative template definitions can be contained as //sections// within a single systemTheme tiddler.
{{{
config.options.txtTemplateTweakFieldname='server.bag'; // use TiddlyWeb bag name as prefix
}}}
Lastly, if no alternative template is found at all, the standard [[ViewTemplate]] or [[EditTemplate]] definition as determined by the TiddlyWiki core handler is used.

''To add your own custom templates:''
&gt;First, decide upon a suitable tag keyword to uniquely identify your custom templates and create custom view and/or edit templates using that keyword as a prefix (e.g., &quot;KeywordViewTemplate&quot; and &quot;KeywordEditTemplate&quot;).  Then, simply create a tiddler and tag it with your chosen keyword... that's it!  As long as the tiddler is tagged with your keyword, it will be displayed using the corresponding alternative templates.  If you remove the tag or rename/delete the alternative templates, the tiddler will revert to using the standard viewing and editing templates.
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
|Sample tiddler| tag | view template | edit template |
|[[MediaSample - QuickTime]]| &lt;&lt;tag media&gt;&gt; | [[MediaViewTemplate]] | [[MediaEditTemplate]] |
|[[MediaSample - Windows]]| &lt;&lt;tag media&gt;&gt; | [[MediaViewTemplate]] | [[MediaEditTemplate]] |
|[[CDSample]]| &lt;&lt;tag CD&gt;&gt; | [[CDViewTemplate]] | [[CDEditTemplate]] |
|&lt;&lt;newTiddler label:&quot;create new task...&quot; title:SampleTask tag:task text:&quot;Type some text and then press DONE to view the task controls&quot;&gt;&gt; | &lt;&lt;tag task&gt;&gt; | [[TaskViewTemplate]] | [[EditTemplate]] |

//(note: if these samples are not present in your document, please visit// http://www.TiddlyTools.com/ //to view these sample tiddlers on-line)//
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.09.02 [1.6.1] apply field-based template (if any) *before* tag-based template
2009.07.31 [1.6.0] added support for using custom field value as prefix
2009.05.04 [1.5.2] check for tiddler exist *after* title-as-prefix (allows shadow tiddlers to use custom templates)
2009.01.06 [1.5.1] reversed logic so that title-as-prefix takes precedence over tag-matched prefix
2008.12.18 [1.5.0] added handling for using tiddler //title// as prefix (e.g., {{{SomeTiddlerViewTemplate}}}) 
2008.08.29 [1.4.1] corrected handling for tiddlers with no matching tagged template when non-default theme is in effect (e.g., use &quot;MyTheme##ViewTemplate&quot;).
2008.05.15 [1.4.0] support use of *shadow* tagged templates (e.g., [[DiscussionViewTemplate]] created by [[DiscussionPlugin]])
2008.05.10 [1.3.0] corrected handling for determining core template when using theme with sections
2008.05.01 [1.2.5] added support for tagged templates stored as sections in a theme
2008.04.01 [1.2.0] added support for using systemTheme section-based template definitions (requested by Phil Hawksworth)
2008.01.22 [*.*.*] plugin size reduction - documentation moved to [[TaggedTemplateTweakInfo]]
2007.06.23 [1.1.0] re-written to use automatic 'tag prefix' search instead of hard coded check for each tag.  Allows new custom tags to be used without requiring code changes to this plugin.
2007.06.11 [1.0.0] initial release
&lt;&lt;&lt;</pre>
</div>
<div title="Tagging a Chapter" modifier="JohnRouillard" created="201007311831" modified="201008011849">
<pre>This is a slightly more technical discussion of how tiddlers involved in a chapter are set up.

!! Chapter control tiddler
Every [[chapter control tiddler|Glossary/chapterControlTiddler]] must have @@chapter@@ as its first tag so that it is recognized (and properly displayed) as a control tiddler. The tag @@story@@ must also be included so the chapter can be displayed in the story column by selecting it from the drop down select box.

!! Content in a chapter
Every tiddler in a chapter must be tagged with content so that it will be exported to the student copy of the coursebook.

!! Preventing Tiddlers from Being Published
If any tiddler is tagged with ~InstructorOnly, it will not be published in the student coursebook.
</pre>
</div>
<div title="Tagging a Presentation" modifier="YourName" created="201007182055" modified="201007270423" tags="content">
<pre>This is a slightly more technical discussion of how tiddlers involved in a presentations are set up.

!! Presentation control tiddler
Every presentation control tiddler must have @@presentation@@ as its first tag so that it is recognized (and properly displayed) as a control tiddler.

!! A slide in a presentation
Every slide must have @@slide@@ as it's first tag so it is displayed as a slide during a presentation.

!! The second tag

In addition to the slide/presentation tags your tiddler must have one of:
;~InstructorOnly
:slide/presentation tiddler is never exported to the student coursebook
;content
: slide/presentation is exported to the student book (if ~InstructorOnly is not present)
to be properly published.

!! The third tag

Also you can append the @@story@@ tag to a presentation tiddler to allow the drop down selection box to open all the tiddlers in the presentation for quick review, editing or printing.
</pre>
</div>
<div title="TemporaryTiddlersPlugin" modifier="ELSDesignStudios" created="200702081951" modified="200811141727" tags="ImportExportPackage systemConfig excludeMissing">
<pre>/***
|Name|TemporaryTiddlersPlugin|
|Source|http://www.TiddlyTools.com/#TemporaryTiddlersPlugin|
|Version|1.1.2|
|Author|Eric Shulman - ELS Design Studios|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides|SaverBase.prototype.externalize()|
|Options|##Configuration|
|Description|blocks tiddlers tagged with &quot;temporary&quot; from being saved into the TW file|
!!!!!Usage
&lt;&lt;&lt;
When the TW document is saved (either to local disk or remote URL), any tiddlers tagged with &quot;temporary&quot; will be skipped over, so that they are not written to the file.  To keep a temporary tiddler, simply edit it and remove the tag before saving the file.  This feature can be combined with various plugins that can automatically create new tiddlers, such as [[SearchOptionsPlugin]] ([[SearchResults]]) and [[ImportTiddlersPlugin]] ([[ImportedTiddlers]]) so that these transient results are not retained when you save you document.

You can also use this tag with the {{{&lt;&lt;loadTiddlers&gt;&gt;}}} macro and the //auto-tagging// features provided by [[ImportTiddlersPlugin]], so that each time you open your document, you can automatically retrieve an up-to-date set of common tiddlers that are stored in another document (either local or via remote URL), without those tiddlers being retained when you save your document.
&lt;&lt;&lt;
!!!!!Configuration
&lt;&lt;&lt;
When saving the document:
&lt;&lt;option chkTemporaryQuiet&gt;&gt; Suppress reporting of individual temporary tiddlers that have not been saved
&lt;&lt;option chkTemporaryKeep&gt;&gt; Keep temporary tiddlers (i.e., ignore the 'temporary' tag)
Enter a tag value to use when marking tiddlers as temporary: &lt;&lt;option txtTemporaryTag&gt;&gt;
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2008.11.14 [1.1.2] added &quot;nnn temporary tiddlers not saved&quot; summary message
2008.04.08 [1.1.1] don't automatically add configuration options to AdvancedOptions tiddler
2008.03.01 [1.1.0] added support for recognizing 'temporary' flag stored as a tiddler *field* (as an optional alternative to using a tag)
2007.02.08 [1.0.0] initial release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.TemporaryTiddlersPlugin= {major: 1, minor: 1, revision: 2, date: new Date(2008,11,14)};

// configuration defaults
if (config.options.chkTemporaryKeep ==undefined) config.options.chkTemporaryKeep =false;
if (config.options.chkTemporaryQuiet==undefined) config.options.chkTemporaryQuiet=true;
if (config.options.txtTemporaryTag==undefined) config.options.txtTemporaryTag=&quot;temporary&quot;;
// lingo
config.messages.TemporaryWarning = &quot;'%0' ...temporary tiddler&quot;;
config.messages.TemporarySummary = &quot;%0 temporary tiddlers will not be saved&quot;;
// core override
SaverBase.prototype.externalize = function(store) 
{
	var results=[]; var totaltemps=0;
	var tiddlers=store.getTiddlers(&quot;title&quot;);
	for (var t=0; t&lt;tiddlers.length; t++) {
		if (config.options.chkTemporaryKeep||!(tiddlers[t].fields['temporary']||tiddlers[t].isTagged(config.options.txtTemporaryTag)))
			results.push(this.externalizeTiddler(store, tiddlers[t]));
		else {
			if (!config.options.chkTemporaryQuiet) // notify user that tiddler won't be saved
				displayMessage(config.messages.TemporaryWarning.format([tiddlers[t].title]));
			totaltemps++;
		}
	}
	if (totaltemps) displayMessage(config.messages.TemporarySummary.format([totaltemps]));
	return results.join(&quot;\n&quot;);
}
//}}}</pre>
</div>
<div title="TestOpenOtherTab" modifier="JohnRouillard" created="201005262349" modified="201005262353" tags="InstructorOnly">
<pre>&lt;&lt;tabs tabID
&quot;Tab A&quot; &quot;tooltip A&quot; [[TestOpenOtherTab##ContentsA]]
&quot;Tab B&quot; &quot;tooltip B&quot; TestOpenOtherTab##ContentsB
&quot;Tab C&quot; &quot;tooltip C&quot; TestOpenOtherTab##ContentsC 
&gt;&gt;
/%
!ContentsA
Consider this format for display of some information.
E.G. multiple examples, glossary popdowns ... However printing all tabs is a problem.

See [[orig thread|http://groups.google.com/group/TiddlyWiki/browse_thread/thread/4f7b952f69b523a2?pli=1]]
and [[Azlandela|http://groups.google.dk/group/tiddlywiki/browse_thread/thread/bbb7a36edea4b6e7?hl=da]]
&lt;html&gt;&lt;a href='javascript:;' onclick='config.options.tabID=&quot;Tab B&quot;; story.refreshTiddler(&quot;TestOpenOtherTab&quot;, null, true) '&gt;link&lt;/a&gt;&lt;/html&gt; to Tab B &lt;html&gt;&lt;a href='javascript:;' onclick='config.options.tabID=&quot;Tab C&quot;;
story.refreshTiddler(&quot;TestOpenOtherTab&quot;, null, true) '&gt;link&lt;/a&gt;&lt;/html&gt; to Tab C 
!ContentsB
&lt;html&gt;&lt;a href='javascript:;' onclick='config.options.tabID=&quot;Tab A&quot;; story.refreshTiddler(&quot;TestOpenOtherTab&quot;, null, true) '&gt;link&lt;/a&gt;&lt;/html&gt; to Tab A &lt;html&gt;&lt;a href='javascript:;' onclick='config.options.tabID=&quot;Tab C&quot;; story.refreshTiddler(&quot;TestOpenOtherTab&quot;, null, true) '&gt;link&lt;/a&gt;&lt;/html&gt; to Tab C 
!ContentsC 
&lt;html&gt;&lt;a href='javascript:;' onclick='config.options.tabID=&quot;Tab A&quot;;
story.refreshTiddler(&quot;TestOpenOtherTab&quot;, null, true) '&gt;link&lt;/a&gt;&lt;/html&gt; to Tab A &lt;html&gt;&lt;a href='javascript:;' onclick='config.options.tabID=&quot;Tab B&quot;; story.refreshTiddler(&quot;TestOpenOtherTab&quot;, null, true) '&gt;link&lt;/a&gt;&lt;/html&gt; to Tab B 
!end
%/</pre>
</div>
<div title="Textbook" modifier="JohnRouillard" created="201007251855" modified="201007311809" tags="slide content">
<pre>&lt;&lt;tiddler SlideSubstyle##levelOne with: url(&quot;textbooks.gif&quot;)&gt;&gt; 

{{comment{
* Provide a standard textbook serial learning mechanism
**  Story (aka chapter) is a series of tiddlers presented serially at one shot.
* ~Non-Linear textbook
**  search is a must have. Search by tiddler title, content or tags.  Return tiddlers w/ hits like google.
}}}</pre>
</div>
<div title="This is the End" modifier="YourName" created="201007252123" modified="201007260356" tags="slide content">
<pre>&lt;&lt;tiddler SlideSubstyle##levelTwo&gt;&gt;
{{adiv{
@@font-size:x-large;text-align:center;margin-left:auto;margin-right:auto;FINI@@
}}}</pre>
</div>
<div title="Tiddler Types in This Coursebook" modifier="JohnRouillard" created="200903222226" modified="200910101740" tags="slide content">
<pre>&lt;&lt;tiddler Welcome/tiddlerclass &gt;&gt;
{{comment{
There are also structural and operational tiddlers that provide major portions of coursebook functionality, set the display styles etc. Consider these fixed content that you don't have to worry about. They just sort of hang out in the background.
}}}</pre>
</div>
<div title="TiddlerNotesPlugin" modifier="JohnRouillard" created="200710261233" modified="200909130203" tags="systemConfig excludeMissing PatchedPlugin">
<pre>/***
|''Name:''|TiddlerNotesPlugin|
|''Description:''|Add notes to tiddlers without modifying the original content|
|''Author:''|Saq Imtiaz ( lewcid@gmail.com )|
|''Source:''|http://tw.lewcid.org/#TiddlerNotesPlugin|
|''Code Repository:''|http://tw.lewcid.org/svn/plugins|
|''Version:''|2.1|
|''Date:''|26/10/07|
|''License:''|[[Creative Commons Attribution-ShareAlike 3.0 License|http://creativecommons.org/licenses/by-sa/3.0/]]|
|''~CoreVersion:''|2.2.3|

!!Concept:
*The TiddlerNotesPlugin allows you to add notes to tiddlers, without needing to edit the original tiddler. This means that your original content will remain unaltered, and if you update it in the future, you wont lose your notes. Notes are stored in separate tiddlers, but can be viewed and edited from within the original tiddler.
*For a tiddler titled &quot;~MySlide&quot;, the notes are by default saved in a tiddler titled &quot;~MySlide-Notes&quot; and is given a tag of &quot;Notes&quot;. The suffix and tags of the notes tiddlers are customizable. You can have one or multiple notes per tiddlers. So it is possible to have for example, teacher's notes and student's notes in the same file.
*Notes can be configured to start off blank, or pre-filled with the contents of the original tiddler.

!!Usage:
*{{{&lt;&lt;notes&gt;&gt;}}} is the simplest usage form.
* additional optional parameters include:
**{{{heading:}}} the heading to use for the notes box
**{{{tag:}}} the tag to be given to the notes tiddler
**{{{suffix:}}} the suffix to be used when naming the notes tiddler
* a full macro call could look like: {{{&lt;&lt;notes heading:&quot;My Notes&quot; tag:&quot;NoteTiddlers&quot; suffix:&quot;Comments&quot;&gt;&gt;}}}
* To avoid adding {{{&lt;&lt;notes&gt;&gt;}}} to each tiddler you want notes for, you could add the macro call to the ViewTemplate
** below the line {{{&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;}}} add the following line: &lt;br&gt; {{{&lt;div class='viewer' macro='notes'&gt;&lt;/div&gt;}}}
** Used in combination with the ~HideWhenPlugin or ~PublisherPlugin, you could have notes be shown only for tiddlers with specific tags. The ~PublisherPlugin would allow you for instance to only have the ~TeachersNotes visible to the teacher, and the ~StudentsNotes for the same tiddler visible to the Student.

!!Configuration
*&lt;&lt;option chkPrefillNotes&gt;&gt; Enable to pre-fill notes with the original tiddler's contents

!!Demo:
* [[MySlide]]

***/
// /%
//!BEGIN-PLUGIN-CODE

if (!config.options.chkPrefillNotes)
	config.options.chkPrefillNotes = false;
	
function createTiddlyElement(theParent,theElement,theID,theClass,theText,attribs)
{
	var e = document.createElement(theElement);
	if(theClass != null)
		e.className = theClass;
	if(theID != null)
		e.setAttribute(&quot;id&quot;,theID);
	if(theText != null)
		e.appendChild(document.createTextNode(theText));
	if(attribs){
		for(var n in attribs){
			e.setAttribute(n,attribs[n]);
		}
	}
	if(theParent != null)
		theParent.appendChild(e);
	return e;
}

function createTiddlyButton(theParent,theText,theTooltip,theAction,theClass,theId,theAccessKey,attribs)
{
	var theButton = document.createElement(&quot;a&quot;);
	if(theAction) {
		theButton.onclick = theAction;
		theButton.setAttribute(&quot;href&quot;,&quot;javascript:;&quot;);
	}
	if(theTooltip)
		theButton.setAttribute(&quot;title&quot;,theTooltip);
	if(theText)
		theButton.appendChild(document.createTextNode(theText));
	if(theClass)
		theButton.className = theClass;
	else
		theButton.className = &quot;button&quot;;
	if(theId)
		theButton.id = theId;
	if(attribs){
		for(var n in attribs){
			theButton.setAttribute(n,attribs[n]);
		}
	}
	if(theParent)
		theParent.appendChild(theButton);
	if(theAccessKey)
		theButton.setAttribute(&quot;accessKey&quot;,theAccessKey);
	return theButton;
}

config.macros.notes={
	
	cancelWarning: &quot;Are you sure you want to abandon changes to your notes for '%0'?&quot;,
	editLabel: &quot;edit notes&quot;,
	editTitle: &quot;double click to edit&quot;,
	saveLabel: &quot;save notes&quot;,
	saveTitle: &quot;double click to save&quot;,
	cancelLabel: &quot;cancel&quot;,
	heading: &quot;Notes&quot;,
	suffix: &quot;Notes&quot;,
	tag: &quot;Notes&quot;,
	
	saveNotes: function(ev){
		e = ev? ev : window.event;
		var theTarget = resolveTarget(e);
		if (theTarget.nodeName.toLowerCase() == &quot;textarea&quot;)
			return false;
		var title = story.findContainingTiddler(theTarget).getAttribute(&quot;tiddler&quot;);
		story.setDirty(title,false);
		var box = document.getElementById(&quot;notesContainer&quot;+title);
		var textarea = document.getElementById(&quot;notesTextArea&quot;+title);
		if(textarea.getAttribute(&quot;oldText&quot;)!=textarea.value &amp;&amp; !hasClass(theTarget,&quot;cancelNotesButton&quot;)){
			var suffix = box.getAttribute(&quot;suffix&quot;);
			var t = store.getTiddler(title+&quot;-&quot;+suffix);
			store.saveTiddler(title+&quot;-&quot;+suffix,title+&quot;-&quot;+suffix,textarea.value,config.options.txtUserName,new Date(),t?t.tags:box.getAttribute(&quot;tag&quot;),t?t.fields:{});
		}
		story.refreshTiddler(title,1,true);
		autoSaveChanges(true);
		return false;
	},
	
	editNotes: function(box,tiddler){
		removeChildren(box);
		story.setDirty(tiddler,true);
		box.title = this.saveTitle;
		box.ondblclick = this.saveNotes;
		createTiddlyButton(box,this.cancelLabel,this.cancelLabel,this.saveNotes,&quot;cancelNotesButton&quot;);
		createTiddlyButton(box,this.saveLabel,this.saveLabel,this.saveNotes,&quot;saveNotesButton&quot;);
		wikify(&quot;!!&quot;+box.getAttribute(&quot;heading&quot;)+&quot;\n&quot;,box);
		addClass(box,&quot;editor&quot;);
		var wrapper1 = createTiddlyElement(null,&quot;fieldset&quot;,null,&quot;fieldsetFix&quot;);
		var wrapper2 = createTiddlyElement(wrapper1,&quot;div&quot;);
		var e = createTiddlyElement(wrapper2,&quot;textarea&quot;,&quot;notesTextArea&quot;+tiddler);
		var v = store.getValue(tiddler+&quot;-&quot;+box.getAttribute(&quot;suffix&quot;),&quot;text&quot;);
		if(!v) 
			v = config.options.chkPrefillNotes? store.getValue(tiddler,&quot;text&quot;):'';
		e.value = v;
		e.setAttribute(&quot;oldText&quot;,v);
		var rows = 10;
		var lines = v.match(/\n/mg);
		var maxLines = Math.max(parseInt(config.options.txtMaxEditRows),5);
		if(lines != null &amp;&amp; lines.length &gt; rows)
			rows = lines.length + 5;
		rows = Math.min(rows,maxLines);
		e.setAttribute(&quot;rows&quot;,rows);
		box.appendChild(wrapper1);
	},
	
	editNotesButtonOnclick: function(e){
		var title = story.findContainingTiddler(this).getAttribute(&quot;tiddler&quot;);
		var box = document.getElementById(&quot;notesContainer&quot;+title);
		config.macros.notes.editNotes(box,title);
		return false;
	},
	
	ondblclick : function(ev){
		e = ev? ev : window.event;
		var theTarget = resolveTarget(e);
		var title = story.findContainingTiddler(theTarget).getAttribute(&quot;tiddler&quot;);
		var box = document.getElementById(&quot;notesContainer&quot;+title);
		config.macros.notes.editNotes(box,title);
		e.cancelBubble = true;
		if(e.stopPropagation) e.stopPropagation();
		return false;
	},
	
	handler : function(place,macroName,params,wikifier,paramString,tiddler){
		
		params = paramString.parseParams(&quot;anon&quot;,null,true,false,false);
		var heading = getParam(params,&quot;heading&quot;,this.heading);
		var tag = getParam(params,&quot;tag&quot;,this.tag);
		var suffix = getParam(params,&quot;suffix&quot;,this.suffix);
                // rouilj add a class for notes that have contents in a tiddler.
                var notesTiddlerExists = store.tiddlerExists(tiddler.title+&quot;-&quot;+suffix);
		var box = createTiddlyElement(place,&quot;div&quot;,&quot;notesContainer&quot;+tiddler.title,&quot;TiddlerNotes&quot;  + (notesTiddlerExists?&quot; TiddlerNotesExists&quot;:&quot;&quot;),null,{&quot;source&quot;:tiddler.title,params:paramString,heading:heading,tag:tag,suffix:suffix});
		// var box = createTiddlyElement(place,&quot;div&quot;,&quot;notesContainer&quot;+tiddler.title,&quot;TiddlerNotes&quot;,null,{&quot;source&quot;:tiddler.title,params:paramString,heading:heading,tag:tag,suffix:suffix});
		createTiddlyButton(box,this.editLabel,this.editLabel,this.editNotesButtonOnclick,&quot;editNotesButton&quot;);
		wikify(&quot;!!&quot;+heading+&quot;\n&quot;,box);
		box.title=this.editTitle;
		box.ondblclick = this.ondblclick;
		wikify(&quot;&lt;&lt;tiddler [[&quot;+tiddler.title+&quot;-&quot;+suffix+&quot;]]&gt;&gt;&quot;,box);
	}		
};

Story.prototype.old_notes_closeTiddler = Story.prototype.closeTiddler;
Story.prototype.closeTiddler = function(title,animate,unused){
	if(story.isDirty(title)) {
            if(!confirm(config.macros.notes.cancelWarning.format([title])))
    		    return false;
         }
	return this.old_notes_closeTiddler.apply(this,arguments);
}

setStylesheet(&quot;.TiddlerNotes {\n&quot;+ &quot; background:#eee;\n&quot;+ &quot; border:1px solid #ccc;\n&quot;+ &quot; padding:10px;\n&quot;+ &quot; margin:15px;\n&quot;+ &quot;}\n&quot;+ &quot;\n&quot;+ &quot;.cancelNotesButton,.editNotesButton, .saveNotesButton {\n&quot;+ &quot; float:right;\n&quot;+ &quot; border:1px solid #ccc;\n&quot;+ &quot; padding:2px 5px;\n&quot;+ &quot;}\n&quot;+ &quot;\n&quot;+ &quot;.saveNotesButton{\n&quot;+ &quot; margin-right:0.5em;\n&quot;+ &quot;}\n&quot;+ &quot;\n&quot;+ &quot;.TiddlerNotes.editor textarea{\n&quot;+ &quot; border:1px solid #ccc;\n&quot;+ &quot;}&quot;,&quot;NotesPluginStyles&quot;);
//!END-PLUGIN-CODE
// %/</pre>
</div>
<div title="TiddlerTweakerPlugin" modifier="ELSDesignStudios" created="200708032311" modified="200909151531" tags="TidIDEPackage systemConfig excludeMissing InstructorOnly">
<pre>/***
|Name|TiddlerTweakerPlugin|
|Source|http://www.TiddlyTools.com/#TiddlerTweakerPlugin|
|Version|2.4.4|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Description|select multiple tiddlers and modify author, created, modified and/or tag values|
~TiddlerTweaker is a 'power tool' for TiddlyWiki authors.  Select multiple tiddlers from a listbox and 'bulk modify' the creator, author, created, modified and/or tag values of those tiddlers using a compact set of form fields.  The values you enter into the fields simultaneously overwrite the existing values in all tiddlers you have selected.
!!!!!Usage
&lt;&lt;&lt;
{{{&lt;&lt;tiddlerTweaker&gt;&gt;}}}
{{smallform{&lt;&lt;tiddlerTweaker&gt;&gt;}}}
By default, any tags you enter into the TiddlerTweaker will //replace// the existing tags in all the tiddlers you have selected.  However, you can also use TiddlerTweaker to quickly filter specified tags from the selected tiddlers, while leaving any other tags assigned to those tiddlers unchanged:
&gt;Any tag preceded by a '+' (plus) or '-' (minus), will be added or removed from the existing tags //instead of replacing the entire tag definition// of each tiddler (e.g., enter '-excludeLists' to remove that tag from all selected tiddlers.  When using this syntax, care should be taken to ensure that //every// tag is preceded by '+' or '-', to avoid inadvertently overwriting any other existing tags on the selected tiddlers.  (note: the '+' or '-' prefix on each tag value is NOT part of the tag value, and is only used by TiddlerTweaker to control how that tag value is processed)
Important Notes:
* TiddlerTweaker is a 'power user' tool that can make changes to many tiddlers at once.  ''You should always have a recent backup of your document (or 'save changes' just *before* tweaking the tiddlers), just in case you accidentally 'shoot yourself in the foot'.''
* The date and author information on any tiddlers you tweak will ONLY be updated if the corresponding checkboxes have been selected.  As a general rule, after using TiddlerTweaker, always ''//remember to save your document//'' when you are done, even though the tiddler timeline tab may not show any recently modified tiddlers.
* Selecting and updating all tiddlers in a document can take a while.  Your browser may warn about an 'unresponsive script'.  Usually, if you allow it to continue, it should complete the processing... eventually.  Nonetheless, be sure to save your work before you begin tweaking lots of tiddlers, just in case something does get stuck.
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.09.15 2.4.4 added 'edit' button. moved html definition to separate section
2009.09.13 2.4.3 in settiddlers(), convert backslashed chars (\n\b\s\t) in replacement text
2009.06.26 2.4.2 only add brackets around tags containing spaces
2009.06.22 2.4.1 in setFields(), add brackets around all tags shown tweaker edit field
2009.03.30 2.4.0 added 'sort by modifier'
2009.01.22 2.3.0 added support for text pattern find/replace
2008.10.27 2.2.3 in setTiddlers(), fixed Safari bug by replacing static Array.concat(...) with new Array().concat(...)
2008.09.07 2.2.2 added removeCookie() function for compatibility with [[CookieManagerPlugin]]
2008.05.12 2.2.1 replace built-in backstage tweak task with tiddler tweaker control panel (moved from BackstageTweaks)
2008.01.13 2.2.0 added 'auto-selection' links: all, changed, tags, title, text
2007.12.26 2.1.0 added support for managing 'creator' custom field (see [[CoreTweaks]])
2007.11.01 2.0.3 added config.options.txtTweakerSortBy for cookie-based persistence of list display order preference setting.
2007.09.28 2.0.2 in settiddlers() and deltiddlers(), added suspend/resume notification handling (improves performance when operating on multiple tiddlers)
2007.08.03 2.0.1 added shadow definition for [[TiddlerTweaker]] tiddler for use as parameter references with {{{&lt;&lt;tiddler&gt;&gt;, &lt;&lt;slider&gt;&gt; or &lt;&lt;tabs&gt;&gt;}}} macros.
2007.08.03 2.0.0 converted from inline script
2006.01.01 1.0.0 initial release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.TiddlerTweakerPlugin= {major: 2, minor: 4, revision: 4, date: new Date(2009,9,15)};

// shadow tiddler
config.shadowTiddlers.TiddlerTweaker='&lt;&lt;tiddlerTweaker&gt;&gt;';

// defaults
if (config.options.txtTweakerSortBy==undefined) config.options.txtTweakerSortBy='modified';

// backstage task
if (config.tasks) { // for TW2.2b3 or above
	config.tasks.tweak.tooltip='review/modify tiddler internals: dates, authors, tags, etc.';
	config.tasks.tweak.content='{{smallform small groupbox{&lt;&lt;tiddlerTweaker&gt;&gt;}}}';
}

// if removeCookie() function is not defined by TW core, define it here.
if (window.removeCookie===undefined) {
	window.removeCookie=function(name) {
		document.cookie = name+'=; expires=Thu, 01-Jan-1970 00:00:01 UTC; path=/;'; 
	}
}

config.macros.tiddlerTweaker = {
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		var span=createTiddlyElement(place,'span');
		span.innerHTML=store.getTiddlerText('TiddlerTweakerPlugin##html');
		this.init(span.getElementsByTagName('form')[0],config.options.txtTweakerSortBy);
	},
	init: function(f,sortby) { // initialize form controls
		if (!f) return; // form might not be rendered yet...
		while (f.list.options[0]) f.list.options[0]=null; // empty current list content
		var tids=store.getTiddlers(sortby);
		if (sortby=='size') // descending order
			tids.sort(function(a,b) {return a.text.length &gt; b.text.length ? -1 : (a.text.length == b.text.length ? 0 : +1);});
		var who='';
		for (i=0; i&lt;tids.length; i++) { var t=tids[i];
			var label=t.title; var value=t.title;
			switch (sortby) {
				case 'modified':
				case 'created':
					var t=tids[tids.length-i-1]; // reverse order
					var when=t[sortby].formatString('YY.0MM.0DD 0hh:0mm ');
					label=when+t.title;
					value=t.title;
					break;
				case 'size':
					label='['+t.text.length+'] '+label;
					break;
				case 'modifier':
				case 'creator':
					if (who!=t[sortby]) {
						who=t[sortby];
						f.list.options[f.list.length]=new Option('by '+who+':','',false,false);
					}
					label='\xa0\xa0\xa0'+label; // indent
					break;
			}
			f.list.options[f.list.length]=new Option(label,value,false,false);
		}
		f.title.value=f.who.value=f.creator.value=f.tags.value='';
		f.cm.value=f.cd.value=f.cy.value=f.ch.value=f.cn.value='';
		f.mm.value=f.md.value=f.my.value=f.mh.value=f.mn.value='';
		f.stats.disabled=f.set.disabled=f.del.disabled=f.edit.disabled=f.display.disabled=true;
		f.settitle.disabled=false;
		config.options.txtTweakerSortBy=sortby;
		f.sortby.value=sortby; // sync droplist
		if (sortby!='modified') saveOptionCookie('txtTweakerSortBy');
		else removeCookie('txtTweakerSortBy');
	},
	selecttiddlers: function(here) { // enables/disables inputs based on #items selected
		var f=here.form; var list=f.list;
		var c=0; for (i=0;i&lt;list.length;i++) if (list.options[i].selected) c++;
		if (c&gt;1) f.title.disabled=true;
		if (c&gt;1) f.settitle.checked=false;
		f.set.disabled=(c==0);
		f.del.disabled=(c==0);
		f.edit.disabled=(c==0);
		f.display.disabled=(c==0);
		f.settitle.disabled=(c&gt;1);
		f.stats.disabled=(c==0);
		var msg=(c==0)?'select tiddlers':(c+' tiddler'+(c!=1?'s':'')+' selected');
		here.previousSibling.firstChild.firstChild.nextSibling.innerHTML=msg;
		if (c) clearMessage(); else displayMessage('no tiddlers selected');
	},
	setfields: function(here) { // set fields from first selected tiddler
		var f=here.form;
		if (!here.value.length) {
			f.title.value=f.who.value=f.creator.value=f.tags.value='';
			f.cm.value=f.cd.value=f.cy.value=f.ch.value=f.cn.value='';
			f.mm.value=f.md.value=f.my.value=f.mh.value=f.mn.value='';
			return;
		}
		var tid=store.getTiddler(here.value); if (!tid) return;
		f.title.value=tid.title;
		f.who.value=tid.modifier;
		f.creator.value=tid.fields['creator']||''; // custom field - might not exist
		f.tags.value=tid.tags.map(function(t){return String.encodeTiddlyLink(t)}).join(' ');
		var c=tid.created; var m=tid.modified;
		f.cm.value=c.getMonth()+1;
		f.cd.value=c.getDate();
		f.cy.value=c.getFullYear();
		f.ch.value=c.getHours();
		f.cn.value=c.getMinutes();
		f.mm.value=m.getMonth()+1;
		f.md.value=m.getDate();
		f.my.value=m.getFullYear();
		f.mh.value=m.getHours();
		f.mn.value=m.getMinutes();
	},
	settiddlers: function(here) {
		var f=here.form; var list=f.list;
		var tids=[];
		for (i=0;i&lt;list.length;i++) if (list.options[i].selected) tids.push(list.options[i].value);
		if (!tids.length) { alert('please select at least one tiddler'); return; }
		var cdate=new Date(f.cy.value,f.cm.value-1,f.cd.value,f.ch.value,f.cn.value);
		var mdate=new Date(f.my.value,f.mm.value-1,f.md.value,f.mh.value,f.mn.value);
		if (tids.length&gt;1 &amp;&amp; !confirm('Are you sure you want to update these tiddlers:\n\n'+tids.join(', '))) return;
		store.suspendNotifications();
		for (t=0;t&lt;tids.length;t++) {
			var tid=store.getTiddler(tids[t]); if (!tid) continue;
			var title=!f.settitle.checked?tid.title:f.title.value;
			var who=!f.setwho.checked?tid.modifier:f.who.value;
			var text=tid.text;
			if (f.replacetext.checked) {
				var r=f.replacement.value.replace(/\\t/mg,'\t').unescapeLineBreaks();
				text=text.replace(new RegExp(f.pattern.value,'mg'),r);
			}				
			var tags=tid.tags;
			if (f.settags.checked) { 
				var intags=f.tags.value.readBracketedList();
				var addtags=[]; var deltags=[]; var reptags=[];
				for (i=0;i&lt;intags.length;i++) {
					if (intags[i].substr(0,1)=='+')
						addtags.push(intags[i].substr(1));
					else if (intags[i].substr(0,1)=='-')
						deltags.push(intags[i].substr(1));
					else
						reptags.push(intags[i]);
				}
				if (reptags.length)
					tags=reptags;
				if (addtags.length)
					tags=new Array().concat(tags,addtags);
				if (deltags.length)
					for (i=0;i&lt;deltags.length;i++)
						{ var pos=tags.indexOf(deltags[i]); if (pos!=-1) tags.splice(pos,1); }
			}
			if (!f.setcdate.checked) cdate=tid.created;
			if (!f.setmdate.checked) mdate=tid.modified;
			store.saveTiddler(tid.title,title,text,who,mdate,tags,tid.fields);
			if (f.setcreator.checked) store.setValue(tid.title,'creator',f.creator.value); // set creator
			if (f.setcdate.checked) tid.assign(null,null,null,null,null,cdate); // set create date
		}
		store.resumeNotifications();
		this.init(f,f.sortby.value);
	},
	displaytiddlers: function(here,edit) {
		var f=here.form; var list=f.list;
		var tids=[];
		for (i=0; i&lt;list.length;i++) if (list.options[i].selected) tids.push(list.options[i].value);
		if (!tids.length) { alert('please select at least one tiddler'); return; }
		story.displayTiddlers(story.findContainingTiddler(f),tids,edit?DEFAULT_EDIT_TEMPLATE:null);
	},
	deltiddlers: function(here) {
		var f=here.form; var list=f.list;
		var tids=[];
		for (i=0;i&lt;list.length;i++) if (list.options[i].selected) tids.push(list.options[i].value);
		if (!tids.length) { alert('please select at least one tiddler'); return; }
		if (!confirm('Are you sure you want to delete these tiddlers:\n\n'+tids.join(', '))) return;
		store.suspendNotifications();
		for (t=0;t&lt;tids.length;t++) {
			var tid=store.getTiddler(tids[t]); if (!tid) continue;
			if (tid.tags.contains('systemConfig')) {
				var msg=tid.title+' is tagged with systemConfig.'
					+'\n\nRemoving this tiddler may cause unexpected results.  Are you sure?';
				if (!confirm(msg)) continue;
			}
			store.removeTiddler(tid.title);
			story.closeTiddler(tid.title);
		}
		store.resumeNotifications();
		this.init(f,f.sortby.value);
	},
	stats: function(here) {
		var f=here.form; var list=f.list; var tids=[]; var out=''; var tot=0;
		var target=f.nextSibling;
		for (i=0;i&lt;list.length;i++) if (list.options[i].selected) tids.push(list.options[i].value);
		if (!tids.length) { alert('please select at least one tiddler'); return; }
		for (t=0;t&lt;tids.length;t++) {
			var tid=store.getTiddler(tids[t]); if (!tid) continue;
			out+='[['+tid.title+']] '+tid.text.length+'\n'; tot+=tid.text.length;
		}
		var avg=tot/tids.length;
		out=tot+' bytes in '+tids.length+' selected tiddlers ('+avg+' bytes/tiddler)\n&lt;&lt;&lt;\n'+out+'&lt;&lt;&lt;\n';
		removeChildren(target);
		target.innerHTML=&quot;&lt;hr&gt;&lt;font size=-2&gt;&lt;a href='javascript:;' style='float:right' &quot;
			+&quot;onclick='this.parentNode.parentNode.style.display=\&quot;none\&quot;'&gt;close&lt;/a&gt;&lt;/font&gt;&quot;;
		wikify(out,target);
		target.style.display='block';
	}
};
//}}}
/***
//{{{
!html
&lt;style&gt;
.tiddlerTweaker table,
.tiddlerTweaker table tr,
.tiddlerTweaker table td
	{ padding:0;margin:0;border:0;white-space:nowrap; }
&lt;/style&gt;&lt;form class='tiddlerTweaker'&gt;&lt;!--
--&gt;&lt;table style=&quot;width:100%&quot;&gt;&lt;tr valign=&quot;top&quot;&gt;&lt;!--
--&gt;&lt;td style=&quot;text-align:center;width:99%;&quot;&gt;&lt;!--
	--&gt;&lt;font size=-2&gt;&lt;div style=&quot;text-align:left;&quot;&gt;&lt;span style=&quot;float:right&quot;&gt;&lt;!--
	--&gt;&amp;nbsp; &lt;a href=&quot;javascript:;&quot; 
		title=&quot;select all tiddlers&quot;
		onclick=&quot;
		var f=this; while (f&amp;&amp;f.nodeName.toLowerCase()!='form')f=f.parentNode;
		for (var t=0; t&lt;f.list.options.length; t++)
			if (f.list.options[t].value.length) f.list.options[t].selected=true;
		config.macros.tiddlerTweaker.selecttiddlers(f.list);
		return false&quot;&gt;all&lt;/a&gt;&lt;!--
	--&gt;&amp;nbsp; &lt;a href=&quot;javascript:;&quot; 
		title=&quot;select tiddlers that are new/changed since the last file save&quot;
		onclick=&quot;
		var lastmod=new Date(document.lastModified);
		var f=this; while (f&amp;&amp;f.nodeName.toLowerCase()!='form')f=f.parentNode;
		for (var t=0; t&lt;f.list.options.length; t++) {
			var tid=store.getTiddler(f.list.options[t].value);
			f.list.options[t].selected=tid&amp;&amp;tid.modified&gt;lastmod;
		}
		config.macros.tiddlerTweaker.selecttiddlers(f.list);
		return false&quot;&gt;changed&lt;/a&gt;&lt;!--
	--&gt;&amp;nbsp; &lt;a href=&quot;javascript:;&quot; 
		title=&quot;select tiddlers with at least one matching tag&quot;
		onclick=&quot;
		var t=prompt('Enter space-separated tags (match ONE)');
		if (!t||!t.length) return false;
		var tags=t.readBracketedList();
		var f=this; while (f&amp;&amp;f.nodeName.toLowerCase()!='form')f=f.parentNode;
		for (var t=0; t&lt;f.list.options.length; t++) {
			f.list.options[t].selected=false;
			var tid=store.getTiddler(f.list.options[t].value);
			if (tid&amp;&amp;tid.tags.containsAny(tags)) f.list.options[t].selected=true;
		}
		config.macros.tiddlerTweaker.selecttiddlers(f.list);
		return false&quot;&gt;tags&lt;/a&gt;&lt;!--
	--&gt;&amp;nbsp; &lt;a href=&quot;javascript:;&quot; 
		title=&quot;select tiddlers whose titles include matching text&quot;
		onclick=&quot;
		var txt=prompt('Enter a title (or portion of a title) to match');
		if (!txt||!txt.length) return false;
		var f=this; while (f&amp;&amp;f.nodeName.toLowerCase()!='form')f=f.parentNode;
		for (var t=0; t&lt;f.list.options.length; t++) {
			f.list.options[t].selected=f.list.options[t].value.indexOf(txt)!=-1;
		}
		config.macros.tiddlerTweaker.selecttiddlers(f.list);
		return false&quot;&gt;titles&lt;/a&gt;&lt;!--
	--&gt;&amp;nbsp; &lt;a href=&quot;javascript:;&quot; 
		title=&quot;select tiddlers containing matching text&quot;
		onclick=&quot;
		var txt=prompt('Enter tiddler text (content) to match');
		if (!txt||!txt.length) return false;
		var f=this; while (f&amp;&amp;f.nodeName.toLowerCase()!='form')f=f.parentNode;
		for (var t=0; t&lt;f.list.options.length; t++) {
			var tt=store.getTiddlerText(f.list.options[t].value,'');
			f.list.options[t].selected=(tt.indexOf(txt)!=-1);
		}
		config.macros.tiddlerTweaker.selecttiddlers(f.list);
		return false&quot;&gt;text&lt;/a&gt; &amp;nbsp;&lt;!--
	--&gt;&lt;/span&gt;&lt;span&gt;select tiddlers&lt;/span&gt;&lt;!--
	--&gt;&lt;/div&gt;&lt;!--
	--&gt;&lt;/font&gt;&lt;select multiple name=list size=&quot;11&quot; style=&quot;width:99.99%&quot; 
		title=&quot;use click, shift-click and/or ctrl-click to select multiple tiddler titles&quot; 
		onclick=&quot;config.macros.tiddlerTweaker.selecttiddlers(this)&quot; 
		onchange=&quot;config.macros.tiddlerTweaker.setfields(this)&quot;&gt;&lt;!--
	--&gt;&lt;/select&gt;&lt;br&gt;&lt;!--
	--&gt;show&lt;input type=text size=1 value=&quot;11&quot; 
		onchange=&quot;this.form.list.size=this.value; this.form.list.multiple=(this.value&gt;1);&quot;&gt;&lt;!--
	--&gt;by&lt;!--
	--&gt;&lt;select name=sortby size=1 
		onchange=&quot;config.macros.tiddlerTweaker.init(this.form,this.value)&quot;&gt;&lt;!--
	--&gt;&lt;option value=&quot;title&quot;&gt;title&lt;/option&gt;&lt;!--
	--&gt;&lt;option value=&quot;size&quot;&gt;size&lt;/option&gt;&lt;!--
	--&gt;&lt;option value=&quot;modified&quot;&gt;modified&lt;/option&gt;&lt;!--
	--&gt;&lt;option value=&quot;created&quot;&gt;created&lt;/option&gt;&lt;!--
	--&gt;&lt;option value=&quot;modifier&quot;&gt;modifier&lt;/option&gt;&lt;!--
	--&gt;&lt;/select&gt;&lt;!--
	--&gt;&lt;input type=&quot;button&quot; value=&quot;refresh&quot; 
		onclick=&quot;config.macros.tiddlerTweaker.init(this.form,this.form.sortby.value)&quot;&lt;!--
	--&gt; &lt;input type=&quot;button&quot; name=&quot;stats&quot; disabled value=&quot;totals...&quot; 
		onclick=&quot;config.macros.tiddlerTweaker.stats(this)&quot;&gt;&lt;!--
--&gt;&lt;/td&gt;&lt;td style=&quot;width:1%&quot;&gt;&lt;!--
	--&gt;&lt;div style=&quot;text-align:left&quot;&gt;&lt;font size=-2&gt;&amp;nbsp;modify values&lt;/font&gt;&lt;/div&gt;&lt;!--
	--&gt;&lt;table style=&quot;width:100%;&quot;&gt;&lt;tr&gt;&lt;!--
	--&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=checkbox name=settitle unchecked 
			title=&quot;allow changes to tiddler title (rename tiddler)&quot; 
			onclick=&quot;this.form.title.disabled=!this.checked&quot;&gt;title&lt;!--
	--&gt;&lt;/td&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=text name=title size=35 style=&quot;width:98%&quot; disabled&gt;&lt;!--
	--&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=checkbox name=setcreator unchecked 
			title=&quot;allow changes to tiddler creator&quot; 
			onclick=&quot;this.form.creator.disabled=!this.checked&quot;&gt;created by&lt;!--
	--&gt;&lt;/td&gt;&lt;td style=&quot;padding:1px;&quot;&gt;&lt;!--
		--&gt;&lt;input type=text name=creator size=35 style=&quot;width:98%&quot; disabled&gt;&lt;!--
	--&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=checkbox name=setwho unchecked 
			title=&quot;allow changes to tiddler author&quot; 
			onclick=&quot;this.form.who.disabled=!this.checked&quot;&gt;modified by&lt;!--
	--&gt;&lt;/td&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=text name=who size=35 style=&quot;width:98%&quot; disabled&gt;&lt;!--
	--&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=checkbox name=setcdate unchecked 
			title=&quot;allow changes to created date&quot; 
			onclick=&quot;var f=this.form;
				f.cm.disabled=f.cd.disabled=f.cy.disabled=f.ch.disabled=f.cn.disabled=!this.checked&quot;&gt;&lt;!--
		--&gt;created on&lt;!--
	--&gt;&lt;/td&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=text name=cm size=2 style=&quot;width:2em;padding:0;text-align:center&quot; disabled&gt;&lt;!--
		--&gt; / &lt;input type=text name=cd size=2 style=&quot;width:2em;padding:0;text-align:center&quot; disabled&gt;&lt;!--
		--&gt; / &lt;input type=text name=cy size=4 style=&quot;width:3em;padding:0;text-align:center&quot; disabled&gt;&lt;!--
		--&gt; at &lt;input type=text name=ch size=2 style=&quot;width:2em;padding:0;text-align:center&quot; disabled&gt;&lt;!--
		--&gt; : &lt;input type=text name=cn size=2 style=&quot;width:2em;padding:0;text-align:center&quot; disabled&gt;&lt;!--
	--&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=checkbox name=setmdate unchecked 
			title=&quot;allow changes to modified date&quot; 
			onclick=&quot;var f=this.form;
				f.mm.disabled=f.md.disabled=f.my.disabled=f.mh.disabled=f.mn.disabled=!this.checked&quot;&gt;&lt;!--
		--&gt;modified on&lt;!--
	--&gt;&lt;/td&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=text name=mm size=2 style=&quot;width:2em;padding:0;text-align:center&quot; disabled&gt;&lt;!--
		--&gt; / &lt;input type=text name=md size=2 style=&quot;width:2em;padding:0;text-align:center&quot; disabled&gt;&lt;!--
		--&gt; / &lt;input type=text name=my size=4 style=&quot;width:3em;padding:0;text-align:center&quot; disabled&gt;&lt;!--
		--&gt; at &lt;input type=text name=mh size=2 style=&quot;width:2em;padding:0;text-align:center&quot; disabled&gt;&lt;!--
		--&gt; : &lt;input type=text name=mn size=2 style=&quot;width:2em;padding:0;text-align:center&quot; disabled&gt;&lt;!--
	--&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=checkbox name=replacetext unchecked
			title=&quot;find/replace matching text&quot; 
			onclick=&quot;this.form.pattern.disabled=this.form.replacement.disabled=!this.checked&quot;&gt;replace text&lt;!--
	--&gt;&lt;/td&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=text name=pattern size=15 value=&quot;&quot; style=&quot;width:40%&quot; disabled 
			title=&quot;enter TEXT PATTERN (regular expression)&quot;&gt; with&lt;!--
		--&gt;&lt;input type=text name=replacement size=15 value=&quot;&quot; style=&quot;width:40%&quot; disabled 
			title=&quot;enter REPLACEMENT TEXT&quot;&gt;&lt;!--
	--&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=checkbox name=settags checked 
			title=&quot;allow changes to tiddler tags&quot; 
			onclick=&quot;this.form.tags.disabled=!this.checked&quot;&gt;tags&lt;!--
	--&gt;&lt;/td&gt;&lt;td style=&quot;padding:1px&quot;&gt;&lt;!--
		--&gt;&lt;input type=text name=tags size=35 value=&quot;&quot; style=&quot;width:98%&quot; 
			title=&quot;enter new tags or use '+tag' and '-tag' to add/remove tags from existing tags&quot;&gt;&lt;!--
	--&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;!--
	--&gt;&lt;div style=&quot;text-align:center&quot;&gt;&lt;!--
	--&gt;&lt;nobr&gt;&lt;input type=button name=display disabled style=&quot;width:24%&quot; value=&quot;display&quot; 
		title=&quot;show selected tiddlers&quot;
		onclick=&quot;config.macros.tiddlerTweaker.displaytiddlers(this,false)&quot;&gt;&lt;!--
	--&gt; &lt;input type=button name=edit disabled style=&quot;width:23%&quot; value=&quot;edit&quot; 
		title=&quot;edit selected tiddlers&quot;
		onclick=&quot;config.macros.tiddlerTweaker.displaytiddlers(this,true)&quot;&gt;&lt;!--
	--&gt; &lt;input type=button name=del disabled style=&quot;width:24%&quot; value=&quot;delete&quot; 
		title=&quot;remove selected tiddlers&quot;
		onclick=&quot;config.macros.tiddlerTweaker.deltiddlers(this)&quot;&gt;&lt;!--
	--&gt; &lt;input type=button name=set disabled style=&quot;width:24%&quot; value=&quot;update&quot; 
		title=&quot;update selected tiddlers&quot;
		onclick=&quot;config.macros.tiddlerTweaker.settiddlers(this)&quot;&gt;&lt;/nobr&gt;&lt;!--
	--&gt;&lt;/div&gt;&lt;!--
--&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;!--
--&gt;&lt;/form&gt;&lt;span style=&quot;display:none&quot;&gt;&lt;!--content replaced by tiddler &quot;stats&quot;--&gt;&lt;/span&gt;
!end
//}}}
***/
 </pre>
</div>
<div title="TiddlyLockPlugin" modifier="JohnRouillard" created="200705101358" modified="201007190236" tags="systemConfig excludeMissing">
<pre>/***
|Name|TiddlyLockPlugin|
|Source|http://www.minormania.com/tiddlylock/tiddlylock.html|
|Version|1.2|
|Author|Richard Hobbis|
|License|[[Creative Commons Attribution-ShareAlike 3.0 License|http://creativecommons.org/licenses/by-sa/3.0/]]|
|Type|plugin|
|Overrides|config.macros.newTiddler.onClickNewTiddler()&lt;br&gt;config.commands.cancelTiddler.handler()&lt;br&gt;config.commands.deleteTiddler.handler&lt;br&gt;config.commands.editTiddler.handler()&lt;br&gt;config.commands.saveTiddler.handler()&lt;br&gt;saveChanges()&lt;br&gt;checkUnsavedChanges()|
|Description|Automatically locks and unlocks the TiddlyWiki as required, allowing multiple users to edit the TiddlyWiki without fear of overwriting other users' changes.|
!!!Usage
&lt;&lt;&lt;
Simply import TiddlyLockPlugin into your TiddlyWiki!
&lt;&lt;&lt;
!!!Installation
&lt;&lt;&lt;
Import (or copy/paste) ''this tiddler'' into your TiddlyWiki and make sure it's tagged with &lt;&lt;tag systemConfig&gt;&gt;. Reload your TiddlyWiki to enable TiddlyLock.
&lt;&lt;&lt;
!!!Configuration
&lt;&lt;&lt;
None required!
&lt;&lt;&lt;
!!!Revision History
&lt;&lt;&lt;
''2010.07.06 [1.2.0]'' Allow the location of the Lock File to be specified by the user, instead of defaulting to the location of the TiddlyWiki file. The default location is the same folder as the TiddlyWiki file itself, however this can be changed by editing ''//this html file//'' in a text editor and search for {{{TiddlyLock.LockPath = '';}}} The folder will be created if it doesn't exist.
''2010.07.06 [1.2.0]'' Upgraded this TiddlyWiki to core version 2.6
''2008.05.15 [1.1.0]'' Upgraded source TiddlyWiki to use core version 2.4. Tested and verified TiddlyLock under version 2.4.
''2007.06.22 [1.0.4]'' Added locking on 'new tiddler' which also traps 'new journal'. Tweaked messages.
''2007.06.20 [1.0.3]'' Fixed an issue that occurred when a user navigated away from the TiddlyWiki without saving outstanding changes.
''2007.05.10 [1.0.2]'' Implemented a timestamp to track the last update time. This fixes the multi-browser edit issue and also removes the need for a password.
''2007.05.08 [1.0.1]'' Function overrides are now done using apply() ensuring clean upgrades (thanks Martin!)
''2007.05.01 [1.0.0]'' Initial Release
&lt;&lt;&lt;
!!!Known Issues
&lt;&lt;&lt;
*Monkey Pirate TiddlyWiki (MPTW) adds a ''disable'' button to the toolbar for systemConfig tiddlers. This button is available even when the TW is marked as readOnly and therefore it's possible for two users to disable/enable plugins at the same time. In this case, whoever saves the TW last will 'win' and their changes will be saved. Note that this is only an issue if there are no other unsaved changes in both browsers - TiddlyLock still handles all other changes.
&lt;&lt;&lt;
!!!Credits
&lt;&lt;&lt;
This feature was developed by Richard Hobbis (rhobbis [at] hotmail [dot] com).
&lt;&lt;&lt;
!!!Code
***/

//{{{
// Convert a date to UTC YYYYMMDDHHMMSSMMM string format
// This is the same as the builtin function convertToYYYYMMDDHHMMSSMMM() but
// without the '.' in the middle - this allows simple date comparisons
Date.prototype.TLConvertToYYYYMMDDHHMMSSMMM = function()
{
  return(String.zeroPad(this.getUTCFullYear(),4)
    + String.zeroPad(this.getUTCMonth()+1,2)
    + String.zeroPad(this.getUTCDate(),2)
    + String.zeroPad(this.getUTCHours(),2)
    + String.zeroPad(this.getUTCMinutes(),2)
    + String.zeroPad(this.getUTCSeconds(),2)
    + String.zeroPad(this.getUTCMilliseconds(),4));
}

// namespace for TiddlyLock
TiddlyLock = {};

// Load/Last Update timestamp
TiddlyLock.TimeStamp = new Date().TLConvertToYYYYMMDDHHMMSSMMM();

// Lockfile
TiddlyLock.LockPath = ''; // custom values *must* include trailing '\\'
TiddlyLock.OldLockData = '';
TiddlyLock.LockData = '';
TiddlyLock.LockFile = TLLockPath();
// define messages
TiddlyLock.Msg = {
  Locked: 'File locked',
  Unlocked: 'File unlocked',
  LockFailed: 'Failed to lock file',
  UnlockFailed: 'Failed to unlock file',
  ReadOnly: 'Now in Read-Only mode.',
  Changed: 'This file has been changed by someone else.',
  Reload: 'Reload this file before editing.'};

// create/update the lock file
function TLSave(timeStamp,lockedBy)
{
  var lockedText='';
  if (lockedBy!='')
  {
    lockedText=timeStamp+'##'+lockedBy;
  }
  else lockedText=timeStamp+'##';
    var lockSave=saveFile(TiddlyLock.LockFile,lockedText);
  TiddlyLock.TimeStamp = timeStamp;
  return false;
}


// Create/update the lock file to prevent other users from editing the TW
function TLLock()
{
  clearMessage();
  lockSave = TLSave(new Date().TLConvertToYYYYMMDDHHMMSSMMM(),config.options.txtUserName);
  displayMessage(TiddlyLock.Msg.Locked,'');
  return false;
}


// Clear the lock file if necessary, but only if I have it locked, setting the
// timestamp in the lockfile to the specified value
function TLUnlock(timeStamp)
{
  if ((store &amp;&amp; store.isDirty &amp;&amp; !store.isDirty())
    &amp;&amp; (story &amp;&amp; story.areAnyDirty &amp;&amp; !story.areAnyDirty())
    &amp;&amp; TLIsLocked()
    &amp;&amp; TLIsLockedByMe())
  {
    lockSave=TLSave(timeStamp,'','');
    displayMessage(TiddlyLock.Msg.Unlocked,'');
    TiddlyLock.OldLockData = TiddlyLock.LockData;
  }
  return false;
}

// Get the contents of the lock file, if it exists
function TLLockPath()
{
  var lockPath,pathRoot,p,fileName;
  var fullPath=document.location.toString();
  if(TiddlyLock.LockPath!='') pathRoot=TiddlyLock.LockPath; // location of lock file is defined by TiddlyLock.LockPath
  else pathRoot=getLocalPath(fullPath); // location of lock file is derived from the wiki filename
  if((p=pathRoot.lastIndexOf('\\'))!=-1) pathRoot=pathRoot.substr(0,p+1); // truncate any trailing filename (derived paths only)
  fileName=getLocalPath(fullPath); // full wiki file name, including path
  if((p=fileName.lastIndexOf('\\'))!=-1) fileName=fileName.substr(p+1); // truncate everything up to the last slash
  if((p=fileName.lastIndexOf('.'))!=-1) fileName=fileName.substr(0,p); // remove any existing extension
  fileName=fileName+'.lck'; // add new extension
  return pathRoot+fileName;
}

// Get the contents of the lock file, if it exists
function TLLockData()
{
  return loadFile(TiddlyLock.LockFile);
}

// Get the contents of the lock file, if it exists
function TLIsLocked()
{
  TiddlyLock.LockData = TLLockData();
  if (TiddlyLock.LockData
      &amp;&amp; ( TLLockedBy(TiddlyLock.LockData)!='' // someone has it locked
         || TiddlyLock.TimeStamp &lt; TLLockedTimeStamp(TiddlyLock.LockData) // changed by someone else but not currently locked
         )
     )
    return true;
  else
    return false;
}


// check if locked by me
function TLIsLockedByMe()
{
  if(TiddlyLock.LockData == TiddlyLock.TimeStamp+'##' + config.options.txtUserName)
    return true;
  else
    return false;
}


// returns just the timestamp portion of the supplied lock file contents
function TLLockedTimeStamp(lockData)
{
  if(lockData)
    return lockData.split('##')[0];
  else
    return '';
}


// returns just the username portion of the supplied lock file contents
function TLLockedBy(lockData)
{
  if(lockData)
    return lockData.split('##')[1];
  else
    return '';
}

// display a message if locked or changed
function TLChangesAllowed()
{
  if(TLIsLocked() &amp;&amp; !TLIsLockedByMe())
  {
    readOnly=true;
    if(TLLockedBy(TiddlyLock.LockData))
    {
      displayMessage(TiddlyLock.Msg.Locked+' by '+TLLockedBy(TiddlyLock.LockData));
      alert(TiddlyLock.Msg.Locked+' by '+TLLockedBy(TiddlyLock.LockData)+'. '+TiddlyLock.Msg.ReadOnly);
    }
    else
    {
      displayMessage(TiddlyLock.Msg.Changed+' '+TiddlyLock.Msg.Reload);
      alert(TiddlyLock.Msg.Changed+' '+TiddlyLock.Msg.Reload);
    }
    return false;
  }
  else
    return true;
}


//*********************************************
// OVERRIDE STANDARD FUNCTIONS
//*********************************************

//
// OVERRIDE onClickNewTiddler()
//
TiddlyLock.onClickNewTiddler = config.macros.newTiddler.onClickNewTiddler;
config.macros.newTiddler.onClickNewTiddler = function(event,src,title)
{
  if (TLChangesAllowed())
  {
    TiddlyLock.OldLockData = TiddlyLock.LockData;
    TLLock();
    var ret = TiddlyLock.onClickNewTiddler.apply(this,arguments);
    return ret;
  }
}

//
// OVERRIDE checkUnsavedChanges()
//
TiddlyLock.checkUnsavedChanges = checkUnsavedChanges;
checkUnsavedChanges = function(event,src,title)
{
  var ret = TiddlyLock.checkUnsavedChanges.apply(this,arguments);
  if(TLIsLocked() &amp;&amp; TLIsLockedByMe())
    lockSave=TLSave(TLLockedTimeStamp(TiddlyLock.OldLockData),'','');
  return ret;
}


//
// OVERRIDE cancelTiddler()
//
TiddlyLock.cancelTiddler = config.commands.cancelTiddler.handler;
config.commands.cancelTiddler.handler = function(event,src,title)
{
  var ret = TiddlyLock.cancelTiddler.apply(this,arguments);
  TLUnlock(TLLockedTimeStamp(TiddlyLock.OldLockData));
  return ret;
}

//
// OVERRIDE deleteTiddler()
//
TiddlyLock.deleteTiddler = config.commands.deleteTiddler.handler;
config.commands.deleteTiddler.handler = function(event,src,title)
{
  if (TLChangesAllowed())
  {
    TiddlyLock.OldLockData = TiddlyLock.LockData;
    TLLock();
    var ret = TiddlyLock.deleteTiddler.apply(this,arguments);
    return ret;
  }
}

//
// OVERRIDE editTiddler()
//
TiddlyLock.editTiddler = config.commands.editTiddler.handler;
config.commands.editTiddler.handler = function(event,src,title)
{
  if (TLChangesAllowed())
  {
    TiddlyLock.OldLockData = TiddlyLock.LockData;
    TLLock();
  }
  var ret = TiddlyLock.editTiddler.apply(this,arguments);
  return ret;
}

//
// OVERRIDE saveChanges()
//
TiddlyLock.saveChanges = saveChanges;
saveChanges = function(onlyIfDirty)
{
  if(TLChangesAllowed())
  {
    var ret = TiddlyLock.saveChanges.apply(this,arguments);
    TLUnlock(new Date().TLConvertToYYYYMMDDHHMMSSMMM());
    return ret;
  }
  else
    return false;
}

//
// OVERRIDE saveTiddler()
//
TiddlyLock.saveTiddler= config.commands.saveTiddler.handler;
config.commands.saveTiddler.handler=function(event,src,title)
{
  var ret = TiddlyLock.saveTiddler.apply(this,arguments);
  TLUnlock(new Date().TLConvertToYYYYMMDDHHMMSSMMM());
  return ret;
}

//}}}</pre>
</div>
<div title="TiddlyWiki" modifier="JohnRouillard" created="200908091931" modified="201007050242" tags="content">
<pre>&lt;&lt;tiddler Glossary/tiddlyWiki&gt;&gt; See http://www.tiddlywiki.org.
</pre>
</div>
<div title="TiddlyWiki Page Layout (Instructor)" modifier="JohnRouillard" created="201008012002" modified="201008081709" tags="InstructorOnly">
<pre>This page includes instructor only info for the [[Reference Appendix 1 - TiddlyWiki Page Layout]] content tiddler.

!mainMenu

All of the links above are present in both the instructor and student coursebooks. The following links are present only in the instructor coursebook and are supplied by the inclusion of the InstructorMainMenu tiddler (which is intentionally missing from the student coursebook).
;Toggle Fullscreen
:This goes one step further and makes the main menu, side bar and title disappear so the story column take over the entire display. When activated a small button at the top right of the page allows you to switch back into normal display mode.
;Defined Tags
:When clicked on this pops up a list of the important tags for tiddlers to make the coursebook work.
;[[Bugs And Feature Requests]]
:This is a place to see what is on the todo list for the coursebook. If you want to add your own, I suggest creating new tiddlers say LocalBugsFeatures and adding: {{{&lt;&lt;tiddler LocalBugsFeatures&gt;&gt;}}} to the bottom of the [[Bugs And Feature Requests]] tiddler. This way you can sync against a new version of the coursebook and not lose your local modifications.
;[[Content Bugs]]
:The bugs and features request relates to issues with the courebook itself, that is the html and javascript code and key structure tiddlers that make the coursebook work. In comparison, this tiddler records issues with the content: missing tiddlers, missing images sections that need to be added to a tiddler etc.

!newTiddlers

The following entries are only present in the instructor version of the coursebook. They are defined in a hidden section of the [[InstructorSidebarFunctions|InstructorSidebarFunctions##newTiddlers]] that is intentionally not exported to the student coursebook.
;new chapter tiddler
:creates a new [[chapter control tiddler|Glossary/chapterControlTiddler]] with a template for the title and appropriate tags.
;new content tiddler
:creates a new tiddler tagged with {{{content}}}.
;new presentation tiddler
:creates a new [[presentation control tiddler|Glossary/presentationControlTiddler]] with a template for the title and appropriate tags.
;new slide tiddler
:creates a new tiddler meant to be used as a slide in a presentation with appropriate tags.

! saveChanges
Using the Tweak tool in the [[backstage|Using the Backstage Link]] menu will not modify the state of the tiddlers, but it will change them, so using this link is the proper way to save the changes.
! instructorMenu
; instructor 
:&lt;&lt;tiddler [[ReadMe##Publishing for Students and others.]]&gt;&gt;
!end</pre>
</div>
<div title="ToggleFullScreen" modifier="ELSDesignStudios" created="200801202351" modified="200910102221" tags="transclusion bookmarklet InstructorOnly">
<pre>/%
!info
|Name|ToggleFullScreen|
|Source|http://www.TiddlyTools.com/#ToggleFullScreen|
|Version|2.0.1|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|transclusion|
|Description|Create a link that shows/hides sidebars and page headers|
Usage
&lt;&lt;&lt;
{{{
&lt;&lt;tiddler ToggleFullScreen&gt;&gt;
&lt;&lt;tiddler ToggleFullScreen with: label altlabel&gt;&gt;
}}}
&lt;&lt;&lt;
Example
&lt;&lt;&lt;
{{{&lt;&lt;tiddler ToggleFullScreen with: fullscreen restore&gt;&gt;}}}
&lt;&lt;tiddler ToggleFullScreen##show with: fullscreen restore&gt;&gt;
&lt;&lt;&lt;
!end

!show
&lt;html&gt;&lt;nowiki&gt;&lt;a href='javascript:;' title=&quot;FULLSCREEN: toggle sidebars and page header&quot;
onmouseover=&quot;
	this.href='javascript:void(eval(decodeURIComponent(%22(function(){try{('
	+encodeURIComponent(encodeURIComponent(this.onclick))
	+')()}catch(e){alert(e.description?e.description:e.toString())}})()%22)))';&quot;
onclick=&quot;
	var co=config.options;
	co.chkFullScreen=!co.chkFullScreen;
	var showmm=!co.chkFullScreen &amp;&amp; co.chkShowLeftSidebar!==false;
	var showsb=!co.chkFullScreen &amp;&amp; co.chkShowRightSidebar!==false;
	var showcrumbs=!co.chkFullScreen &amp;&amp; co.chkShowBreadcrumbs!==false
		&amp;&amp; config.macros.breadcrumbs &amp;&amp; config.macros.breadcrumbs.crumbs.length;
	var cw=document.getElementById('contentWrapper');
	var da=document.getElementById('displayArea');
	var mm=document.getElementById('mainMenu');
	var sb=document.getElementById('sidebar');
	var sm=document.getElementById('storyMenu');
	var bc=document.getElementById('breadCrumbs');
	if (cw){
		var elems=cw.getElementsByTagName('*');
		for (var i=0; i&lt;elems.length; i++) if (hasClass(elems[i],'header')) 
			{ elems[i].style.display=co.chkFullScreen?'none':'block'; break; }
	}
	if (mm) {
		mm.style.display=showmm?'block':'none';
		da.style.marginLeft=showmm?(co.txtDisplayAreaLeftMargin||''):'1em';
	}
	if (sb) {
		sb.style.display=showsb?'block':'none';
		da.style.marginRight=showsb?(co.txtDisplayAreaRightMargin||''):'1em';
	}
	if (sm) sm.style.display=!co.chkFullScreen ?'block':'none';
	if (bc) bc.style.display=showcrumbs?'block':'none';

	this.innerHTML=!co.chkFullScreen?'$1':'$2';
	var b=document.getElementById('restoreFromFullscreenButton');
	if (b) removeNode(b);
	else { 
		setStylesheet(store.getTiddlerText('ToggleFullScreen##styles'),'fullScreenStyles');
		var b=createTiddlyElement(null,'span','restoreFromFullscreenButton','selected');
		b.innerHTML='&amp;loz;';
		b.title='RESTORE: redisplay page header, menu and sidebar';
		b.onclick=this.onclick;
		document.body.insertBefore(b,null);
	}
	return false;
&quot;&gt;$1&lt;/a&gt;&lt;/html&gt;
!styles
#restoreFromFullscreenButton {
	position:fixed; top:.3em; right:.3em; z-index:10001;
	cursor:pointer; font-size:8pt; color:ButtonText !important;
	border:2px outset ButtonFace; padding:0px 3px;
	background-color:ButtonFace; -moz-appearance:button;
}
!end
%/&lt;&lt;tiddler {{var src='ToggleFullScreen'; src+(tiddler&amp;&amp;tiddler.title==src?'##info':'##show');}}
with:	{{'$'+'1'!='$1'?'$1':'fullscreen'}}
	{{'$'+'2'!='$2'?'$2':'restore'}}&gt;&gt;</pre>
</div>
<div title="ToggleSideBarMacro" modifier="Saq" created="200607191655" modified="200607241018" tags="systemConfig lewcidExtension excludeLists excludeMissing">
<pre>/***

|Name|ToggleSideBarMacro|
|Created by|SaqImtiaz|
|Location|http://tw.lewcid.org/#ToggleSideBarMacro|
|Version|1.0|
|Requires|~TW2.x|
!Description:
Provides a button for toggling visibility of the SideBar. You can choose whether the SideBar should initially be hidden or displayed.

!Demo
&lt;&lt;toggleSideBar &quot;Toggle Sidebar&quot;&gt;&gt;

!Usage:
{{{&lt;&lt;toggleSideBar&gt;&gt;}}} &lt;&lt;toggleSideBar&gt;&gt;
additional options:
{{{&lt;&lt;toggleSideBar label tooltip show/hide&gt;&gt;}}} where:
label = custom label for the button,
tooltip = custom tooltip for the button,
show/hide = use one or the other, determines whether the sidebar is shown at first or not.
(default is to show the sidebar)

You can add it to your tiddler toolbar, your MainMenu, or where you like really.
If you are using a horizontal MainMenu and want the button to be right aligned, put the following in your StyleSheet:
{{{ .HideSideBarButton {float:right;} }}}

!History
*23-07-06: version 1.0: completely rewritten, now works with custom stylesheets too, and easier to customize start behaviour. 
*20-07-06: version 0.11
*27-04-06: version 0.1: working.

!Code
***/
//{{{
config.macros.toggleSideBar={};

config.macros.toggleSideBar.settings={
         styleHide :  &quot;#sidebar { display: none;}\n&quot;+&quot;#contentWrapper #displayArea { margin-right: 1em;}\n&quot;+&quot;&quot;,
         styleShow : &quot; &quot;,
         arrow1: &quot;&quot;,
         arrow2: &quot;&quot;
};

config.macros.toggleSideBar.handler=function (place,macroName,params,wikifier,paramString,tiddler)
{
          var tooltip= params[1]||'toggle sidebar';
          var mode = (params[2] &amp;&amp; params[2]==&quot;hide&quot;)? &quot;hide&quot;:&quot;show&quot;;
          var arrow = (mode == &quot;hide&quot;)? this.settings.arrow1:this.settings.arrow2;
          var label= (params[0]&amp;&amp;params[0]!='.')?params[0]+&quot; &quot;+arrow:arrow;
          var theBtn = createTiddlyButton(place,label,tooltip,this.onToggleSideBar,&quot;button HideSideBarButton&quot;);
          if (mode == &quot;hide&quot;)
             { 
             (document.getElementById(&quot;sidebar&quot;)).setAttribute(&quot;toggle&quot;,&quot;hide&quot;);
              setStylesheet(this.settings.styleHide,&quot;ToggleSideBarStyles&quot;);
             }
};

config.macros.toggleSideBar.onToggleSideBar = function(){
          var sidebar = document.getElementById(&quot;sidebar&quot;);
          var settings = config.macros.toggleSideBar.settings;
          if (sidebar.getAttribute(&quot;toggle&quot;)=='hide')
             {
              setStylesheet(settings.styleShow,&quot;ToggleSideBarStyles&quot;);
              sidebar.setAttribute(&quot;toggle&quot;,&quot;show&quot;);
              this.firstChild.data= (this.firstChild.data).replace(settings.arrow1,settings.arrow2);
              }
          else
              {    
               setStylesheet(settings.styleHide,&quot;ToggleSideBarStyles&quot;);
               sidebar.setAttribute(&quot;toggle&quot;,&quot;hide&quot;);
               this.firstChild.data= (this.firstChild.data).replace(settings.arrow2,settings.arrow1);
              }

     return false;
}

setStylesheet(&quot;.HideSideBarButton .button {font-weight:bold; padding: 0 5px;}\n&quot;,&quot;ToggleSideBarButtonStyles&quot;);

//}}}</pre>
</div>
<div title="ToolbarCommands" modifier="JohnRouillard" created="201007050102" modified="201008012058">
<pre>|~ViewToolbar|closeTiddler closeOthers +editTiddler deleteTiddler &gt; fields syncing permalink references revisions jump|
|~EditToolbar|+saveTiddler -cancelTiddler copyTiddler deleteTiddler|</pre>
</div>
<div title="TspotSetupPlugin" modifier="YourName" created="200808081041" modified="200808081041" tags="systemConfig">
<pre>/***
Description: Contains the stuff you need to use Tiddlyspot
Note, you also need UploadPlugin, PasswordOptionPlugin and LoadRemoteFileThroughProxy
from http://tiddlywiki.bidix.info for a complete working Tiddlyspot site.
***/
//{{{

// edit this if you are migrating sites or retrofitting an existing TW
config.tiddlyspotSiteId = 'coursebook';

// make it so you can by default see edit controls via http
config.options.chkHttpReadOnly = false;
window.readOnly = false; // make sure of it (for tw 2.2)
window.showBackstage = true; // show backstage too

// disable autosave in d3
if (window.location.protocol != &quot;file:&quot;)
	config.options.chkGTDLazyAutoSave = false;

// tweak shadow tiddlers to add upload button, password entry box etc
with (config.shadowTiddlers) {
	SiteUrl = 'http://'+config.tiddlyspotSiteId+'.tiddlyspot.com';
	SideBarOptions = SideBarOptions.replace(/(&lt;&lt;saveChanges&gt;&gt;)/,&quot;$1&lt;&lt;tiddler TspotSidebar&gt;&gt;&quot;);
	OptionsPanel = OptionsPanel.replace(/^/,&quot;&lt;&lt;tiddler TspotOptions&gt;&gt;&quot;);
	DefaultTiddlers = DefaultTiddlers.replace(/^/,&quot;[[WelcomeToTiddlyspot]] &quot;);
	MainMenu = MainMenu.replace(/^/,&quot;[[WelcomeToTiddlyspot]] &quot;);
}

// create some shadow tiddler content
merge(config.shadowTiddlers,{

'TspotOptions':[
 &quot;tiddlyspot password:&quot;,
 &quot;&lt;&lt;option pasUploadPassword&gt;&gt;&quot;,
 &quot;&quot;
].join(&quot;\n&quot;),

'TspotControls':[
 &quot;| tiddlyspot password:|&lt;&lt;option pasUploadPassword&gt;&gt;|&quot;,
 &quot;| site management:|&lt;&lt;upload http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/store.cgi index.html . .  &quot; + config.tiddlyspotSiteId + &quot;&gt;&gt;//(requires tiddlyspot password)//&lt;br&gt;[[control panel|http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/controlpanel]], [[download (go offline)|http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/download]]|&quot;,
 &quot;| links:|[[tiddlyspot.com|http://tiddlyspot.com/]], [[FAQs|http://faq.tiddlyspot.com/]], [[blog|http://tiddlyspot.blogspot.com/]], email [[support|mailto:support@tiddlyspot.com]] &amp; [[feedback|mailto:feedback@tiddlyspot.com]], [[donate|http://tiddlyspot.com/?page=donate]]|&quot;
].join(&quot;\n&quot;),

'WelcomeToTiddlyspot':[
 &quot;This document is a ~TiddlyWiki from tiddlyspot.com.  A ~TiddlyWiki is an electronic notebook that is great for managing todo lists, personal information, and all sorts of things.&quot;,
 &quot;&quot;,
 &quot;@@font-weight:bold;font-size:1.3em;color:#444; //What now?// &amp;nbsp;&amp;nbsp;@@ Before you can save any changes, you need to enter your password in the form below.  Then configure privacy and other site settings at your [[control panel|http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/controlpanel]] (your control panel username is //&quot; + config.tiddlyspotSiteId + &quot;//).&quot;,
 &quot;&lt;&lt;tiddler TspotControls&gt;&gt;&quot;,
 &quot;See also GettingStarted.&quot;,
 &quot;&quot;,
 &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Working online// &amp;nbsp;&amp;nbsp;@@ You can edit this ~TiddlyWiki right now, and save your changes using the \&quot;save to web\&quot; button in the column on the right.&quot;,
 &quot;&quot;,
 &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Working offline// &amp;nbsp;&amp;nbsp;@@ A fully functioning copy of this ~TiddlyWiki can be saved onto your hard drive or USB stick.  You can make changes and save them locally without being connected to the Internet.  When you're ready to sync up again, just click \&quot;upload\&quot; and your ~TiddlyWiki will be saved back to tiddlyspot.com.&quot;,
 &quot;&quot;,
 &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Help!// &amp;nbsp;&amp;nbsp;@@ Find out more about ~TiddlyWiki at [[TiddlyWiki.com|http://tiddlywiki.com]].  Also visit [[TiddlyWiki.org|http://tiddlywiki.org]] for documentation on learning and using ~TiddlyWiki. New users are especially welcome on the [[TiddlyWiki mailing list|http://groups.google.com/group/TiddlyWiki]], which is an excellent place to ask questions and get help.  If you have a tiddlyspot related problem email [[tiddlyspot support|mailto:support@tiddlyspot.com]].&quot;,
 &quot;&quot;,
 &quot;@@font-weight:bold;font-size:1.3em;color:#444; //Enjoy :)// &amp;nbsp;&amp;nbsp;@@ We hope you like using your tiddlyspot.com site.  Please email [[feedback@tiddlyspot.com|mailto:feedback@tiddlyspot.com]] with any comments or suggestions.&quot;
].join(&quot;\n&quot;),

'TspotSidebar':[
 &quot;&lt;&lt;upload http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/store.cgi index.html . .  &quot; + config.tiddlyspotSiteId + &quot;&gt;&gt;&lt;html&gt;&lt;a href='http://&quot; + config.tiddlyspotSiteId + &quot;.tiddlyspot.com/download' class='button'&gt;download&lt;/a&gt;&lt;/html&gt;&quot;
].join(&quot;\n&quot;)

});
//}}}
</pre>
</div>
<div title="Types of Presentations" modifier="JohnRouillard" created="201007181857" modified="201007182120" tags="content">
<pre>You can create two types of presentations:
# Single tiddler presentations
# Multi-tiddler presentations

!! Single Tiddler Presentations
As the name &quot;Single tiddler&quot; implies, the presentation tiddler is divided into multiple segments and each segment is displayed as a slide in the presentation. This method has a few advantages:
* editing is easier as only one tiddler need to be modified,
* useful for &quot;administrative presentations&quot;. For example:
** a looping slide show at the beginning of a class welcoming the students and displaying info they need to know about the class. 
** a looping slide show during a class break with a countdown timer till class resumes.
However it comes with some drawbacks:
* Slide titles are generic ~TempSlide1, ~TempSlide2 etc. So you have to use a style/theme that doesn't display the tiddler title.
* Students can't annotate a slide as there is no actual tiddler associated with each slide.
* You have to hide certain control elements when using a single tiddler, but these elements aren't hidden if exported to the student copy.

!! Multi-tiddler Presentations
As the name &quot;Multi-tiddler&quot; implies, a single tiddler links to multiple slide tiddlers and each slide tiddler is displayed as a slide in the presentation. This method has a few advantages:
* Student's can't annotate single tiddler shows as there is no actual tiddler associated with each slide.
* The tiddler title is used as a slide title to provide a useful description of the slide content.
* A single tiddler can be used in multiple presentations
However it comes with some drawbacks:
* Revising multiple slides requires editing multiple tiddlers. (If you are doing text substitution consider using the TiddlerTweakerPlugin to do batch editing of content.)
* More tiddlers makes tiddlywiki somewhat slower
* The addition of slide tiddlers can make it more difficult to find the specific tiddler you are interested in.
</pre>
</div>
<div title="UnsavedChangesPlugin" modifier="ELSDesignStudios" created="200708030219" modified="200903021933" tags="systemConfig excludeMissing">
<pre>/***
|Name|UnsavedChangesPlugin|
|Source|http://www.TiddlyTools.com/#UnsavedChangesPlugin|
|Version|3.3.3|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements &lt;br&gt;and [[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
|~CoreVersion|2.1|
|Type|plugin|
|Requires||
|Overrides|TiddlyWiki.prototype.setDirty,store.saveTiddler,store.removeTiddler|
|Description|show droplist of tiddlers that have changed since the last time the document was saved|
Display a list of tiddlers that have been changed since the last time the document was saved.  The list includes all new/modified tiddlers as well as those changed with &quot;minor edits&quot; enabled and any tiddlers that you import during the session, regardless of their modification date.
!!!!!Usage
&lt;&lt;&lt;
{{{
&lt;&lt;unsavedChanges panel&gt;&gt; or &lt;&lt;unsavedChanges&gt;&gt;
}}}
{{indent{
the ''panel'' keyword displays a 'control panel' interface containing a droplist of unsaved tiddlers and a 'goto' button, along with a command link to 'save changes'.  Depending upon what other plugins are installed, several additional elements will also be displayed: When [[NestedSlidersPlugin]] is installed, the entire control panel is contained within a ''SLIDER''.  When [[LoadTiddlersPlugin]] is installed, a ''REVERT'' button is added.  When [[SaveAsPlugin]] is installed, a ''SAVE AS'' link is added.  When [[UploadPlugin]] is installed, an ''UPLOAD'' (or ''save to web'') link is added.  When [[TrashPlugin]] is installed and there are tiddlers tagged with&lt;&lt;tag Trash&gt;&gt;, an ''EMPTY TRASH'' link is added.
}}}
{{{
&lt;&lt;unsavedChanges list separator&gt;&gt;
}}}
{{indent{
the ''list'' keyword displays a simple space-separated list of unsaved tiddlers without any other command links.  You can specify an optional ''separator'' value that can be used in place of the default space character.  For example, you can specify {{{&quot;&lt;br&gt;&quot;}}} as the separator in order to display each link, one per line.
}}}
{{{
&lt;&lt;unsavedChanges command label tip&gt;&gt;
}}}
{{indent{
the ''command'' keyword displays a single 'command link' that, when clicked, displays a ~TiddlyWiki popup containing the list of unsaved tiddlers, the 'save changes' command and, depending upon what other plugins are installed, additional commands for 'save as', 'upload', and 'empty trash' (similar to the panel display described above).

You can specify optional ''label'' and ''tip'' parameters in the macro to customize the command link text and tooltip.  The default label for the command link is: &quot;There %1 %0 unsaved tiddler%2...&quot;, where:
* %0 is automatically replaced with the number of unsaved changes
* %1 is either &quot;is&quot; (if changes=1) or &quot;are&quot; (if changes&gt;1)
* %2 is either blank (if changes=1) or &quot;s&quot; (if changes&gt;1)
resulting in the text: //&quot;There is 1 unsaved tiddler...&quot;, &quot;There are 2 unsaved tiddlers...&quot;, etc.//
}}}
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
^^//note: the following examples will not display any output unless you have already created/modified tiddlers in the current document.//^^
{{{&lt;&lt;unsavedChanges&gt;&gt;}}}
&lt;&lt;unsavedChanges&gt;&gt;
----
{{{&lt;&lt;unsavedChanges command&gt;&gt;}}}
&lt;&lt;unsavedChanges command&gt;&gt;
----
{{{&lt;&lt;unsavedChanges list&gt;&gt;}}}
&lt;&lt;unsavedChanges list&gt;&gt;
----
{{{&lt;&lt;unsavedChanges list &quot;&lt;br&gt;&quot;&gt;&gt;}}}
&lt;&lt;unsavedChanges list &quot;&lt;br&gt;&quot;&gt;&gt;
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.03.02 [3.3.3] fix handling for titles that contain HTML special chars (lt,gt,quot,amp)
2008.09.02 [3.3.2] cleanup popup list output generation and added timestamps/sizes to popup display
2008.08.23 [3.3.1] added optional custom 'label' and 'tip' params to 'command' mode and defined default values for mode, label, tip, and separator as object properties for I18N/L10N-readiness.
2008.08.21 [3.3.0] complete re-write of rendering and refresh processing to support multiple instances and automatic self-refresh (no longer depends upon core refresh notifications)
2008.08.21 [3.2.0] added 'command' option for link+popup as alternative to 'control panel' interface
2008.04.22 [3.1.2] use SaveAsPlugin instead of obsolete NewDocumentPlugin to add &quot;save as&quot; link
2007.12.22 [3.1.1] hijack removeTiddler() instead of low-level deleteTiddler() to correct tracking and refresh handling issues.  in saveTiddler(), check for 'tiddler rename' (title!=newtitle) and adjust list accordingly.
2007.12.21 [3.1.0] added support for {{{&lt;&lt;unsavedChanges list separator&gt;&gt;}}} usage to unsaved tiddlers as a simple list of links, embedded in tiddler content (e.g., [[MainMenu]])
2007.12.20 [3.0.0] rewrite to track ALL changed tiddlers, including imports and minor edits, regardless of saved modification dates.  Also, rewrote display logic to directly refresh macro output instead of triggering a page refresh.  The entire process is MUCH more efficient now.
2007.08.02 [2.0.0] converted from inline script
2007.01.01 [1.0.0] initial release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.UnsavedChangesPlugin= {major: 3, minor: 3, revision: 3, date: new Date(2009,3,2)};

config.macros.unsavedChanges = {
	changed: [], // list of currently unsaved tiddler titles
	defMode: &quot;panel&quot;,
	defSep: &quot; &quot;,
	defLabel: &quot;There %1 %0 unsaved tiddler%2...&quot;,
	defTip: &quot;view a list of unsaved tiddler changes&quot;,
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		var wrapper=createTiddlyElement(place,&quot;span&quot;,null,&quot;unsavedChanges&quot;);
		wrapper.setAttribute(&quot;mode&quot;,params[0]||this.defMode);
		wrapper.setAttribute(&quot;sep&quot;,params[1]||this.defSep); // for 'list' mode
		wrapper.setAttribute(&quot;label&quot;,params[1]||this.defLabel); // for 'command' mode
		wrapper.setAttribute(&quot;tip&quot;,params[2]||this.defTip); // for 'command' mode
		this.render(wrapper);
	},
	render: function(wrapper) {
		removeChildren(wrapper); // make sure its empty
		if (!this.changed.length) return; // no changes = no output
		switch (wrapper.getAttribute(&quot;mode&quot;)) {
			case &quot;command&quot;: this.command(wrapper); break;
			case &quot;list&quot;: this.list(wrapper); break;
			case &quot;panel&quot;: default: this.panel(wrapper); break;
		}
	},
	refresh: function() {
		var wrappers=document.getElementsByTagName(&quot;span&quot;);
		for (var w=0; w&lt;wrappers.length; w++)
			if (hasClass(wrappers[w],&quot;unsavedChanges&quot;))
				this.render(wrappers[w]);
	},
	list: function(place) { // show simple list of unsaved tiddlers
		wikify(&quot;[[&quot;+this.changed.join(&quot;]]&quot;+place.getAttribute(&quot;sep&quot;)+&quot;[[&quot;)+&quot;]]&quot;,place);
	},
	command: function(place) { // show command link with popup list
		var c=this.changed.length;
		var txt=place.getAttribute(&quot;label&quot;).format([c,c==1?'is':'are',c==1?'':'s']);
		var tip=place.getAttribute(&quot;tip&quot;);
		var action=function(ev) { if (!ev) var ev=window.event;
			var p=Popup.create(this); if (!p) return false;
			var d=createTiddlyElement(p,&quot;div&quot;);
			d.style.whiteSpace=&quot;normal&quot;; d.style.width=&quot;auto&quot;; d.style.padding=&quot;2px&quot;;
			// gather pretty links for changed tiddlers
			var list=[]; var item=&quot; &amp;nbsp;[[%1 - %0 (%2 bytes)|%0]]&amp;nbsp; &quot;;
			for (var i=config.macros.unsavedChanges.changed.length-1; i&gt;=0; i--) {
				var tid=store.getTiddler(config.macros.unsavedChanges.changed[i]);
				if (!tid) continue;
				var when=tid.modified.formatString('YYYY.0MM.0DD 0hh:0mm:0ss');
				list.push(item.format([tid.title,when,tid.text.length]));
			}
			wikify(&quot;@@white-space:nowrap;&quot;+list.join(&quot;&lt;br&gt;&quot;)+&quot;@@&quot;,d);
			if (!readOnly) {
				var t=&quot;\n----\n&quot;;
				t+=&quot;@@white-space:nowrap;display:block;text-align:center; &amp;nbsp;&quot;;
				t+=&quot;&lt;&lt;saveChanges&gt;&gt;&quot;;
				t+=config.macros.saveAs?&quot; | &lt;&lt;saveAs&gt;&gt;&quot;:&quot;&quot;;
				t+=config.macros.upload?&quot; | &lt;&lt;upload&gt;&gt;&quot;:&quot;&quot;;
				t+=(config.macros.emptyTrash&amp;&amp;store.getTaggedTiddlers(&quot;Trash&quot;).length)?&quot; | &lt;&lt;emptyTrash&gt;&gt;&quot;:&quot;&quot;;
				t+=&quot;&amp;nbsp; @@&quot;;
				wikify(t,d);
			}
			Popup.show();
			ev.cancelBubble=true; if(ev.stopPropagation)ev.stopPropagation();
			return(false);
		}
		createTiddlyButton(place,txt,tip,action,&quot;button&quot;);
	},
	panel: function(place) { // show composite droplist+buttons+commands
		// gather changed tiddlers (in reverse order by date - most recent first)
		var tids=[]; for (var i=this.changed.length-1; i&gt;=0; i--)
			{ var t=store.getTiddler(this.changed[i]); if (t) tids.push(t); }
		tids.sort(function(a,b){return a.modified&lt;b.modified?-1:(a.modified==b.modified?0:1);});
		// generate droplist items
 		var list=[]; var item='&lt;option value=&quot;%0&quot;&gt;%1 - %0 (%2 bytes)&lt;/option&gt;';
		for (var i=tids.length-1; i&gt;=0; i--) {
			var when=tids[i].modified.formatString('YYYY.0MM.0DD 0hh:0mm:0ss');
			list.push(item.format([tids[i].title.htmlEncode(),when,tids[i].text.length]));
		}
		// display droplist, buttons, and command links
		var out=''; var c=this.changed.length;
		var NSP=config.formatters.findByField(&quot;name&quot;,&quot;nestedSliders&quot;);
		var summary=this.defLabel.format([c,c==1?'is':'are',c==1?'':'s'])
		out+=NSP?'+++(unsaved)['+summary+'|'+this.defTip+']...':(summary+&quot;\n&quot;);
		out+='&lt;html&gt;&lt;form style=&quot;display:inline&quot;&gt;&lt;!--\
			--&gt;&lt;select size=&quot;1&quot; name=&quot;list&quot; \
				title=&quot;select a tiddler to view&quot; \
				onchange=&quot;var v=this.value; if (v.length) story.displayTiddler(null,v);&quot;&gt;&lt;!--\
			--&gt;'+list.join('')+'&lt;!--\
			--&gt;&lt;/select&gt;&lt;!--\
			--&gt;&lt;input type=&quot;button&quot; value=&quot;goto&quot; onclick=&quot;this.form.list.onchange();&quot;&gt;';
		if (config.macros.loadTiddlers)  {
			out+='&lt;input type=&quot;button&quot; value=&quot;revert&quot; \
				title=&quot;import the last saved version of this tiddler&quot; \
				onclick=&quot;var v=this.form.list.value; if (!v.length) return; \
					var t=\'&lt;\'+\'&lt;loadTiddlers [[tiddler:\'+v+\']] \'; \
					t+=document.location.href; \
					t+=\' confirm force noreport&gt;\'+\'&gt;\'; \
					var e=document.getElementById(\'executeRevert\'); \
					if (e) e.parentNode.removeChild(e); \
					e=document.createElement(\'span\'); \
					e.id=\'executeRevert\'; \
					wikify(t,e);&quot;&gt;';
		}
		out+='&lt;/form&gt;&lt;/html&gt;';
		if (!readOnly) {
			out+='\n{{small nowrap{';
			out+=&quot;&lt;&lt;saveChanges&gt;&gt;&quot;;
			out+=config.macros.saveAs?&quot; | &lt;&lt;saveAs&gt;&gt;&quot;:&quot;&quot;;
			out+=config.macros.upload?&quot; | &lt;&lt;upload&gt;&gt;&quot;:&quot;&quot;;
			out+=(config.macros.emptyTrash&amp;&amp;store.getTaggedTiddlers(&quot;Trash&quot;).length)?&quot; | &lt;&lt;emptyTrash&gt;&gt;&quot;:&quot;&quot;;
			out+='}}}';
		}
		out+=NSP?'===':'';
		wikify(out,place);
	}
};

// hijack store.saveTiddler() to track changes to tiddlers
if (store.showUnsaved_saveTiddler==undefined) {
	store.showUnsaved_saveTiddler=store.saveTiddler;
	store.saveTiddler=function(title,newtitle) {
		if (title!=newtitle) {
			var i=config.macros.unsavedChanges.changed.indexOf(title);
			if (i!=-1) config.macros.unsavedChanges.changed.splice(i,1); // remove old from list
		} 
		var i=config.macros.unsavedChanges.changed.indexOf(newtitle);
		if (i!=-1) config.macros.unsavedChanges.changed.splice(i,1); // remove new title from list
		config.macros.unsavedChanges.changed.push(newtitle); // add new title to END of list
		var t=this.showUnsaved_saveTiddler.apply(this,arguments);
		if (!this.notificationLevel) config.macros.unsavedChanges.refresh();
		return t;
	}
}

// hijack store.removeTiddler() to track changes to tiddlers
if (store.showUnsaved_removeTiddler==undefined) {
	store.showUnsaved_removeTiddler=store.removeTiddler;
	store.removeTiddler=function(title) {
		var i=config.macros.unsavedChanges.changed.indexOf(title);
		if (i!=-1) config.macros.unsavedChanges.changed.splice(i,1); // remove from list
		this.showUnsaved_removeTiddler.apply(this,arguments);
		if (!this.notificationLevel) config.macros.unsavedChanges.refresh();
	}
}

// hijack store.setDirty() function to reset change list after file save
// note: do NOT hijack the prototype function.  This hijack should only be applied to
// the main 'store' instance only (i.e., don't refresh when loading temporary store
// as part of ImportTiddlers processing)
if (store.showUnsaved_setDirty==undefined) {
	store.showUnsaved_setDirty=store.setDirty;
	store.setDirty = function(flag) {
		var refresh=this.isDirty() &amp;&amp; !flag; // 'dirty' to 'clean', force a refresh...
		this.showUnsaved_setDirty.apply(this,arguments); // but change the flag first.
		if (refresh) {
			config.macros.unsavedChanges.changed=[]; // clear changed list
			config.macros.unsavedChanges.refresh();
		}
	}
}
//}}}</pre>
</div>
<div title="Update Your Coursebook" modifier="JohnRouillard" created="200910241746" modified="201007182154" tags="InstructorOnly slide">
<pre>After your coursebook is open, please update your coursebook:
# Go to the &quot;sync&quot; tiddler (all lower case) by typing ''sync'' into the Goto box on the top right and hitting enter.
# Click on the @@Import new content from &lt;&lt;tiddler [[GettingStarted::courseHomeContent]]&gt;&gt;@@ button (this usually takes 15-30 seconds to complete).
# You should see it import some tiddlers.
# Save the coursebook ''using the @@save changes@@ link in the right hand column''. You ''MUST NOT'' use the save menu item in your browser, it will break the coursebook.
# Refresh/reopen the coursebook
# Your coursebook is ready for class
/% these overlays keep the instructions on screen longer %/
{{overlay1{}}}
{{overlay2{}}}
</pre>
</div>
<div title="UploadLog" modifier="JohnRouillard" created="201007310658" modified="201008081932">
<pre>| !date | !user | !location | !storeUrl | !uploadDir | !toFilename | !backupdir | !origin |
| 31/07/2010 02:58:18 | JohnRouillard | [[coursebook_spot.html|file:///C:/Documents%20and%20Settings/rouilj/My%20Documents/coursebook/coursebook_spot.html]] | [[store.cgi|http://coursebook.tiddlyspot.com/store.cgi]] | . | [[index.html | http://coursebook.tiddlyspot.com/index.html]] | . | ok |
| 31/07/2010 03:29:43 | JohnRouillard | [[coursebook_spot.html|file:///C:/Documents%20and%20Settings/rouilj/My%20Documents/coursebook/coursebook_spot.html]] | [[store.cgi|http://coursebook.tiddlyspot.com/store.cgi]] | . | [[index.html | http://coursebook.tiddlyspot.com/index.html]] | . |
| 08/08/2010 15:29:37 | JohnRouillard | [[tscoursebook.html|file:///C:/Users/rouilj/Downloads/tscoursebook.html]] | [[store.cgi|http://coursebook.tiddlyspot.com/store.cgi]] | . | [[index.html | http://coursebook.tiddlyspot.com/index.html]] | . |
| 08/08/2010 15:32:05 | JohnRouillard | [[tscoursebook.html|file:///C:/Users/rouilj/Downloads/tscoursebook.html]] | [[store.cgi|http://coursebook.tiddlyspot.com/store.cgi]] | . | [[index.html | http://coursebook.tiddlyspot.com/index.html]] | . |</pre>
</div>
<div title="UploadPlugin" modifier="YourName" created="200808080918" modified="201007300138" tags="systemConfig">
<pre>/***
|''Name:''|UploadPlugin|
|''Description:''|Save to web a TiddlyWiki|
|''Version:''|4.1.3|
|''Date:''|Feb 24, 2008|
|''Source:''|http://tiddlywiki.bidix.info/#UploadPlugin|
|''Documentation:''|http://tiddlywiki.bidix.info/#UploadPluginDoc|
|''Author:''|BidiX (BidiX (at) bidix (dot) info)|
|''License:''|[[BSD open source license|http://tiddlywiki.bidix.info/#%5B%5BBSD%20open%20source%20license%5D%5D ]]|
|''~CoreVersion:''|2.2.0|
|''Requires:''|PasswordOptionPlugin|
***/
//{{{
version.extensions.UploadPlugin = {
	major: 4, minor: 1, revision: 3,
	date: new Date(&quot;Feb 24, 2008&quot;),
	source: 'http://tiddlywiki.bidix.info/#UploadPlugin',
	author: 'BidiX (BidiX (at) bidix (dot) info',
	coreVersion: '2.2.0'
};

//
// Environment
//

if (!window.bidix) window.bidix = {}; // bidix namespace
bidix.debugMode = false;	// true to activate both in Plugin and UploadService
	
//
// Upload Macro
//

config.macros.upload = {
// default values
	defaultBackupDir: '',	//no backup
	defaultStoreScript: &quot;store.php&quot;,
	defaultToFilename: &quot;index.html&quot;,
	defaultUploadDir: &quot;.&quot;,
	authenticateUser: true	// UploadService Authenticate User
};
	
config.macros.upload.label = {
	promptOption: &quot;Save and Upload this TiddlyWiki with UploadOptions&quot;,
	promptParamMacro: &quot;Save and Upload this TiddlyWiki in %0&quot;,
	saveLabel: &quot;save to web&quot;, 
	saveToDisk: &quot;save to disk&quot;,
	uploadLabel: &quot;upload&quot;	
};

config.macros.upload.messages = {
	noStoreUrl: &quot;No store URL in parmeters or options&quot;,
	usernameOrPasswordMissing: &quot;Username or password missing&quot;
};

config.macros.upload.handler = function(place,macroName,params) {
	if (readOnly)
		return;
	var label;
	if (document.location.toString().substr(0,4) == &quot;http&quot;) 
		label = this.label.saveLabel;
	else
		label = this.label.uploadLabel;
	var prompt;
	if (params[0]) {
		prompt = this.label.promptParamMacro.toString().format([this.destFile(params[0], 
			(params[1] ? params[1]:bidix.basename(window.location.toString())), params[3])]);
	} else {
		prompt = this.label.promptOption;
	}
	createTiddlyButton(place, label, prompt, function() {config.macros.upload.action(params);}, null, null, this.accessKey);
};

config.macros.upload.action = function(params)
{
		// for missing macro parameter set value from options
		if (!params) params = {};
		var storeUrl = params[0] ? params[0] : config.options.txtUploadStoreUrl;
		var toFilename = params[1] ? params[1] : config.options.txtUploadFilename;
		var backupDir = params[2] ? params[2] : config.options.txtUploadBackupDir;
		var uploadDir = params[3] ? params[3] : config.options.txtUploadDir;
		var username = params[4] ? params[4] : config.options.txtUploadUserName;
		var password = config.options.pasUploadPassword; // for security reason no password as macro parameter	
		// for still missing parameter set default value
		if ((!storeUrl) &amp;&amp; (document.location.toString().substr(0,4) == &quot;http&quot;)) 
			storeUrl = bidix.dirname(document.location.toString())+'/'+config.macros.upload.defaultStoreScript;
		if (storeUrl.substr(0,4) != &quot;http&quot;)
			storeUrl = bidix.dirname(document.location.toString()) +'/'+ storeUrl;
		if (!toFilename)
			toFilename = bidix.basename(window.location.toString());
		if (!toFilename)
			toFilename = config.macros.upload.defaultToFilename;
		if (!uploadDir)
			uploadDir = config.macros.upload.defaultUploadDir;
		if (!backupDir)
			backupDir = config.macros.upload.defaultBackupDir;
		// report error if still missing
		if (!storeUrl) {
			alert(config.macros.upload.messages.noStoreUrl);
			clearMessage();
			return false;
		}
		if (config.macros.upload.authenticateUser &amp;&amp; (!username || !password)) {
			alert(config.macros.upload.messages.usernameOrPasswordMissing);
			clearMessage();
			return false;
		}
		bidix.upload.uploadChanges(false,null,storeUrl, toFilename, uploadDir, backupDir, username, password); 
		return false; 
};

config.macros.upload.destFile = function(storeUrl, toFilename, uploadDir) 
{
	if (!storeUrl)
		return null;
		var dest = bidix.dirname(storeUrl);
		if (uploadDir &amp;&amp; uploadDir != '.')
			dest = dest + '/' + uploadDir;
		dest = dest + '/' + toFilename;
	return dest;
};

//
// uploadOptions Macro
//

config.macros.uploadOptions = {
	handler: function(place,macroName,params) {
		var wizard = new Wizard();
		wizard.createWizard(place,this.wizardTitle);
		wizard.addStep(this.step1Title,this.step1Html);
		var markList = wizard.getElement(&quot;markList&quot;);
		var listWrapper = document.createElement(&quot;div&quot;);
		markList.parentNode.insertBefore(listWrapper,markList);
		wizard.setValue(&quot;listWrapper&quot;,listWrapper);
		this.refreshOptions(listWrapper,false);
		var uploadCaption;
		if (document.location.toString().substr(0,4) == &quot;http&quot;) 
			uploadCaption = config.macros.upload.label.saveLabel;
		else
			uploadCaption = config.macros.upload.label.uploadLabel;
		
		wizard.setButtons([
				{caption: uploadCaption, tooltip: config.macros.upload.label.promptOption, 
					onClick: config.macros.upload.action},
				{caption: this.cancelButton, tooltip: this.cancelButtonPrompt, onClick: this.onCancel}
				
			]);
	},
	options: [
		&quot;txtUploadUserName&quot;,
		&quot;pasUploadPassword&quot;,
		&quot;txtUploadStoreUrl&quot;,
		&quot;txtUploadDir&quot;,
		&quot;txtUploadFilename&quot;,
		&quot;txtUploadBackupDir&quot;,
		&quot;chkUploadLog&quot;,
		&quot;txtUploadLogMaxLine&quot;		
	],
	refreshOptions: function(listWrapper) {
		var opts = [];
		for(i=0; i&lt;this.options.length; i++) {
			var opt = {};
			opts.push();
			opt.option = &quot;&quot;;
			n = this.options[i];
			opt.name = n;
			opt.lowlight = !config.optionsDesc[n];
			opt.description = opt.lowlight ? this.unknownDescription : config.optionsDesc[n];
			opts.push(opt);
		}
		var listview = ListView.create(listWrapper,opts,this.listViewTemplate);
		for(n=0; n&lt;opts.length; n++) {
			var type = opts[n].name.substr(0,3);
			var h = config.macros.option.types[type];
			if (h &amp;&amp; h.create) {
				h.create(opts[n].colElements['option'],type,opts[n].name,opts[n].name,&quot;no&quot;);
			}
		}
		
	},
	onCancel: function(e)
	{
		backstage.switchTab(null);
		return false;
	},
	
	wizardTitle: &quot;Upload with options&quot;,
	step1Title: &quot;These options are saved in cookies in your browser&quot;,
	step1Html: &quot;&lt;input type='hidden' name='markList'&gt;&lt;/input&gt;&lt;br&gt;&quot;,
	cancelButton: &quot;Cancel&quot;,
	cancelButtonPrompt: &quot;Cancel prompt&quot;,
	listViewTemplate: {
		columns: [
			{name: 'Description', field: 'description', title: &quot;Description&quot;, type: 'WikiText'},
			{name: 'Option', field: 'option', title: &quot;Option&quot;, type: 'String'},
			{name: 'Name', field: 'name', title: &quot;Name&quot;, type: 'String'}
			],
		rowClasses: [
			{className: 'lowlight', field: 'lowlight'} 
			]}
};

//
// upload functions
//

if (!bidix.upload) bidix.upload = {};

if (!bidix.upload.messages) bidix.upload.messages = {
	//from saving
	invalidFileError: &quot;The original file '%0' does not appear to be a valid TiddlyWiki&quot;,
	backupSaved: &quot;Backup saved&quot;,
	backupFailed: &quot;Failed to upload backup file&quot;,
	rssSaved: &quot;RSS feed uploaded&quot;,
	rssFailed: &quot;Failed to upload RSS feed file&quot;,
	emptySaved: &quot;Empty template uploaded&quot;,
	emptyFailed: &quot;Failed to upload empty template file&quot;,
	mainSaved: &quot;Main TiddlyWiki file uploaded&quot;,
	mainFailed: &quot;Failed to upload main TiddlyWiki file. Your changes have not been saved&quot;,
	//specific upload
	loadOriginalHttpPostError: &quot;Can't get original file&quot;,
	aboutToSaveOnHttpPost: 'About to upload on %0 ...',
	storePhpNotFound: &quot;The store script '%0' was not found.&quot;
};

bidix.upload.uploadChanges = function(onlyIfDirty,tiddlers,storeUrl,toFilename,uploadDir,backupDir,username,password)
{
	var callback = function(status,uploadParams,original,url,xhr) {
		if (!status) {
			displayMessage(bidix.upload.messages.loadOriginalHttpPostError);
			return;
		}
		if (bidix.debugMode) 
			alert(original.substr(0,500)+&quot;\n...&quot;);
		// Locate the storeArea div's 
		var posDiv = locateStoreArea(original);
		if((posDiv[0] == -1) || (posDiv[1] == -1)) {
			alert(config.messages.invalidFileError.format([localPath]));
			return;
		}
		bidix.upload.uploadRss(uploadParams,original,posDiv);
	};
	
	if(onlyIfDirty &amp;&amp; !store.isDirty())
		return;
	clearMessage();
	// save on localdisk ?
	if (document.location.toString().substr(0,4) == &quot;file&quot;) {
		var path = document.location.toString();
		var localPath = getLocalPath(path);
		saveChanges();
	}
	// get original
	var uploadParams = new Array(storeUrl,toFilename,uploadDir,backupDir,username,password);
	var originalPath = document.location.toString();
	// If url is a directory : add index.html
	if (originalPath.charAt(originalPath.length-1) == &quot;/&quot;)
		originalPath = originalPath + &quot;index.html&quot;;
	var dest = config.macros.upload.destFile(storeUrl,toFilename,uploadDir);
	var log = new bidix.UploadLog();
	log.startUpload(storeUrl, dest, uploadDir,  backupDir);
	displayMessage(bidix.upload.messages.aboutToSaveOnHttpPost.format([dest]));
	if (bidix.debugMode) 
		alert(&quot;about to execute Http - GET on &quot;+originalPath);
	var r = doHttp(&quot;GET&quot;,originalPath,null,null,username,password,callback,uploadParams,null);
	if (typeof r == &quot;string&quot;)
		displayMessage(r);
	return r;
};

bidix.upload.uploadRss = function(uploadParams,original,posDiv) 
{
	var callback = function(status,params,responseText,url,xhr) {
		if(status) {
			var destfile = responseText.substring(responseText.indexOf(&quot;destfile:&quot;)+9,responseText.indexOf(&quot;\n&quot;, responseText.indexOf(&quot;destfile:&quot;)));
			displayMessage(bidix.upload.messages.rssSaved,bidix.dirname(url)+'/'+destfile);
			bidix.upload.uploadMain(params[0],params[1],params[2]);
		} else {
			displayMessage(bidix.upload.messages.rssFailed);			
		}
	};
	// do uploadRss
	if(config.options.chkGenerateAnRssFeed) {
		var rssPath = uploadParams[1].substr(0,uploadParams[1].lastIndexOf(&quot;.&quot;)) + &quot;.xml&quot;;
		var rssUploadParams = new Array(uploadParams[0],rssPath,uploadParams[2],'',uploadParams[4],uploadParams[5]);
		var rssString = generateRss();
		// no UnicodeToUTF8 conversion needed when location is &quot;file&quot; !!!
		if (document.location.toString().substr(0,4) != &quot;file&quot;)
			rssString = convertUnicodeToUTF8(rssString);	
		bidix.upload.httpUpload(rssUploadParams,rssString,callback,Array(uploadParams,original,posDiv));
	} else {
		bidix.upload.uploadMain(uploadParams,original,posDiv);
	}
};

bidix.upload.uploadMain = function(uploadParams,original,posDiv) 
{
	var callback = function(status,params,responseText,url,xhr) {
		var log = new bidix.UploadLog();
		if(status) {
			// if backupDir specified
			if ((params[3]) &amp;&amp; (responseText.indexOf(&quot;backupfile:&quot;) &gt; -1))  {
				var backupfile = responseText.substring(responseText.indexOf(&quot;backupfile:&quot;)+11,responseText.indexOf(&quot;\n&quot;, responseText.indexOf(&quot;backupfile:&quot;)));
				displayMessage(bidix.upload.messages.backupSaved,bidix.dirname(url)+'/'+backupfile);
			}
			var destfile = responseText.substring(responseText.indexOf(&quot;destfile:&quot;)+9,responseText.indexOf(&quot;\n&quot;, responseText.indexOf(&quot;destfile:&quot;)));
			displayMessage(bidix.upload.messages.mainSaved,bidix.dirname(url)+'/'+destfile);
			store.setDirty(false);
			log.endUpload(&quot;ok&quot;);
		} else {
			alert(bidix.upload.messages.mainFailed);
			displayMessage(bidix.upload.messages.mainFailed);
			log.endUpload(&quot;failed&quot;);			
		}
	};
	// do uploadMain
	var revised = bidix.upload.updateOriginal(original,posDiv);
	bidix.upload.httpUpload(uploadParams,revised,callback,uploadParams);
};

bidix.upload.httpUpload = function(uploadParams,data,callback,params)
{
	var localCallback = function(status,params,responseText,url,xhr) {
		url = (url.indexOf(&quot;nocache=&quot;) &lt; 0 ? url : url.substring(0,url.indexOf(&quot;nocache=&quot;)-1));
		if (xhr.status == 404)
			alert(bidix.upload.messages.storePhpNotFound.format([url]));
		if ((bidix.debugMode) || (responseText.indexOf(&quot;Debug mode&quot;) &gt;= 0 )) {
			alert(responseText);
			if (responseText.indexOf(&quot;Debug mode&quot;) &gt;= 0 )
				responseText = responseText.substring(responseText.indexOf(&quot;\n\n&quot;)+2);
		} else if (responseText.charAt(0) != '0') 
			alert(responseText);
		if (responseText.charAt(0) != '0')
			status = null;
		callback(status,params,responseText,url,xhr);
	};
	// do httpUpload
	var boundary = &quot;---------------------------&quot;+&quot;AaB03x&quot;;	
	var uploadFormName = &quot;UploadPlugin&quot;;
	// compose headers data
	var sheader = &quot;&quot;;
	sheader += &quot;--&quot; + boundary + &quot;\r\nContent-disposition: form-data; name=\&quot;&quot;;
	sheader += uploadFormName +&quot;\&quot;\r\n\r\n&quot;;
	sheader += &quot;backupDir=&quot;+uploadParams[3] +
				&quot;;user=&quot; + uploadParams[4] +
				&quot;;password=&quot; + uploadParams[5] +
				&quot;;uploaddir=&quot; + uploadParams[2];
	if (bidix.debugMode)
		sheader += &quot;;debug=1&quot;;
	sheader += &quot;;;\r\n&quot;; 
	sheader += &quot;\r\n&quot; + &quot;--&quot; + boundary + &quot;\r\n&quot;;
	sheader += &quot;Content-disposition: form-data; name=\&quot;userfile\&quot;; filename=\&quot;&quot;+uploadParams[1]+&quot;\&quot;\r\n&quot;;
	sheader += &quot;Content-Type: text/html;charset=UTF-8&quot; + &quot;\r\n&quot;;
	sheader += &quot;Content-Length: &quot; + data.length + &quot;\r\n\r\n&quot;;
	// compose trailer data
	var strailer = new String();
	strailer = &quot;\r\n--&quot; + boundary + &quot;--\r\n&quot;;
	data = sheader + data + strailer;
	if (bidix.debugMode) alert(&quot;about to execute Http - POST on &quot;+uploadParams[0]+&quot;\n with \n&quot;+data.substr(0,500)+ &quot; ... &quot;);
	var r = doHttp(&quot;POST&quot;,uploadParams[0],data,&quot;multipart/form-data; ;charset=UTF-8; boundary=&quot;+boundary,uploadParams[4],uploadParams[5],localCallback,params,null);
	if (typeof r == &quot;string&quot;)
		displayMessage(r);
	return r;
};

// same as Saving's updateOriginal but without convertUnicodeToUTF8 calls
bidix.upload.updateOriginal = function(original, posDiv)
{
	if (!posDiv)
		posDiv = locateStoreArea(original);
	if((posDiv[0] == -1) || (posDiv[1] == -1)) {
		alert(config.messages.invalidFileError.format([localPath]));
		return;
	}
	var revised = original.substr(0,posDiv[0] + startSaveArea.length) + &quot;\n&quot; +
				store.allTiddlersAsHtml() + &quot;\n&quot; +
				original.substr(posDiv[1]);
	var newSiteTitle = getPageTitle().htmlEncode();
	revised = revised.replaceChunk(&quot;&lt;title&quot;+&quot;&gt;&quot;,&quot;&lt;/title&quot;+&quot;&gt;&quot;,&quot; &quot; + newSiteTitle + &quot; &quot;);
	revised = updateMarkupBlock(revised,&quot;PRE-HEAD&quot;,&quot;MarkupPreHead&quot;);
	revised = updateMarkupBlock(revised,&quot;POST-HEAD&quot;,&quot;MarkupPostHead&quot;);
	revised = updateMarkupBlock(revised,&quot;PRE-BODY&quot;,&quot;MarkupPreBody&quot;);
	revised = updateMarkupBlock(revised,&quot;POST-SCRIPT&quot;,&quot;MarkupPostBody&quot;);
	return revised;
};

//
// UploadLog
// 
// config.options.chkUploadLog :
//		false : no logging
//		true : logging
// config.options.txtUploadLogMaxLine :
//		-1 : no limit
//      0 :  no Log lines but UploadLog is still in place
//		n :  the last n lines are only kept
//		NaN : no limit (-1)

bidix.UploadLog = function() {
	if (!config.options.chkUploadLog) 
		return; // this.tiddler = null
	this.tiddler = store.getTiddler(&quot;UploadLog&quot;);
	if (!this.tiddler) {
		this.tiddler = new Tiddler();
		this.tiddler.title = &quot;UploadLog&quot;;
		this.tiddler.text = &quot;| !date | !user | !location | !storeUrl | !uploadDir | !toFilename | !backupdir | !origin |&quot;;
		this.tiddler.created = new Date();
		this.tiddler.modifier = config.options.txtUserName;
		this.tiddler.modified = new Date();
		store.addTiddler(this.tiddler);
	}
	return this;
};

bidix.UploadLog.prototype.addText = function(text) {
	if (!this.tiddler)
		return;
	// retrieve maxLine when we need it
	var maxLine = parseInt(config.options.txtUploadLogMaxLine,10);
	if (isNaN(maxLine))
		maxLine = -1;
	// add text
	if (maxLine != 0) 
		this.tiddler.text = this.tiddler.text + text;
	// Trunck to maxLine
	if (maxLine &gt;= 0) {
		var textArray = this.tiddler.text.split('\n');
		if (textArray.length &gt; maxLine + 1)
			textArray.splice(1,textArray.length-1-maxLine);
			this.tiddler.text = textArray.join('\n');		
	}
	// update tiddler fields
	this.tiddler.modifier = config.options.txtUserName;
	this.tiddler.modified = new Date();
	store.addTiddler(this.tiddler);
	// refresh and notifiy for immediate update
	story.refreshTiddler(this.tiddler.title);
	store.notify(this.tiddler.title, true);
};

bidix.UploadLog.prototype.startUpload = function(storeUrl, toFilename, uploadDir,  backupDir) {
	if (!this.tiddler)
		return;
	var now = new Date();
	var text = &quot;\n| &quot;;
	var filename = bidix.basename(document.location.toString());
	if (!filename) filename = '/';
	text += now.formatString(&quot;0DD/0MM/YYYY 0hh:0mm:0ss&quot;) +&quot; | &quot;;
	text += config.options.txtUserName + &quot; | &quot;;
	text += &quot;[[&quot;+filename+&quot;|&quot;+location + &quot;]] |&quot;;
	text += &quot; [[&quot; + bidix.basename(storeUrl) + &quot;|&quot; + storeUrl + &quot;]] | &quot;;
	text += uploadDir + &quot; | &quot;;
	text += &quot;[[&quot; + bidix.basename(toFilename) + &quot; | &quot; +toFilename + &quot;]] | &quot;;
	text += backupDir + &quot; |&quot;;
	this.addText(text);
};

bidix.UploadLog.prototype.endUpload = function(status) {
	if (!this.tiddler)
		return;
	this.addText(&quot; &quot;+status+&quot; |&quot;);
};

//
// Utilities
// 

bidix.checkPlugin = function(plugin, major, minor, revision) {
	var ext = version.extensions[plugin];
	if (!
		(ext  &amp;&amp; 
			((ext.major &gt; major) || 
			((ext.major == major) &amp;&amp; (ext.minor &gt; minor))  ||
			((ext.major == major) &amp;&amp; (ext.minor == minor) &amp;&amp; (ext.revision &gt;= revision))))) {
			// write error in PluginManager
			if (pluginInfo)
				pluginInfo.log.push(&quot;Requires &quot; + plugin + &quot; &quot; + major + &quot;.&quot; + minor + &quot;.&quot; + revision);
			eval(plugin); // generate an error : &quot;Error: ReferenceError: xxxx is not defined&quot;
	}
};

bidix.dirname = function(filePath) {
	if (!filePath) 
		return;
	var lastpos;
	if ((lastpos = filePath.lastIndexOf(&quot;/&quot;)) != -1) {
		return filePath.substring(0, lastpos);
	} else {
		return filePath.substring(0, filePath.lastIndexOf(&quot;\\&quot;));
	}
};

bidix.basename = function(filePath) {
	if (!filePath) 
		return;
	var lastpos;
	if ((lastpos = filePath.lastIndexOf(&quot;#&quot;)) != -1) 
		filePath = filePath.substring(0, lastpos);
	if ((lastpos = filePath.lastIndexOf(&quot;/&quot;)) != -1) {
		return filePath.substring(lastpos + 1);
	} else
		return filePath.substring(filePath.lastIndexOf(&quot;\\&quot;)+1);
};

bidix.initOption = function(name,value) {
	if (!config.options[name])
		config.options[name] = value;
};

//
// Initializations
//

// require PasswordOptionPlugin 1.0.1 or better
bidix.checkPlugin(&quot;PasswordOptionPlugin&quot;, 1, 0, 1);

// styleSheet
setStylesheet('.txtUploadStoreUrl, .txtUploadBackupDir, .txtUploadDir {width: 22em;}',&quot;uploadPluginStyles&quot;);

//optionsDesc
merge(config.optionsDesc,{
	txtUploadStoreUrl: &quot;Url of the UploadService script (default: store.php)&quot;,
	txtUploadFilename: &quot;Filename of the uploaded file (default: in index.html)&quot;,
	txtUploadDir: &quot;Relative Directory where to store the file (default: . (downloadService directory))&quot;,
	txtUploadBackupDir: &quot;Relative Directory where to backup the file. If empty no backup. (default: ''(empty))&quot;,
	txtUploadUserName: &quot;Upload Username&quot;,
	pasUploadPassword: &quot;Upload Password&quot;,
	chkUploadLog: &quot;do Logging in UploadLog (default: true)&quot;,
	txtUploadLogMaxLine: &quot;Maximum of lines in UploadLog (default: 10)&quot;
});

// Options Initializations
bidix.initOption('txtUploadStoreUrl','');
bidix.initOption('txtUploadFilename','');
bidix.initOption('txtUploadDir','');
bidix.initOption('txtUploadBackupDir','');
bidix.initOption('txtUploadUserName','');
bidix.initOption('pasUploadPassword','');
bidix.initOption('chkUploadLog',true);
bidix.initOption('txtUploadLogMaxLine','10');


// Backstage
merge(config.tasks,{
	uploadOptions: {text: &quot;upload&quot;, tooltip: &quot;Change UploadOptions and Upload&quot;, content: '&lt;&lt;uploadOptions&gt;&gt;'}
});
config.backstageTasks.push(&quot;uploadOptions&quot;);


//}}}

</pre>
</div>
<div title="Using Chapters" modifier="JohnRouillard" created="200907111943" modified="200910311302" tags="slide content">
<pre>! Chapters are listed in the MainMenu
* A  chapter is composed of multiple tiddlers.
* A pulldown listing of all the chapters is provided in the MainMenu
* Viewing options allow you to replace the story column with the chapter or add it to the open tiddlers.
* Use the index of open tiddlers at the top of the story column to skip to a section
* Alternatively use a tiddler's more/jump menu item to jump to a specific open tiddler
* A notebook is provided after each tiddler
{{comment{
There are two mechanisms for accessing chapters:
# A pull down menu
# A traditional set of links to the &quot;control topic&quot;/table of contents (TOC) for the chapter

The pull down menu allows you to control where the tiddlers making up the chapter are opened:
* At the beginning of the story column
* At the end of the story column
* Replacing the story column (closing all tiddlers open for viewing)

The traditional set of links allows users with browsers that cut off the chapter titles to navigate the chapters.
If you click on a link to go to the chapter &quot;control topic&quot; tiddler, a button at the bottom along with some check boxes will allow you to open the chapter similar to the pull down mechanism.
}}}</pre>
</div>
<div title="Using Notebook" modifier="JohnRouillard" created="200907111923" modified="200910101735" tags="slide content">
<pre>Notebook blocks are:
* placed at the end of each content tiddler
* colored gray
* edited with doubleclick or {{{edit notes}}} button
* saved by clicking on {{{save notes}}}
{{comment{
Save your notes before moving on to the next slide when in slide view mode.
If you don't the notes and it's tiddler will still be shown when you move to the next slide.
}}}</pre>
</div>
<div title="Using Presentations" modifier="JohnRouillard" created="200907111937" modified="201007050234" tags="slide content">
<pre>The left hand menu contains the presentations:
* Click on the link to display the control tiddler for the show.
* Start the show use the Student button at the top of the control tiddler
* Take notes using the notes block (don't forget to save)
* Use the navigation controls at the top right to: move forward [&gt;], move back [&lt;], exit [x], jump to a slide (click on slide number and select).&lt;br /&gt;&lt;br /&gt;
* Print the slide show (including instructor but not student notes) use the Print button at the top of the control tiddler. (Press any key to exit print mode.)

{{comment{
The print mode does not show the student's notes. To print the slides and student notes, open the slides in the story column using the drop down select box at the top of the presentation list in the MainMenu, then use the browsers print function.}}}</pre>
</div>
<div title="Using This Tiddlywiki" modifier="JohnRouillard" created="200903221749" modified="201008072216" tags="content directions">
<pre>! Using this Tiddlywiki
For those of you who are used to tiddlywiki's this one has a few changes. It is based on version &lt;&lt;version&gt;&gt; of tiddlywiki with a number of plugins and customizations. The most obvious of these changes is the inability to edit tiddlers tagged with {{{content}}} by double clicking on them. As a result you can use double or triple clicks to select text from content tiddlers for pasting in the notebook or elsewhere. Because content tiddlers can be updated from the instructors copy (deleting your changes) of the coursebook, it is not recommended that you edit content tiddlers using the edit menu item.You must use the edit menu to edit content tiddlers. This prevents inadvertent changes that will be destroyed on your next synchronization from the source. Use the notebook block to record your changes/notes.

!! Editing Notebook
You will see below every content tiddler a notebook tiddler block. Double click on the gray notes block, or use the edit notes button to add your own notes and observations to the content tiddler. The notes are not overwritten by a [[sync]] operation and provides you with a way to annotate the pages even if newer pages are released with corrected errors or more explanatory material.

You can use ~TiddlyWiki formatting markup which is summarized in the FormattingCheatSheet tiddler.

More information on using tiddlers in this TiddlyWiki can be found in [[Working with Tiddlers]].
Also [[Reference Appendix 1 - Working with a TiddlyWiki]] provides more information, the highlights are summarized below to get you started
quickly. However reading appendix 1 is recommended to get the most from this coursebook.

!! Presentations
Presentations are accessed from the MainMenu on the left hand side of the page.

!!! View Presentations in student mode
Running a slide show presentation in student form allows you to follow along with the instructor's slide display. The student mode display presents the same material but in a different style from the instructor.

To start the student mode display:
* click on the title of the  presentation in the MainMenu, this will start the presentation.

The student display mode creates a slide show right on your desktop. The student mode allows you to:
* view each slide without the clutter of the normal tiddlywiki display
* move between slides using the controls at the top right
* view instructor comments on the slide (highlighted in yellow)
* add your notes to the slide using the notebook

!!! Other Presentation modes
To print the slides or interact in other ways, see [[Opening a Presentation]], [[Display a Presentation]] [[Printing Slide Set]].

/%
If you want to print the slides, click on the {{{open}}} link next to the presentation title. On the control tiddler is a print button. This creates a display of the slides including the instructor comments (but not including your notes) where each slide is printed on a seperate page which can be used for manual note taking if you can't bring your computer to the lecture. You can use your browser's print function to print them off.

If you use the pulldown select box right below the Presentation header in the MainMenu, all of the slides for that presentation will open in the center column. In this mode, you can print the ((slide contents, instructor comments and your notes(With every slide on a new page))) using your browser's print function.
%/

!! Chapters
Chapters provide a structured presentation for the non-structured wiki format material. They are composed of multiple tiddlers. You can display them using the title link under the Chapters header in the MainMenu. See [[Opening a Chapter]] and [[Printing Chapters]] for more ways to interact with chapters.

!! Searching
The search box on the upper right allows you to search for tiddlers that match the keywords that your type in. Try it now to look for the words: &quot;presentation searching&quot;. It searches as you type (once you have entered three characters, use enter to trigger searching for fewer characters) so you can see the list of tiddlers being refined. &lt;&lt;tiddler [[Reference Appendix 1 - TiddlyWiki Page Layout##search]]&gt;&gt; It displays a list of tiddlers that match the terms along with the list of tags and a synopsis of the content in the tiddler. You can refine the search operation by changing the settings on [[YourSearch Options]]. For full details of the search functionality see: [[YourSearch Help]]

!! Getting updates and errata
Books and manuals have errors and need to be updated. Image having a book that updates and corrects itself while preserving the notes you write in the margins. Using tiddlywiki you can gather these updates into your tiddlywiki from the author's web site. Also there is an rss reader located on the ContentChanges page to notify you with the latest changes.

All tiddlers marked with the tags {{{content}}} or {{{structure}}} are sourced from the author's tiddlywiki. See the [[sync]] page for instructions on updating these tiddlers with current copies.

!! Emergency recovery
In the event you have made changes to the coursebook that you want to save and something is preventing you from saving it, you can click on &lt;&lt;tiddler SaveToClipboard with: &quot;Emergency Save TiddlyWiki&quot;l&gt;&gt; to get a copy of the coursebook content that can be copied and then hand edited into the coursebook. See SaveToClipboard for detailed instructions on using the results of the emergency save. This should rarely if ever be needed, but can be useful on occasion.</pre>
</div>
<div title="Using the Backstage Link" modifier="JohnRouillard" created="201008072056" modified="201008072146" tags="content">
<pre>The backstage link displayed in the upper right hand side of the page is used to perform administrative functions on the TiddlyWiki. Normal day to day use of the Coursebook should not require you to use this.

Clicking on backstage will display a menu of options:
;save
:saves the tiddlywiki just like the @@save changes@@ link in the sidebar.
;saveAs
:allows you to save the Coursebook under a different name. This is useful for manually saving a backup or starting another Coursebook.
;sync
: synchronizes the current plugins against the original site from which they were downloaded. Don't confuse this with [[sync]] which syncs the Coursebook content. The sync mechanism can seriously screw things up, so forget that it exists.
;attach
:if present it allows you to attach files to the tiddlywiki. Special [[attachment]] tiddlers are created that can be references in the tiddlywiki and allow you to access the attached file from: encoded data enclosed in the attachment tiddler, a local file reference, a remote url reference to the file. See AttachFilePluginInfo for details.
;import
:allows you to import tiddlers from another tiddlywiki. This can be used to import plugins or normal tiddlers. The import menu does not use the default import mechanism supplied with an un-enhanced tiddlywiki. See ImportTiddlersPluginInfo for information on using the http://www.tiddlytools.com enhanced version of the import tool included in this Coursebook. Also see [[Importing a new plugin|here##Importing a new plugin]].
;export
: allows you to export tiddlers to another file on local disk. This can be used to export unused plugins, create backups of particular tiddlers, reduce the size of the Coursebook by exporting tiddlers and then loading them on demand using the [[IncludePlugin|http://tiddlywiki.abego-software.de/#%5B%5BIncludePlugin%20Documentation%5D%5D%20IncludePlugin]] or the [[ExernalTiddlersPlugin|http://www.tiddlytools.com/#ExternalTiddlersPluginInfo%20ExternalTiddlersPlugin]]. The export menu does not use the default export mechanism supplied with an un-enhanced tiddlywiki. See ExportTiddlersPluginInfo for information on using the http://www.tiddlytools.com enhanced version of the export tool included in this Coursebook.
;tweak
:allows mass editing/changes to multiple tiddlers. When it changes the tiddlers, it does not mark them as dirty, so any list of unsaved tiddlers will not show these tiddlers. See TiddlerTweakerPlugin for direction on how to use this tool.
;upgrade
:this link upgrades the core javascript code that makes a tiddlywiki work. Unless you have a bug that is fixed in a newer release, you probably don't want to do this as some plugins may not work after the upgrade. If you do choose to upgrade, make sure you have a copy of the original coursebook (maybe using the saveAs backstage menu item) so you can recover..
;plugins
:this shows all the plugins in the tiddlywiki and their state. If a plugin fails to initialize properly because of a syntax or other error, it is reported here.

!! Importing a new plugin
Importing plugins seems to be a topic that beginners have problems with. In this example we will import the [[ExernalTiddlersPlugin|http://www.tiddlytools.com/#ExternalTiddlersPluginInfo%20ExternalTiddlersPlugin]] from http://www.tidlytools.com.
* Click on the import menu item in the backstage menu
* select the @@import from@@ @@web server@@ radio button
* type http://www.tiddlytools.com into the input box under @@enter a URL...@@
* click on the open button, a message box should pop up on the right indicating it is loading the site (this may take a minute or so at slow speeds)
** when it is done it will say how many tiddlers were found
* since I loaded www.tiddlytools.com earlier and read what tiddlers are needed to import the ~ExternalTiddlersPlugin, scroll down the alphabetically sorted list of tiddlers to the ~ExternalTiddlersPlugin and
** left click on it to select it. A message box pops up on the right to indicate I have selected one tiddler
** then control-left click (apple users may need to use cmd click) to select the ~ExternalTiddlersPluginInfo tiddler as well. The message box tells me I have two tiddlers selected for import.
* I don't wish to select any options, so I click on the import button.
* after 10 seconds, the message box is display telling me it  {{Imported 2 of 449 tiddlers from http://www.tiddlytools.com}}.
* Click on the gray semi-transparent background to dismiss the import screen and the ImportedTiddlers tiddler is displayed. You can see the two new imported tiddlers recorded there.
* check to make sure you aren't editing any tiddlers. If you are click on done so that they are stored.
* choose @@save changes@@ from the sidebar to save the imported tiddlers
* use your browsers refresh button to reload the saved Coursebook. This will activate the newly imported plugin.

This concludes the steps needed to import a plugin or other tiddler.</pre>
</div>
<div title="Using the Content Links in the Main Menu" modifier="JohnRouillard" created="201008012146" modified="201008072023">
<pre>This tiddler describes using the presentation, chapter ... section in the main menu. Using the other links is described in [[The Main Menu|Reference Appendix 1 - TiddlyWiki Page Layout##The Main Menu column]].

The content links are arranged into 4 sections:
# Presentations
# Chapters
# References
# Quizzes

! Presentations
The presentation section consists of the selection pulldown, start title links and display links. Use of the display links and start title links is described in [[Display a Presentation]].

The selection pulldown opens all the tiddlers associated with a [[multi-tidder presentation|Glossary/multiTiddlerPresentation]] in the story column. Depending on the [[configuration options|StorySaverPluginInfo##Configuration]] it may close all tiddlers in view mode. The section pulldown will not list [[single tidder presentation|Glossary/singleTiddlerPresentation]]. See [[Opening a Presentation]] for more details.

! Chapters
The chapter section consists of the same three parts as the presentation section. See [[Opening a Chapter]] for details on using these sections.

! References and Quizzes
These sections just list links to tiddlers. Clicking on the link opens the corresponding tiddler.

</pre>
</div>
<div title="Welcome" modifier="JohnRouillard" created="200903151825" modified="201007050141" tags="content">
<pre>Welcome to the Coursebook on using the Coursebook.

This coursebook was created by [[John Rouillard|JohnRouillard]] to support a class he was teaching.

{{sectionTOC{}}}

&lt;part coursebook&gt;
This coursebook is based on version &lt;&lt;version&gt;&gt; of [[tiddlywiki|http://www.tiddlywiki.org]] and serves as:
* A textbook for the class (including quizzes)
* A notebook during the class
* A presentation tool for the class
&lt;/part&gt;
&lt;part tiddlerclass&gt;
It has two main types of entries called tiddlers:
# Content tiddlers are can be updated from the main website for this class
# Note tiddlers are used to store your notes for each tiddler
Content tiddlers are overwritten when you choose to [[sync]] your Coursebook to the updated contents from the master Coursebook.

Your notes are safely preserved across updates.

Identify content tiddlers by looking for {{{content}}} in the gray &quot;tags&quot; block on the upper right side of a tiddler.
&lt;/part&gt;

You can click on the content tag in the tag box on the upper right and see all the tiddlers tagged with content.

You can search for particular keywords using the search box at the upper right.

A list of chapters is shown below:
&lt;&lt;matchTags inline &quot;* %0&quot; &quot;\n&quot; sort:title chapter&gt;&gt;
&lt;&lt;tiddler [[Using This Tiddlywiki]]&gt;&gt;

! Credits

&lt;&lt;tiddler [[Credits]]&gt;&gt;

+++(welcomelegal)![Legal stuff &lt;sub&gt;click to display&lt;/sub&gt;|Click to display legal information]...
&lt;&lt;tiddler [[Copyright and Legal Stuff]]&gt;&gt;
===</pre>
</div>
<div title="Welcome to the presentation" modifier="JohnRouillard" created="201007051948" modified="201008020333" tags="presentation InstructorOnly story">
<pre>{{exclude comment{&lt;&lt;slideShow single  theme:InstructorSlideShowStyleSheet3 toc:header  footer:&quot;copyright&amp;copy; 2010&lt;br /&gt;John Rouillard&quot;  label:&quot;Start autoplay&quot; tooltip:&quot;Autoplay show in instructor projection mode&quot; cycle auto:5&gt;&gt;}}}
&lt;&lt;tiddler WelcomeSlide&gt;&gt;
-s-
! The ~TiddlyWiki Coursebook provides:
* Presentation tool
* Textbook
* Quizzes
* Student notebook
{{overlay1{all in a single html file.}}}
-s-
! The coursebook was developed ...
{{overlay1{as a tool for teaching a workshop on event correlation at a conference of system administrators.}}}
-s-
&lt;&lt;tiddler [[Opening the Coursebook]]&gt;&gt;
-s-
&lt;&lt;tiddler [[Update Your Coursebook]]&gt;&gt;
-s-
! You can take it home with you
Download from:
   FIXME
-s-
&lt;&lt;tiddler [[Random Factoid]]&gt;&gt;</pre>
</div>
<div title="WelcomeSlide" modifier="JohnRouillard" created="200907100332" modified="201008020349" tags="InstructorOnly slide">
<pre>@@display:block;text-align:center;font-weight:bold;font-size:150%;Welcome to the ~TiddlyWiki Coursebook@@
@@display:block;text-align:center;font-weight:bold;font-size:120%;with John Rouillard@@
{{image{
@@left:0%;position:relative;top:0px;[img[main_lk.png]]@@@@left:-10%;position:relative;top:0px;z-index:500;[img[stu_slide_nk.png]]@@@@left:0%;position:relative;top:0px;z-index:1;[img[ins_slide_rk.png]]@@
}}}
{{overlay1{Please come in, have a seat, set up your laptop and get ready to update your coursebook. &lt;br&gt;If you don't have a computer make friends with somebody in the class who does.}}}</pre>
</div>
<div title="What is a TiddlyWiki" modifier="JohnRouillard" created="200907111919" modified="200908260233" tags="slide content">
<pre>A [[TiddlyWiki|http://www.tiddlywiki.org]] is:

* An html file that uses javascript to create a wiki (like Wikipedia)
* You edit not pages, but pieces of micro content called tiddlers</pre>
</div>
<div title="WikifyPlugin" modifier="YourName" created="200706230458" modified="201007270514" tags="BookmarkPackage MediaPackage systemConfig InputPackage IFramePackage TaskPackage structure">
<pre>/***
|Name|WikifyPlugin|
|Source|http://www.TiddlyTools.com/#WikifyPlugin|
|Documentation|http://www.TiddlyTools.com/#WikifyPluginInfo|
|Version|1.1.4|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|plugin|
|Description|substitute fields, slices, or computed values into a wiki-syntax format string and render results dynamically|
The {{{&lt;&lt;wikify&gt;&gt;}}} macro allows you to easily retrieve values from custom tiddler fields, tiddler slices, computed values (using javascript) or just plain old literals, and assemble them into small bits of generated wiki-syntax text content that can be rendered directly into a tiddler, or used in the ViewTemplate or EditTemplate to add dynamically-generated content to each tiddler.

The {{{&lt;&lt;wikiCalc&gt;&gt;}}} macro performs the same processing as {{{&lt;&lt;wikify&gt;&gt;}}} and, in addition, passes the assembled text content through javascript's {{{eval()}}} function before rendering the results.  This allows you to, for example, construct and compute mathematical expressions that use input values extracted from tiddler fields or slices.
!!!!!Documentation
&gt; see [[WikifyPluginInfo]]
!!!!!Revisions
&lt;&lt;&lt;
2009.03.29 [1.1.4] in handler(), pass 'tiddler' value to wikify() to fix macro errors in rendered content
|please see [[WikifyPluginInfo]] for additional revision details|
2007.06.22 [1.0.0] initial release
&lt;&lt;&lt;
!!!!!Code
***/
//{{{
version.extensions.WikifyPlugin= {major: 1, minor: 1, revision: 4, date: new Date(2009,3,29)};

config.macros.wikify={
	handler: function(place,macroName,params,wikifier,paramString,tiddler) {
		var fmt=params.shift();
		var values=[];
		var out=&quot;&quot;;
		if (!fmt.match(/\%[0-9]/g) &amp;&amp; params.length) // format has no markers, just join all params with spaces
			out=fmt+&quot; &quot;+params.join(&quot; &quot;);
		else { // format param has markers, get values and perform substitution
			while (p=params.shift()) values.push(this.getFieldReference(place,p));
			out=fmt.format(values);
		}
		if (macroName==&quot;wikiCalc&quot;) out=eval(out).toString();
		wikify(out.unescapeLineBreaks(),place,null,tiddler);
	},
	getFieldReference: function(place,p) { // &quot;slicename::tiddlername&quot; or &quot;fieldname@tiddlername&quot; or &quot;fieldname&quot;
		if (typeof p != &quot;string&quot;) return p; // literal non-string value... just return it...
		var parts=p.split(config.textPrimitives.sliceSeparator);
		if (parts.length==2) {// maybe a slice reference?
			var tid=parts[0]; var slice=parts[1];
			if (!tid || !tid.length || tid==&quot;here&quot;) { // no target (or &quot;here&quot;), use containing tiddler
				tid=story.findContainingTiddler(place);
				if (tid) tid=tid.getAttribute(&quot;tiddler&quot;)
				else tid=&quot;SiteSlices&quot;; // fallback for 'non-tiddler' areas (e.g, header, sidebar, etc.)
			}
			var val=store.getTiddlerSlice(tid,slice);  // get tiddler slice value
		}
		if (val==undefined) {// not a slice, or slice not found, maybe a field reference?
			var parts=p.split(&quot;@&quot;);
			var field=parts[0];
			if (!field || !field.length) field=&quot;checked&quot;; // missing fieldname, fallback: checked@tiddlername
			var tid=parts[1];
			if (!tid || !tid.length || tid==&quot;here&quot;) { // no target (or &quot;here&quot;), use containing tiddler
				tid=story.findContainingTiddler(place);
				if (tid) tid=tid.getAttribute(&quot;tiddler&quot;)
				else tid=&quot;SiteFields&quot;; // fallback for 'non-tiddler' areas (e.g, header, sidebar, etc.)
			}
			var val=store.getValue(tid,field);
		}
		// not a slice or field, or slice/field not found... return value unchanged
		return val===undefined?p:val;
	}
}
//}}}
//{{{
// define alternative macroName for triggering pre-rendering call to eval()
config.macros.wikiCalc=config.macros.wikify;
//}}}</pre>
</div>
<div title="WikifyPluginInfo" modifier="ELSDesignStudios" created="200706230458" modified="200903300255" tags="pluginInfo InstructorOnly">
<pre>/***
|Name|WikifyPlugin|
|Source|http://www.TiddlyTools.com/#WikifyPlugin|
|Documentation|http://www.TiddlyTools.com/#WikifyPluginInfo|
|Version|1.1.4|
|Author|Eric Shulman|
|License|http://www.TiddlyTools.com/#LegalStatements|
|~CoreVersion|2.1|
|Type|documentation|
|Description|documentation for WikifyPlugin|
The {{{&lt;&lt;wikify&gt;&gt;}}} macro allows you to easily retrieve values from custom tiddler fields, tiddler slices, computed values (using javascript) or just plain old literals, and assemble them into small bits of generated wiki-syntax text content that can be rendered directly into a tiddler, or used in the ViewTemplate or EditTemplate to add dynamically-generated content to each tiddler.

The {{{&lt;&lt;wikiCalc&gt;&gt;}}} macro performs the same processing as {{{&lt;&lt;wikify&gt;&gt;}}} and, in addition, passes the assembled text content through javascript's {{{eval()}}} function before rendering the results.  This allows you to, for example, construct and compute mathematical expressions that use input values extracted from tiddler fields or slices.
!!!!!Usage
&lt;&lt;&lt;
The syntax for use in tiddlers:
{{{
&lt;&lt;wikify format value value value value ...&gt;&gt;
&lt;&lt;wikiCalc format value value value value ...&gt;&gt;
}}}
The syntax for use in templates:
{{{
&lt;span macro='wikify format value value value value ...'&gt;&lt;/span&gt;
&lt;span macro='wikiCalc format value value value value ...'&gt;&lt;/span&gt;
}}}
where:
* ''format'' specifies the format of the wiki-syntax content (or javascript expression, if using {{{&lt;&lt;wikiCalc&gt;&gt;}}}) that will be rendered
* ''value'' parameters (space-separated), specified using any of:
** ''&quot;tiddlername::slicename&quot;'' - a tiddler slice reference
** ''&quot;fieldname@tiddlername&quot;'' - a tiddler custom field reference
** ''&quot;&quot;&quot;{{config.options.txtUserName}}&quot;&quot;&quot;'' - evaluated javascript parameter
** ''&quot;none of the above&quot;'' - literal text
When the ''format'' parameter contains //substitution markers// (using &quot;%0&quot; through &quot;%9&quot; character sequences), each value parameter is retrieved and embedded into the formatted content, replacing its corresponding marker.  If the ''format'' parameter does //not// contain any substitution markers, then all parameters are simply joined together for output.  Once the values have been formatted (and, if {{{&lt;&lt;wikiCalc&gt;&gt;}}} is used, evaluated as a javascript expression), the resulting content is then passed to the core wikify() parser to render and display it.

Notes:
* If a parameter is not recognized as fitting any of the above syntax, or if the slice/field referred to cannot be located, the reference will be inserted as literal text into the output
* When working with custom tiddler fields or tiddler slices, you can enter a special psuedo-tiddler name, ''@here'' (e.g., &quot;fieldname@here&quot;) or ''here::'' (e.g., &quot;here::slicename&quot;) to access custom fields and slices associated with the //current// tiddler.  This //relative// reference syntax can be particularly helpful when placed directly into a ViewTemplate and/or EditTemplate definition, where it can be applied automatically to each tiddler that is displayed.   Note: if you omit the ''@here'' portion of a field reference (e.g., just using &quot;fieldname&quot;), it is assumed to be a reference to a field in the current tiddler (i.e., it is treated as if you specified ''fieldname@here'').
&lt;&lt;&lt;
!!!!!Examples
&lt;&lt;&lt;
{{{
&lt;&lt;wikify [[This tiddler is: %0 using %1 bytes (last author: %2)]] title {{tiddler.text.length}} modifier&gt;&gt;
&lt;&lt;wikify [[The source URL for this plugin is: %0]] 'here::Source'&gt;&gt;
&lt;&lt;wikify [[The tiddler has been changed %0 times]] changecount@here&gt;&gt;
&lt;&lt;wikify [[The Primary Mid color is: @@background:%0;%0@@]] 'ColorPalette::PrimaryMid'&gt;&gt;
&lt;&lt;wikify [[This current user is: %0]] {{config.options.txtUserName}}&gt;&gt;
}}}
&lt;&lt;wikify [[This tiddler is: %0 using %1 bytes (last author: %2)]] title {{tiddler.text.length}} modifier&gt;&gt;
&lt;&lt;wikify [[The source URL for this plugin is: %0]] 'here::Source'&gt;&gt;
&lt;&lt;wikify [[The tiddler has been changed %0 times]] changecount@here&gt;&gt;
&lt;&lt;wikify [[The Primary Mid color is: @@background:%0;%0@@]] 'ColorPalette::PrimaryMid'&gt;&gt;
&lt;&lt;wikify [[This current user is: %0]] {{config.options.txtUserName}}&gt;&gt;
&lt;&lt;&lt;
!!!!!Revisions
&lt;&lt;&lt;
2009.03.29 1.1.4 in handler(), pass 'tiddler' value to wikify() to fix macro errors in rendered content
2009.03.26 1.1.3 unescape output before wikify so that \n can be used in formatting string
2008.11.16 1.1.2 in getFieldReference(), if not a field/slice reference (or field/slice is not found), return string input unchanged instead of returning a blank string.
2008.03.08 1.1.1 size reduction: documentation moved to [[WikifyPluginInfo]]
2008.03.07 1.1.0 added {{{&lt;&lt;wikicalc&gt;&gt;}}} variant for evaluating assembled output as javascript before rendering the result
2007.11.11 1.0.1 in handler(), fixed problem where a trailing space was created when no substitution markers were present in the format param.
2007.06.22 1.0.0 initial release
&lt;&lt;&lt;</pre>
</div>
<div title="Working with Tiddlers" modifier="JohnRouillard" created="201008012040" modified="201008081841" tags="content">
<pre>Tiddlers are display in the story column of a tiddlywiki. They are shown in two modes:
# View Mode
# Edit Mode

!! View Mode
[img[viewModeTiddler.png]]

A viewed tiddler has the following elements:
;&lt;html&gt;&lt;a name=&quot;title&quot;&gt;&lt;/html&gt; title
:The name of the tiddler. This is used to create  a link to the tiddler by surrounding the title with double square brackets. E.G. {{{[[Working with Tiddlers]]}}} produces [[Working with Tiddlers]]. It also can be used to incorporate the contents of the tiddler into another tiddler using the [[tiddler macro|http://tiddlywiki.org/wiki/Tiddler_%28macro%29]]. Note that spaces in titles are collapsed, so two spaces in a title shows up as a single space when displayed. However references to the tiddler by title must include two spaces. This is important since chapters and presentation titles are often padded so that it will be [[properly sorted in the MainMenu|How to Create a Chapter]]. &lt;html&gt;&lt;/a&gt;&lt;/html&gt;
;tool bar
:&lt;&lt;tiddler [[Working with Tiddlers##toolBar]]&gt;&gt;
;change information
:displays the user who last changed the tiddler and the date on which the tiddler was changed.
; content
:This makes up the body of the tiddler and is formatted using [[tiddlywiki markup|FormattingCheatSheet]] that provides easily typed shortcuts to make headers, lists, tables etc in the body of the tiddler.
; tags
:Are a mechanism for organizing and grouping tiddlers. For example tiddlers tagged with content are meant to be content displayed to the student. Other tags also have special meanings for the coursebook or the tiddlywiki. They are also useful for finding relationships between tiddlers if the instructor has developed a tagging style. E.G. there may be an examples tag that groups all the tiddlers that contain class examples. The @@[edit]@@ link at the bottom of the tag box is discussed below.  &lt;html&gt;&lt;a name=&quot;notebook&quot;&gt;&lt;/html&gt;
;notebook
:This is an addition to the coursebook compared to a normal tiddlywiki. Double clicking on the notebook will provide you a place to store your notes on the tiddler. As in the content of a tiddler,  [[tiddlywiki markup|FormattingCheatSheet]] can be used to format the notes. Notes are preserved across coursebook [[syncs|sync]].

!!! Tagging in view mode
the @@[edit]@@ link at the bottom of the tags box allows the student to add tags to tiddlers to create a unique system for accessing/grouping content. Clicking on the edit link will open and jump to a tag editing box below the tiddler. Typing will produce a list of matching tags that can be selected or a new tag can be added. Using this mechanism helps prevent typos that prevents tiddlers from being mistagged due to case or mispelling. See [[IntelliTaggerPlugin Documentation]] for full instructions on using this.

!! Edit Mode
[img[editModeTiddler.png]]

The components of a tiddler in edit mode are:
; original title
: the current title of the tiddler
; tool bar
: &lt;&lt;tiddler [[Working with Tiddlers##editToolbar]]&gt;&gt;
; edit title
: if you want to change the title, make you change in this box. It will be changed when you click on done. Changing the title does not change any references to the original title. So you must go through the document to find these obsolete references. Also the [[missing tab|Reference Appendix 1 - TiddlyWiki Page Layout/missingTab]] in the sidebar will show you what tiddlers are referencing the tiddler with the old name.
; edit content
: edit the content of the tiddler using [[tiddlywiki markup|FormattingCheatSheet]] as described in the FormattingCheatSheet.
; edit tags
: allows adding or removing tags from the tiddler. Typing will produce a list of matching tags that can be selected or a new tag can be added. Using this mechanism helps prevent typos that prevents tiddlers from being mistagged due to case or mispelling. See [[IntelliTaggerPlugin Documentation]] for full instructions on using this.

/%

|asdf|ghjk|lmno|

!outline
        View Mode
            Image needed w/ callouts
            title
            content
            tags
            notebook
        Edit Mode
            Image needed w/ callouts
            Title editing
            Content editing
                Mention FormattingCheatSheet
            Tag editing
            Tag editing from ViewMode
                edit link at bottom of tag bar

!toolBar
The toolbar provides functions for operating on the tiddler.
; bookmark
: adds a link to this tidder to the BookmarkList that is accessible from the Bookmarks link in the main menu.
; close
: closes this tiddler removing it from being displayed in the story column. It does not delete it.
; close others
: closes all the other tiddlers in the story column. It keeps the tidder its accoiated with open.
; edit
: opens the tiddler in edit mode. If you have a student copy of the coursebook you shouldn't edit any tiddlers tagged with {{{content}}} as they are replaced when you do a sync to get updated course content. Because of this, the normal tiddlywiki shortcut to edit a tiddler (double click on the tiddler) is disabled in the student coursebook.
;refresh
:refresh the display of this tiddler. Because tiddler contents can be dynamically constructed when they are displayed a refresh is sometimes needed to display the most up to date content.
;jump
: move to another open tiddler. This link displays a menu for you to select the tiddler to jump to.
;more
: when clicked on displays some less used tools.
;;fields
:: tiddlers can have addition information associated with them in fields. This item provides a way to change those values. It is unlikely that you will need this.
;;permalink
:: like the permalink link on the sidebar, this changes the url displayed in the browser so that it will open this tiddler when used. You can bookmark the url using you browsers standad bookmark function, and when the bookmark is clicked on it will open the tiddlywiki with this tiddler displayed.
;;references
::show what tiddlers have links to (point to) this tiddler.
;;less
:: when clicked on hides the display of less used tools.
! NOTE
consider adding deletetiddler here in an instructors only setup?? fixme
!editToolbar
This controls editing actions on the tiddler:
;done
: saves changes to the tiddler and returns to view mode. The keystroke control-enter (or control-return) is a shortcut for the done function.
; cancel
:discards changes to the tiddler and returns to view mode. The escape key is a shortcut for this command.
;copy
:copies the current tiddler and creates a new editing instance of the copied tiddler
; delete
: deletes the tiddler. If you save the tiddywiki, the tidder is gone and only recoverable if you saved backups.
; convert
: converts data in a comma separated value list (as exported from a spreadsheet) into a tiddlywiki table.. E.G. type: {{{asdf,bghi,lmno}}} select it and choose convert to table. It will replace the text with {{{|asdf | bghi | lmno |}}}.
!end
%/</pre>
</div>
<div title="YourSearchPlugin" modifier="YourName" created="200601161427" modified="200909041056" tags="Plugin UdoBorkowski YourSearchProject systemConfig excludeMissing">
<pre>/***
|''Name:''|YourSearchPlugin|
|''Version:''|2.1.4 (2009-09-04)|
|''Source:''|http://tiddlywiki.abego-software.de/#YourSearchPlugin|
|''Author:''|UdoBorkowski (ub [at] abego-software [dot] de)|
|''Licence:''|[[BSD open source license (abego Software)|http://www.abego-software.de/legal/apl-v10.html]]|
|''Copyright:''|&amp;copy; 2005-2009 [[abego Software|http://www.abego-software.de]]|
|''~CoreVersion:''|2.1.0|
|''Community:''|[[del.icio.us|http://del.icio.us/post?url=http://tiddlywiki.abego-software.de/index.html%23YourSearchPlugin]]|
|''Browser:''|Firefox 1.0.4+; Firefox 1.5; ~InternetExplorer 6.0|
!About YourSearch
YourSearch gives you a bunch of new features to simplify and speed up your daily searches in TiddlyWiki. It seamlessly integrates into the standard TiddlyWiki search: just start typing into the 'search' field and explore!

For more information see [[Help|YourSearch Help]].
!Compatibility
This plugin requires TiddlyWiki 2.1. 
Check the [[archive|http://tiddlywiki.abego-software.de/archive]] for ~YourSearchPlugins supporting older versions of TiddlyWiki.
!Source Code
***/
/***
This plugin's source code is compressed (and hidden). Use this [[link|http://tiddlywiki.abego-software.de/archive/YourSearchPlugin/Plugin-YourSearch-src.2.1.4.js]] to get the readable source code.
***/
///%
if(!version.extensions.YourSearchPlugin){version.extensions.YourSearchPlugin={major:2,minor:1,revision:4,source:&quot;http://tiddlywiki.abego-software.de/#YourSearchPlugin&quot;,licence:&quot;[[BSD open source license (abego Software)|http://www.abego-software.de/legal/apl-v10.html]]&quot;,copyright:&quot;Copyright (c) abego Software GmbH, 2005-2009 (www.abego-software.de)&quot;};if(!window.abego){window.abego={};}if(!Array.forEach){Array.forEach=function(_1,_2,_3){for(var i=0,_4=_1.length;i&lt;_4;i++){_2.call(_3,_1[i],i,_1);}};Array.prototype.forEach=function(_5,_6){for(var i=0,_7=this.length;i&lt;_7;i++){_5.call(_6,this[i],i,this);}};}abego.toInt=function(s,_8){if(!s){return _8;}var n=parseInt(s);return (n==NaN)?_8:n;};abego.createEllipsis=function(_9){var e=createTiddlyElement(_9,&quot;span&quot;);e.innerHTML=&quot;&amp;hellip;&quot;;};abego.shallowCopy=function(_a){if(!_a){return _a;}var _b={};for(var n in _a){_b[n]=_a[n];}return _b;};abego.copyOptions=function(_c){return !_c?{}:abego.shallowCopy(_c);};abego.countStrings=function(_d,s){if(!s){return 0;}var _e=s.length;var n=0;var _f=0;while(1){var i=_d.indexOf(s,_f);if(i&lt;0){return n;}n++;_f=i+_e;}return n;};abego.getBracedText=function(_10,_11,_12){if(!_11){_11=0;}var re=/\{([^\}]*)\}/gm;re.lastIndex=_11;var m=re.exec(_10);if(m){var s=m[1];var _13=abego.countStrings(s,&quot;{&quot;);if(!_13){if(_12){_12.lastIndex=re.lastIndex;}return s;}var len=_10.length;for(var i=re.lastIndex;i&lt;len&amp;&amp;_13;i++){var c=_10.charAt(i);if(c==&quot;{&quot;){_13++;}else{if(c==&quot;}&quot;){_13--;}}}if(!_13){if(_12){_12.lastIndex=i-1;}return _10.substring(m.index+1,i-1);}}};abego.select=function(_14,_15,_16,_17){if(!_17){_17=[];}_14.forEach(function(t){if(_15.call(_16,t)){_17.push(t);}});return _17;};abego.consumeEvent=function(e){if(e.stopPropagation){e.stopPropagation();}if(e.preventDefault){e.preventDefault();}e.cancelBubble=true;e.returnValue=true;};abego.TiddlerFilterTerm=function(_18,_19){if(!_19){_19={};}var _1a=_18;if(!_19.textIsRegExp){_1a=_18.escapeRegExp();if(_19.fullWordMatch){_1a=&quot;\\b&quot;+_1a+&quot;\\b&quot;;}}var _1b=new RegExp(_1a,&quot;m&quot;+(_19.caseSensitive?&quot;&quot;:&quot;i&quot;));this.tester=new abego.MultiFieldRegExpTester(_1b,_19.fields,_19.withExtendedFields);};abego.TiddlerFilterTerm.prototype.test=function(_1c){return this.tester.test(_1c);};abego.parseNewTiddlerCommandLine=function(s){var m=/(.*?)\.(?:\s+|$)([^#]*)(#.*)?/.exec(s);if(!m){m=/([^#]*)()(#.*)?/.exec(s);}if(m){var r;if(m[3]){var s2=m[3].replace(/#/g,&quot;&quot;);r=s2.parseParams(&quot;tag&quot;);}else{r=[[]];}var _1d=m[2]?m[2].trim():&quot;&quot;;r.push({name:&quot;text&quot;,value:_1d});r[0].text=[_1d];return {title:m[1].trim(),params:r};}else{return {title:s.trim(),params:[[]]};}};abego.parseTiddlerFilterTerm=function(_1e,_1f,_20){var re=/\s*(?:(?:\{([^\}]*)\})|(?:(=)|([#%!])|(?:(\w+)\s*\:(?!\/\/))|(?:(?:(&quot;(?:(?:\\&quot;)|[^&quot;])+&quot;)|(?:\/((?:(?:\\\/)|[^\/])+)\/)|(\w+\:\/\/[^\s]+)|([^\s\)\-\&quot;]+)))))/mg;var _21={&quot;!&quot;:&quot;title&quot;,&quot;%&quot;:&quot;text&quot;,&quot;#&quot;:&quot;tags&quot;};var _22={};var _23;re.lastIndex=_1f;while(1){var i=re.lastIndex;var m=re.exec(_1e);if(!m||m.index!=i){throw &quot;Word or String literal expected&quot;;}if(m[1]){var _24={};var _25=abego.getBracedText(_1e,0,_24);if(!_25){throw &quot;Invalid {...} syntax&quot;;}var f=Function(&quot;tiddler&quot;,&quot;return (&quot;+_25+&quot;);&quot;);return {func:f,lastIndex:_24.lastIndex,markRE:null};}if(m[2]){_23=true;}else{if(m[3]){_22[_21[m[3]]]=1;}else{if(m[4]){_22[m[4]]=1;}else{var _26=m[6];var _27=m[5]?window.eval(m[5]):m[6]?m[6]:m[7]?m[7]:m[8];var _20=abego.copyOptions(_20);_20.fullWordMatch=_23;_20.textIsRegExp=_26;var _28=[];for(var n in _22){_28.push(n);}if(_28.length==0){_20.fields=_20.defaultFields;}else{_20.fields=_28;_20.withExtendedFields=false;}var _29=new abego.TiddlerFilterTerm(_27,_20);var _2a=_26?_27:_27.escapeRegExp();if(_2a&amp;&amp;_23){_2a=&quot;\\b&quot;+_2a+&quot;\\b&quot;;}return {func:function(_2b){return _29.test(_2b);},lastIndex:re.lastIndex,markRE:_2a?&quot;(?:&quot;+_2a+&quot;)&quot;:null};}}}}};abego.BoolExp=function(s,_2c,_2d){this.s=s;var _2e=_2d&amp;&amp;_2d.defaultOperationIs_OR;var _2f=/\s*(?:(\-|not)|(\())/gi;var _30=/\s*\)/g;var _31=/\s*(?:(and|\&amp;\&amp;)|(or|\|\|))/gi;var _32=/\s*[^\)\s]/g;var _33=/\s*(\-|not)?(\s*\()?/gi;var _34;var _35=function(_36){_33.lastIndex=_36;var m=_33.exec(s);var _37;var _38;if(m&amp;&amp;m.index==_36){_36+=m[0].length;_37=m[1];if(m[2]){var e=_34(_36);_30.lastIndex=e.lastIndex;if(!_30.exec(s)){throw &quot;Missing ')'&quot;;}_38={func:e.func,lastIndex:_30.lastIndex,markRE:e.markRE};}}if(!_38){_38=_2c(s,_36,_2d);}if(_37){_38.func=(function(f){return function(_39){return !f(_39);};})(_38.func);_38.markRE=null;}return _38;};_34=function(_3a){var _3b=_35(_3a);while(1){var l=_3b.lastIndex;_31.lastIndex=l;var m=_31.exec(s);var _3c;var _3d;if(m&amp;&amp;m.index==l){_3c=!m[1];_3d=_35(_31.lastIndex);}else{try{_3d=_35(l);}catch(e){return _3b;}_3c=_2e;}_3b.func=(function(_3e,_3f,_40){return _40?function(_41){return _3e(_41)||_3f(_41);}:function(_42){return _3e(_42)&amp;&amp;_3f(_42);};})(_3b.func,_3d.func,_3c);_3b.lastIndex=_3d.lastIndex;if(!_3b.markRE){_3b.markRE=_3d.markRE;}else{if(_3d.markRE){_3b.markRE=_3b.markRE+&quot;|&quot;+_3d.markRE;}}}};var _43=_34(0);this.evalFunc=_43.func;if(_43.markRE){this.markRegExp=new RegExp(_43.markRE,_2d.caseSensitive?&quot;mg&quot;:&quot;img&quot;);}};abego.BoolExp.prototype.exec=function(){return this.evalFunc.apply(this,arguments);};abego.BoolExp.prototype.getMarkRegExp=function(){return this.markRegExp;};abego.BoolExp.prototype.toString=function(){return this.s;};abego.MultiFieldRegExpTester=function(re,_44,_45){this.re=re;this.fields=_44?_44:[&quot;title&quot;,&quot;text&quot;,&quot;tags&quot;];this.withExtendedFields=_45;};abego.MultiFieldRegExpTester.prototype.test=function(_46){var re=this.re;for(var i=0;i&lt;this.fields.length;i++){var s=store.getValue(_46,this.fields[i]);if(typeof s==&quot;string&quot;&amp;&amp;re.test(s)){return this.fields[i];}}if(this.withExtendedFields){return store.forEachField(_46,function(_47,_48,_49){return typeof _49==&quot;string&quot;&amp;&amp;re.test(_49)?_48:null;},true);}return null;};abego.TiddlerQuery=function(_4a,_4b,_4c,_4d,_4e){if(_4c){this.regExp=new RegExp(_4a,_4b?&quot;mg&quot;:&quot;img&quot;);this.tester=new abego.MultiFieldRegExpTester(this.regExp,_4d,_4e);}else{this.expr=new abego.BoolExp(_4a,abego.parseTiddlerFilterTerm,{defaultFields:_4d,caseSensitive:_4b,withExtendedFields:_4e});}this.getQueryText=function(){return _4a;};this.getUseRegExp=function(){return _4c;};this.getCaseSensitive=function(){return _4b;};this.getDefaultFields=function(){return _4d;};this.getWithExtendedFields=function(){return _4e;};};abego.TiddlerQuery.prototype.test=function(_4f){if(!_4f){return false;}if(this.regExp){return this.tester.test(_4f);}return this.expr.exec(_4f);};abego.TiddlerQuery.prototype.filter=function(_50){return abego.select(_50,this.test,this);};abego.TiddlerQuery.prototype.getMarkRegExp=function(){if(this.regExp){return &quot;&quot;.search(this.regExp)&gt;=0?null:this.regExp;}return this.expr.getMarkRegExp();};abego.TiddlerQuery.prototype.toString=function(){return (this.regExp?this.regExp:this.expr).toString();};abego.PageWiseRenderer=function(){this.firstIndexOnPage=0;};merge(abego.PageWiseRenderer.prototype,{setItems:function(_51){this.items=_51;this.setFirstIndexOnPage(0);},getMaxPagesInNavigation:function(){return 10;},getItemsCount:function(_52){return this.items?this.items.length:0;},getCurrentPageIndex:function(){return Math.floor(this.firstIndexOnPage/this.getItemsPerPage());},getLastPageIndex:function(){return Math.floor((this.getItemsCount()-1)/this.getItemsPerPage());},setFirstIndexOnPage:function(_53){this.firstIndexOnPage=Math.min(Math.max(0,_53),this.getItemsCount()-1);},getFirstIndexOnPage:function(){this.firstIndexOnPage=Math.floor(this.firstIndexOnPage/this.getItemsPerPage())*this.getItemsPerPage();return this.firstIndexOnPage;},getLastIndexOnPage:function(){return Math.min(this.getFirstIndexOnPage()+this.getItemsPerPage()-1,this.getItemsCount()-1);},onPageChanged:function(_54,_55){},renderPage:function(_56){if(_56.beginRendering){_56.beginRendering(this);}try{if(this.getItemsCount()){var _57=this.getLastIndexOnPage();var _58=-1;for(var i=this.getFirstIndexOnPage();i&lt;=_57;i++){_58++;_56.render(this,this.items[i],i,_58);}}}finally{if(_56.endRendering){_56.endRendering(this);}}},addPageNavigation:function(_59){if(!this.getItemsCount()){return;}var _5a=this;var _5b=function(e){if(!e){var e=window.event;}abego.consumeEvent(e);var _5c=abego.toInt(this.getAttribute(&quot;page&quot;),0);var _5d=_5a.getCurrentPageIndex();if(_5c==_5d){return;}var _5e=_5c*_5a.getItemsPerPage();_5a.setFirstIndexOnPage(_5e);_5a.onPageChanged(_5c,_5d);};var _5f;var _60=this.getCurrentPageIndex();var _61=this.getLastPageIndex();if(_60&gt;0){_5f=createTiddlyButton(_59,&quot;Previous&quot;,&quot;Go to previous page (Shortcut: Alt-'&lt;')&quot;,_5b,&quot;prev&quot;);_5f.setAttribute(&quot;page&quot;,(_60-1).toString());_5f.setAttribute(&quot;accessKey&quot;,&quot;&lt;&quot;);}for(var i=-this.getMaxPagesInNavigation();i&lt;this.getMaxPagesInNavigation();i++){var _62=_60+i;if(_62&lt;0){continue;}if(_62&gt;_61){break;}var _63=(i+_60+1).toString();var _64=_62==_60?&quot;currentPage&quot;:&quot;otherPage&quot;;_5f=createTiddlyButton(_59,_63,&quot;Go to page %0&quot;.format([_63]),_5b,_64);_5f.setAttribute(&quot;page&quot;,(_62).toString());}if(_60&lt;_61){_5f=createTiddlyButton(_59,&quot;Next&quot;,&quot;Go to next page (Shortcut: Alt-'&gt;')&quot;,_5b,&quot;next&quot;);_5f.setAttribute(&quot;page&quot;,(_60+1).toString());_5f.setAttribute(&quot;accessKey&quot;,&quot;&gt;&quot;);}}});abego.LimitedTextRenderer=function(){var _65=40;var _66=4;var _67=function(_68,_69,_6a){var n=_68.length;if(n==0){_68.push({start:_69,end:_6a});return;}var i=0;for(;i&lt;n;i++){var _6b=_68[i];if(_6b.start&lt;=_6a&amp;&amp;_69&lt;=_6b.end){var r;var _6c=i+1;for(;_6c&lt;n;_6c++){r=_68[_6c];if(r.start&gt;_6a||_69&gt;_6b.end){break;}}var _6d=_69;var _6e=_6a;for(var j=i;j&lt;_6c;j++){r=_68[j];_6d=Math.min(_6d,r.start);_6e=Math.max(_6e,r.end);}_68.splice(i,_6c-i,{start:_6d,end:_6e});return;}if(_6b.start&gt;_6a){break;}}_68.splice(i,0,{start:_69,end:_6a});};var _6f=function(_70){var _71=0;for(var i=0;i&lt;_70.length;i++){var _72=_70[i];_71+=_72.end-_72.start;}return _71;};var _73=function(c){return (c&gt;=&quot;a&quot;&amp;&amp;c&lt;=&quot;z&quot;)||(c&gt;=&quot;A&quot;&amp;&amp;c&lt;=&quot;Z&quot;)||c==&quot;_&quot;;};var _74=function(s,_75){if(!_73(s[_75])){return null;}for(var i=_75-1;i&gt;=0&amp;&amp;_73(s[i]);i--){}var _76=i+1;var n=s.length;for(i=_75+1;i&lt;n&amp;&amp;_73(s[i]);i++){}return {start:_76,end:i};};var _77=function(s,_78,_79){var _7a;if(_79){_7a=_74(s,_78);}else{if(_78&lt;=0){return _78;}_7a=_74(s,_78-1);}if(!_7a){return _78;}if(_79){if(_7a.start&gt;=_78-_66){return _7a.start;}if(_7a.end&lt;=_78+_66){return _7a.end;}}else{if(_7a.end&lt;=_78+_66){return _7a.end;}if(_7a.start&gt;=_78-_66){return _7a.start;}}return _78;};var _7b=function(s,_7c){var _7d=[];if(_7c){var _7e=0;var n=s.length;var _7f=0;do{_7c.lastIndex=_7e;var _80=_7c.exec(s);if(_80){if(_7e&lt;_80.index){var t=s.substring(_7e,_80.index);_7d.push({text:t});}_7d.push({text:_80[0],isMatch:true});_7e=_80.index+_80[0].length;}else{_7d.push({text:s.substr(_7e)});break;}}while(true);}else{_7d.push({text:s});}return _7d;};var _81=function(_82){var _83=0;for(var i=0;i&lt;_82.length;i++){if(_82[i].isMatch){_83++;}}return _83;};var _84=function(s,_85,_86,_87,_88){var _89=Math.max(Math.floor(_88/(_87+1)),_65);var _8a=Math.max(_89-(_86-_85),0);var _8b=Math.min(Math.floor(_86+_8a/3),s.length);var _8c=Math.max(_8b-_89,0);_8c=_77(s,_8c,true);_8b=_77(s,_8b,false);return {start:_8c,end:_8b};};var _8d=function(_8e,s,_8f){var _90=[];var _91=_81(_8e);var pos=0;for(var i=0;i&lt;_8e.length;i++){var t=_8e[i];var _92=t.text;if(t.isMatch){var _93=_84(s,pos,pos+_92.length,_91,_8f);_67(_90,_93.start,_93.end);}pos+=_92.length;}return _90;};var _94=function(s,_95,_96){var _97=_96-_6f(_95);while(_97&gt;0){if(_95.length==0){_67(_95,0,_77(s,_96,false));return;}else{var _98=_95[0];var _99;var _9a;if(_98.start==0){_99=_98.end;if(_95.length&gt;1){_9a=_95[1].start;}else{_67(_95,_99,_77(s,_99+_97,false));return;}}else{_99=0;_9a=_98.start;}var _9b=Math.min(_9a,_99+_97);_67(_95,_99,_9b);_97-=(_9b-_99);}}};var _9c=function(_9d,s,_9e,_9f,_a0){if(_9f.length==0){return;}var _a1=function(_a2,s,_a3,_a4,_a5){var t;var _a6;var pos=0;var i=0;var _a7=0;for(;i&lt;_a3.length;i++){t=_a3[i];_a6=t.text;if(_a4&lt;pos+_a6.length){_a7=_a4-pos;break;}pos+=_a6.length;}var _a8=_a5-_a4;for(;i&lt;_a3.length&amp;&amp;_a8&gt;0;i++){t=_a3[i];_a6=t.text.substr(_a7);_a7=0;if(_a6.length&gt;_a8){_a6=_a6.substr(0,_a8);}if(t.isMatch){createTiddlyElement(_a2,&quot;span&quot;,null,&quot;marked&quot;,_a6);}else{createTiddlyText(_a2,_a6);}_a8-=_a6.length;}if(_a5&lt;s.length){abego.createEllipsis(_a2);}};if(_9f[0].start&gt;0){abego.createEllipsis(_9d);}var _a9=_a0;for(var i=0;i&lt;_9f.length&amp;&amp;_a9&gt;0;i++){var _aa=_9f[i];var len=Math.min(_aa.end-_aa.start,_a9);_a1(_9d,s,_9e,_aa.start,_aa.start+len);_a9-=len;}};this.render=function(_ab,s,_ac,_ad){if(s.length&lt;_ac){_ac=s.length;}var _ae=_7b(s,_ad);var _af=_8d(_ae,s,_ac);_94(s,_af,_ac);_9c(_ab,s,_ae,_af,_ac);};};(function(){function _b0(msg){alert(msg);throw msg;};if(version.major&lt;2||(version.major==2&amp;&amp;version.minor&lt;1)){_b0(&quot;YourSearchPlugin requires TiddlyWiki 2.1 or newer.\n\nCheck the archive for YourSearch plugins\nsupporting older versions of TiddlyWiki.\n\nArchive: http://tiddlywiki.abego-software.de/archive&quot;);}abego.YourSearch={};var _b1;var _b2;var _b3=function(_b4){_b1=_b4;};var _b5=function(){return _b1?_b1:[];};var _b6=function(){return _b1?_b1.length:0;};var _b7=4;var _b8=10;var _b9=2;var _ba=function(s,re){var m=s.match(re);return m?m.length:0;};var _bb=function(_bc,_bd){var _be=_bd.getMarkRegExp();if(!_be){return 1;}var _bf=_bc.title.match(_be);var _c0=_bf?_bf.length:0;var _c1=_ba(_bc.getTags(),_be);var _c2=_bf?_bf.join(&quot;&quot;).length:0;var _c3=_bc.title.length&gt;0?_c2/_bc.title.length:0;var _c4=_c0*_b7+_c1*_b9+_c3*_b8+1;return _c4;};var _c5=function(_c6,_c7,_c8,_c9,_ca,_cb){_b2=null;var _cc=_c6.reverseLookup(&quot;tags&quot;,_cb,false);try{var _cd=[];if(config.options.chkSearchInTitle){_cd.push(&quot;title&quot;);}if(config.options.chkSearchInText){_cd.push(&quot;text&quot;);}if(config.options.chkSearchInTags){_cd.push(&quot;tags&quot;);}_b2=new abego.TiddlerQuery(_c7,_c8,_c9,_cd,config.options.chkSearchExtendedFields);}catch(e){return [];}var _ce=_b2.filter(_cc);var _cf=abego.YourSearch.getRankFunction();for(var i=0;i&lt;_ce.length;i++){var _d0=_ce[i];var _d1=_cf(_d0,_b2);_d0.searchRank=_d1;}if(!_ca){_ca=&quot;title&quot;;}var _d2=function(a,b){var _d3=a.searchRank-b.searchRank;if(_d3==0){if(a[_ca]==b[_ca]){return (0);}else{return (a[_ca]&lt;b[_ca])?-1:+1;}}else{return (_d3&gt;0)?-1:+1;}};_ce.sort(_d2);return _ce;};var _d4=80;var _d5=50;var _d6=250;var _d7=50;var _d8=25;var _d9=10;var _da=&quot;yourSearchResult&quot;;var _db=&quot;yourSearchResultItems&quot;;var _dc;var _dd;var _de;var _df;var _e0;var _e1=function(){if(version.extensions.YourSearchPlugin.styleSheetInited){return;}version.extensions.YourSearchPlugin.styleSheetInited=true;setStylesheet(store.getTiddlerText(&quot;YourSearchStyleSheet&quot;),&quot;yourSearch&quot;);};var _e2=function(){return _dd!=null&amp;&amp;_dd.parentNode==document.body;};var _e3=function(){if(_e2()){document.body.removeChild(_dd);}};var _e4=function(e){_e3();var _e5=this.getAttribute(&quot;tiddlyLink&quot;);if(_e5){var _e6=this.getAttribute(&quot;withHilite&quot;);var _e7=highlightHack;if(_e6&amp;&amp;_e6==&quot;true&quot;&amp;&amp;_b2){highlightHack=_b2.getMarkRegExp();}story.displayTiddler(this,_e5);highlightHack=_e7;}return (false);};var _e8=function(){if(!_de){return;}var _e9=_de;var _ea=findPosX(_e9);var _eb=findPosY(_e9);var _ec=_e9.offsetHeight;var _ed=_ea;var _ee=_eb+_ec;var _ef=findWindowWidth();if(_ef&lt;_dd.offsetWidth){_dd.style.width=(_ef-100)+&quot;px&quot;;_ef=findWindowWidth();}var _f0=_dd.offsetWidth;if(_ed+_f0&gt;_ef){_ed=_ef-_f0-30;}if(_ed&lt;0){_ed=0;}_dd.style.left=_ed+&quot;px&quot;;_dd.style.top=_ee+&quot;px&quot;;_dd.style.display=&quot;block&quot;;};var _f1=function(){if(_dd){window.scrollTo(0,ensureVisible(_dd));}if(_de){window.scrollTo(0,ensureVisible(_de));}};var _f2=function(){_e8();_f1();};var _f3;var _f4;var _f5=new abego.PageWiseRenderer();var _f6=function(_f7){this.itemHtml=store.getTiddlerText(&quot;YourSearchItemTemplate&quot;);if(!this.itemHtml){_b0(&quot;YourSearchItemTemplate not found&quot;);}this.place=document.getElementById(_db);if(!this.place){this.place=createTiddlyElement(_f7,&quot;div&quot;,_db);}};merge(_f6.prototype,{render:function(_f8,_f9,_fa,_fb){_f3=_fb;_f4=_f9;var _fc=createTiddlyElement(this.place,&quot;div&quot;,null,&quot;yourSearchItem&quot;);_fc.innerHTML=this.itemHtml;applyHtmlMacros(_fc,null);refreshElements(_fc,null);},endRendering:function(_fd){_f4=null;}});var _fe=function(){if(!_dd||!_de){return;}var _ff=store.getTiddlerText(&quot;YourSearchResultTemplate&quot;);if(!_ff){_ff=&quot;&lt;b&gt;Tiddler YourSearchResultTemplate not found&lt;/b&gt;&quot;;}_dd.innerHTML=_ff;applyHtmlMacros(_dd,null);refreshElements(_dd,null);var _100=new _f6(_dd);_f5.renderPage(_100);_f2();};_f5.getItemsPerPage=function(){var n=(config.options.chkPreviewText)?abego.toInt(config.options.txtItemsPerPageWithPreview,_d9):abego.toInt(config.options.txtItemsPerPage,_d8);return (n&gt;0)?n:1;};_f5.onPageChanged=function(){_fe();};var _101=function(){if(_de==null||!config.options.chkUseYourSearch){return;}if((_de.value==_dc)&amp;&amp;_dc&amp;&amp;!_e2()){if(_dd&amp;&amp;(_dd.parentNode!=document.body)){document.body.appendChild(_dd);_f2();}else{abego.YourSearch.onShowResult(true);}}};var _102=function(){_e3();_dd=null;_dc=null;};var _103=function(self,e){while(e!=null){if(self==e){return true;}e=e.parentNode;}return false;};var _104=function(e){if(e.target==_de){return;}if(e.target==_df){return;}if(_dd&amp;&amp;_103(_dd,e.target)){return;}_e3();};var _105=function(e){if(e.keyCode==27){_e3();}};addEvent(document,&quot;click&quot;,_104);addEvent(document,&quot;keyup&quot;,_105);var _106=function(text,_107,_108){_dc=text;_b3(_c5(store,text,_107,_108,&quot;title&quot;,&quot;excludeSearch&quot;));abego.YourSearch.onShowResult();};var _109=function(_10a,_10b,_10c,_10d,_10e,_10f){_e1();_dc=&quot;&quot;;var _110=null;var _111=function(txt){if(config.options.chkUseYourSearch){_106(txt.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch);}else{story.search(txt.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch);}_dc=txt.value;};var _112=function(e){_111(_de);return false;};var _113=function(e){if(!e){var e=window.event;}_de=this;switch(e.keyCode){case 13:if(e.ctrlKey&amp;&amp;_e0&amp;&amp;_e2()){_e0.onclick.apply(_e0,[e]);}else{_111(this);}break;case 27:if(_e2()){_e3();}else{this.value=&quot;&quot;;clearMessage();}break;}if(String.fromCharCode(e.keyCode)==this.accessKey||e.altKey){_101();}if(this.value.length&lt;3&amp;&amp;_110){clearTimeout(_110);}if(this.value.length&gt;2){if(this.value!=_dc){if(!config.options.chkUseYourSearch||config.options.chkSearchAsYouType){if(_110){clearTimeout(_110);}var txt=this;_110=setTimeout(function(){_111(txt);},500);}}else{if(_110){clearTimeout(_110);}}}if(this.value.length==0){_e3();}};var _114=function(e){this.select();clearMessage();_101();};var args=_10e.parseParams(&quot;list&quot;,null,true);var _115=getFlag(args,&quot;buttonAtRight&quot;);var _116=getParam(args,&quot;sizeTextbox&quot;,this.sizeTextbox);var btn;if(!_115){btn=createTiddlyButton(_10a,this.label,this.prompt,_112);}var txt=createTiddlyElement(null,&quot;input&quot;,null,null,null);if(_10c[0]){txt.value=_10c[0];}txt.onkeyup=_113;txt.onfocus=_114;txt.setAttribute(&quot;size&quot;,_116);txt.setAttribute(&quot;accessKey&quot;,this.accessKey);txt.setAttribute(&quot;autocomplete&quot;,&quot;off&quot;);if(config.browser.isSafari){txt.setAttribute(&quot;type&quot;,&quot;search&quot;);txt.setAttribute(&quot;results&quot;,&quot;5&quot;);}else{txt.setAttribute(&quot;type&quot;,&quot;text&quot;);}if(_10a){_10a.appendChild(txt);}if(_115){btn=createTiddlyButton(_10a,this.label,this.prompt,_112);}_de=txt;_df=btn;};var _117=function(){_e3();var _118=_b5();var n=_118.length;if(n){var _119=[];for(var i=0;i&lt;n;i++){_119.push(_118[i].title);}story.displayTiddlers(null,_119);}};var _11a=function(_11b,_11c,_11d,_11e){invokeMacro(_11b,&quot;option&quot;,_11c,_11d,_11e);var elem=_11b.lastChild;var _11f=elem.onclick;elem.onclick=function(e){var _120=_11f.apply(this,arguments);_fe();return _120;};return elem;};var _121=function(s){var _122=[&quot;''&quot;,&quot;{{{&quot;,&quot;}}}&quot;,&quot;//&quot;,&quot;&lt;&lt;&lt;&quot;,&quot;/***&quot;,&quot;***/&quot;];var _123=&quot;&quot;;for(var i=0;i&lt;_122.length;i++){if(i!=0){_123+=&quot;|&quot;;}_123+=&quot;(&quot;+_122[i].escapeRegExp()+&quot;)&quot;;}return s.replace(new RegExp(_123,&quot;mg&quot;),&quot;&quot;).trim();};var _124=function(){var i=_f3;return (i&gt;=0&amp;&amp;i&lt;=9)?(i&lt;9?(i+1):0):-1;};var _125=new abego.LimitedTextRenderer();var _126=function(_127,s,_128){_125.render(_127,s,_128,_b2.getMarkRegExp());};var _129=TiddlyWiki.prototype.saveTiddler;TiddlyWiki.prototype.saveTiddler=function(_12a,_12b,_12c,_12d,_12e,tags,_12f){_129.apply(this,arguments);_102();};var _130=TiddlyWiki.prototype.removeTiddler;TiddlyWiki.prototype.removeTiddler=function(_131){_130.apply(this,arguments);_102();};config.macros.yourSearch={label:&quot;yourSearch&quot;,prompt:&quot;Gives access to the current/last YourSearch result&quot;,handler:function(_132,_133,_134,_135,_136,_137){if(_134.length==0){return;}var name=_134[0];var func=config.macros.yourSearch.funcs[name];if(func){func(_132,_133,_134,_135,_136,_137);}},tests:{&quot;true&quot;:function(){return true;},&quot;false&quot;:function(){return false;},&quot;found&quot;:function(){return _b6()&gt;0;},&quot;previewText&quot;:function(){return config.options.chkPreviewText;}},funcs:{itemRange:function(_138){if(_b6()){var _139=_f5.getLastIndexOnPage();var s=&quot;%0 - %1&quot;.format([_f5.getFirstIndexOnPage()+1,_139+1]);createTiddlyText(_138,s);}},count:function(_13a){createTiddlyText(_13a,_b6().toString());},query:function(_13b){if(_b2){createTiddlyText(_13b,_b2.toString());}},version:function(_13c){var t=&quot;YourSearch %0.%1.%2&quot;.format([version.extensions.YourSearchPlugin.major,version.extensions.YourSearchPlugin.minor,version.extensions.YourSearchPlugin.revision]);var e=createTiddlyElement(_13c,&quot;a&quot;);e.setAttribute(&quot;href&quot;,&quot;http://tiddlywiki.abego-software.de/#YourSearchPlugin&quot;);e.innerHTML=&quot;&lt;font color=\&quot;black\&quot; face=\&quot;Arial, Helvetica, sans-serif\&quot;&gt;&quot;+t+&quot;&lt;font&gt;&quot;;},copyright:function(_13d){var e=createTiddlyElement(_13d,&quot;a&quot;);e.setAttribute(&quot;href&quot;,&quot;http://www.abego-software.de&quot;);e.innerHTML=&quot;&lt;font color=\&quot;black\&quot; face=\&quot;Arial, Helvetica, sans-serif\&quot;&gt;&amp;copy; 2005-2008 &lt;b&gt;&lt;font color=\&quot;red\&quot;&gt;abego&lt;/font&gt;&lt;/b&gt; Software&lt;font&gt;&quot;;},newTiddlerButton:function(_13e){if(_b2){var r=abego.parseNewTiddlerCommandLine(_b2.getQueryText());var btn=config.macros.newTiddler.createNewTiddlerButton(_13e,r.title,r.params,&quot;new tiddler&quot;,&quot;Create a new tiddler based on search text. (Shortcut: Ctrl-Enter; Separators: '.', '#')&quot;,null,&quot;text&quot;);var _13f=btn.onclick;btn.onclick=function(){_e3();_13f.apply(this,arguments);};_e0=btn;}},linkButton:function(_140,_141,_142,_143,_144,_145){if(_142&lt;2){return;}var _146=_142[1];var text=_142&lt;3?_146:_142[2];var _147=_142&lt;4?text:_142[3];var _148=_142&lt;5?null:_142[4];var btn=createTiddlyButton(_140,text,_147,_e4,null,null,_148);btn.setAttribute(&quot;tiddlyLink&quot;,_146);},closeButton:function(_149,_14a,_14b,_14c,_14d,_14e){var _14f=createTiddlyButton(_149,&quot;close&quot;,&quot;Close the Search Results (Shortcut: ESC)&quot;,_e3);},openAllButton:function(_150,_151,_152,_153,_154,_155){var n=_b6();if(n==0){return;}var _156=n==1?&quot;open tiddler&quot;:&quot;open all %0 tiddlers&quot;.format([n]);var _157=createTiddlyButton(_150,_156,&quot;Open all found tiddlers (Shortcut: Alt-O)&quot;,_117);_157.setAttribute(&quot;accessKey&quot;,&quot;O&quot;);},naviBar:function(_158,_159,_15a,_15b,_15c,_15d){_f5.addPageNavigation(_158);},&quot;if&quot;:function(_15e,_15f,_160,_161,_162,_163){if(_160.length&lt;2){return;}var _164=_160[1];var _165=(_164==&quot;not&quot;);if(_165){if(_160.length&lt;3){return;}_164=_160[2];}var test=config.macros.yourSearch.tests[_164];var _166=false;try{if(test){_166=test(_15e,_15f,_160,_161,_162,_163)!=_165;}else{_166=(!eval(_164))==_165;}}catch(ex){}if(!_166){_15e.style.display=&quot;none&quot;;}},chkPreviewText:function(_167,_168,_169,_16a,_16b,_16c){var _16d=_169.slice(1).join(&quot; &quot;);var elem=_11a(_167,&quot;chkPreviewText&quot;,_16a,_16c);elem.setAttribute(&quot;accessKey&quot;,&quot;P&quot;);elem.title=&quot;Show text preview of found tiddlers (Shortcut: Alt-P)&quot;;return elem;}}};config.macros.foundTiddler={label:&quot;foundTiddler&quot;,prompt:&quot;Provides information on the tiddler currently processed on the YourSearch result page&quot;,handler:function(_16e,_16f,_170,_171,_172,_173){var name=_170[0];var func=config.macros.foundTiddler.funcs[name];if(func){func(_16e,_16f,_170,_171,_172,_173);}},funcs:{title:function(_174,_175,_176,_177,_178,_179){if(!_f4){return;}var _17a=_124();var _17b=_17a&gt;=0?&quot;Open tiddler (Shortcut: Alt-%0)&quot;.format([_17a.toString()]):&quot;Open tiddler&quot;;var btn=createTiddlyButton(_174,null,_17b,_e4,null);btn.setAttribute(&quot;tiddlyLink&quot;,_f4.title);btn.setAttribute(&quot;withHilite&quot;,&quot;true&quot;);_126(btn,_f4.title,_d4);if(_17a&gt;=0){btn.setAttribute(&quot;accessKey&quot;,_17a.toString());}},tags:function(_17c,_17d,_17e,_17f,_180,_181){if(!_f4){return;}_126(_17c,_f4.getTags(),_d5);},text:function(_182,_183,_184,_185,_186,_187){if(!_f4){return;}_126(_182,_121(_f4.text),_d6);},field:function(_188,_189,_18a,_18b,_18c,_18d){if(!_f4){return;}var name=_18a[1];var len=_18a.length&gt;2?abego.toInt(_18a[2],_d7):_d7;var v=store.getValue(_f4,name);if(v){_126(_188,_121(v),len);}},number:function(_18e,_18f,_190,_191,_192,_193){var _194=_124();if(_194&gt;=0){var text=&quot;%0)&quot;.format([_194.toString()]);createTiddlyElement(_18e,&quot;span&quot;,null,&quot;shortcutNumber&quot;,text);}}}};var opts={chkUseYourSearch:true,chkPreviewText:true,chkSearchAsYouType:true,chkSearchInTitle:true,chkSearchInText:true,chkSearchInTags:true,chkSearchExtendedFields:true,txtItemsPerPage:_d8,txtItemsPerPageWithPreview:_d9};for(var n in opts){if(config.options[n]==undefined){config.options[n]=opts[n];}}config.shadowTiddlers.AdvancedOptions+=&quot;\n&lt;&lt;option chkUseYourSearch&gt;&gt; Use 'Your Search' //([[more options|YourSearch Options]]) ([[help|YourSearch Help]])// &quot;;config.shadowTiddlers[&quot;YourSearch Help&quot;]=&quot;!Field Search\nWith the Field Search you can restrict your search to certain fields of a tiddler, e.g&quot;+&quot; only search the tags or only the titles. The general form is //fieldname//'':''//textToSearch// (e.&quot;+&quot;g. {{{title:intro}}}). In addition one-character shortcuts are also supported for the standard field&quot;+&quot;s {{{title}}}, {{{text}}} and {{{tags}}}:\n|!What you want|!What you type|!Example|\n|Search ''titles &quot;+&quot;only''|start word with ''!''|{{{!jonny}}} (shortcut for {{{title:jonny}}})|\n|Search ''contents/text &quot;+&quot;only''|start word with ''%''|{{{%football}}} (shortcut for {{{text:football}}})|\n|Search ''tags only&quot;+&quot;''|start word with ''#''|{{{#Plugin}}} (shortcut for {{{tags:Plugin}}})|\n\nUsing this feature you may&quot;+&quot; also search the extended fields (\&quot;Metadata\&quot;) introduced with TiddlyWiki 2.1, e.g. use {{{priority:1&quot;+&quot;}}} to find all tiddlers with the priority field set to \&quot;1\&quot;.\n\nYou may search a word in more than one&quot;+&quot; field. E.g. {{{!#Plugin}}} (or {{{title:tags:Plugin}}} in the \&quot;long form\&quot;) finds tiddlers containin&quot;+&quot;g \&quot;Plugin\&quot; either in the title or in the tags (but does not look for \&quot;Plugin\&quot; in the text). \n\n!Boole&quot;+&quot;an Search\nThe Boolean Search is useful when searching for multiple words.\n|!What you want|!What you &quot;+&quot;type|!Example|\n|''All words'' must exist|List of words|{{{jonny jeremy}}} (or {{{jonny and jeremy}}}&quot;+&quot;)|\n|''At least one word'' must exist|Separate words by ''or''|{{{jonny or jeremy}}}|\n|A word ''must &quot;+&quot;not exist''|Start word with ''-''|{{{-jonny}}} (or {{{not jonny}}})|\n\n''Note:'' When you specify two&quot;+&quot; words, separated with a space, YourSearch finds all tiddlers that contain both words, but not neces&quot;+&quot;sarily next to each other. If you want to find a sequence of word, e.g. '{{{John Brown}}}', you need&quot;+&quot; to put the words into quotes. I.e. you type: {{{\&quot;john brown\&quot;}}}.\n\nUsing parenthesis you may change &quot;+&quot;the default \&quot;left to right\&quot; evaluation of the boolean search. E.g. {{{not (jonny or jeremy)}}} finds&quot;+&quot; all tiddlers that contain neither \&quot;jonny\&quot; nor \&quot;jeremy. In contrast to this {{{not jonny or jeremy}}&quot;+&quot;} (i.e. without parenthesis) finds all tiddlers that either don't contain \&quot;jonny\&quot; or that contain \&quot;j&quot;+&quot;eremy\&quot;.\n\n!'Exact Word' Search\nBy default a search result all matches that 'contain' the searched tex&quot;+&quot;t. E.g. if you search for {{{Task}}} you will get all tiddlers containing 'Task', but also '~Complet&quot;+&quot;edTask', '~TaskForce' etc.\n\nIf you only want to get the tiddlers that contain 'exactly the word' you&quot;+&quot; need to prefix it with a '='. E.g. typing '=Task' will find the tiddlers that contain the word 'Tas&quot;+&quot;k', ignoring words that just contain 'Task' as a substring.\n\n!~CaseSensitiveSearch and ~RegExpSearch&quot;+&quot;\nThe standard search options ~CaseSensitiveSearch and ~RegExpSearch are fully supported by YourSearc&quot;+&quot;h. However when ''~RegExpSearch'' is on Filtered and Boolean Search are disabled.\n\nIn addition you m&quot;+&quot;ay do a \&quot;regular expression\&quot; search even with the ''~RegExpSearch'' set to false by directly enterin&quot;+&quot;g the regular expression into the search field, framed with {{{/.../}}}. \n\nExample: {{{/m[ae][iy]er/&quot;+&quot;}}} will find all tiddlers that contain either \&quot;maier\&quot;, \&quot;mayer\&quot;, \&quot;meier\&quot; or \&quot;meyer\&quot;.\n\n!~JavaScript E&quot;+&quot;xpression Filtering\nIf you are familiar with JavaScript programming and know some TiddlyWiki interna&quot;+&quot;ls you may also use JavaScript expression for the search. Just enter a JavaScript boolean expression&quot;+&quot; into the search field, framed with {{{ { ... } }}}. In the code refer to the variable tiddler and e&quot;+&quot;valuate to {{{true}}} when the given tiddler should be included in the result. \n\nExample: {{{ { tidd&quot;+&quot;ler.modified &gt; new Date(\&quot;Jul 4, 2005\&quot;)} }}} returns all tiddler modified after July 4th, 2005.\n\n!Com&quot;+&quot;bined Search\nYou are free to combine the various search options. \n\n''Examples''\n|!What you type|!Res&quot;+&quot;ult|\n|{{{!jonny !jeremy -%football}}}|all tiddlers with both {{{jonny}}} and {{{jeremy}}} in its tit&quot;+&quot;les, but no {{{football}}} in content.|\n|{{{#=Task}}}|All tiddlers tagged with 'Task' (the exact wor&quot;+&quot;d). Tags named '~CompletedTask', '~TaskForce' etc. are not considered.|\n\n!Access Keys\nYou are encour&quot;+&quot;aged to use the access keys (also called \&quot;shortcut\&quot; keys) for the most frequently used operations. F&quot;+&quot;or quick reference these shortcuts are also mentioned in the tooltip for the various buttons etc.\n\n|&quot;+&quot;!Key|!Operation|\n|{{{Alt-F}}}|''The most important keystroke'': It moves the cursor to the search in&quot;+&quot;put field so you can directly start typing your query. Pressing {{{Alt-F}}} will also display the pr&quot;+&quot;evious search result. This way you can quickly display multiple tiddlers using \&quot;Press {{{Alt-F}}}. S&quot;+&quot;elect tiddler.\&quot; sequences.|\n|{{{ESC}}}|Closes the [[YourSearch Result]]. When the [[YourSearch Resul&quot;+&quot;t]] is already closed and the cursor is in the search input field the field's content is cleared so &quot;+&quot;you start a new query.|\n|{{{Alt-1}}}, {{{Alt-2}}},... |Pressing these keys opens the first, second e&quot;+&quot;tc. tiddler from the result list.|\n|{{{Alt-O}}}|Opens all found tiddlers.|\n|{{{Alt-P}}}|Toggles the &quot;+&quot;'Preview Text' mode.|\n|{{{Alt-'&lt;'}}}, {{{Alt-'&gt;'}}}|Displays the previous or next page in the [[Your&quot;+&quot;Search Result]].|\n|{{{Return}}}|When you have turned off the 'as you type' search mode pressing the &quot;+&quot;{{{Return}}} key actually starts the search (as does pressing the 'search' button).|\n\n//If some of t&quot;+&quot;hese shortcuts don't work for you check your browser if you have other extensions installed that alr&quot;+&quot;eady \&quot;use\&quot; these shortcuts.//&quot;;config.shadowTiddlers[&quot;YourSearch Options&quot;]=&quot;|&gt;|!YourSearch Options|\n|&gt;|&lt;&lt;option chkUseYourSearch&gt;&gt; Use 'Your Search'|\n|!|&lt;&lt;option chkPreviewText&quot;+&quot;&gt;&gt; Show Text Preview|\n|!|&lt;&lt;option chkSearchAsYouType&gt;&gt; 'Search As You Type' Mode (No RETURN required&quot;+&quot; to start search)|\n|!|Default Search Filter:&lt;&lt;option chkSearchInTitle&gt;&gt;Title ('!')     &lt;&lt;option chk&quot;+&quot;SearchInText&gt;&gt;Text ('%')     &lt;&lt;option chkSearchInTags&gt;&gt;Tags ('#')    &lt;&lt;option chkSearchExtendedFiel&quot;+&quot;ds&gt;&gt;Extended Fields&lt;html&gt;&lt;br&gt;&lt;font size=\&quot;-2\&quot;&gt;The fields of a tiddlers that are searched when you don&quot;+&quot;'t explicitly specify a filter in the search text &lt;br&gt;(Explictly specify fields using one or more '!&quot;+&quot;', '%', '#' or 'fieldname:' prefix before the word/text to find).&lt;/font&gt;&lt;/html&gt;|\n|!|Number of items &quot;+&quot;on search result page: &lt;&lt;option txtItemsPerPage&gt;&gt;|\n|!|Number of items on search result page with pre&quot;+&quot;view text: &lt;&lt;option txtItemsPerPageWithPreview&gt;&gt;|\n&quot;;config.shadowTiddlers[&quot;YourSearchStyleSheet&quot;]=&quot;/***\n!~YourSearchResult Stylesheet\n***/\n/*{{{*/\n.yourSearchResult {\n\tposition: absolute;\n\twidth: 800&quot;+&quot;px;\n\n\tpadding: 0.2em;\n\tlist-style: none;\n\tmargin: 0;\n\n\tbackground: #ffd;\n\tborder: 1px solid DarkGra&quot;+&quot;y;\n}\n\n/*}}}*/\n/***\n!!Summary Section\n***/\n/*{{{*/\n.yourSearchResult .summary {\n\tborder-bottom-width:&quot;+&quot; thin;\n\tborder-bottom-style: solid;\n\tborder-bottom-color: #999999;\n\tpadding-bottom: 4px;\n}\n\n.yourSea&quot;+&quot;rchRange, .yourSearchCount, .yourSearchQuery   {\n\tfont-weight: bold;\n}\n\n.yourSearchResult .summary .&quot;+&quot;button {\n\tfont-size: 10px;\n\n\tpadding-left: 0.3em;\n\tpadding-right: 0.3em;\n}\n\n.yourSearchResult .summa&quot;+&quot;ry .chkBoxLabel {\n\tfont-size: 10px;\n\n\tpadding-right: 0.3em;\n}\n\n/*}}}*/\n/***\n!!Items Area\n***/\n/*{{{*&quot;+&quot;/\n.yourSearchResult .marked {\n\tbackground: none;\n\tfont-weight: bold;\n}\n\n.yourSearchItem {\n\tmargin-to&quot;+&quot;p: 2px;\n}\n\n.yourSearchNumber {\n\tcolor: #808080;\n}\n\n\n.yourSearchTags {\n\tcolor: #008000;\n}\n\n.yourSearc&quot;+&quot;hText {\n\tcolor: #808080;\n\tmargin-bottom: 6px;\n}\n\n/*}}}*/\n/***\n!!Footer\n***/\n/*{{{*/\n.yourSearchFoote&quot;+&quot;r {\n\tmargin-top: 8px;\n\tborder-top-width: thin;\n\tborder-top-style: solid;\n\tborder-top-color: #999999;&quot;+&quot;\n}\n\n.yourSearchFooter a:hover{\n\tbackground: none;\n\tcolor: none;\n}\n/*}}}*/\n/***\n!!Navigation Bar\n***/&quot;+&quot;\n/*{{{*/\n.yourSearchNaviBar a {\n\tfont-size: 16px;\n\tmargin-left: 4px;\n\tmargin-right: 4px;\n\tcolor: bla&quot;+&quot;ck;\n\ttext-decoration: underline;\n}\n\n.yourSearchNaviBar a:hover {\n\tbackground-color: none;\n}\n\n.yourSe&quot;+&quot;archNaviBar .prev {\n\tfont-weight: bold;\n\tcolor: blue;\n}\n\n.yourSearchNaviBar .currentPage {\n\tcolor: #&quot;+&quot;FF0000;\n\tfont-weight: bold;\n\ttext-decoration: none;\n}\n\n.yourSearchNaviBar .next {\n\tfont-weight: bold&quot;+&quot;;\n\tcolor: blue;\n}\n/*}}}*/\n&quot;;config.shadowTiddlers[&quot;YourSearchResultTemplate&quot;]=&quot;&lt;!--\n{{{\n--&gt;\n&lt;span macro=\&quot;yourSearch if found\&quot;&gt;\n&lt;!-- The Summary Header ============================&quot;+&quot;================ --&gt;\n&lt;table class=\&quot;summary\&quot; border=\&quot;0\&quot; width=\&quot;100%\&quot; cellspacing=\&quot;0\&quot; cellpadding=\&quot;0\&quot;&gt;&quot;+&quot;&lt;tbody&gt;\n  &lt;tr&gt;\n\t&lt;td align=\&quot;left\&quot;&gt;\n\t\tYourSearch Result &lt;span class=\&quot;yourSearchRange\&quot; macro=\&quot;yourSearc&quot;+&quot;h itemRange\&quot;&gt;&lt;/span&gt;\n\t\t&amp;nbsp;of&amp;nbsp;&lt;span class=\&quot;yourSearchCount\&quot; macro=\&quot;yourSearch count\&quot;&gt;&lt;/span&gt;\n&quot;+&quot;\t\tfor&amp;nbsp;&lt;span class=\&quot;yourSearchQuery\&quot; macro=\&quot;yourSearch query\&quot;&gt;&lt;/span&gt;\n\t&lt;/td&gt;\n\t&lt;td class=\&quot;yourSea&quot;+&quot;rchButtons\&quot; align=\&quot;right\&quot;&gt;\n\t\t&lt;span macro=\&quot;yourSearch chkPreviewText\&quot;&gt;&lt;/span&gt;&lt;span class=\&quot;chkBoxLabel&quot;+&quot;\&quot;&gt;preview text&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch newTiddlerButton\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch openAllButton\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch lin&quot;+&quot;kButton 'YourSearch Options' options 'Configure YourSearch'\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch linkB&quot;+&quot;utton 'YourSearch Help' help 'Get help how to use YourSearch'\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch clo&quot;+&quot;seButton\&quot;&gt;&lt;/span&gt;\n\t&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n\n&lt;!-- The List of Found Tiddlers =================&quot;+&quot;=========================== --&gt;\n&lt;div id=\&quot;yourSearchResultItems\&quot; itemsPerPage=\&quot;25\&quot; itemsPerPageWithPr&quot;+&quot;eview=\&quot;10\&quot;&gt;&lt;/div&gt;\n\n&lt;!-- The Footer (with the Navigation) ===========================================&quot;+&quot;= --&gt;\n&lt;table class=\&quot;yourSearchFooter\&quot; border=\&quot;0\&quot; width=\&quot;100%\&quot; cellspacing=\&quot;0\&quot; cellpadding=\&quot;0\&quot;&gt;&lt;tbody&quot;+&quot;&gt;\n  &lt;tr&gt;\n\t&lt;td align=\&quot;left\&quot;&gt;\n\t\tResult page: &lt;span class=\&quot;yourSearchNaviBar\&quot; macro=\&quot;yourSearch naviBar&quot;+&quot;\&quot;&gt;&lt;/span&gt;\n\t&lt;/td&gt;\n\t&lt;td align=\&quot;right\&quot;&gt;&lt;span macro=\&quot;yourSearch version\&quot;&gt;&lt;/span&gt;, &lt;span macro=\&quot;yourSearc&quot;+&quot;h copyright\&quot;&gt;&lt;/span&gt;\n\t&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n&lt;!-- end of the 'tiddlers found' case =========&quot;+&quot;================================== --&gt;\n&lt;/span&gt;\n\n\n&lt;!-- The \&quot;No tiddlers found\&quot; case =================&quot;+&quot;========================== --&gt;\n&lt;span macro=\&quot;yourSearch if not found\&quot;&gt;\n&lt;table class=\&quot;summary\&quot; border=&quot;+&quot;\&quot;0\&quot; width=\&quot;100%\&quot; cellspacing=\&quot;0\&quot; cellpadding=\&quot;0\&quot;&gt;&lt;tbody&gt;\n  &lt;tr&gt;\n\t&lt;td align=\&quot;left\&quot;&gt;\n\t\tYourSearch Resu&quot;+&quot;lt: No tiddlers found for &lt;span class=\&quot;yourSearchQuery\&quot; macro=\&quot;yourSearch query\&quot;&gt;&lt;/span&gt;.\n\t&lt;/td&gt;\n\t&lt;t&quot;+&quot;d class=\&quot;yourSearchButtons\&quot; align=\&quot;right\&quot;&gt;\n\t\t&lt;span macro=\&quot;yourSearch newTiddlerButton\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch linkButton 'YourSearch Options'&quot;+&quot; options 'Configure YourSearch'\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch linkButton 'YourSearch Help' help&quot;+&quot; 'Get help how to use YourSearch'\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch closeButton\&quot;&gt;&lt;/span&gt;\n\t&lt;/td&gt;\n  &lt;&quot;+&quot;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n&lt;/span&gt;\n\n\n&lt;!--\n}}}\n--&gt;\n&quot;;config.shadowTiddlers[&quot;YourSearchItemTemplate&quot;]=&quot;&lt;!--\n{{{\n--&gt;\n&lt;span class='yourSearchNumber' macro='foundTiddler number'&gt;&lt;/span&gt;\n&lt;span class='yourSea&quot;+&quot;rchTitle' macro='foundTiddler title'/&gt;&lt;/span&gt;&amp;nbsp;-&amp;nbsp;\n&lt;span class='yourSearchTags' macro='found&quot;+&quot;Tiddler field tags 50'/&gt;&lt;/span&gt;\n&lt;span macro=\&quot;yourSearch if previewText\&quot;&gt;&lt;div class='yourSearchText' macro='fo&quot;+&quot;undTiddler field text 250'/&gt;&lt;/div&gt;&lt;/span&gt;\n&lt;!--\n}}}\n--&gt;&quot;;config.shadowTiddlers[&quot;YourSearch&quot;]=&quot;&lt;&lt;tiddler [[YourSearch Help]]&gt;&gt;&quot;;config.shadowTiddlers[&quot;YourSearch Result&quot;]=&quot;The popup-like window displaying the result of a YourSearch query.&quot;;config.macros.search.handler=_109;var _195=function(){if(config.macros.search.handler!=_109){alert(&quot;Message from YourSearchPlugin:\n\n\nAnother plugin has disabled the 'Your Search' features.\n\n\nYou may &quot;+&quot;disable the other plugin or change the load order of \nthe plugins (by changing the names of the tidd&quot;+&quot;lers)\nto enable the 'Your Search' features.&quot;);}};setTimeout(_195,5000);abego.YourSearch.getStandardRankFunction=function(){return _bb;};abego.YourSearch.getRankFunction=function(){return abego.YourSearch.getStandardRankFunction();};abego.YourSearch.getCurrentTiddler=function(){return _f4;};abego.YourSearch.closeResult=function(){_e3();};abego.YourSearch.getFoundTiddlers=function(){return _b1;};abego.YourSearch.getQuery=function(){return _b2;};abego.YourSearch.onShowResult=function(_196){highlightHack=_b2?_b2.getMarkRegExp():null;if(!_196){_f5.setItems(_b5());}if(!_dd){_dd=createTiddlyElement(document.body,&quot;div&quot;,_da,&quot;yourSearchResult&quot;);}else{if(_dd.parentNode!=document.body){document.body.appendChild(_dd);}}_fe();highlightHack=null;};})();}
//%/
</pre>
</div>
<div title="attachment" modifier="JohnRouillard" created="200909072015" modified="200909080040" tags="structure excludeMissing excludeOrphans">
<pre>{{nocol{}}}
&lt;&lt;tiddler OpenStoryButton with: &quot;Open all tiddlers tagged with attachment&quot; &quot;Open the attachment tiddlers to cache their source URLs&quot;&gt;&gt;</pre>
</div>
<div title="block-icon.png" modifier="JohnRouillard" created="201007310844" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[block-icon.png]]}}}
[img[block-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./block-icon.png
!url

!data
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAPvElEQVR42tWaCZAU13nH/6+75549Zy+W2dld9uK+QbJsybISFgfZGJCQLBuCSCLHOayUFUmWk8iWEiMHl12JnEJly3GVY3Q4kiX5SixcCpGQwSBYxLGw7MLCXuw5Mzu7O0ffnfd6pnsOWBCxFFde0TM9PT3v/f7f+77vfa8Xgg+gndoOQt+K6DGzdC+MD2IMq5H3AXYxR7gdHEg7Ja0GDC/vcjkEl5uosgRNEmUYJEkHGjdg7NcM/QdU1InfqQAKvZwn3MMg5E5voNLrD4acjrIACC+Ad5eAc/jBCR4YhgZdTUKNj8LQdaixKOKD/UoiPJ6iX/6KitlNxRz7PxNAwRsp+A9cJWU3lbXMd/ElZSDxGSAaAaZiIIZh9kjSL9lGLxscvVBcCqO8HPAXQ52OIXa+SxYnox1UyA4q5PwHJoCCl3LgnnF4fZ8KLFrqFTxeGAP9wPQ0nQTWC0U2j0yXV/LbL0yjwV78NETqQtTFJITPnhTVRPyXVMgDVEjkfRVA4ds4wr9VuXBplauiiuj9fTBikyYsSb+YFs8Kma3bNDx7MUWY00KPkhKQUCPkyTDGO09EdF27nYrofF8EnN5OPik4XS9UrbzJT6amoQ0NZCxNsvB5QtIi7M5JmjGrwchMhGHOQlaQATKnFqDuNdZxOKlK4v1L9hov/1YCOreTR5xFJU9WLF3lYVbXJ2NpWK4AHiTf8pb7FMZAgRulxeSLQDFNAA2NiJzqEKXp2O7Fe40n/lcCTm/HnS5/yUsVS1d6le5uICVmfTxj8VwRumogkZTpoWiqZkDXDGKYXevmq9MpGB4Pz/l8TuJw8BlB+fCGkVHpcoFvm4/I6eMpcXrq/iXPGS/dkADq8wsEh+tI9cqbi5Sengw8ruIygCRpiMZETeVcSDTdRsK1q7mEsxSq009TP2f2x2kyvFODCETOGiUX3jScREagoZor/8g9EDtehzI+kBaU41JwOU0RY8cPxxVRvHXZ87OvG6QAvowuSmerlq2pMYZHoMemsuCW69CmUStHYylN8lQYQzf/mRD11prXeZ6Hx+OhFnfC4XCA4zioqgpFUZBMJiHLMjxTQ5h39Dt6aOUKrmr9TkT2fC4Lj4wQ3QBXXAQSnIvRjiNh3dAXURHj1xVA/f6HZQ0t2wSdEHVkJCdgYadKSdYQnlK18Y8+yI+WtJnXymnwWQcTIQiCLdaC0ulCxkREO3+N0lcfRfPmuyGdfhs6XT+s+Mi6UloQV10FzSEYkfNdP13yvLH5mgKo9ZscLs+7FQuWFUmnOwv8PH0kUooeU1x63+8/Lsw4Sk3gYDCI4uJi0+Iu6r+58GwGcgUkut9B7OlPI3jTQrhrW5A88J95lrdTbI4Q58IFmOjqjEupxNrlL6BrVgGd28h/lTcv+Biik0SfmslbnGzLSy615+NPCZrDi3nz5qGqqsqEZm7DBFhuk9vYZxO+5x1c3rURwbXz4appQurgvlnhc9Ms8ftAqiqN8bOnjyx70fjQVQWc/CxWuHxFb5XVNxfJ53quyDQaBRifNtSBDbsEyV+N1tZW0/oMnB3M6sx1LPhCEfHuw+h/8hMIrmmDq7oByUNvWOQwbAGAKKpmOeJwcnkZytnchOhgfyI1HVu34kf4zRUCTn2WfL+8oXknjUyixxN5CxML3okpVRm79UFHuGopFi9ebLqMz+czrW9ZvRDaagkG/7VPIriawleEkDry3wULWjoAUkkNQ5cTaLu5FcrYsHmNBTP7mvN6gIoAJnq6X17+78Y9V87AfWS0etGyaqmr+wrry6qOCAmo59p3CfPnzzfdJhf+ahbPwh/BQAbeWV6L1NEDeZbPmJ9mag39IwocZaUI1tB+1QR0UcybBdf8NgyfPBmhGaly1cvZPQY58WkscvuLDxZXVJbIA5dz4NNCxmd0eaT9cae7Za3p9wze7Xbb2Wa2lobfiDrqNs6SKqQ6DuatxtbqnEpp6KPw4fYvIsDF4D+41wgGBKJranaFpv+EuXMwFY5MJ6Zi61b/GO/YAo7fg11lc4Nf5pMi0Wfi6YsZETr98ajoUnu37BHWrFkDr9drB+y14Q9j6KktFL4FDl8AqROHM5ZH1nS076QJryK8/ouQahfAy2sI/exRo0JIEnPBzsCbtZLPC93nMyL9A3tWvYov2ALevZu8VdnUdJsyOGR2aqVAM23KuhFuWqdjw6N8Q0NDXraZHf43GPr6XQitaYVANzepU8fyyK0JYPCXRlVE1j8EaU6bnRDKDn9fL+56nZT6aPDlplTK4wgFMdJ1oWP1T4zVtoBjW9Azp7mpReofzFuwWIukIA7f8Zi7tf0+FBUV5QXtVeHPUfjdd6N+dSt4uitLdR5HDrZ9lkwyeA2Rjz8EmcKzjOb3+023dPYfA/nx42pNkS5YApDJVK5QHYa6Lgyu/RlCtoCjmzFa29RQLQ1eNmM6V8RYgogTW592L7l1vVkeWCXCbJa/vHtrGp53I3X2VM63WQHJpI7eUR3RDX8NpabFTAo1NTVmv2xMIxFF7In1al2ZIeTCm4tasBZD5/omzm39t+odO3YYaQGbuEht/ZxycWTcLoktEcMJTlYe/ImzqW2hDc+sdDX44W/cgxCDh4DUOWs/Qq6Av0i39tEND0OpbjbB6+rqzNiyVnBdo7Pzp21qiAooTLeumkpcvjQ+OeOvrf69F/qVjABHpGZuoFweD+dtSpiIoTinur/6tlBbW2sHbqH7JM4dwvA376OWbwGhiUPsyaz2ObUQGz2RovB0iMkNj0KtmmfC19fXm67DjGMlDmbtszsa5FCJ6izcPzgq6YbncmwymZSab/sVouYwBzeQiVBjVYU0FrbTpzULl+kMlPzDIWdlTa09xaxZIkz4b30G9auaQWhpLfb22Mwkp06M04C9GOYQu/MRGz4UCplxxeDZrNqZT5XRuaNRDhWrzsLFzkkXs/7ecFRVtMrb99PNBhvnwDoMNzZVzpHCUdtyliuNprhUxVff8JQEW0zrM+vY8F2HMPLP29BA4Y2kBOlir11Z5cHTgO0N85ja+CVolQ2orq424ZnlWVKw4K0mTwyh9+EPJWt9qte2fubdXVGG3u6J8Y/uZ8+fMmO9eQc6G5sDi+TIZLajjCtFJJIoeeA7vvKbN14FfjsaGTwtPcS+vgKvSZ/EReY2DP7L0GgZweCZz88Gz9r0yTcx/k/bElVezWfPQObdFSjDhXPhix97C032SPtvx76GhrJ2PT5D79GzQUzfEwotg5dvnAn+5bNFts+feRuj/7ITDSub6IZnGtLQYA5yVkWc+fykA9MMPlBnwrPS+1rwrA18+/MpZ+fP3V6HTtK+n5kBOoJAa7BLF6KH7jiAD9vDvf4RPBSc49/tdaqClpLzYoDWUhhRPGLbd3vchOORPPNrjO35IzSsaII2OUnhLxc8A8qx/KQTM59Kw7NUacHn+vzV2tk/bhWD3qSbZFJnxvjg6TZTVHl9aCj+9+2H8KQ94i9uQsjrE95tqnOXSzOJnBkALa6qMDoWiQc+/6yPc/vJ6J4H0LSiEWokAoluOfOfPqRPZlIG+qZcmN70N9DL59rwrIa6HvxUxxtG+Jk/SVZ7FJ8FbqVhBy0lBoel6PSUcsudR9GdN+p/rEXvojb/PDmeyIsB9lK99Qs4+cpzEtFUV/OKeXQTPg5pdKyAOwMvUvhpN2Y2/S30slpUVla+Z3hD13D2L1akgvyUh4eG3NrDfFjh9+JMV3xow1HU5f7O7O2nK/H1pgb3l9wOjeiymgdWtGAVqu99xDTH4Hf/igqYyP95hicuApemPYhvZvBzTMuz9YMtUteDZ23i9X9VU689JVe6Va9dxGUU8DQDyppg9Pal9nyiI1vI2ZivLEWDy006lrS4y8VEKn8geuqspFvH6hDiZzryfmrdNkPh+2a8iG/5O+ilNTcMn+g5hkv/eK/YWKS6Cd395e7SWPP43ei6IEYTSeOWLaey7pPnwa8uwfeaG5w7fR6dVzOzUCjEBs/5PJ0C+hN+JO6i8CXVNwwvjQ+g57F2sd4nugWi2eC6nv5ecPJ0P87p5y/JL206hfsKf2/3/KOFCDgFdK9c6AyILBtZNxBcCWDDc+hPUXhqeYNuWm4UfubMIePSt+6XQn7Z5TQ0YhVvtBzKlNCg8ePEiS45KkpYdG8XRmcVwNpLi/BE/Rz+sapy4mIbbOsOjmTvtlbZaJLWSmIxknd/BUZxRR48y/Ns0ZsNXlckjL72tBzb96zeWGq4oSjmkwuW7TMbMXMsj0dAdArypSH121vP4JGr9ZU3wgt098cTHFnSyi91OQxOknX7u9wilLnNyAw1mN9vpFZv5co/vBk1dfW25WeD16UUIgde0YZe/Jpc41a4iiLOpaREWoGmx1G17NNst4s91eOMEz3qGZqg1nymB+J1BbD2fCsqOAHvrpnPBdmWUlEMuyAW+LRLCWUBeOiyDlnC0EBEGpuhA4baxPJbNhX5mpZzTrp+cG4f1HgUSnQM4mifEd7//Exq6LyrymvoNaW8x1BUKJJsP/9h8MzvWf9OB111qSU7uvQRWcHKbeevdJ1ZBWRELHY58OaqhXxApdYRpcxDJpKeCZ6WRAJ7FM4epygiDTQBSUmnqVRVpkSqmWZjVSeExp/uFHTiFYirxMs7mFU1SiTTGNMzUcqMr6rphENMyxM4BQ7Hu7UoXZbW/WEvjuMabdYIe64V66iIF1e08QGOGGZtY80Eiwk2G9bWgLkLTy/wjvQDLvYsifXMnuvo7NkO+wMfzWyaqmbdiYLTSTDLlXQfgN/DmUjHz2kRGhY7qdv8HNdp1/wLzQ+b0UaZ9i1r4eu8HoNjmxLLWpYQNhscnxPo12gMlmUYdujZjRroGCZ8SiL6iR5tmGr9gx0X3tufma47LJ2JMgr3y9AcbmmoinhUnf0xgwrR8+/jiJVys4dVjxmZvJ4LzRqbRZ+Xg4P6++C4IfZd1rsUDe339yL8XuDfkwDW9rZQQ3P4HHXNr7SEuEBlGXHINLhF6veKll10rtWs7MLcjoaMmWVYsIZjULv6tCiNhV20n2eo5dXr93aDAqxGg9tDAR6jpcmfz6vlisuLiZM931JVAxIVpFETa1rW6tZMMDfjqZUZsEMgZsaZnIZ6YViLKTK+Rz/vouCJG2HJFcAyPJc55zIHn3Nufbau8WuKULqlAu1z3djqFdASrOTcVIyHBj1dSNLQbFK0jBAWNyxgo3GIg2OamFBwcVjCq69FsO/YDCaRuT1zFJ7rOdesc8N6Z9CuAthCMeyg+1OwGt2Rc42d8wEHPHdVYM08D5b7ecx18aiiX5TSGxx0BE02EEvoiE4rGL2YROcvJvFORME0/a2aA6rkwLFzNhvJAgFGwWfz+K3/s8fvuv2/F/A/IQq7oSxPlcIAAAAASUVORK5CYII=
</pre>
</div>
<div title="bookmark-icon.png" modifier="JohnRouillard" created="201007310844" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[bookmark-icon.png]]}}}
[img[bookmark-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./bookmark-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="bubble-icon.png" modifier="JohnRouillard" created="201007310844" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[bubble-icon.png]]}}}
[img[bubble-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./bubble-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="chapterViewTemplate" modifier="YourName" created="201007120111" tags="structure excludeOrphans">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[OtherToolbarCommands::ContentViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='view modified date'&gt;&lt;/span&gt; (&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='tiddler OpenStoryButton'&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;span macro=&quot;sectionTOC&quot;&gt;&lt;/span&gt;
&lt;div id=&quot;Notes&quot; class='notes viewer' macro='notes heading:Notebook tag:&quot;Notes excludeLists noReload&quot; suffix:Notes'&gt;&lt;/div&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="clipboard-icon.png" modifier="JohnRouillard" created="201007310844" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[clipboard-icon.png]]}}}
[img[clipboard-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./clipboard-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="content" modifier="JohnRouillard" created="200903221809" modified="200908292236" tags="InstructorOnly excludeOrphans">
<pre>This tag marks all tiddlers that the student will read. This is in contrast with [[structure]] tiddlers that are specific configurations that allow the unique functionality of this tiddlywiki to be implemented.

By default tiddlers tagged content do not switch to edit mode on a double click. This allows using double/triple click to select text from the content tiddler.. This allows easy copy/paste and prevents inadvertent changes that would be overwritten by synchronizing/updating the content from the master source.</pre>
</div>
<div title="contentViewTemplate" modifier="JohnRouillard" created="200903151958" modified="200909050317" tags="structure excludeOrphans">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[OtherToolbarCommands::ContentViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='view modified date'&gt;&lt;/span&gt; (&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;span macro=&quot;sectionTOC&quot;&gt;&lt;/span&gt;
&lt;div id=&quot;Notes&quot; class='notes viewer' macro='notes heading:Notebook tag:&quot;Notes excludeLists noReload&quot; suffix:Notes'&gt;&lt;/div&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="delete-icon.png" modifier="JohnRouillard" created="201007310844" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[delete-icon.png]]}}}
[img[delete-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./delete-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="editModeTiddler.png" modifier="JohnRouillard" created="201008020334" modified="201008020337" tags="icons attachment excludeMissing">
<pre>!usage
{{{[img[editModeTiddler.png]]}}}
[img[editModeTiddler.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./support/images/editModeTiddler.png
!url

!data

</pre>
</div>
<div title="example" modifier="JohnRouillard" created="200909052228" modified="200909110424" tags="content excludeOrphans">
<pre>{{nocol{}}}
Examples are intended to illustrate the mechanism of log analysis with SEC. They usually have working rules and include information about the events that are recognized by the rules.</pre>
</div>
<div title="exercise" modifier="JohnRouillard" created="200909052230" modified="200909110426" tags="content excludeOrphans">
<pre>{{nocol{}}}
Exercises present problems in log analysis for the student to solve. Some of them include extensive background discussion and hints on how to solve the problem while others are intended for the student to solve from the ground up.</pre>
</div>
<div title="flag-icon.png" modifier="JohnRouillard" created="201007310844" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[flag-icon.png]]}}}
[img[flag-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./flag-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="goal.jpg" modifier="JohnRouillard" created="201008020338" tags="icons attachment excludeMissing">
<pre>!usage
{{{[img[goal.jpg]]}}}
[img[goal.jpg]]
!notes
attached by FileDropPlugin
!type
image/jpeg
!file
./support/images/goal.jpg
!url

!data

</pre>
</div>
<div title="info-icon.png" modifier="JohnRouillard" created="201007310843" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[info-icon.png]]}}}
[img[info-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./info-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="label-icon.png" modifier="JohnRouillard" created="201007310843" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[label-icon.png]]}}}
[img[label-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./label-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="pageLayout.png" modifier="JohnRouillard" created="201008020334" tags="icons attachment excludeMissing">
<pre>!usage
{{{[img[pageLayout.png]]}}}
[img[pageLayout.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./support/images/pageLayout.png
!url

!data

</pre>
</div>
<div title="pencil-icon.png" modifier="JohnRouillard" created="201007310843" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[pencil-icon.png]]}}}
[img[pencil-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./pencil-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="presentationViewTemplate" modifier="JohnRouillard" created="200908290008" modified="201007310539" tags="structure excludeOrphans">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[OtherToolbarCommands::ContentViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='view modified date'&gt;&lt;/span&gt; (&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='showWhenExists InstructorSlideShowStyleSheet'&gt;
&lt;div macro='tiddler SlideStyleLinks##Instructor'&gt;&lt;/div&gt;
&lt;div class=&quot;exclude&quot; macro='slideShow  theme:InstructorSlideShowStyleSheet toc:titles noClicks footer:&quot;copyright&amp;copy; 2010&lt;br /&gt;John Rouillard&quot; clock:+ label:&quot;Instructor&quot; tooltip:&quot;Start slideshow in instructor projection mode&quot;'&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;div macro='tiddler SlideStyleLinks##Student'&gt;&lt;/div&gt;
&lt;div class='viewer exclude' macro='slideShow noClicks noKeyboard noOverlays toc:titles label:&quot;Student&quot; tooltip:&quot;Start the slideshow in student mode&quot;'&gt;&lt;/div&gt;

&lt;div macro='tiddler SlideStyleLinks##Print'&gt;&lt;/div&gt;
&lt;div class='viewer exclude' macro='slideShow showAll theme:PrintingSlideShowStyleSheet label:Print tooltip:&quot;Display slide show for printing&quot;'&gt;&lt;/div&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;span macro=&quot;sectionTOC&quot;&gt;&lt;/span&gt;
&lt;div id=&quot;Notes&quot; class='notes viewer' macro='notes heading:Notebook tag:&quot;Notes excludeLists noReload&quot; suffix:Notes'&gt;&lt;/div&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="search-icon.png" modifier="JohnRouillard" created="201007310856" tags="icons attachment excludeMissing">
<pre>!usage
{{{[img[search-icon.png]]}}}
[img[search-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./search-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="slideViewTemplate" modifier="JohnRouillard" created="200907030348" modified="200909050320" tags="structure excludeOrphans">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[OtherToolbarCommands::ContentViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='view modified date'&gt;&lt;/span&gt; (&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;div id=&quot;Notes&quot; class='notes viewer' macro='notes heading:Notebook tag:&quot;Notes excludeLists noReload&quot; suffix:Notes'&gt;&lt;/div&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="structure" modifier="JohnRouillard" created="200903221810" modified="200908170139" tags="InstructorOnly">
<pre>Tiddlers tagged with this tag are used to implement/control the functionality of the tiddlywiki and are not meant to be seen by the student.</pre>
</div>
<div title="sync" modifier="JohnRouillard" created="200903151849" modified="200910251749" tags="content structure">
<pre>To synchronize your {{{content}}} and {{{structure}}} tiddlers use the import button below. It will import all the updated tiddlers from the source site while preserving your notes.

&lt;&lt;loadTiddlers &quot;label:Import new content from %0&quot; updates {{store.getTiddlerSlice('GettingStarted','courseHomeContent')}} &gt;&gt;

If you want you can also manually import particular tiddlers using the import tool in  the backstage menu after seeing which tiddlers have been updated by looking at the ContentChanges tiddler.

After performing an update you may want to visit DeletedTiddler to remove/clean up any tiddlers that have been superseded and are no longer necessary. You can also display the removed tiddlers and copy any notes you may have before deleting the tiddlers.</pre>
</div>
<div title="tabs" modifier="JohnRouillard" created="200907030353" modified="200909051839" tags="test nopublish InstructorOnly">
<pre>! Slide 1
!! sub item

{{comment{
A slide comment
!!! sub sub item
}}}

&lt;&lt;tabs tabsClass
Welcome &quot;A description of how tags work in TiddlyWiki&quot; Welcome
&quot;Chapter 1&quot; &quot;A description of slides in TiddlyWiki&quot; [[Chapter  1 - Getting started, basic concepts and use]]
&gt;&gt;</pre>
</div>
<div title="tick-icon.png" modifier="JohnRouillard" created="201007310843" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[tick-icon.png]]}}}
[img[tick-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./tick-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="viewModeTiddler.png" modifier="JohnRouillard" created="201008020334" tags="icons attachment excludeMissing">
<pre>!usage
{{{[img[viewModeTiddler.png]]}}}
[img[viewModeTiddler.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./support/images/viewModeTiddler.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="warning-icon.png" modifier="JohnRouillard" created="201007310843" tags="icons attachment excludeMissing content">
<pre>!usage
{{{[img[warning-icon.png]]}}}
[img[warning-icon.png]]
!notes
attached by FileDropPlugin
!type
image/png
!file
./warning-icon.png
!url

!data
data:image/png;base64,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
</pre>
</div>
<div title="zzInstructorSettings" modifier="JohnRouillard" created="200908161955" modified="201007050123" tags="systemConfig InstructorOnly excludeOrphans">
<pre>/***
! Make tiddler macro report an error if tiddler not found

Useful when debugging coursebook.

The zzInstructorSettings tiddler isn't exported to the student book, so missing tiddlers in the studentbook are just left blank,
but with this tiddler present they look like:

&lt;&lt;tiddler MissingTiddler&gt;&gt;

which should be somewhat attention grabbing 8-).
***/

//{{{
// monkey patched version
// display large red text indicating missing tiddler. Include link to tidder w/ reference. Also if tiddler w/ link is a part tiddler, reference
// the real tiddler not the part. Check to see if tidder is defined so that it doesn't cause an error with the TiddlerNotePlugin.
var newcode = 'if (params[0] &amp;&amp; tiddler &amp;&amp; !(store.getTiddlerText(params[0]) || store.isShadowTiddler(params[0]))) return wikify(&quot;@@background:red;font-size: 200%;Error in [[&quot;+tiddler.title.replace(new RegExp(&quot;/[^/]+$&quot;), &quot;&quot;)+&quot;]]: &lt;nowiki&gt;&lt;&lt;tiddler [[&lt;/nowiki&gt;&quot;+params[0]+&quot;&lt;nowiki&gt;]]&gt;&gt;&lt;/nowiki&gt; not found@@&quot;,place);';

var code=config.macros.tiddler.handler.toString();
var pos=code.indexOf('{');
code = code.substr(0,pos+1)+newcode+code.substr(pos+1);
eval('config.macros.tiddler.handler='+code);

//}}}
</pre>
</div>
<div title="zzLocalSettings" modifier="JohnRouillard" created="200907111952" modified="200909080220" tags="systemConfig structure excludeOrphans">
<pre>/***
See also [[StorySaverPluginConfig]].
***/
/***
! Implementing excludeOrphans

Add the functionality for an excludeOrphans tag similar to excludeMissing. When a tiddler is tagged with excludeOrphans, it won't be shown as an orphan even if there are no referrers to it. It's used to allow top level tiddlers (like story tiddlers) to be referenced by the result of a search rather thanhard coded into tiddlers.

Ideas from: [[Searching for excludeOrphans tag functionality|http://groups.google.com/group/TiddlyWiki/browse_thread/thread/39f7be322883586e/2a19fc0a30a6c3ee]].
***/
//{{{
var orig = TiddlyWiki.prototype.getOrphans;
TiddlyWiki.prototype.getOrphans = function() {
     var results = [];
     var orphans = orig.apply(this, arguments);

     for (var i=0;i&lt;orphans.length;i++) {
       var title = orphans[i];
       var tiddler = store.getTiddler(title); 
       if(this.getReferringTiddlers(title).length == 0 &amp;&amp;
             !tiddler.isTagged(&quot;excludeLists&quot;) &amp;&amp;
             !tiddler.isTagged(&quot;excludeOrphans&quot;)) {
                        results.push(title);
         }
     }
     results.sort();
     return results;
}; 
//}}}

/***
! Set the shadow DefaultTiddlers for Coursebook

Set the Welcome tiddler as the default tiddlers when student coursebook opens.
Set a default Instructor main menu to suppress missing tiddler report when editing
coursebook with instructor/editing style sheet and macro definitions.
***/
//{{{
config.shadowTiddlers.DefaultTiddlers = &quot;[[Welcome]]&quot;;
config.shadowTiddlers.InstructorMainMenu = &quot;&quot;;
//}}}

/***
! Make Unsaved Changes active in the SideBarOptions

Add call to &lt; &lt;unsavedChanges command&gt; &gt; to sidebar right before saveChanges
***/
//{{{
config.shadowTiddlers.SideBarOptions=config.shadowTiddlers.SideBarOptions.replace('&lt;&lt;saveChanges&gt;&gt;','&lt;&lt;unsavedChanges command&gt;&gt;&lt;&lt;saveChanges&gt;&gt;');
//}}}

/***
! Closing a tiddler moves back to tiddler that it was linked from

From http://groups.google.com/group/tiddlywiki/browse_thread/thread/05719eb737c9ae22/fa2cff7e65fa2cb8?#fa2cff7e65fa2cb8:
{{{
From: FND &lt;F...@gmx.net&gt;
Date: Thu, 03 Sep 2009 17:44:55 +0100
Local: Thurs, Sep 3 2009 12:44 pm 
Subject: Re: [tw] Re: Close tiddler and go back to the one which opened it? Any thoughts?
Reply | Reply to author | Forward | Print | Individual message | Show original | Report this message | Find messages by this author 
You could try this quick hack: 
--------------- 
}}}
***/
//{{{
(function() {

var _closeTiddler = config.commands.closeTiddler.handler;
config.commands.closeTiddler.handler = function(event, src, title) {
     var tiddlerElem = story.getTiddler(title);
     var origin = tiddlerElem.getAttribute(&quot;origin&quot;);
     origin = tiddlerElem ? story.getTiddler(origin) : null;
     var status = _closeTiddler.apply(this, arguments);
     if(origin) {
         if(config.options.chkAnimate) {
             anim.startAnimating(new Zoomer(title, tiddlerElem, origin),
                 new Scroller(origin));
         } else {
             window.scrollTo(0,ensureVisible(origin));
         }
     }
     return status;

};

var _onClickTiddlerLink = onClickTiddlerLink;
onClickTiddlerLink = function(ev) {
     var status = _onClickTiddlerLink.apply(this, arguments);
     var target = resolveTarget(ev || window.event);
     var link = target;
     do {
         title = link.getAttribute(&quot;tiddlyLink&quot;);
         link = link.parentNode;
     } while(title === null &amp;&amp; link !== null);
     var el = story.getTiddler(title);
     var origin = story.findContainingTiddler(target);
     origin = origin ? origin.getAttribute(&quot;tiddler&quot;) : null;
     el.setAttribute(&quot;origin&quot;, origin);
     return status;

};
})();
//}}}

/***
! Set an off mode for the Tabs in the sidebar

***/
//{{{
config.shadowTiddlers.SideBarTabs=config.shadowTiddlers.SideBarTabs.replace('&lt;&lt;tabs txtMainTab','&lt;&lt;tabs txtMainTab &quot;Off&quot; &quot;A blank tab&quot; &quot;&quot;');

//}}}

/***
! Define isFirefox config.browser option

To determine if this is running within firefox.
***/
//{{{
config.browser.isFirefox = navigator.userAgent.indexOf('Firefox') != -1;
//}}}</pre>
</div>
</div>
<!--POST-STOREAREA-->
<!--POST-BODY-START-->
<!--POST-BODY-END-->
<script id="jsArea" type="text/javascript">
//<![CDATA[
//
// Please note:
//
// * This code is designed to be readable but for compactness it only includes brief comments. You can see fuller comments
//   in the project Subversion repository at http://svn.tiddlywiki.org/Trunk/core/
//
// * You should never need to modify this source code directly. TiddlyWiki is carefully designed to allow deep customisation
//   without changing the core code. Please consult the development group at http://groups.google.com/group/TiddlyWikiDev
//

//--
//-- Configuration repository
//--

// Miscellaneous options
var config = {
	numRssItems: 20, // Number of items in the RSS feed
	animDuration: 400, // Duration of UI animations in milliseconds
	cascadeFast: 20, // Speed for cascade animations (higher == slower)
	cascadeSlow: 60, // Speed for EasterEgg cascade animations
	cascadeDepth: 5, // Depth of cascade animation
	locale: "en" // W3C language tag
};

// Hashmap of alternative parsers for the wikifier
config.parsers = {};

// Adaptors
config.adaptors = {};
config.defaultAdaptor = null;

// Backstage tasks
config.tasks = {};

// Annotations
config.annotations = {};

// Custom fields to be automatically added to new tiddlers
config.defaultCustomFields = {};

// Messages
config.messages = {
	messageClose: {},
	dates: {},
	tiddlerPopup: {}
};

// Options that can be set in the options panel and/or cookies
config.options = {
	chkRegExpSearch: false,
	chkCaseSensitiveSearch: false,
	chkIncrementalSearch: true,
	chkAnimate: true,
	chkSaveBackups: true,
	chkAutoSave: false,
	chkGenerateAnRssFeed: false,
	chkSaveEmptyTemplate: false,
	chkOpenInNewWindow: true,
	chkToggleLinks: false,
	chkHttpReadOnly: true,
	chkForceMinorUpdate: false,
	chkConfirmDelete: true,
	chkInsertTabs: false,
	chkUsePreForStorage: true, // Whether to use <pre> format for storage
	chkDisplayInstrumentation: false,
	txtBackupFolder: "",
	txtEditorFocus: "text",
	txtMainTab: "tabTimeline",
	txtMoreTab: "moreTabAll",
	txtMaxEditRows: "30",
	txtFileSystemCharSet: "UTF-8",
	txtTheme: ""
	};
config.optionsDesc = {};

// Default tiddler templates
var DEFAULT_VIEW_TEMPLATE = 1;
var DEFAULT_EDIT_TEMPLATE = 2;
config.tiddlerTemplates = {
	1: "ViewTemplate",
	2: "EditTemplate"
};

// More messages (rather a legacy layout that should not really be like this)
config.views = {
	wikified: {
		tag: {}
	},
	editor: {
		tagChooser: {}
	}
};

// Backstage tasks
config.backstageTasks = ["save","sync","importTask","tweak","upgrade","plugins"];

// Extensions
config.extensions = {};

// Macros; each has a 'handler' member that is inserted later
config.macros = {
	today: {},
	version: {},
	search: {sizeTextbox: 15},
	tiddler: {},
	tag: {},
	tags: {},
	tagging: {},
	timeline: {},
	allTags: {},
	list: {
		all: {},
		missing: {},
		orphans: {},
		shadowed: {},
		touched: {},
		filter: {}
	},
	closeAll: {},
	permaview: {},
	saveChanges: {},
	slider: {},
	option: {},
	options: {},
	newTiddler: {},
	newJournal: {},
	tabs: {},
	gradient: {},
	message: {},
	view: {defaultView: "text"},
	edit: {},
	tagChooser: {},
	toolbar: {},
	plugins: {},
	refreshDisplay: {},
	importTiddlers: {},
	upgrade: {
		source: "http://www.tiddlywiki.com/upgrade/",
		backupExtension: "pre.core.upgrade"
	},
	sync: {},
	annotations: {}
};

// Commands supported by the toolbar macro
config.commands = {
	closeTiddler: {},
	closeOthers: {},
	editTiddler: {},
	saveTiddler: {hideReadOnly: true},
	cancelTiddler: {},
	deleteTiddler: {hideReadOnly: true},
	permalink: {},
	references: {type: "popup"},
	jump: {type: "popup"},
	syncing: {type: "popup"},
	fields: {type: "popup"}
};

// Browser detection... In a very few places, there's nothing else for it but to know what browser we're using.
config.userAgent = navigator.userAgent.toLowerCase();
config.browser = {
	isIE: config.userAgent.indexOf("msie") != -1 && config.userAgent.indexOf("opera") == -1,
	isGecko: navigator.product == "Gecko" && config.userAgent.indexOf("WebKit") == -1,
	ieVersion: /MSIE (\d.\d)/i.exec(config.userAgent), // config.browser.ieVersion[1], if it exists, will be the IE version string, eg "6.0"
	isSafari: config.userAgent.indexOf("applewebkit") != -1,
	isBadSafari: !((new RegExp("[\u0150\u0170]","g")).test("\u0150")),
	firefoxDate: /gecko\/(\d{8})/i.exec(config.userAgent), // config.browser.firefoxDate[1], if it exists, will be Firefox release date as "YYYYMMDD"
	isOpera: config.userAgent.indexOf("opera") != -1,
	isLinux: config.userAgent.indexOf("linux") != -1,
	isUnix: config.userAgent.indexOf("x11") != -1,
	isMac: config.userAgent.indexOf("mac") != -1,
	isWindows: config.userAgent.indexOf("win") != -1
};

// Basic regular expressions
config.textPrimitives = {
	upperLetter: "[A-Z\u00c0-\u00de\u0150\u0170]",
	lowerLetter: "[a-z0-9_\\-\u00df-\u00ff\u0151\u0171]",
	anyLetter:   "[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]",
	anyLetterStrict: "[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]"
};
if(config.browser.isBadSafari) {
	config.textPrimitives = {
		upperLetter: "[A-Z\u00c0-\u00de]",
		lowerLetter: "[a-z0-9_\\-\u00df-\u00ff]",
		anyLetter:   "[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff]",
		anyLetterStrict: "[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff]"
	};
}
config.textPrimitives.sliceSeparator = "::";
config.textPrimitives.sectionSeparator = "##";
config.textPrimitives.urlPattern = "(?:file|http|https|mailto|ftp|irc|news|data):[^\\s'\"]+(?:/|\\b)";
config.textPrimitives.unWikiLink = "~";
config.textPrimitives.wikiLink = "(?:(?:" + config.textPrimitives.upperLetter + "+" +
	config.textPrimitives.lowerLetter + "+" +
	config.textPrimitives.upperLetter +
	config.textPrimitives.anyLetter + "*)|(?:" +
	config.textPrimitives.upperLetter + "{2,}" +
	config.textPrimitives.lowerLetter + "+))";

config.textPrimitives.cssLookahead = "(?:(" + config.textPrimitives.anyLetter + "+)\\(([^\\)\\|\\n]+)(?:\\):))|(?:(" + config.textPrimitives.anyLetter + "+):([^;\\|\\n]+);)";
config.textPrimitives.cssLookaheadRegExp = new RegExp(config.textPrimitives.cssLookahead,"mg");

config.textPrimitives.brackettedLink = "\\[\\[([^\\]]+)\\]\\]";
config.textPrimitives.titledBrackettedLink = "\\[\\[([^\\[\\]\\|]+)\\|([^\\[\\]\\|]+)\\]\\]";
config.textPrimitives.tiddlerForcedLinkRegExp = new RegExp("(?:" + config.textPrimitives.titledBrackettedLink + ")|(?:" +
	config.textPrimitives.brackettedLink + ")|(?:" +
	config.textPrimitives.urlPattern + ")","mg");
config.textPrimitives.tiddlerAnyLinkRegExp = new RegExp("("+ config.textPrimitives.wikiLink + ")|(?:" +
	config.textPrimitives.titledBrackettedLink + ")|(?:" +
	config.textPrimitives.brackettedLink + ")|(?:" +
	config.textPrimitives.urlPattern + ")","mg");

config.glyphs = {
	browsers: [
		function() {return config.browser.isIE;},
		function() {return true;}
	],
	currBrowser: null,
	codes: {
		downTriangle: ["\u25BC","\u25BE"],
		downArrow: ["\u2193","\u2193"],
		bentArrowLeft: ["\u2190","\u21A9"],
		bentArrowRight: ["\u2192","\u21AA"]
	}
};

//--
//-- Shadow tiddlers
//--

config.shadowTiddlers = {
	StyleSheet: "",
	MarkupPreHead: "",
	MarkupPostHead: "",
	MarkupPreBody: "",
	MarkupPostBody: "",
	TabTimeline: '<<timeline>>',
	TabAll: '<<list all>>',
	TabTags: '<<allTags excludeLists>>',
	TabMoreMissing: '<<list missing>>',
	TabMoreOrphans: '<<list orphans>>',
	TabMoreShadowed: '<<list shadowed>>',
	AdvancedOptions: '<<options>>',
	PluginManager: '<<plugins>>',
	ToolbarCommands: '|~ViewToolbar|closeTiddler closeOthers +editTiddler > fields syncing permalink references jump|\n|~EditToolbar|+saveTiddler -cancelTiddler deleteTiddler|',
	WindowTitle: '<<tiddler SiteTitle>> - <<tiddler SiteSubtitle>>'
};

//--
//-- Translateable strings
//--

// Strings in "double quotes" should be translated; strings in 'single quotes' should be left alone

merge(config.options,{
	txtUserName: "YourName"});

merge(config.tasks,{
	save: {text: "save", tooltip: "Save your changes to this TiddlyWiki", action: saveChanges},
	sync: {text: "sync", tooltip: "Synchronise changes with other TiddlyWiki files and servers", content: '<<sync>>'},
	importTask: {text: "import", tooltip: "Import tiddlers and plugins from other TiddlyWiki files and servers", content: '<<importTiddlers>>'},
	tweak: {text: "tweak", tooltip: "Tweak the appearance and behaviour of TiddlyWiki", content: '<<options>>'},
	upgrade: {text: "upgrade", tooltip: "Upgrade TiddlyWiki core code", content: '<<upgrade>>'},
	plugins: {text: "plugins", tooltip: "Manage installed plugins", content: '<<plugins>>'}
});

// Options that can be set in the options panel and/or cookies
merge(config.optionsDesc,{
	txtUserName: "Username for signing your edits",
	chkRegExpSearch: "Enable regular expressions for searches",
	chkCaseSensitiveSearch: "Case-sensitive searching",
	chkIncrementalSearch: "Incremental key-by-key searching",
	chkAnimate: "Enable animations",
	chkSaveBackups: "Keep backup file when saving changes",
	chkAutoSave: "Automatically save changes",
	chkGenerateAnRssFeed: "Generate an RSS feed when saving changes",
	chkSaveEmptyTemplate: "Generate an empty template when saving changes",
	chkOpenInNewWindow: "Open external links in a new window",
	chkToggleLinks: "Clicking on links to open tiddlers causes them to close",
	chkHttpReadOnly: "Hide editing features when viewed over HTTP",
	chkForceMinorUpdate: "Don't update modifier username and date when editing tiddlers",
	chkConfirmDelete: "Require confirmation before deleting tiddlers",
	chkInsertTabs: "Use the tab key to insert tab characters instead of moving between fields",
	txtBackupFolder: "Name of folder to use for backups",
	txtMaxEditRows: "Maximum number of rows in edit boxes",
	txtTheme: "Name of the theme to use",
	txtFileSystemCharSet: "Default character set for saving changes (Firefox/Mozilla only)"});

merge(config.messages,{
	customConfigError: "Problems were encountered loading plugins. See PluginManager for details",
	pluginError: "Error: %0",
	pluginDisabled: "Not executed because disabled via 'systemConfigDisable' tag",
	pluginForced: "Executed because forced via 'systemConfigForce' tag",
	pluginVersionError: "Not executed because this plugin needs a newer version of TiddlyWiki",
	nothingSelected: "Nothing is selected. You must select one or more items first",
	savedSnapshotError: "It appears that this TiddlyWiki has been incorrectly saved. Please see http://www.tiddlywiki.com/#Download for details",
	subtitleUnknown: "(unknown)",
	undefinedTiddlerToolTip: "The tiddler '%0' doesn't yet exist",
	shadowedTiddlerToolTip: "The tiddler '%0' doesn't yet exist, but has a pre-defined shadow value",
	tiddlerLinkTooltip: "%0 - %1, %2",
	externalLinkTooltip: "External link to %0",
	noTags: "There are no tagged tiddlers",
	notFileUrlError: "You need to save this TiddlyWiki to a file before you can save changes",
	cantSaveError: "It's not possible to save changes. Possible reasons include:\n- your browser doesn't support saving (Firefox, Internet Explorer, Safari and Opera all work if properly configured)\n- the pathname to your TiddlyWiki file contains illegal characters\n- the TiddlyWiki HTML file has been moved or renamed",
	invalidFileError: "The original file '%0' does not appear to be a valid TiddlyWiki",
	backupSaved: "Backup saved",
	backupFailed: "Failed to save backup file",
	rssSaved: "RSS feed saved",
	rssFailed: "Failed to save RSS feed file",
	emptySaved: "Empty template saved",
	emptyFailed: "Failed to save empty template file",
	mainSaved: "Main TiddlyWiki file saved",
	mainFailed: "Failed to save main TiddlyWiki file. Your changes have not been saved",
	macroError: "Error in macro <<\%0>>",
	macroErrorDetails: "Error while executing macro <<\%0>>:\n%1",
	missingMacro: "No such macro",
	overwriteWarning: "A tiddler named '%0' already exists. Choose OK to overwrite it",
	unsavedChangesWarning: "WARNING! There are unsaved changes in TiddlyWiki\n\nChoose OK to save\nChoose CANCEL to discard",
	confirmExit: "--------------------------------\n\nThere are unsaved changes in TiddlyWiki. If you continue you will lose those changes\n\n--------------------------------",
	saveInstructions: "SaveChanges",
	unsupportedTWFormat: "Unsupported TiddlyWiki format '%0'",
	tiddlerSaveError: "Error when saving tiddler '%0'",
	tiddlerLoadError: "Error when loading tiddler '%0'",
	wrongSaveFormat: "Cannot save with storage format '%0'. Using standard format for save.",
	invalidFieldName: "Invalid field name %0",
	fieldCannotBeChanged: "Field '%0' cannot be changed",
	loadingMissingTiddler: "Attempting to retrieve the tiddler '%0' from the '%1' server at:\n\n'%2' in the workspace '%3'",
	upgradeDone: "The upgrade to version %0 is now complete\n\nClick 'OK' to reload the newly upgraded TiddlyWiki"});

merge(config.messages.messageClose,{
	text: "close",
	tooltip: "close this message area"});

config.messages.backstage = {
	open: {text: "backstage", tooltip: "Open the backstage area to perform authoring and editing tasks"},
	close: {text: "close", tooltip: "Close the backstage area"},
	prompt: "backstage: ",
	decal: {
		edit: {text: "edit", tooltip: "Edit the tiddler '%0'"}
	}
};

config.messages.listView = {
	tiddlerTooltip: "Click for the full text of this tiddler",
	previewUnavailable: "(preview not available)"
};

config.messages.dates.months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November","December"];
config.messages.dates.days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
config.messages.dates.shortMonths = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
config.messages.dates.shortDays = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
// suffixes for dates, eg "1st","2nd","3rd"..."30th","31st"
config.messages.dates.daySuffixes = ["st","nd","rd","th","th","th","th","th","th","th",
		"th","th","th","th","th","th","th","th","th","th",
		"st","nd","rd","th","th","th","th","th","th","th",
		"st"];
config.messages.dates.am = "am";
config.messages.dates.pm = "pm";

merge(config.messages.tiddlerPopup,{
	});

merge(config.views.wikified.tag,{
	labelNoTags: "no tags",
	labelTags: "tags: ",
	openTag: "Open tag '%0'",
	tooltip: "Show tiddlers tagged with '%0'",
	openAllText: "Open all",
	openAllTooltip: "Open all of these tiddlers",
	popupNone: "No other tiddlers tagged with '%0'"});

merge(config.views.wikified,{
	defaultText: "The tiddler '%0' doesn't yet exist. Double-click to create it",
	defaultModifier: "(missing)",
	shadowModifier: "(built-in shadow tiddler)",
	dateFormat: "DD MMM YYYY",
	createdPrompt: "created"});

merge(config.views.editor,{
	tagPrompt: "Type tags separated with spaces, [[use double square brackets]] if necessary, or add existing",
	defaultText: "Type the text for '%0'"});

merge(config.views.editor.tagChooser,{
	text: "tags",
	tooltip: "Choose existing tags to add to this tiddler",
	popupNone: "There are no tags defined",
	tagTooltip: "Add the tag '%0'"});

merge(config.messages,{
	sizeTemplates:
		[
		{unit: 1024*1024*1024, template: "%0\u00a0GB"},
		{unit: 1024*1024, template: "%0\u00a0MB"},
		{unit: 1024, template: "%0\u00a0KB"},
		{unit: 1, template: "%0\u00a0B"}
		]});

merge(config.macros.search,{
	label: "search",
	prompt: "Search this TiddlyWiki",
	accessKey: "F",
	successMsg: "%0 tiddlers found matching %1",
	failureMsg: "No tiddlers found matching %0"});

merge(config.macros.tagging,{
	label: "tagging: ",
	labelNotTag: "not tagging",
	tooltip: "List of tiddlers tagged with '%0'"});

merge(config.macros.timeline,{
	dateFormat: "DD MMM YYYY"});

merge(config.macros.allTags,{
	tooltip: "Show tiddlers tagged with '%0'",
	noTags: "There are no tagged tiddlers"});

config.macros.list.all.prompt = "All tiddlers in alphabetical order";
config.macros.list.missing.prompt = "Tiddlers that have links to them but are not defined";
config.macros.list.orphans.prompt = "Tiddlers that are not linked to from any other tiddlers";
config.macros.list.shadowed.prompt = "Tiddlers shadowed with default contents";
config.macros.list.touched.prompt = "Tiddlers that have been modified locally";

merge(config.macros.closeAll,{
	label: "close all",
	prompt: "Close all displayed tiddlers (except any that are being edited)"});

merge(config.macros.permaview,{
	label: "permaview",
	prompt: "Link to an URL that retrieves all the currently displayed tiddlers"});

merge(config.macros.saveChanges,{
	label: "save changes",
	prompt: "Save all tiddlers to create a new TiddlyWiki",
	accessKey: "S"});

merge(config.macros.newTiddler,{
	label: "new tiddler",
	prompt: "Create a new tiddler",
	title: "New Tiddler",
	accessKey: "N"});

merge(config.macros.newJournal,{
	label: "new journal",
	prompt: "Create a new tiddler from the current date and time",
	accessKey: "J"});

merge(config.macros.options,{
	wizardTitle: "Tweak advanced options",
	step1Title: "These options are saved in cookies in your browser",
	step1Html: "<input type='hidden' name='markList'></input><br><input type='checkbox' checked='false' name='chkUnknown'>Show unknown options</input>",
	unknownDescription: "//(unknown)//",
	listViewTemplate: {
		columns: [
			{name: 'Option', field: 'option', title: "Option", type: 'String'},
			{name: 'Description', field: 'description', title: "Description", type: 'WikiText'},
			{name: 'Name', field: 'name', title: "Name", type: 'String'}
			],
		rowClasses: [
			{className: 'lowlight', field: 'lowlight'}
			]}
	});

merge(config.macros.plugins,{
	wizardTitle: "Manage plugins",
	step1Title: "Currently loaded plugins",
	step1Html: "<input type='hidden' name='markList'></input>", // DO NOT TRANSLATE
	skippedText: "(This plugin has not been executed because it was added since startup)",
	noPluginText: "There are no plugins installed",
	confirmDeleteText: "Are you sure you want to delete these plugins:\n\n%0",
	removeLabel: "remove systemConfig tag",
	removePrompt: "Remove systemConfig tag",
	deleteLabel: "delete",
	deletePrompt: "Delete these tiddlers forever",
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Description', field: 'Description', title: "Description", type: 'String'},
			{name: 'Version', field: 'Version', title: "Version", type: 'String'},
			{name: 'Size', field: 'size', tiddlerLink: 'size', title: "Size", type: 'Size'},
			{name: 'Forced', field: 'forced', title: "Forced", tag: 'systemConfigForce', type: 'TagCheckbox'},
			{name: 'Disabled', field: 'disabled', title: "Disabled", tag: 'systemConfigDisable', type: 'TagCheckbox'},
			{name: 'Executed', field: 'executed', title: "Loaded", type: 'Boolean', trueText: "Yes", falseText: "No"},
			{name: 'Startup Time', field: 'startupTime', title: "Startup Time", type: 'String'},
			{name: 'Error', field: 'error', title: "Status", type: 'Boolean', trueText: "Error", falseText: "OK"},
			{name: 'Log', field: 'log', title: "Log", type: 'StringList'}
			],
		rowClasses: [
			{className: 'error', field: 'error'},
			{className: 'warning', field: 'warning'}
			]}
	});

merge(config.macros.toolbar,{
	moreLabel: "more",
	morePrompt: "Show additional commands",
	lessLabel: "less",
	lessPrompt: "Hide additional commands",
	separator: "|"
	});

merge(config.macros.refreshDisplay,{
	label: "refresh",
	prompt: "Redraw the entire TiddlyWiki display"
	});

merge(config.macros.importTiddlers,{
	readOnlyWarning: "You cannot import into a read-only TiddlyWiki file. Try opening it from a file:// URL",
	wizardTitle: "Import tiddlers from another file or server",
	step1Title: "Step 1: Locate the server or TiddlyWiki file",
	step1Html: "Specify the type of the server: <select name='selTypes'><option value=''>Choose...</option></select><br>Enter the URL or pathname here: <input type='text' size=50 name='txtPath'><br>...or browse for a file: <input type='file' size=50 name='txtBrowse'><br><hr>...or select a pre-defined feed: <select name='selFeeds'><option value=''>Choose...</option></select>",
	openLabel: "open",
	openPrompt: "Open the connection to this file or server",
	openError: "There were problems fetching the tiddlywiki file",
	statusOpenHost: "Opening the host",
	statusGetWorkspaceList: "Getting the list of available workspaces",
	step2Title: "Step 2: Choose the workspace",
	step2Html: "Enter a workspace name: <input type='text' size=50 name='txtWorkspace'><br>...or select a workspace: <select name='selWorkspace'><option value=''>Choose...</option></select>",
	cancelLabel: "cancel",
	cancelPrompt: "Cancel this import",
	statusOpenWorkspace: "Opening the workspace",
	statusGetTiddlerList: "Getting the list of available tiddlers",
	errorGettingTiddlerList: "Error getting list of tiddlers, click Cancel to try again",
	step3Title: "Step 3: Choose the tiddlers to import",
	step3Html: "<input type='hidden' name='markList'></input><br><input type='checkbox' checked='true' name='chkSync'>Keep these tiddlers linked to this server so that you can synchronise subsequent changes</input><br><input type='checkbox' name='chkSave'>Save the details of this server in a 'systemServer' tiddler called:</input> <input type='text' size=25 name='txtSaveTiddler'>",
	importLabel: "import",
	importPrompt: "Import these tiddlers",
	confirmOverwriteText: "Are you sure you want to overwrite these tiddlers:\n\n%0",
	step4Title: "Step 4: Importing %0 tiddler(s)",
	step4Html: "<input type='hidden' name='markReport'></input>", // DO NOT TRANSLATE
	doneLabel: "done",
	donePrompt: "Close this wizard",
	statusDoingImport: "Importing tiddlers",
	statusDoneImport: "All tiddlers imported",
	systemServerNamePattern: "%2 on %1",
	systemServerNamePatternNoWorkspace: "%1",
	confirmOverwriteSaveTiddler: "The tiddler '%0' already exists. Click 'OK' to overwrite it with the details of this server, or 'Cancel' to leave it unchanged",
	serverSaveTemplate: "|''Type:''|%0|\n|''URL:''|%1|\n|''Workspace:''|%2|\n\nThis tiddler was automatically created to record the details of this server",
	serverSaveModifier: "(System)",
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Size', field: 'size', tiddlerLink: 'size', title: "Size", type: 'Size'},
			{name: 'Tags', field: 'tags', title: "Tags", type: 'Tags'}
			],
		rowClasses: [
			]}
	});

merge(config.macros.upgrade,{
	wizardTitle: "Upgrade TiddlyWiki core code",
	step1Title: "Update or repair this TiddlyWiki to the latest release",
	step1Html: "You are about to upgrade to the latest release of the TiddlyWiki core code (from <a href='%0' class='externalLink' target='_blank'>%1</a>). Your content will be preserved across the upgrade.<br><br>Note that core upgrades have been known to interfere with older plugins. If you run into problems with the upgraded file, see <a href='http://www.tiddlywiki.org/wiki/CoreUpgrades' class='externalLink' target='_blank'>http://www.tiddlywiki.org/wiki/CoreUpgrades</a>",
	errorCantUpgrade: "Unable to upgrade this TiddlyWiki. You can only perform upgrades on TiddlyWiki files stored locally",
	errorNotSaved: "You must save changes before you can perform an upgrade",
	step2Title: "Confirm the upgrade details",
	step2Html_downgrade: "You are about to downgrade to TiddlyWiki version %0 from %1.<br><br>Downgrading to an earlier version of the core code is not recommended",
	step2Html_restore: "This TiddlyWiki appears to be already using the latest version of the core code (%0).<br><br>You can continue to upgrade anyway to ensure that the core code hasn't been corrupted or damaged",
	step2Html_upgrade: "You are about to upgrade to TiddlyWiki version %0 from %1",
	upgradeLabel: "upgrade",
	upgradePrompt: "Prepare for the upgrade process",
	statusPreparingBackup: "Preparing backup",
	statusSavingBackup: "Saving backup file",
	errorSavingBackup: "There was a problem saving the backup file",
	statusLoadingCore: "Loading core code",
	errorLoadingCore: "Error loading the core code",
	errorCoreFormat: "Error with the new core code",
	statusSavingCore: "Saving the new core code",
	statusReloadingCore: "Reloading the new core code",
	startLabel: "start",
	startPrompt: "Start the upgrade process",
	cancelLabel: "cancel",
	cancelPrompt: "Cancel the upgrade process",
	step3Title: "Upgrade cancelled",
	step3Html: "You have cancelled the upgrade process"
	});

merge(config.macros.sync,{
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Server Type', field: 'serverType', title: "Server type", type: 'String'},
			{name: 'Server Host', field: 'serverHost', title: "Server host", type: 'String'},
			{name: 'Server Workspace', field: 'serverWorkspace', title: "Server workspace", type: 'String'},
			{name: 'Status', field: 'status', title: "Synchronisation status", type: 'String'},
			{name: 'Server URL', field: 'serverUrl', title: "Server URL", text: "View", type: 'Link'}
			],
		rowClasses: [
			],
		buttons: [
			{caption: "Sync these tiddlers", name: 'sync'}
			]},
	wizardTitle: "Synchronize with external servers and files",
	step1Title: "Choose the tiddlers you want to synchronize",
	step1Html: "<input type='hidden' name='markList'></input>", // DO NOT TRANSLATE
	syncLabel: "sync",
	syncPrompt: "Sync these tiddlers",
	hasChanged: "Changed while unplugged",
	hasNotChanged: "Unchanged while unplugged",
	syncStatusList: {
		none: {text: "...", display:null, className:'notChanged'},
		changedServer: {text: "Changed on server", display:null, className:'changedServer'},
		changedLocally: {text: "Changed while unplugged", display:null, className:'changedLocally'},
		changedBoth: {text: "Changed while unplugged and on server", display:null, className:'changedBoth'},
		notFound: {text: "Not found on server", display:null, className:'notFound'},
		putToServer: {text: "Saved update on server", display:null, className:'putToServer'},
		gotFromServer: {text: "Retrieved update from server", display:null, className:'gotFromServer'}
		}
	});

merge(config.macros.annotations,{
	});

merge(config.commands.closeTiddler,{
	text: "close",
	tooltip: "Close this tiddler"});

merge(config.commands.closeOthers,{
	text: "close others",
	tooltip: "Close all other tiddlers"});

merge(config.commands.editTiddler,{
	text: "edit",
	tooltip: "Edit this tiddler",
	readOnlyText: "view",
	readOnlyTooltip: "View the source of this tiddler"});

merge(config.commands.saveTiddler,{
	text: "done",
	tooltip: "Save changes to this tiddler"});

merge(config.commands.cancelTiddler,{
	text: "cancel",
	tooltip: "Undo changes to this tiddler",
	warning: "Are you sure you want to abandon your changes to '%0'?",
	readOnlyText: "done",
	readOnlyTooltip: "View this tiddler normally"});

merge(config.commands.deleteTiddler,{
	text: "delete",
	tooltip: "Delete this tiddler",
	warning: "Are you sure you want to delete '%0'?"});

merge(config.commands.permalink,{
	text: "permalink",
	tooltip: "Permalink for this tiddler"});

merge(config.commands.references,{
	text: "references",
	tooltip: "Show tiddlers that link to this one",
	popupNone: "No references"});

merge(config.commands.jump,{
	text: "jump",
	tooltip: "Jump to another open tiddler"});

merge(config.commands.syncing,{
	text: "syncing",
	tooltip: "Control synchronisation of this tiddler with a server or external file",
	currentlySyncing: "<div>Currently syncing via <span class='popupHighlight'>'%0'</span> to:</"+"div><div>host: <span class='popupHighlight'>%1</span></"+"div><div>workspace: <span class='popupHighlight'>%2</span></"+"div>", // Note escaping of closing <div> tag
	notCurrentlySyncing: "Not currently syncing",
	captionUnSync: "Stop synchronising this tiddler",
	chooseServer: "Synchronise this tiddler with another server:",
	currServerMarker: "\u25cf ",
	notCurrServerMarker: "  "});

merge(config.commands.fields,{
	text: "fields",
	tooltip: "Show the extended fields of this tiddler",
	emptyText: "There are no extended fields for this tiddler",
	listViewTemplate: {
		columns: [
			{name: 'Field', field: 'field', title: "Field", type: 'String'},
			{name: 'Value', field: 'value', title: "Value", type: 'String'}
			],
		rowClasses: [
			],
		buttons: [
			]}});

merge(config.shadowTiddlers,{
	DefaultTiddlers: "[[GettingStarted]]",
	MainMenu: "[[GettingStarted]]",
	SiteTitle: "My TiddlyWiki",
	SiteSubtitle: "a reusable non-linear personal web notebook",
	SiteUrl: "",
	SideBarOptions: '<<search>><<closeAll>><<permaview>><<newTiddler>><<newJournal "DD MMM YYYY" "journal">><<saveChanges>><<slider chkSliderOptionsPanel OptionsPanel "options \u00bb" "Change TiddlyWiki advanced options">>',
	SideBarTabs: '<<tabs txtMainTab "Timeline" "Timeline" TabTimeline "All" "All tiddlers" TabAll "Tags" "All tags" TabTags "More" "More lists" TabMore>>',
	TabMore: '<<tabs txtMoreTab "Missing" "Missing tiddlers" TabMoreMissing "Orphans" "Orphaned tiddlers" TabMoreOrphans "Shadowed" "Shadowed tiddlers" TabMoreShadowed>>'
	});

merge(config.annotations,{
	AdvancedOptions: "This shadow tiddler provides access to several advanced options",
	ColorPalette: "These values in this shadow tiddler determine the colour scheme of the ~TiddlyWiki user interface",
	DefaultTiddlers: "The tiddlers listed in this shadow tiddler will be automatically displayed when ~TiddlyWiki starts up",
	EditTemplate: "The HTML template in this shadow tiddler determines how tiddlers look while they are being edited",
	GettingStarted: "This shadow tiddler provides basic usage instructions",
	ImportTiddlers: "This shadow tiddler provides access to importing tiddlers",
	MainMenu: "This shadow tiddler is used as the contents of the main menu in the left-hand column of the screen",
	MarkupPreHead: "This tiddler is inserted at the top of the <head> section of the TiddlyWiki HTML file",
	MarkupPostHead: "This tiddler is inserted at the bottom of the <head> section of the TiddlyWiki HTML file",
	MarkupPreBody: "This tiddler is inserted at the top of the <body> section of the TiddlyWiki HTML file",
	MarkupPostBody: "This tiddler is inserted at the end of the <body> section of the TiddlyWiki HTML file immediately after the script block",
	OptionsPanel: "This shadow tiddler is used as the contents of the options panel slider in the right-hand sidebar",
	PageTemplate: "The HTML template in this shadow tiddler determines the overall ~TiddlyWiki layout",
	PluginManager: "This shadow tiddler provides access to the plugin manager",
	SideBarOptions: "This shadow tiddler is used as the contents of the option panel in the right-hand sidebar",
	SideBarTabs: "This shadow tiddler is used as the contents of the tabs panel in the right-hand sidebar",
	SiteSubtitle: "This shadow tiddler is used as the second part of the page title",
	SiteTitle: "This shadow tiddler is used as the first part of the page title",
	SiteUrl: "This shadow tiddler should be set to the full target URL for publication",
	StyleSheetColors: "This shadow tiddler contains CSS definitions related to the color of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler",
	StyleSheet: "This tiddler can contain custom CSS definitions",
	StyleSheetLayout: "This shadow tiddler contains CSS definitions related to the layout of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler",
	StyleSheetLocale: "This shadow tiddler contains CSS definitions related to the translation locale",
	StyleSheetPrint: "This shadow tiddler contains CSS definitions for printing",
	TabAll: "This shadow tiddler contains the contents of the 'All' tab in the right-hand sidebar",
	TabMore: "This shadow tiddler contains the contents of the 'More' tab in the right-hand sidebar",
	TabMoreMissing: "This shadow tiddler contains the contents of the 'Missing' tab in the right-hand sidebar",
	TabMoreOrphans: "This shadow tiddler contains the contents of the 'Orphans' tab in the right-hand sidebar",
	TabMoreShadowed: "This shadow tiddler contains the contents of the 'Shadowed' tab in the right-hand sidebar",
	TabTags: "This shadow tiddler contains the contents of the 'Tags' tab in the right-hand sidebar",
	TabTimeline: "This shadow tiddler contains the contents of the 'Timeline' tab in the right-hand sidebar",
	ToolbarCommands: "This shadow tiddler determines which commands are shown in tiddler toolbars",
	ViewTemplate: "The HTML template in this shadow tiddler determines how tiddlers look"
	});

//--
//-- Main
//--

var params = null; // Command line parameters
var store = null; // TiddlyWiki storage
var story = null; // Main story
var formatter = null; // Default formatters for the wikifier
var anim = typeof Animator == "function" ? new Animator() : null; // Animation engine
var readOnly = false; // Whether we're in readonly mode
var highlightHack = null; // Embarrassing hack department...
var hadConfirmExit = false; // Don't warn more than once
var safeMode = false; // Disable all plugins and cookies
var showBackstage; // Whether to include the backstage area
var installedPlugins = []; // Information filled in when plugins are executed
var startingUp = false; // Whether we're in the process of starting up
var pluginInfo,tiddler; // Used to pass information to plugins in loadPlugins()

// Whether to use the JavaSaver applet
var useJavaSaver = (config.browser.isSafari || config.browser.isOpera) && (document.location.toString().substr(0,4) != "http");

// Starting up
function main()
{
	var t10,t9,t8,t7,t6,t5,t4,t3,t2,t1,t0 = new Date();
	startingUp = true;
	jQuery.noConflict();
	window.onbeforeunload = function(e) {if(window.confirmExit) return confirmExit();};
	params = getParameters();
	if(params)
		params = params.parseParams("open",null,false);
	store = new TiddlyWiki();
	invokeParamifier(params,"oninit");
	story = new Story("tiddlerDisplay","tiddler");
	addEvent(document,"click",Popup.onDocumentClick);
	saveTest();
	loadOptionsCookie();
	for(var s=0; s<config.notifyTiddlers.length; s++)
		store.addNotification(config.notifyTiddlers[s].name,config.notifyTiddlers[s].notify);
	t1 = new Date();
	loadShadowTiddlers();
	jQuery().trigger("loadShadows");
	t2 = new Date();
	store.loadFromDiv("storeArea","store",true);
	jQuery().trigger("loadTiddlers");
	t3 = new Date();
	invokeParamifier(params,"onload");
	t4 = new Date();
	readOnly = (window.location.protocol == "file:") ? false : config.options.chkHttpReadOnly;
	var pluginProblem = loadPlugins();
	jQuery().trigger("loadPlugins");
	t5 = new Date();
	formatter = new Formatter(config.formatters);
	invokeParamifier(params,"onconfig");
	story.switchTheme(config.options.txtTheme);
	showBackstage = !readOnly;
	t6 = new Date();
	for(var m in config.macros) {
		if(config.macros[m].init)
			config.macros[m].init();
	}
	t7 = new Date();
	store.notifyAll();
	t8 = new Date();
	restart();
	refreshDisplay();
	t9 = new Date();
	if(pluginProblem) {
		story.displayTiddler(null,"PluginManager");
		displayMessage(config.messages.customConfigError);
	}
	if(showBackstage)
		backstage.init();
	t10 = new Date();
	if(config.options.chkDisplayInstrumentation) {
		displayMessage("LoadShadows " + (t2-t1) + " ms");
		displayMessage("LoadFromDiv " + (t3-t2) + " ms");
		displayMessage("LoadPlugins " + (t5-t4) + " ms");
		displayMessage("Macro init " + (t7-t6) + " ms");
		displayMessage("Notify " + (t8-t7) + " ms");
		displayMessage("Restart " + (t9-t8) + " ms");
		displayMessage("Total: " + (t10-t0) + " ms");
	}
	startingUp = false;
	jQuery().trigger("startup");
}

// Called on unload. All functions called conditionally since they themselves may have been unloaded.
function unload()
{
	if(window.checkUnsavedChanges)
		checkUnsavedChanges();
	if(window.scrubNodes)
		scrubNodes(document.body);
}

// Restarting
function restart()
{
	invokeParamifier(params,"onstart");
	if(story.isEmpty()) {
		story.displayDefaultTiddlers();
	}
	window.scrollTo(0,0);
}

function saveTest()
{
	var s = document.getElementById("saveTest");
	if(s.hasChildNodes())
		alert(config.messages.savedSnapshotError);
	s.appendChild(document.createTextNode("savetest"));
}

function loadShadowTiddlers()
{
	var shadows = new TiddlyWiki();
	shadows.loadFromDiv("shadowArea","shadows",true);
	shadows.forEachTiddler(function(title,tiddler){config.shadowTiddlers[title] = tiddler.text;});
	delete shadows;
}

function loadPlugins()
{
	if(safeMode)
		return false;
	var tiddlers = store.getTaggedTiddlers("systemConfig");
	var toLoad = [];
	var nLoaded = 0;
	var map = {};
	var nPlugins = tiddlers.length;
	installedPlugins = [];
	for(var i=0; i<nPlugins; i++) {
		var p = getPluginInfo(tiddlers[i]);
		installedPlugins[i] = p;
		var n = p.Name;
		if(n)
			map[n] = p;
		n = p.Source;
		if(n)
			map[n] = p;
	}
	var visit = function(p) {
		if(!p || p.done)
			return;
		p.done = 1;
		var reqs = p.Requires;
		if(reqs) {
			reqs = reqs.readBracketedList();
			for(var i=0; i<reqs.length; i++)
				visit(map[reqs[i]]);
		}
		toLoad.push(p);
	};
	for(i=0; i<nPlugins; i++)
		visit(installedPlugins[i]);
	for(i=0; i<toLoad.length; i++) {
		p = toLoad[i];
		pluginInfo = p;
		tiddler = p.tiddler;
		if(isPluginExecutable(p)) {
			if(isPluginEnabled(p)) {
				p.executed = true;
				var startTime = new Date();
				try {
					if(tiddler.text)
						window.eval(tiddler.text);
					nLoaded++;
				} catch(ex) {
					p.log.push(config.messages.pluginError.format([exceptionText(ex)]));
					p.error = true;
				}
				pluginInfo.startupTime = String((new Date()) - startTime) + "ms";
			} else {
				nPlugins--;
			}
		} else {
			p.warning = true;
		}
	}
	return nLoaded != nPlugins;
}

function getPluginInfo(tiddler)
{
	var p = store.getTiddlerSlices(tiddler.title,["Name","Description","Version","Requires","CoreVersion","Date","Source","Author","License","Browsers"]);
	p.tiddler = tiddler;
	p.title = tiddler.title;
	p.log = [];
	return p;
}

// Check that a particular plugin is valid for execution
function isPluginExecutable(plugin)
{
	if(plugin.tiddler.isTagged("systemConfigForce")) {
		plugin.log.push(config.messages.pluginForced);
		return true;
	}
	if(plugin["CoreVersion"]) {
		var coreVersion = plugin["CoreVersion"].split(".");
		var w = parseInt(coreVersion[0],10) - version.major;
		if(w == 0 && coreVersion[1])
			w = parseInt(coreVersion[1],10) - version.minor;
		if(w == 0 && coreVersion[2])
			w = parseInt(coreVersion[2],10) - version.revision;
		if(w > 0) {
			plugin.log.push(config.messages.pluginVersionError);
			return false;
		}
	}
	return true;
}

function isPluginEnabled(plugin)
{
	if(plugin.tiddler.isTagged("systemConfigDisable")) {
		plugin.log.push(config.messages.pluginDisabled);
		return false;
	}
	return true;
}

function invokeMacro(place,macro,params,wikifier,tiddler)
{
	try {
		var m = config.macros[macro];
		if(m && m.handler) {
			var tiddlerElem = story.findContainingTiddler(place);
			window.tiddler = tiddlerElem ? store.getTiddler(tiddlerElem.getAttribute("tiddler")) : null;
			window.place = place;
			m.handler(place,macro,m.noPreParse?null:params.readMacroParams(),wikifier,params,tiddler);
		} else {
			createTiddlyError(place,config.messages.macroError.format([macro]),config.messages.macroErrorDetails.format([macro,config.messages.missingMacro]));
		}
	} catch(ex) {
		createTiddlyError(place,config.messages.macroError.format([macro]),config.messages.macroErrorDetails.format([macro,ex.toString()]));
	}
}

//--
//-- Paramifiers
//--

function getParameters()
{
	var p = null;
	if(window.location.hash) {
		p = decodeURIComponent(window.location.hash.substr(1));
		if(config.browser.firefoxDate != null && config.browser.firefoxDate[1] < "20051111")
			p = convertUTF8ToUnicode(p);
	}
	return p;
}

function invokeParamifier(params,handler)
{
	if(!params || params.length == undefined || params.length <= 1)
		return;
	for(var i=1; i<params.length; i++) {
		var p = config.paramifiers[params[i].name];
		if(p && p[handler] instanceof Function)
			p[handler](params[i].value);
		else {
			var h = config.optionHandlers[params[i].name.substr(0,3)];
			if(h && h.set instanceof Function)
				h.set(params[i].name,params[i].value);
		}
	}
}

config.paramifiers = {};

config.paramifiers.start = {
	oninit: function(v) {
		safeMode = v.toLowerCase() == "safe";
	}
};

config.paramifiers.open = {
	onstart: function(v) {
		if(!readOnly || store.tiddlerExists(v) || store.isShadowTiddler(v))
			story.displayTiddler("bottom",v,null,false,null);
	}
};

config.paramifiers.story = {
	onstart: function(v) {
		var list = store.getTiddlerText(v,"").parseParams("open",null,false);
		invokeParamifier(list,"onstart");
	}
};

config.paramifiers.search = {
	onstart: function(v) {
		story.search(v,false,false);
	}
};

config.paramifiers.searchRegExp = {
	onstart: function(v) {
		story.prototype.search(v,false,true);
	}
};

config.paramifiers.tag = {
	onstart: function(v) {
		story.displayTiddlers(null,store.filterTiddlers("[tag["+v+"]]"),null,false,null);
	}
};

config.paramifiers.newTiddler = {
	onstart: function(v) {
		if(!readOnly) {
			story.displayTiddler(null,v,DEFAULT_EDIT_TEMPLATE);
			story.focusTiddler(v,"text");
		}
	}
};

config.paramifiers.newJournal = {
	onstart: function(v) {
		if(!readOnly) {
			var now = new Date();
			var title = now.formatString(v.trim());
			story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE);
			story.focusTiddler(title,"text");
		}
	}
};

config.paramifiers.readOnly = {
	onconfig: function(v) {
		var p = v.toLowerCase();
		readOnly = p == "yes" ? true : (p == "no" ? false : readOnly);
	}
};

config.paramifiers.theme = {
	onconfig: function(v) {
		story.switchTheme(v);
	}
};

config.paramifiers.upgrade = {
	onstart: function(v) {
		upgradeFrom(v);
	}
};

config.paramifiers.recent= {
	onstart: function(v) {
		var titles=[];
		var tiddlers=store.getTiddlers("modified","excludeLists").reverse();
		for(var i=0; i<v && i<tiddlers.length; i++)
			titles.push(tiddlers[i].title);
		story.displayTiddlers(null,titles);
	}
};

config.paramifiers.filter = {
	onstart: function(v) {
		story.displayTiddlers(null,store.filterTiddlers(v),null,false);
	}
};

//--
//-- Formatter helpers
//--

function Formatter(formatters)
{
	this.formatters = [];
	var pattern = [];
	for(var n=0; n<formatters.length; n++) {
		pattern.push("(" + formatters[n].match + ")");
		this.formatters.push(formatters[n]);
	}
	this.formatterRegExp = new RegExp(pattern.join("|"),"mg");
}

config.formatterHelpers = {

	createElementAndWikify: function(w)
	{
		w.subWikifyTerm(createTiddlyElement(w.output,this.element),this.termRegExp);
	},

	inlineCssHelper: function(w)
	{
		var styles = [];
		config.textPrimitives.cssLookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = config.textPrimitives.cssLookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			var s,v;
			if(lookaheadMatch[1]) {
				s = lookaheadMatch[1].unDash();
				v = lookaheadMatch[2];
			} else {
				s = lookaheadMatch[3].unDash();
				v = lookaheadMatch[4];
			}
			if(s=="bgcolor")
				s = "backgroundColor";
			styles.push({style: s, value: v});
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			config.textPrimitives.cssLookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = config.textPrimitives.cssLookaheadRegExp.exec(w.source);
		}
		return styles;
	},

	applyCssHelper: function(e,styles)
	{
		for(var t=0; t< styles.length; t++) {
			try {
				e.style[styles[t].style] = styles[t].value;
			} catch (ex) {
			}
		}
	},

	enclosedTextHelper: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var text = lookaheadMatch[1];
			if(config.browser.isIE)
				text = text.replace(/\n/g,"\r");
			createTiddlyElement(w.output,this.element,null,null,text);
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
		}
	},

	isExternalLink: function(link)
	{
		if(store.tiddlerExists(link) || store.isShadowTiddler(link)) {
			return false;
		}
		var urlRegExp = new RegExp(config.textPrimitives.urlPattern,"mg");
		if(urlRegExp.exec(link)) {
			return true;
		}
		if(link.indexOf(".")!=-1 || link.indexOf("\\")!=-1 || link.indexOf("/")!=-1 || link.indexOf("#")!=-1) {
			return true;
		}
		return false;
	}

};

//--
//-- Standard formatters
//--

config.formatters = [
{
	name: "table",
	match: "^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",
	lookaheadRegExp: /^\|([^\n]*)\|([fhck]?)$/mg,
	rowTermRegExp: /(\|(?:[fhck]?)$\n?)/mg,
	cellRegExp: /(?:\|([^\n\|]*)\|)|(\|[fhck]?$\n?)/mg,
	cellTermRegExp: /((?:\x20*)\|)/mg,
	rowTypes: {"c":"caption", "h":"thead", "":"tbody", "f":"tfoot"},
	handler: function(w)
	{
		var table = createTiddlyElement(w.output,"table",null,"twtable");
		var prevColumns = [];
		var currRowType = null;
		var rowContainer;
		var rowCount = 0;
		w.nextMatch = w.matchStart;
		this.lookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			var nextRowType = lookaheadMatch[2];
			if(nextRowType == "k") {
				table.className = lookaheadMatch[1];
				w.nextMatch += lookaheadMatch[0].length+1;
			} else {
				if(nextRowType != currRowType) {
					rowContainer = createTiddlyElement(table,this.rowTypes[nextRowType]);
					currRowType = nextRowType;
				}
				if(currRowType == "c") {
					// Caption
					w.nextMatch++;
					if(rowContainer != table.firstChild)
						table.insertBefore(rowContainer,table.firstChild);
					rowContainer.setAttribute("align",rowCount == 0?"top":"bottom");
					w.subWikifyTerm(rowContainer,this.rowTermRegExp);
				} else {
					var theRow = createTiddlyElement(rowContainer,"tr",null,(rowCount&1)?"oddRow":"evenRow");
					theRow.onmouseover = function() {addClass(this,"hoverRow");};
					theRow.onmouseout = function() {removeClass(this,"hoverRow");};
					this.rowHandler(w,theRow,prevColumns);
					rowCount++;
				}
			}
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		}
	},
	rowHandler: function(w,e,prevColumns)
	{
		var col = 0;
		var colSpanCount = 1;
		var prevCell = null;
		this.cellRegExp.lastIndex = w.nextMatch;
		var cellMatch = this.cellRegExp.exec(w.source);
		while(cellMatch && cellMatch.index == w.nextMatch) {
			if(cellMatch[1] == "~") {
				// Rowspan
				var last = prevColumns[col];
				if(last) {
					last.rowSpanCount++;
					last.element.setAttribute("rowspan",last.rowSpanCount);
					last.element.setAttribute("rowSpan",last.rowSpanCount); // Needed for IE
					last.element.valign = "center";
					if(colSpanCount > 1) {
						last.element.setAttribute("colspan",colSpanCount);
						last.element.setAttribute("colSpan",colSpanCount); // Needed for IE
						colSpanCount = 1;
					}
				}
				w.nextMatch = this.cellRegExp.lastIndex-1;
			} else if(cellMatch[1] == ">") {
				// Colspan
				colSpanCount++;
				w.nextMatch = this.cellRegExp.lastIndex-1;
			} else if(cellMatch[2]) {
				// End of row
				if(prevCell && colSpanCount > 1) {
					prevCell.setAttribute("colspan",colSpanCount);
					prevCell.setAttribute("colSpan",colSpanCount); // Needed for IE
				}
				w.nextMatch = this.cellRegExp.lastIndex;
				break;
			} else {
				// Cell
				w.nextMatch++;
				var styles = config.formatterHelpers.inlineCssHelper(w);
				var spaceLeft = false;
				var chr = w.source.substr(w.nextMatch,1);
				while(chr == " ") {
					spaceLeft = true;
					w.nextMatch++;
					chr = w.source.substr(w.nextMatch,1);
				}
				var cell;
				if(chr == "!") {
					cell = createTiddlyElement(e,"th");
					w.nextMatch++;
				} else {
					cell = createTiddlyElement(e,"td");
				}
				prevCell = cell;
				prevColumns[col] = {rowSpanCount:1,element:cell};
				if(colSpanCount > 1) {
					cell.setAttribute("colspan",colSpanCount);
					cell.setAttribute("colSpan",colSpanCount); // Needed for IE
					colSpanCount = 1;
				}
				config.formatterHelpers.applyCssHelper(cell,styles);
				w.subWikifyTerm(cell,this.cellTermRegExp);
				if(w.matchText.substr(w.matchText.length-2,1) == " ") // spaceRight
					cell.align = spaceLeft ? "center" : "left";
				else if(spaceLeft)
					cell.align = "right";
				w.nextMatch--;
			}
			col++;
			this.cellRegExp.lastIndex = w.nextMatch;
			cellMatch = this.cellRegExp.exec(w.source);
		}
	}
},

{
	name: "heading",
	match: "^!{1,6}",
	termRegExp: /(\n)/mg,
	handler: function(w)
	{
		w.subWikifyTerm(createTiddlyElement(w.output,"h" + w.matchLength),this.termRegExp);
	}
},

{
	name: "list",
	match: "^(?:[\\*#;:]+)",
	lookaheadRegExp: /^(?:(?:(\*)|(#)|(;)|(:))+)/mg,
	termRegExp: /(\n)/mg,
	handler: function(w)
	{
		var stack = [w.output];
		var currLevel = 0, currType = null;
		var listLevel, listType, itemType, baseType;
		w.nextMatch = w.matchStart;
		this.lookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			if(lookaheadMatch[1]) {
				listType = "ul";
				itemType = "li";
			} else if(lookaheadMatch[2]) {
				listType = "ol";
				itemType = "li";
			} else if(lookaheadMatch[3]) {
				listType = "dl";
				itemType = "dt";
			} else if(lookaheadMatch[4]) {
				listType = "dl";
				itemType = "dd";
			}
			if(!baseType)
				baseType = listType;
			listLevel = lookaheadMatch[0].length;
			w.nextMatch += lookaheadMatch[0].length;
			var t;
			if(listLevel > currLevel) {
				for(t=currLevel; t<listLevel; t++) {
					var target = (currLevel == 0) ? stack[stack.length-1] : stack[stack.length-1].lastChild;
					stack.push(createTiddlyElement(target,listType));
				}
			} else if(listType!=baseType && listLevel==1) {
				w.nextMatch -= lookaheadMatch[0].length;
				return;
			} else if(listLevel < currLevel) {
				for(t=currLevel; t>listLevel; t--)
					stack.pop();
			} else if(listLevel == currLevel && listType != currType) {
				stack.pop();
				stack.push(createTiddlyElement(stack[stack.length-1].lastChild,listType));
			}
			currLevel = listLevel;
			currType = listType;
			var e = createTiddlyElement(stack[stack.length-1],itemType);
			w.subWikifyTerm(e,this.termRegExp);
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		}
	}
},

{
	name: "quoteByBlock",
	match: "^<<<\\n",
	termRegExp: /(^<<<(\n|$))/mg,
	element: "blockquote",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "quoteByLine",
	match: "^>+",
	lookaheadRegExp: /^>+/mg,
	termRegExp: /(\n)/mg,
	element: "blockquote",
	handler: function(w)
	{
		var stack = [w.output];
		var currLevel = 0;
		var newLevel = w.matchLength;
		var t;
		do {
			if(newLevel > currLevel) {
				for(t=currLevel; t<newLevel; t++)
					stack.push(createTiddlyElement(stack[stack.length-1],this.element));
			} else if(newLevel < currLevel) {
				for(t=currLevel; t>newLevel; t--)
					stack.pop();
			}
			currLevel = newLevel;
			w.subWikifyTerm(stack[stack.length-1],this.termRegExp);
			createTiddlyElement(stack[stack.length-1],"br");
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
			var matched = lookaheadMatch && lookaheadMatch.index == w.nextMatch;
			if(matched) {
				newLevel = lookaheadMatch[0].length;
				w.nextMatch += lookaheadMatch[0].length;
			}
		} while(matched);
	}
},

{
	name: "rule",
	match: "^----+$\\n?|<hr ?/?>\\n?",
	handler: function(w)
	{
		createTiddlyElement(w.output,"hr");
	}
},

{
	name: "monospacedByLine",
	match: "^(?:/\\*\\{\\{\\{\\*/|\\{\\{\\{|//\\{\\{\\{|<!--\\{\\{\\{-->)\\n",
	element: "pre",
	handler: function(w)
	{
		switch(w.matchText) {
		case "/*{{{*/\n": // CSS
			this.lookaheadRegExp = /\/\*\{\{\{\*\/\n*((?:^[^\n]*\n)+?)(\n*^\f*\/\*\}\}\}\*\/$\n?)/mg;
			break;
		case "{{{\n": // monospaced block
			this.lookaheadRegExp = /^\{\{\{\n((?:^[^\n]*\n)+?)(^\f*\}\}\}$\n?)/mg;
			break;
		case "//{{{\n": // plugin
			this.lookaheadRegExp = /^\/\/\{\{\{\n\n*((?:^[^\n]*\n)+?)(\n*^\f*\/\/\}\}\}$\n?)/mg;
			break;
		case "<!--{{{-->\n": //template
			this.lookaheadRegExp = /<!--\{\{\{-->\n*((?:^[^\n]*\n)+?)(\n*^\f*<!--\}\}\}-->$\n?)/mg;
			break;
		default:
			break;
		}
		config.formatterHelpers.enclosedTextHelper.call(this,w);
	}
},

{
	name: "wikifyComment",
	match: "^(?:/\\*\\*\\*|<!---)\\n",
	handler: function(w)
	{
		var termRegExp = (w.matchText == "/***\n") ? (/(^\*\*\*\/\n)/mg) : (/(^--->\n)/mg);
		w.subWikifyTerm(w.output,termRegExp);
	}
},

{
	name: "macro",
	match: "<<",
	lookaheadRegExp: /<<([^>\s]+)(?:\s*)((?:[^>]|(?:>(?!>)))*)>>/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart && lookaheadMatch[1]) {
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			invokeMacro(w.output,lookaheadMatch[1],lookaheadMatch[2],w,w.tiddler);
		}
	}
},

{
	name: "prettyLink",
	match: "\\[\\[",
	lookaheadRegExp: /\[\[(.*?)(?:\|(~)?(.*?))?\]\]/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var e;
			var text = lookaheadMatch[1];
			if(lookaheadMatch[3]) {
				// Pretty bracketted link
				var link = lookaheadMatch[3];
				e = (!lookaheadMatch[2] && config.formatterHelpers.isExternalLink(link)) ?
						createExternalLink(w.output,link) : createTiddlyLink(w.output,decodeURIComponent(link),false,null,w.isStatic,w.tiddler);
			} else {
				// Simple bracketted link
				e = createTiddlyLink(w.output,decodeURIComponent(text),false,null,w.isStatic,w.tiddler);
			}
			createTiddlyText(e,text);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "wikiLink",
	match: config.textPrimitives.unWikiLink+"?"+config.textPrimitives.wikiLink,
	handler: function(w)
	{
		if(w.matchText.substr(0,1) == config.textPrimitives.unWikiLink) {
			w.outputText(w.output,w.matchStart+1,w.nextMatch);
			return;
		}
		if(w.matchStart > 0) {
			var preRegExp = new RegExp(config.textPrimitives.anyLetterStrict,"mg");
			preRegExp.lastIndex = w.matchStart-1;
			var preMatch = preRegExp.exec(w.source);
			if(preMatch.index == w.matchStart-1) {
				w.outputText(w.output,w.matchStart,w.nextMatch);
				return;
			}
		}
		if(w.autoLinkWikiWords || store.isShadowTiddler(w.matchText)) {
			var link = createTiddlyLink(w.output,w.matchText,false,null,w.isStatic,w.tiddler);
			w.outputText(link,w.matchStart,w.nextMatch);
		} else {
			w.outputText(w.output,w.matchStart,w.nextMatch);
		}
	}
},

{
	name: "urlLink",
	match: config.textPrimitives.urlPattern,
	handler: function(w)
	{
		w.outputText(createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch);
	}
},

{
	name: "image",
	match: "\\[[<>]?[Ii][Mm][Gg]\\[",
	lookaheadRegExp: /\[([<]?)(>?)[Ii][Mm][Gg]\[(?:([^\|\]]+)\|)?([^\[\]\|]+)\](?:\[([^\]]*)\])?\]/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var e = w.output;
			if(lookaheadMatch[5]) {
				var link = lookaheadMatch[5];
				e = config.formatterHelpers.isExternalLink(link) ? createExternalLink(w.output,link) : createTiddlyLink(w.output,link,false,null,w.isStatic,w.tiddler);
				addClass(e,"imageLink");
			}
			var img = createTiddlyElement(e,"img");
			if(lookaheadMatch[1])
				img.align = "left";
			else if(lookaheadMatch[2])
				img.align = "right";
			if(lookaheadMatch[3]) {
				img.title = lookaheadMatch[3];
				img.setAttribute("alt",lookaheadMatch[3]);
			}
			img.src = lookaheadMatch[4];
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "html",
	match: "<[Hh][Tt][Mm][Ll]>",
	lookaheadRegExp: /<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			createTiddlyElement(w.output,"span").innerHTML = lookaheadMatch[1];
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "commentByBlock",
	match: "/%",
	lookaheadRegExp: /\/%((?:.|\n)*?)%\//mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			w.nextMatch = this.lookaheadRegExp.lastIndex;
	}
},

{
	name: "characterFormat",
	match: "''|//|__|\\^\\^|~~|--(?!\\s|$)|\\{\\{\\{",
	handler: function(w)
	{
		switch(w.matchText) {
		case "''":
			w.subWikifyTerm(w.output.appendChild(document.createElement("strong")),/('')/mg);
			break;
		case "//":
			w.subWikifyTerm(createTiddlyElement(w.output,"em"),/(\/\/)/mg);
			break;
		case "__":
			w.subWikifyTerm(createTiddlyElement(w.output,"u"),/(__)/mg);
			break;
		case "^^":
			w.subWikifyTerm(createTiddlyElement(w.output,"sup"),/(\^\^)/mg);
			break;
		case "~~":
			w.subWikifyTerm(createTiddlyElement(w.output,"sub"),/(~~)/mg);
			break;
		case "--":
			w.subWikifyTerm(createTiddlyElement(w.output,"strike"),/(--)/mg);
			break;
		case "{{{":
			var lookaheadRegExp = /\{\{\{((?:.|\n)*?)\}\}\}/mg;
			lookaheadRegExp.lastIndex = w.matchStart;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
				createTiddlyElement(w.output,"code",null,null,lookaheadMatch[1]);
				w.nextMatch = lookaheadRegExp.lastIndex;
			}
			break;
		}
	}
},

{
	name: "customFormat",
	match: "@@|\\{\\{",
	handler: function(w)
	{
		switch(w.matchText) {
		case "@@":
			var e = createTiddlyElement(w.output,"span");
			var styles = config.formatterHelpers.inlineCssHelper(w);
			if(styles.length == 0)
				e.className = "marked";
			else
				config.formatterHelpers.applyCssHelper(e,styles);
			w.subWikifyTerm(e,/(@@)/mg);
			break;
		case "{{":
			var lookaheadRegExp = /\{\{[\s]*([\w]+[\s\w]*)[\s]*\{(\n?)/mg;
			lookaheadRegExp.lastIndex = w.matchStart;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			if(lookaheadMatch) {
				w.nextMatch = lookaheadRegExp.lastIndex;
				e = createTiddlyElement(w.output,lookaheadMatch[2] == "\n" ? "div" : "span",null,lookaheadMatch[1]);
				w.subWikifyTerm(e,/(\}\}\})/mg);
			}
			break;
		}
	}
},

{
	name: "mdash",
	match: "--",
	handler: function(w)
	{
		createTiddlyElement(w.output,"span").innerHTML = "&mdash;";
	}
},

{
	name: "lineBreak",
	match: "\\n|<br ?/?>",
	handler: function(w)
	{
		createTiddlyElement(w.output,"br");
	}
},

{
	name: "rawText",
	match: "\"{3}|<nowiki>",
	lookaheadRegExp: /(?:\"{3}|<nowiki>)((?:.|\n)*?)(?:\"{3}|<\/nowiki>)/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			createTiddlyElement(w.output,"span",null,null,lookaheadMatch[1]);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "htmlEntitiesEncoding",
	match: "(?:(?:&#?[a-zA-Z0-9]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9a-fA-F]|1D[c-fC-F][0-9a-fA-F]|20[d-fD-F][0-9a-fA-F]|FE2[0-9a-fA-F])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[a-zA-Z0-9]{2,8};)",
	handler: function(w)
	{
		createTiddlyElement(w.output,"span").innerHTML = w.matchText;
	}
}

];

//--
//-- Wikifier
//--

function getParser(tiddler,format)
{
	if(tiddler) {
		if(!format)
			format = tiddler.fields["wikiformat"];
		var i;
		if(format) {
			for(i in config.parsers) {
				if(format == config.parsers[i].format)
					return config.parsers[i];
			}
		} else {
			for(i in config.parsers) {
				if(tiddler.isTagged(config.parsers[i].formatTag))
					return config.parsers[i];
			}
		}
	}
	return formatter;
}

function wikify(source,output,highlightRegExp,tiddler)
{
	if(source) {
		var wikifier = new Wikifier(source,getParser(tiddler),highlightRegExp,tiddler);
		var t0 = new Date();
		wikifier.subWikify(output);
		if(tiddler && config.options.chkDisplayInstrumentation)
			displayMessage("wikify:" +tiddler.title+ " in " + (new Date()-t0) + " ms");
	}
}

function wikifyStatic(source,highlightRegExp,tiddler,format)
{
	var e = createTiddlyElement(document.body,"pre");
	e.style.display = "none";
	var html = "";
	if(source && source != "") {
		if(!tiddler)
			tiddler = new Tiddler("temp");
		var wikifier = new Wikifier(source,getParser(tiddler,format),highlightRegExp,tiddler);
		wikifier.isStatic = true;
		wikifier.subWikify(e);
		html = e.innerHTML;
		removeNode(e);
	}
	return html;
}

function wikifyPlain(title,theStore,limit)
{
	if(!theStore)
		theStore = store;
	if(theStore.tiddlerExists(title) || theStore.isShadowTiddler(title)) {
		return wikifyPlainText(theStore.getTiddlerText(title),limit,tiddler);
	} else {
		return "";
	}
}

function wikifyPlainText(text,limit,tiddler)
{
	if(limit > 0)
		text = text.substr(0,limit);
	var wikifier = new Wikifier(text,formatter,null,tiddler);
	return wikifier.wikifyPlain();
}

function highlightify(source,output,highlightRegExp,tiddler)
{
	if(source) {
		var wikifier = new Wikifier(source,formatter,highlightRegExp,tiddler);
		wikifier.outputText(output,0,source.length);
	}
}

function Wikifier(source,formatter,highlightRegExp,tiddler)
{
	this.source = source;
	this.output = null;
	this.formatter = formatter;
	this.nextMatch = 0;
	this.autoLinkWikiWords = tiddler && tiddler.autoLinkWikiWords() == false ? false : true;
	this.highlightRegExp = highlightRegExp;
	this.highlightMatch = null;
	this.isStatic = false;
	if(highlightRegExp) {
		highlightRegExp.lastIndex = 0;
		this.highlightMatch = highlightRegExp.exec(source);
	}
	this.tiddler = tiddler;
}

Wikifier.prototype.wikifyPlain = function()
{
	var e = createTiddlyElement(document.body,"div");
	e.style.display = "none";
	this.subWikify(e);
	var text = getPlainText(e);
	removeNode(e);
	return text;
};

Wikifier.prototype.subWikify = function(output,terminator)
{
	try {
		if(terminator)
			this.subWikifyTerm(output,new RegExp("(" + terminator + ")","mg"));
		else
			this.subWikifyUnterm(output);
	} catch(ex) {
		showException(ex);
	}
};

Wikifier.prototype.subWikifyUnterm = function(output)
{
	var oldOutput = this.output;
	this.output = output;
	this.formatter.formatterRegExp.lastIndex = this.nextMatch;
	var formatterMatch = this.formatter.formatterRegExp.exec(this.source);
	while(formatterMatch) {
		// Output any text before the match
		if(formatterMatch.index > this.nextMatch)
			this.outputText(this.output,this.nextMatch,formatterMatch.index);
		// Set the match parameters for the handler
		this.matchStart = formatterMatch.index;
		this.matchLength = formatterMatch[0].length;
		this.matchText = formatterMatch[0];
		this.nextMatch = this.formatter.formatterRegExp.lastIndex;
		for(var t=1; t<formatterMatch.length; t++) {
			if(formatterMatch[t]) {
				this.formatter.formatters[t-1].handler(this);
				this.formatter.formatterRegExp.lastIndex = this.nextMatch;
				break;
			}
		}
		formatterMatch = this.formatter.formatterRegExp.exec(this.source);
	}
	if(this.nextMatch < this.source.length) {
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
	}
	this.output = oldOutput;
};

Wikifier.prototype.subWikifyTerm = function(output,terminatorRegExp)
{
	var oldOutput = this.output;
	this.output = output;
	terminatorRegExp.lastIndex = this.nextMatch;
	var terminatorMatch = terminatorRegExp.exec(this.source);
	this.formatter.formatterRegExp.lastIndex = this.nextMatch;
	var formatterMatch = this.formatter.formatterRegExp.exec(terminatorMatch ? this.source.substr(0,terminatorMatch.index) : this.source);
	while(terminatorMatch || formatterMatch) {
		if(terminatorMatch && (!formatterMatch || terminatorMatch.index <= formatterMatch.index)) {
			if(terminatorMatch.index > this.nextMatch)
				this.outputText(this.output,this.nextMatch,terminatorMatch.index);
			this.matchText = terminatorMatch[1];
			this.matchLength = terminatorMatch[1].length;
			this.matchStart = terminatorMatch.index;
			this.nextMatch = this.matchStart + this.matchLength;
			this.output = oldOutput;
			return;
		}
		if(formatterMatch.index > this.nextMatch)
			this.outputText(this.output,this.nextMatch,formatterMatch.index);
		this.matchStart = formatterMatch.index;
		this.matchLength = formatterMatch[0].length;
		this.matchText = formatterMatch[0];
		this.nextMatch = this.formatter.formatterRegExp.lastIndex;
		for(var t=1; t<formatterMatch.length; t++) {
			if(formatterMatch[t]) {
				this.formatter.formatters[t-1].handler(this);
				this.formatter.formatterRegExp.lastIndex = this.nextMatch;
				break;
			}
		}
		terminatorRegExp.lastIndex = this.nextMatch;
		terminatorMatch = terminatorRegExp.exec(this.source);
		formatterMatch = this.formatter.formatterRegExp.exec(terminatorMatch ? this.source.substr(0,terminatorMatch.index) : this.source);
	}
	if(this.nextMatch < this.source.length) {
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
	}
	this.output = oldOutput;
};

Wikifier.prototype.outputText = function(place,startPos,endPos)
{
	while(this.highlightMatch && (this.highlightRegExp.lastIndex > startPos) && (this.highlightMatch.index < endPos) && (startPos < endPos)) {
		if(this.highlightMatch.index > startPos) {
			createTiddlyText(place,this.source.substring(startPos,this.highlightMatch.index));
			startPos = this.highlightMatch.index;
		}
		var highlightEnd = Math.min(this.highlightRegExp.lastIndex,endPos);
		var theHighlight = createTiddlyElement(place,"span",null,"highlight",this.source.substring(startPos,highlightEnd));
		startPos = highlightEnd;
		if(startPos >= this.highlightRegExp.lastIndex)
			this.highlightMatch = this.highlightRegExp.exec(this.source);
	}
	if(startPos < endPos) {
		createTiddlyText(place,this.source.substring(startPos,endPos));
	}
};

//--
//-- Macro definitions
//--

config.macros.today.handler = function(place,macroName,params)
{
	var now = new Date();
	var text = params[0] ? now.formatString(params[0].trim()) : now.toLocaleString();
	jQuery("<span/>").text(text).appendTo(place);
};

config.macros.version.handler = function(place)
{
	jQuery("<span/>").text(formatVersion()).appendTo(place);
};

config.macros.list.handler = function(place,macroName,params)
{
	var type = params[0] || "all";
	var list = document.createElement("ul");
	place.appendChild(list);
	if(this[type].prompt)
		createTiddlyElement(list,"li",null,"listTitle",this[type].prompt);
	var results;
	if(this[type].handler)
		results = this[type].handler(params);
	for(var t = 0; t < results.length; t++) {
		var li = document.createElement("li");
		list.appendChild(li);
		createTiddlyLink(li,typeof results[t] == "string" ? results[t] : results[t].title,true);
	}
};

config.macros.list.all.handler = function(params)
{
	return store.reverseLookup("tags","excludeLists",false,"title");
};

config.macros.list.missing.handler = function(params)
{
	return store.getMissingLinks();
};

config.macros.list.orphans.handler = function(params)
{
	return store.getOrphans();
};

config.macros.list.shadowed.handler = function(params)
{
	return store.getShadowed();
};

config.macros.list.touched.handler = function(params)
{
	return store.getTouched();
};

config.macros.list.filter.handler = function(params)
{
	var filter = params[1];
	var results = [];
	if(filter) {
		var tiddlers = store.filterTiddlers(filter);
		for(var t=0; t<tiddlers.length; t++)
			results.push(tiddlers[t].title);
	}
	return results;
};

config.macros.allTags.handler = function(place,macroName,params)
{
	var tags = store.getTags(params[0]);
	var ul = createTiddlyElement(place,"ul");
	if(tags.length == 0)
		createTiddlyElement(ul,"li",null,"listTitle",this.noTags);
	for(var t=0; t<tags.length; t++) {
		var title = tags[t][0];
		var info = getTiddlyLinkInfo(title);
		var li = createTiddlyElement(ul,"li");
		var btn = createTiddlyButton(li,title + " (" + tags[t][1] + ")",this.tooltip.format([title]),onClickTag,info.classes);
		btn.setAttribute("tag",title);
		btn.setAttribute("refresh","link");
		btn.setAttribute("tiddlyLink",title);
		if(params[1]) {
			btn.setAttribute("sortby",params[1]);
		}
	}
};

config.macros.timeline.handler = function(place,macroName,params)
{
	var field = params[0] || "modified";
	var tiddlers = store.reverseLookup("tags","excludeLists",false,field);
	var lastDay = "";
	var last = params[1] ? tiddlers.length-Math.min(tiddlers.length,parseInt(params[1])) : 0;
	var dateFormat = params[2] || this.dateFormat;
	for(var t=tiddlers.length-1; t>=last; t--) {
		var tiddler = tiddlers[t];
		var theDay = tiddler[field].convertToLocalYYYYMMDDHHMM().substr(0,8);
		if(theDay != lastDay) {
			var ul = document.createElement("ul");
			addClass(ul,"timeline");
			place.appendChild(ul);
			createTiddlyElement(ul,"li",null,"listTitle",tiddler[field].formatString(dateFormat));
			lastDay = theDay;
		}
		createTiddlyElement(ul,"li",null,"listLink").appendChild(createTiddlyLink(place,tiddler.title,true));
	}
};

config.macros.tiddler.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("name",null,true,false,true);
	var names = params[0]["name"];
	var tiddlerName = names[0];
	var className = names[1] || null;
	var args = params[0]["with"];
	var wrapper = createTiddlyElement(place,"span",null,className);
	wrapper.setAttribute("refresh","content");
	wrapper.setAttribute("tiddler",tiddlerName);
	if(args!==undefined)
		wrapper.setAttribute("args","[["+args.join("]] [[")+"]]");
	this.transclude(wrapper,tiddlerName,args);
};

config.macros.tiddler.transclude = function(wrapper,tiddlerName,args)
{
	var text = store.getTiddlerText(tiddlerName);
	if(!text)
		return;
	var stack = config.macros.tiddler.tiddlerStack;
	if(stack.indexOf(tiddlerName) !== -1)
		return;
	stack.push(tiddlerName);
	try {
		if(typeof args == "string")
			args = args.readBracketedList();
		var n = args ? Math.min(args.length,9) : 0;
		for(var i=0; i<n; i++) {
			var placeholderRE = new RegExp("\\$" + (i + 1),"mg");
			text = text.replace(placeholderRE,args[i]);
		}
		config.macros.tiddler.renderText(wrapper,text,tiddlerName,params);
	} finally {
		stack.pop();
	}
};

config.macros.tiddler.renderText = function(place,text,tiddlerName,params)
{
	wikify(text,place,null,store.getTiddler(tiddlerName));
};

config.macros.tiddler.tiddlerStack = [];

config.macros.tag.handler = function(place,macroName,params)
{
	createTagButton(place,params[0],null,params[1],params[2]);
	if(params[3]) {
		btn.setAttribute('sortby',params[3]);
	}
};

config.macros.tags.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var ul = createTiddlyElement(place,"ul");
	var title = getParam(params,"anon","");
	if(title && store.tiddlerExists(title))
		tiddler = store.getTiddler(title);
	var sep = getParam(params,"sep"," ");
	var lingo = config.views.wikified.tag;
	var prompt = tiddler.tags.length == 0 ? lingo.labelNoTags : lingo.labelTags;
	createTiddlyElement(ul,"li",null,"listTitle",prompt.format([tiddler.title]));
	for(var t=0; t<tiddler.tags.length; t++) {
		var tag = store.getTiddler(tiddler.tags[t]);
		if(!tag || !tag.tags.contains("excludeLists")) {
			createTagButton(createTiddlyElement(ul,"li"),tiddler.tags[t],tiddler.title);
			if(t<tiddler.tags.length-1)
				createTiddlyText(ul,sep);
		}
	}
};

config.macros.tagging.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var ul = createTiddlyElement(place,"ul");
	var title = getParam(params,"anon","");
	if(title == "" && tiddler instanceof Tiddler)
		title = tiddler.title;
	var sep = getParam(params,"sep"," ");
	ul.setAttribute("title",this.tooltip.format([title]));
	var tagged = store.getTaggedTiddlers(title);
	var prompt = tagged.length == 0 ? this.labelNotTag : this.label;
	createTiddlyElement(ul,"li",null,"listTitle",prompt.format([title,tagged.length]));
	for(var t=0; t<tagged.length; t++) {
		createTiddlyLink(createTiddlyElement(ul,"li"),tagged[t].title,true);
		if(t<tagged.length-1)
			createTiddlyText(ul,sep);
	}
};

config.macros.closeAll.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.closeAll.onClick = function(e)
{
	story.closeAllTiddlers();
	return false;
};

config.macros.permaview.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.permaview.onClick = function(e)
{
	story.permaView();
	return false;
};

config.macros.saveChanges.handler = function(place,macroName,params)
{
	if(!readOnly)
		createTiddlyButton(place,params[0] || this.label,params[1] || this.prompt,this.onClick,null,null,this.accessKey);
};

config.macros.saveChanges.onClick = function(e)
{
	saveChanges();
	return false;
};

config.macros.slider.onClickSlider = function(ev)
{
	var e = ev || window.event;
	var n = this.nextSibling;
	var cookie = n.getAttribute("cookie");
	var isOpen = n.style.display != "none";
	if(config.options.chkAnimate && anim && typeof Slider == "function")
		anim.startAnimating(new Slider(n,!isOpen,null,"none"));
	else
		n.style.display = isOpen ? "none" : "block";
	config.options[cookie] = !isOpen;
	saveOptionCookie(cookie);
	return false;
};

config.macros.slider.createSlider = function(place,cookie,title,tooltip)
{
	var c = cookie || "";
	var btn = createTiddlyButton(place,title,tooltip,this.onClickSlider);
	var panel = createTiddlyElement(null,"div",null,"sliderPanel");
	panel.setAttribute("cookie",c);
	panel.style.display = config.options[c] ? "block" : "none";
	place.appendChild(panel);
	return panel;
};

config.macros.slider.handler = function(place,macroName,params)
{
	var panel = this.createSlider(place,params[0],params[2],params[3]);
	var text = store.getTiddlerText(params[1]);
	panel.setAttribute("refresh","content");
	panel.setAttribute("tiddler",params[1]);
	if(text)
		wikify(text,panel,null,store.getTiddler(params[1]));
};

// <<gradient [[tiddler name]] vert|horiz rgb rgb rgb rgb... >>
config.macros.gradient.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var panel = wikifier ? createTiddlyElement(place,"div",null,"gradient") : place;
	panel.style.position = "relative";
	panel.style.overflow = "hidden";
	panel.style.zIndex = "0";
	if(wikifier) {
		var styles = config.formatterHelpers.inlineCssHelper(wikifier);
		config.formatterHelpers.applyCssHelper(panel,styles);
	}
	params = paramString.parseParams("color");
	var locolors = [], hicolors = [];
	for(var t=2; t<params.length; t++) {
		var c = params[t].value;
		if(params[t].name == "snap") {
			hicolors[hicolors.length-1] = c;
		} else {
			locolors.push(c);
			hicolors.push(c);
		}
	}
	drawGradient(panel,params[1].value != "vert",locolors,hicolors);
	if(wikifier)
		wikifier.subWikify(panel,">>");
	if(document.all) {
		panel.style.height = "100%";
		panel.style.width = "100%";
	}
};

config.macros.message.handler = function(place,macroName,params)
{
	if(params[0]) {
		var names = params[0].split(".");
		var lookupMessage = function(root,nameIndex) {
				if(names[nameIndex] in root) {
					if(nameIndex < names.length-1)
						return (lookupMessage(root[names[nameIndex]],nameIndex+1));
					else
						return root[names[nameIndex]];
				} else
					return null;
			};
		var m = lookupMessage(config,0);
		if(m == null)
			m = lookupMessage(window,0);
		createTiddlyText(place,m.toString().format(params.splice(1)));
	}
};


config.macros.view.views = {
	text: function(value,place,params,wikifier,paramString,tiddler) {
		highlightify(value,place,highlightHack,tiddler);
	},
	link: function(value,place,params,wikifier,paramString,tiddler) {
		createTiddlyLink(place,value,true);
	},
	wikified: function(value,place,params,wikifier,paramString,tiddler) {
		if(params[2])
			value=params[2].unescapeLineBreaks().format([value]);
		wikify(value,place,highlightHack,tiddler);
	},
	date: function(value,place,params,wikifier,paramString,tiddler) {
		value = Date.convertFromYYYYMMDDHHMM(value);
		createTiddlyText(place,value.formatString(params[2] ? params[2] : config.views.wikified.dateFormat));
	}
};

config.macros.view.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if((tiddler instanceof Tiddler) && params[0]) {
		var value = store.getValue(tiddler,params[0]);
		if(value) {
			var type = params[1] || config.macros.view.defaultView;
			var handler = config.macros.view.views[type];
			if(handler)
				handler(value,place,params,wikifier,paramString,tiddler);
		}
	}
};

config.macros.edit.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var field = params[0];
	var rows = params[1] || 0;
	var defVal = params[2] || '';
	if((tiddler instanceof Tiddler) && field) {
		story.setDirty(tiddler.title,true);
		var e,v;
		if(field != "text" && !rows) {
			e = createTiddlyElement(null,"input");
			e.setAttribute("edit",field);
			e.setAttribute("type","text");
			e.value = store.getValue(tiddler,field) || defVal;
			e.setAttribute("size","40");
			e.setAttribute("autocomplete","off");
			place.appendChild(e);
		} else {
			var wrapper1 = createTiddlyElement(null,"fieldset",null,"fieldsetFix");
			var wrapper2 = createTiddlyElement(wrapper1,"div");
			e = createTiddlyElement(wrapper2,"textarea");
			e.value = v = store.getValue(tiddler,field) || defVal;
			rows = rows || 10;
			var lines = v.match(/\n/mg);
			var maxLines = Math.max(parseInt(config.options.txtMaxEditRows),5);
			if(lines != null && lines.length > rows)
				rows = lines.length + 5;
			rows = Math.min(rows,maxLines);
			e.setAttribute("rows",rows);
			e.setAttribute("edit",field);
			place.appendChild(wrapper1);
		}
		if(tiddler.isReadOnly()) {
			e.setAttribute("readOnly","readOnly");
			addClass(e,"readOnly");
		}
		return e;
	}
};

config.macros.tagChooser.onClick = function(ev)
{
	var e = ev || window.event;
	var lingo = config.views.editor.tagChooser;
	var popup = Popup.create(this);
	var tags = store.getTags(this.getAttribute("tags"));
	if(tags.length == 0)
		jQuery("<li/>").text(lingo.popupNone).appendTo(jQuery(popup));
	for(var t=0; t<tags.length; t++) {
		var tag = createTiddlyButton(createTiddlyElement(popup,"li"),tags[t][0],lingo.tagTooltip.format([tags[t][0]]),config.macros.tagChooser.onTagClick);
		tag.setAttribute("tag",tags[t][0]);
		tag.setAttribute("tiddler",this.getAttribute("tiddler"));
	}
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
};

config.macros.tagChooser.onTagClick = function(ev)
{
	var e = ev || window.event;
	if(e.metaKey || e.ctrlKey) stopEvent(e); //# keep popup open on CTRL-click
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(!readOnly)
		story.setTiddlerTag(title,tag,0);
	return false;
};

config.macros.tagChooser.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(tiddler instanceof Tiddler) {
		var lingo = config.views.editor.tagChooser;
		var btn = createTiddlyButton(place,lingo.text,lingo.tooltip,this.onClick);
		btn.setAttribute("tiddler",tiddler.title);
		btn.setAttribute("tags",params[0]);
	}
};

config.macros.refreshDisplay.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.refreshDisplay.onClick = function(e)
{
	refreshAll();
	return false;
};

config.macros.annotations.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var title = tiddler ? tiddler.title : null;
	var a = title ? config.annotations[title] : null;
	if(!tiddler || !title || !a)
		return;
	var text = a.format([title]);
	wikify(text,createTiddlyElement(place,"div",null,"annotation"),null,tiddler);
};

//--
//-- NewTiddler and NewJournal macros
//--

config.macros.newTiddler.createNewTiddlerButton = function(place,title,params,label,prompt,accessKey,newFocus,isJournal)
{
	var tags = [];
	for(var t=1; t<params.length; t++) {
		if((params[t].name == "anon" && t != 1) || (params[t].name == "tag"))
			tags.push(params[t].value);
	}
	label = getParam(params,"label",label);
	prompt = getParam(params,"prompt",prompt);
	accessKey = getParam(params,"accessKey",accessKey);
	newFocus = getParam(params,"focus",newFocus);
	var customFields = getParam(params,"fields","");
	if(!customFields && !store.isShadowTiddler(title))
		customFields = String.encodeHashMap(config.defaultCustomFields);
	var btn = createTiddlyButton(place,label,prompt,this.onClickNewTiddler,null,null,accessKey);
	btn.setAttribute("newTitle",title);
	btn.setAttribute("isJournal",isJournal ? "true" : "false");
	if(tags.length > 0)
		btn.setAttribute("params",tags.join("|"));
	btn.setAttribute("newFocus",newFocus);
	btn.setAttribute("newTemplate",getParam(params,"template",DEFAULT_EDIT_TEMPLATE));
	if(customFields !== "")
		btn.setAttribute("customFields",customFields);
	var text = getParam(params,"text");
	if(text !== undefined)
		btn.setAttribute("newText",text);
	return btn;
};

config.macros.newTiddler.onClickNewTiddler = function()
{
	var title = this.getAttribute("newTitle");
	if(this.getAttribute("isJournal") == "true") {
		title = new Date().formatString(title.trim());
	}
	var params = this.getAttribute("params");
	var tags = params ? params.split("|") : [];
	var focus = this.getAttribute("newFocus");
	var template = this.getAttribute("newTemplate");
	var customFields = this.getAttribute("customFields");
	if(!customFields && !store.isShadowTiddler(title))
		customFields = String.encodeHashMap(config.defaultCustomFields);
	story.displayTiddler(null,title,template,false,null,null);
	var tiddlerElem = story.getTiddler(title);
	if(customFields)
		story.addCustomFields(tiddlerElem,customFields);
	var text = this.getAttribute("newText");
	if(typeof text == "string" && story.getTiddlerField(title,"text"))
		story.getTiddlerField(title,"text").value = text.format([title]);
	for(var t=0;t<tags.length;t++)
		story.setTiddlerTag(title,tags[t],+1);
	story.focusTiddler(title,focus);
	return false;
};

config.macros.newTiddler.handler = function(place,macroName,params,wikifier,paramString)
{
	if(!readOnly) {
		params = paramString.parseParams("anon",null,true,false,false);
		var title = params[1] && params[1].name == "anon" ? params[1].value : this.title;
		title = getParam(params,"title",title);
		this.createNewTiddlerButton(place,title,params,this.label,this.prompt,this.accessKey,"title",false);
	}
};

config.macros.newJournal.handler = function(place,macroName,params,wikifier,paramString)
{
	if(!readOnly) {
		params = paramString.parseParams("anon",null,true,false,false);
		var title = params[1] && params[1].name == "anon" ? params[1].value : config.macros.timeline.dateFormat;
		title = getParam(params,"title",title);
		config.macros.newTiddler.createNewTiddlerButton(place,title,params,this.label,this.prompt,this.accessKey,"text",true);
	}
};

//--
//-- Search macro
//--

config.macros.search.handler = function(place,macroName,params)
{
	var searchTimeout = null;
	var btn = createTiddlyButton(place,this.label,this.prompt,this.onClick,"searchButton");
	var txt = createTiddlyElement(null,"input",null,"txtOptionInput searchField");
	if(params[0])
		txt.value = params[0];
	if(config.browser.isSafari) {
		txt.setAttribute("type","search");
		txt.setAttribute("results","5");
	} else {
		txt.setAttribute("type","text");
	}
	place.appendChild(txt);
	txt.onkeyup = this.onKeyPress;
	txt.onfocus = this.onFocus;
	txt.setAttribute("size",this.sizeTextbox);
	txt.setAttribute("accessKey",params[1] || this.accessKey);
	txt.setAttribute("autocomplete","off");
	txt.setAttribute("lastSearchText","");
};

// Global because there's only ever one outstanding incremental search timer
config.macros.search.timeout = null;

config.macros.search.doSearch = function(txt)
{
	if(txt.value.length > 0) {
		story.search(txt.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch);
		txt.setAttribute("lastSearchText",txt.value);
	}
};

config.macros.search.onClick = function(e)
{
	config.macros.search.doSearch(this.nextSibling);
	return false;
};

config.macros.search.onKeyPress = function(ev)
{
	var e = ev || window.event;
	switch(e.keyCode) {
		case 13: // Ctrl-Enter
		case 10: // Ctrl-Enter on IE PC
			config.macros.search.doSearch(this);
			break;
		case 27: // Escape
			this.value = "";
			clearMessage();
			break;
	}
	if(config.options.chkIncrementalSearch) {
		if(this.value.length > 2) {
			if(this.value != this.getAttribute("lastSearchText")) {
				if(config.macros.search.timeout)
					clearTimeout(config.macros.search.timeout);
				var txt = this;
				config.macros.search.timeout = setTimeout(function() {config.macros.search.doSearch(txt);},500);
			}
		} else {
			if(config.macros.search.timeout)
				clearTimeout(config.macros.search.timeout);
		}
	}
};

config.macros.search.onFocus = function(e)
{
	this.select();
};

//--
//-- Tabs macro
//--

config.macros.tabs.handler = function(place,macroName,params)
{
	var cookie = params[0];
	var numTabs = (params.length-1)/3;
	var wrapper = createTiddlyElement(null,"div",null,"tabsetWrapper " + cookie);
	var tabset = createTiddlyElement(wrapper,"div",null,"tabset");
	tabset.setAttribute("cookie",cookie);
	var validTab = false;
	for(var t=0; t<numTabs; t++) {
		var label = params[t*3+1];
		var prompt = params[t*3+2];
		var content = params[t*3+3];
		var tab = createTiddlyButton(tabset,label,prompt,this.onClickTab,"tab tabUnselected");
		createTiddlyElement(tab,"span",null,null," ",{style:"font-size:0pt;line-height:0px"});
		tab.setAttribute("tab",label);
		tab.setAttribute("content",content);
		tab.title = prompt;
		if(config.options[cookie] == label)
			validTab = true;
	}
	if(!validTab)
		config.options[cookie] = params[1];
	place.appendChild(wrapper);
	this.switchTab(tabset,config.options[cookie]);
};

config.macros.tabs.onClickTab = function(e)
{
	config.macros.tabs.switchTab(this.parentNode,this.getAttribute("tab"));
	return false;
};

config.macros.tabs.switchTab = function(tabset,tab)
{
	var cookie = tabset.getAttribute("cookie");
	var theTab = null;
	var nodes = tabset.childNodes;
	for(var t=0; t<nodes.length; t++) {
		if(nodes[t].getAttribute && nodes[t].getAttribute("tab") == tab) {
			theTab = nodes[t];
			theTab.className = "tab tabSelected";
		} else {
			nodes[t].className = "tab tabUnselected";
		}
	}
	if(theTab) {
		if(tabset.nextSibling && tabset.nextSibling.className == "tabContents")
			removeNode(tabset.nextSibling);
		var tabContent = createTiddlyElement(null,"div",null,"tabContents");
		tabset.parentNode.insertBefore(tabContent,tabset.nextSibling);
		var contentTitle = theTab.getAttribute("content");
		wikify(store.getTiddlerText(contentTitle),tabContent,null,store.getTiddler(contentTitle));
		if(cookie) {
			config.options[cookie] = tab;
			saveOptionCookie(cookie);
		}
	}
};

//--
//-- Tiddler toolbar
//--

// Create a toolbar command button
config.macros.toolbar.createCommand = function(place,commandName,tiddler,className)
{
	if(typeof commandName != "string") {
		var c = null;
		for(var t in config.commands) {
			if(config.commands[t] == commandName)
				c = t;
		}
		commandName = c;
	}
	if((tiddler instanceof Tiddler) && (typeof commandName == "string")) {
		var command = config.commands[commandName];
		if(command.isEnabled ? command.isEnabled(tiddler) : this.isCommandEnabled(command,tiddler)) {
			var text = command.getText ? command.getText(tiddler) : this.getCommandText(command,tiddler);
			var tooltip = command.getTooltip ? command.getTooltip(tiddler) : this.getCommandTooltip(command,tiddler);
			var cmd;
			switch(command.type) {
			case "popup":
				cmd = this.onClickPopup;
				break;
			case "command":
			default:
				cmd = this.onClickCommand;
				break;
			}
			var btn = createTiddlyButton(null,text,tooltip,cmd);
			btn.setAttribute("commandName",commandName);
			btn.setAttribute("tiddler",tiddler.title);
			addClass(btn,"command_" + commandName);
			if(className)
				addClass(btn,className);
			place.appendChild(btn);
		}
	}
};

config.macros.toolbar.isCommandEnabled = function(command,tiddler)
{
	var title = tiddler.title;
	var ro = tiddler.isReadOnly();
	var shadow = store.isShadowTiddler(title) && !store.tiddlerExists(title);
	return (!ro || (ro && !command.hideReadOnly)) && !(shadow && command.hideShadow);
};

config.macros.toolbar.getCommandText = function(command,tiddler)
{
	return tiddler.isReadOnly() && command.readOnlyText || command.text;
};

config.macros.toolbar.getCommandTooltip = function(command,tiddler)
{
	return tiddler.isReadOnly() && command.readOnlyTooltip || command.tooltip;
};

config.macros.toolbar.onClickCommand = function(ev)
{
	var e = ev || window.event;
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	var command = config.commands[this.getAttribute("commandName")];
	return command.handler(e,this,this.getAttribute("tiddler"));
};

config.macros.toolbar.onClickPopup = function(ev)
{
	var e = ev || window.event;
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	var popup = Popup.create(this);
	var command = config.commands[this.getAttribute("commandName")];
	var title = this.getAttribute("tiddler");
	var tiddler = store.fetchTiddler(title);
	popup.setAttribute("tiddler",title);
	command.handlePopup(popup,title);
	Popup.show();
	return false;
};

// Invoke the first command encountered from a given place that is tagged with a specified class
config.macros.toolbar.invokeCommand = function(place,className,event)
{
	var children = place.getElementsByTagName("a");
	for(var t=0; t<children.length; t++) {
		var c = children[t];
		if(hasClass(c,className) && c.getAttribute && c.getAttribute("commandName")) {
			if(c.onclick instanceof Function)
				c.onclick.call(c,event);
			break;
		}
	}
};

config.macros.toolbar.onClickMore = function(ev)
{
	var e = this.nextSibling;
	e.style.display = "inline";
	this.style.display = "none";
	return false;
};

config.macros.toolbar.onClickLess = function(ev)
{
	var e = this.parentNode;
	var m = e.previousSibling;
	e.style.display = "none";
	m.style.display = "inline";
	return false;
};

config.macros.toolbar.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	for(var t=0; t<params.length; t++) {
		var c = params[t];
		switch(c) {
		case "!":
			createTiddlyText(place,this.separator);
			break;
		case "*":
			createTiddlyElement(place,"br");
			break;
		case "<":
			var btn = createTiddlyButton(place,this.lessLabel,this.lessPrompt,config.macros.toolbar.onClickLess);
			addClass(btn,"lessCommand");
			break;
		case ">":
			var btn = createTiddlyButton(place,this.moreLabel,this.morePrompt,config.macros.toolbar.onClickMore);
			addClass(btn,"moreCommand");
			var e = createTiddlyElement(place,"span",null,"moreCommand");
			e.style.display = "none";
			place = e;
			break;
		default:
			var className = "";
			switch(c.substr(0,1)) {
			case "+":
				className = "defaultCommand";
				c = c.substr(1);
				break;
			case "-":
				className = "cancelCommand";
				c = c.substr(1);
				break;
			}
			if(c in config.commands)
				this.createCommand(place,c,tiddler,className);
			break;
		}
	}
};

//--
//-- Menu and toolbar commands
//--

config.commands.closeTiddler.handler = function(event,src,title)
{
	if(story.isDirty(title) && !readOnly) {
		if(!confirm(config.commands.cancelTiddler.warning.format([title])))
			return false;
	}
	story.setDirty(title,false);
	story.closeTiddler(title,true);
	return false;
};

config.commands.closeOthers.handler = function(event,src,title)
{
	story.closeAllTiddlers(title);
	return false;
};

config.commands.editTiddler.handler = function(event,src,title)
{
	clearMessage();
	var tiddlerElem = story.getTiddler(title);
	var fields = tiddlerElem.getAttribute("tiddlyFields");
	story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE,false,null,fields);
	story.focusTiddler(title,config.options.txtEditorFocus||"text");
	return false;
};

config.commands.saveTiddler.handler = function(event,src,title)
{
	var newTitle = story.saveTiddler(title,event.shiftKey);
	if(newTitle)
		story.displayTiddler(null,newTitle);
	return false;
};

config.commands.cancelTiddler.handler = function(event,src,title)
{
	if(story.hasChanges(title) && !readOnly) {
		if(!confirm(this.warning.format([title])))
			return false;
	}
	story.setDirty(title,false);
	story.displayTiddler(null,title);
	return false;
};

config.commands.deleteTiddler.handler = function(event,src,title)
{
	var deleteIt = true;
	if(config.options.chkConfirmDelete)
		deleteIt = confirm(this.warning.format([title]));
	if(deleteIt) {
		store.removeTiddler(title);
		story.closeTiddler(title,true);
		autoSaveChanges();
	}
	return false;
};

config.commands.permalink.handler = function(event,src,title)
{
	var t = encodeURIComponent(String.encodeTiddlyLink(title));
	if(window.location.hash != t)
		window.location.hash = t;
	return false;
};

config.commands.references.handlePopup = function(popup,title)
{
	var references = store.getReferringTiddlers(title);
	var c = false;
	for(var r=0; r<references.length; r++) {
		if(references[r].title != title && !references[r].isTagged("excludeLists")) {
			createTiddlyLink(createTiddlyElement(popup,"li"),references[r].title,true);
			c = true;
		}
	}
	if(!c)
		createTiddlyElement(popup,"li",null,"disabled",this.popupNone);
};

config.commands.jump.handlePopup = function(popup,title)
{
	story.forEachTiddler(function(title,element) {
		createTiddlyLink(createTiddlyElement(popup,"li"),title,true,null,false,null,true);
		});
};

config.commands.syncing.handlePopup = function(popup,title)
{
	var tiddler = store.fetchTiddler(title);
	if(!tiddler)
		return;
	var serverType = tiddler.getServerType();
	var serverHost = tiddler.fields["server.host"];
	var serverWorkspace = tiddler.fields["server.workspace"];
	if(!serverWorkspace)
		serverWorkspace = "";
	if(serverType) {
		var e = createTiddlyElement(popup,"li",null,"popupMessage");
		e.innerHTML = config.commands.syncing.currentlySyncing.format([serverType,serverHost,serverWorkspace]);
	} else {
		createTiddlyElement(popup,"li",null,"popupMessage",config.commands.syncing.notCurrentlySyncing);
	}
	if(serverType) {
		createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
		var btn = createTiddlyButton(createTiddlyElement(popup,"li"),this.captionUnSync,null,config.commands.syncing.onChooseServer);
		btn.setAttribute("tiddler",title);
		btn.setAttribute("server.type","");
	}
	createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
	createTiddlyElement(popup,"li",null,"popupMessage",config.commands.syncing.chooseServer);
	var feeds = store.getTaggedTiddlers("systemServer","title");
	for(var t=0; t<feeds.length; t++) {
		var f = feeds[t];
		var feedServerType = store.getTiddlerSlice(f.title,"Type");
		if(!feedServerType)
			feedServerType = "file";
		var feedServerHost = store.getTiddlerSlice(f.title,"URL");
		if(!feedServerHost)
			feedServerHost = "";
		var feedServerWorkspace = store.getTiddlerSlice(f.title,"Workspace");
		if(!feedServerWorkspace)
			feedServerWorkspace = "";
		var caption = f.title;
		if(serverType == feedServerType && serverHost == feedServerHost && serverWorkspace == feedServerWorkspace) {
			caption = config.commands.syncing.currServerMarker + caption;
		} else {
			caption = config.commands.syncing.notCurrServerMarker + caption;
		}
		btn = createTiddlyButton(createTiddlyElement(popup,"li"),caption,null,config.commands.syncing.onChooseServer);
		btn.setAttribute("tiddler",title);
		btn.setAttribute("server.type",feedServerType);
		btn.setAttribute("server.host",feedServerHost);
		btn.setAttribute("server.workspace",feedServerWorkspace);
	}
};

config.commands.syncing.onChooseServer = function(e)
{
	var tiddler = this.getAttribute("tiddler");
	var serverType = this.getAttribute("server.type");
	if(serverType) {
		store.addTiddlerFields(tiddler,{
			"server.type": serverType,
			"server.host": this.getAttribute("server.host"),
			"server.workspace": this.getAttribute("server.workspace")
			});
	} else {
		store.setValue(tiddler,"server",null);
	}
	return false;
};

config.commands.fields.handlePopup = function(popup,title)
{
	var tiddler = store.fetchTiddler(title);
	if(!tiddler)
		return;
	var items = [];
	store.forEachField(tiddler,function(tiddler,fieldName,value){items.push({field:fieldName,value:value});},true);
	items.sort(function(a,b) {return a.field < b.field ? -1 : (a.field == b.field ? 0 : +1);});
	if(items.length > 0)
		ListView.create(popup,items,this.listViewTemplate);
	else
		createTiddlyElement(popup,"div",null,null,this.emptyText);
};

//--
//-- Tiddler() object
//--

function Tiddler(title)
{
	this.title = title;
	this.text = "";
	this.creator = null;
	this.modifier = null;
	this.created = new Date();
	this.modified = this.created;
	this.links = [];
	this.linksUpdated = false;
	this.tags = [];
	this.fields = {};
	return this;
}

Tiddler.prototype.getLinks = function()
{
	if(this.linksUpdated==false)
		this.changed();
	return this.links;
};

// Returns the fields that are inherited in string field:"value" field2:"value2" format
Tiddler.prototype.getInheritedFields = function()
{
	var f = {};
	for(var i in this.fields) {
		if(i=="server.host" || i=="server.workspace" || i=="wikiformat"|| i=="server.type") {
			f[i] = this.fields[i];
		}
	}
	return String.encodeHashMap(f);
};

// Increment the changeCount of a tiddler
Tiddler.prototype.incChangeCount = function()
{
	var c = this.fields['changecount'];
	c = c ? parseInt(c,10) : 0;
	this.fields['changecount'] = String(c+1);
};

// Clear the changeCount of a tiddler
Tiddler.prototype.clearChangeCount = function()
{
	if(this.fields['changecount']) {
		delete this.fields['changecount'];
	}
};

Tiddler.prototype.doNotSave = function()
{
	return this.fields['doNotSave'];
};

// Returns true if the tiddler has been updated since the tiddler was created or downloaded
Tiddler.prototype.isTouched = function()
{
	var changeCount = this.fields['changecount'];
	if(changeCount === undefined)
		changeCount = 0;
	return changeCount > 0;
};

// Change the text and other attributes of a tiddler
Tiddler.prototype.set = function(title,text,modifier,modified,tags,created,fields,creator)
{
	this.assign(title,text,modifier,modified,tags,created,fields,creator);
	this.changed();
	return this;
};

// Change the text and other attributes of a tiddler without triggered a tiddler.changed() call
Tiddler.prototype.assign = function(title,text,modifier,modified,tags,created,fields,creator)
{
	if(title != undefined)
		this.title = title;
	if(text != undefined)
		this.text = text;
	if(modifier != undefined)
		this.modifier = modifier;
	if(modified != undefined)
		this.modified = modified;
	if(creator != undefined)
		this.creator = creator;
	if(created != undefined)
		this.created = created;
	if(fields != undefined)
		this.fields = fields;
	if(tags != undefined)
		this.tags = (typeof tags == "string") ? tags.readBracketedList() : tags;
	else if(this.tags == undefined)
		this.tags = [];
	return this;
};

// Get the tags for a tiddler as a string (space delimited, using [[brackets]] for tags containing spaces)
Tiddler.prototype.getTags = function()
{
	return String.encodeTiddlyLinkList(this.tags);
};

// Test if a tiddler carries a tag
Tiddler.prototype.isTagged = function(tag)
{
	return this.tags.indexOf(tag) != -1;
};

// Static method to convert "\n" to newlines, "\s" to "\"
Tiddler.unescapeLineBreaks = function(text)
{
	return text ? text.unescapeLineBreaks() : "";
};

// Convert newlines to "\n", "\" to "\s"
Tiddler.prototype.escapeLineBreaks = function()
{
	return this.text.escapeLineBreaks();
};

// Updates the secondary information (like links[] array) after a change to a tiddler
Tiddler.prototype.changed = function()
{
	this.links = [];
	var text = this.text;
	// remove 'quoted' text before scanning tiddler source
	text = text.replace(/\/%((?:.|\n)*?)%\//g,"").
		replace(/\{{3}((?:.|\n)*?)\}{3}/g,"").
		replace(/"""((?:.|\n)*?)"""/g,"").
		replace(/\<nowiki\>((?:.|\n)*?)\<\/nowiki\>/g,"").
		replace(/\<html\>((?:.|\n)*?)\<\/html\>/g,"").
		replace(/\<script((?:.|\n)*?)\<\/script\>/g,"");
	var t = this.autoLinkWikiWords() ? 0 : 1;
	var tiddlerLinkRegExp = t==0 ? config.textPrimitives.tiddlerAnyLinkRegExp : config.textPrimitives.tiddlerForcedLinkRegExp;
	tiddlerLinkRegExp.lastIndex = 0;
	var formatMatch = tiddlerLinkRegExp.exec(text);
	while(formatMatch) {
		var lastIndex = tiddlerLinkRegExp.lastIndex;
		if(t==0 && formatMatch[1] && formatMatch[1] != this.title) {
			// wikiWordLink
			if(formatMatch.index > 0) {
				var preRegExp = new RegExp(config.textPrimitives.unWikiLink+"|"+config.textPrimitives.anyLetter,"mg");
				preRegExp.lastIndex = formatMatch.index-1;
				var preMatch = preRegExp.exec(text);
				if(preMatch.index != formatMatch.index-1)
					this.links.pushUnique(formatMatch[1]);
			} else {
				this.links.pushUnique(formatMatch[1]);
			}
		}
		else if(formatMatch[2-t] && !config.formatterHelpers.isExternalLink(formatMatch[3-t])) // titledBrackettedLink
			this.links.pushUnique(formatMatch[3-t]);
		else if(formatMatch[4-t] && formatMatch[4-t] != this.title) // brackettedLink
			this.links.pushUnique(formatMatch[4-t]);
		tiddlerLinkRegExp.lastIndex = lastIndex;
		formatMatch = tiddlerLinkRegExp.exec(text);
	}
	this.linksUpdated = true;
};

Tiddler.prototype.getSubtitle = function()
{
	var modifier = this.modifier;
	if(!modifier)
		modifier = config.messages.subtitleUnknown;
	var modified = this.modified;
	if(modified)
		modified = modified.toLocaleString();
	else
		modified = config.messages.subtitleUnknown;
	return config.messages.tiddlerLinkTooltip.format([this.title,modifier,modified]);
};

Tiddler.prototype.isReadOnly = function()
{
	return readOnly;
};

Tiddler.prototype.autoLinkWikiWords = function()
{
	return !(this.isTagged("systemConfig") || this.isTagged("excludeMissing"));
};

Tiddler.prototype.getServerType = function()
{
	var serverType = null;
	if(this.fields['server.type'])
		serverType = this.fields['server.type'];
	if(!serverType)
		serverType = this.fields['wikiformat'];
	if(serverType && !config.adaptors[serverType])
		serverType = null;
	return serverType;
};

Tiddler.prototype.getAdaptor = function()
{
	var serverType = this.getServerType();
	return serverType ? new config.adaptors[serverType]() : null;
};

//--
//-- TiddlyWiki() object contains Tiddler()s
//--

function TiddlyWiki()
{
	var tiddlers = {}; // Hashmap by name of tiddlers
	this.tiddlersUpdated = false;
	this.namedNotifications = []; // Array of {name:,notify:} of notification functions
	this.notificationLevel = 0;
	this.slices = {}; // map tiddlerName->(map sliceName->sliceValue). Lazy.
	this.clear = function() {
		tiddlers = {};
		this.setDirty(false);
	};
	this.fetchTiddler = function(title) {
		var t = tiddlers[title];
		return t instanceof Tiddler ? t : null;
	};
	this.deleteTiddler = function(title) {
		delete this.slices[title];
		delete tiddlers[title];
	};
	this.addTiddler = function(tiddler) {
		delete this.slices[tiddler.title];
		tiddlers[tiddler.title] = tiddler;
	};
	this.forEachTiddler = function(callback) {
		for(var t in tiddlers) {
			var tiddler = tiddlers[t];
			if(tiddler instanceof Tiddler)
				callback.call(this,t,tiddler);
		}
	};
}

TiddlyWiki.prototype.setDirty = function(dirty)
{
	this.dirty = dirty;
};

TiddlyWiki.prototype.isDirty = function()
{
	return this.dirty;
};

TiddlyWiki.prototype.tiddlerExists = function(title)
{
	var t = this.fetchTiddler(title);
	return t != undefined;
};

TiddlyWiki.prototype.isShadowTiddler = function(title)
{
	return config.shadowTiddlers[title] === undefined ? false : true;
};

TiddlyWiki.prototype.createTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(!tiddler) {
		tiddler = new Tiddler(title);
		this.addTiddler(tiddler);
		this.setDirty(true);
	}
	return tiddler;
};

TiddlyWiki.prototype.getTiddler = function(title)
{
	var t = this.fetchTiddler(title);
	if(t != undefined)
		return t;
	else
		return null;
};

TiddlyWiki.prototype.getShadowTiddlerText = function(title)
{
	if(typeof config.shadowTiddlers[title] == "string")
		return config.shadowTiddlers[title];
	else
		return "";
};

// Retrieve tiddler contents
TiddlyWiki.prototype.getTiddlerText = function(title,defaultText)
{
	if(!title)
		return defaultText;
	var pos = title.indexOf(config.textPrimitives.sectionSeparator);
	var section = null;
	if(pos != -1) {
		section = title.substr(pos + config.textPrimitives.sectionSeparator.length);
		title = title.substr(0,pos);
	}
	pos = title.indexOf(config.textPrimitives.sliceSeparator);
	if(pos != -1) {
		var slice = this.getTiddlerSlice(title.substr(0,pos),title.substr(pos + config.textPrimitives.sliceSeparator.length));
		if(slice)
			return slice;
	}
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		if(!section)
			return tiddler.text;
		var re = new RegExp("(^!{1,6}[ \t]*" + section.escapeRegExp() + "[ \t]*\n)","mg");
		re.lastIndex = 0;
		var match = re.exec(tiddler.text);
		if(match) {
			var t = tiddler.text.substr(match.index+match[1].length);
			var re2 = /^!/mg;
			re2.lastIndex = 0;
			match = re2.exec(t); //# search for the next heading
			if(match)
				t = t.substr(0,match.index-1);//# don't include final \n
			return t;
		}
		return defaultText;
	}
	if(this.isShadowTiddler(title))
		return this.getShadowTiddlerText(title);
	if(defaultText != undefined)
		return defaultText;
	return null;
};

TiddlyWiki.prototype.getRecursiveTiddlerText = function(title,defaultText,depth)
{
	var bracketRegExp = new RegExp("(?:\\[\\[([^\\]]+)\\]\\])","mg");
	var text = this.getTiddlerText(title,null);
	if(text == null)
		return defaultText;
	var textOut = [];
	var lastPos = 0;
	do {
		var match = bracketRegExp.exec(text);
		if(match) {
			textOut.push(text.substr(lastPos,match.index-lastPos));
			if(match[1]) {
				if(depth <= 0)
					textOut.push(match[1]);
				else
					textOut.push(this.getRecursiveTiddlerText(match[1],"",depth-1));
			}
			lastPos = match.index + match[0].length;
		} else {
			textOut.push(text.substr(lastPos));
		}
	} while(match);
	return textOut.join("");
};

TiddlyWiki.prototype.slicesRE = /(?:^([\'\/]{0,2})~?([\.\w]+)\:\1[\t\x20]*([^\n]+)[\t\x20]*$)|(?:^\|([\'\/]{0,2})~?([\.\w]+)\:?\4\|[\t\x20]*([^\n]+)[\t\x20]*\|$)/gm;

// @internal
TiddlyWiki.prototype.calcAllSlices = function(title)
{
	var slices = {};
	var text = this.getTiddlerText(title,"");
	this.slicesRE.lastIndex = 0;
	var m = this.slicesRE.exec(text);
	while(m) {
		if(m[2])
			slices[m[2]] = m[3];
		else
			slices[m[5]] = m[6];
		m = this.slicesRE.exec(text);
	}
	return slices;
};

// Returns the slice of text of the given name
TiddlyWiki.prototype.getTiddlerSlice = function(title,sliceName)
{
	var slices = this.slices[title];
	if(!slices) {
		slices = this.calcAllSlices(title);
		this.slices[title] = slices;
	}
	return slices[sliceName];
};

// Build an hashmap of the specified named slices of a tiddler
TiddlyWiki.prototype.getTiddlerSlices = function(title,sliceNames)
{
	var r = {};
	for(var t=0; t<sliceNames.length; t++) {
		var slice = this.getTiddlerSlice(title,sliceNames[t]);
		if(slice)
			r[sliceNames[t]] = slice;
	}
	return r;
};

TiddlyWiki.prototype.suspendNotifications = function()
{
	this.notificationLevel--;
};

TiddlyWiki.prototype.resumeNotifications = function()
{
	this.notificationLevel++;
};

// Invoke the notification handlers for a particular tiddler
TiddlyWiki.prototype.notify = function(title,doBlanket)
{
	if(!this.notificationLevel) {
		for(var t=0; t<this.namedNotifications.length; t++) {
			var n = this.namedNotifications[t];
			if((n.name == null && doBlanket) || (n.name == title))
				n.notify(title);
		}
	}
};

// Invoke the notification handlers for all tiddlers
TiddlyWiki.prototype.notifyAll = function()
{
	if(!this.notificationLevel) {
		for(var t=0; t<this.namedNotifications.length; t++) {
			var n = this.namedNotifications[t];
			if(n.name)
				n.notify(n.name);
		}
	}
};

// Add a notification handler to a tiddler
TiddlyWiki.prototype.addNotification = function(title,fn)
{
	for(var i=0; i<this.namedNotifications.length; i++) {
		if((this.namedNotifications[i].name == title) && (this.namedNotifications[i].notify == fn))
			return this;
	}
	this.namedNotifications.push({name: title, notify: fn});
	return this;
};

TiddlyWiki.prototype.removeTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		this.deleteTiddler(title);
		this.notify(title,true);
		this.setDirty(true);
	}
};

// Reset the sync status of a freshly synced tiddler
TiddlyWiki.prototype.resetTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		tiddler.clearChangeCount();
		this.notify(title,true);
		this.setDirty(true);
	}
};

TiddlyWiki.prototype.setTiddlerTag = function(title,status,tag)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		var t = tiddler.tags.indexOf(tag);
		if(t != -1)
			tiddler.tags.splice(t,1);
		if(status)
			tiddler.tags.push(tag);
		tiddler.changed();
		tiddler.incChangeCount();
		this.notify(title,true);
		this.setDirty(true);
	}
};

TiddlyWiki.prototype.addTiddlerFields = function(title,fields)
{
	var tiddler = this.fetchTiddler(title);
	if(!tiddler)
		return;
	merge(tiddler.fields,fields);
	tiddler.changed();
	tiddler.incChangeCount();
	this.notify(title,true);
	this.setDirty(true);
};

// Store tiddler in TiddlyWiki instance
TiddlyWiki.prototype.saveTiddler = function(title,newTitle,newBody,modifier,modified,tags,fields,clearChangeCount,created,creator)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		created = created || tiddler.created; // Preserve created date
		creator = creator || tiddler.creator;
		this.deleteTiddler(title);
	} else {
		created = created || modified;
		tiddler = new Tiddler();
	}
	fields = merge({},fields);
	tiddler.set(newTitle,newBody,modifier,modified,tags,created,fields,creator);
	this.addTiddler(tiddler);
	if(clearChangeCount)
		tiddler.clearChangeCount();
	else
		tiddler.incChangeCount();
	if(title != newTitle)
		this.notify(title,true);
	this.notify(newTitle,true);
	this.setDirty(true);
	return tiddler;
};

TiddlyWiki.prototype.incChangeCount = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler)
		tiddler.incChangeCount();
};

TiddlyWiki.prototype.getLoader = function()
{
	if(!this.loader)
		this.loader = new TW21Loader();
	return this.loader;
};

TiddlyWiki.prototype.getSaver = function()
{
	if(!this.saver)
		this.saver = new TW21Saver();
	return this.saver;
};

// Return all tiddlers formatted as an HTML string
TiddlyWiki.prototype.allTiddlersAsHtml = function()
{
	return this.getSaver().externalize(store);
};

// Load contents of a TiddlyWiki from an HTML DIV
TiddlyWiki.prototype.loadFromDiv = function(src,idPrefix,noUpdate)
{
	this.idPrefix = idPrefix;
	var storeElem = (typeof src == "string") ? document.getElementById(src) : src;
	if(!storeElem)
		return;
	var tiddlers = this.getLoader().loadTiddlers(this,storeElem.childNodes);
	this.setDirty(false);
	if(!noUpdate) {
		for(var i = 0;i<tiddlers.length; i++)
			tiddlers[i].changed();
	}
	jQuery().trigger("loadTiddlers");
};

// Load contents of a TiddlyWiki from a string
// Returns null if there's an error
TiddlyWiki.prototype.importTiddlyWiki = function(text)
{
	var posDiv = locateStoreArea(text);
	if(!posDiv)
		return null;
	var content = "<" + "html><" + "body>" + text.substring(posDiv[0],posDiv[1] + endSaveArea.length) + "<" + "/body><" + "/html>";
	// Create the iframe
	var iframe = document.createElement("iframe");
	iframe.style.display = "none";
	document.body.appendChild(iframe);
	var doc = iframe.document;
	if(iframe.contentDocument)
		doc = iframe.contentDocument; // For NS6
	else if(iframe.contentWindow)
		doc = iframe.contentWindow.document; // For IE5.5 and IE6
	// Put the content in the iframe
	doc.open();
	doc.writeln(content);
	doc.close();
	// Load the content into a TiddlyWiki() object
	var storeArea = doc.getElementById("storeArea");
	this.loadFromDiv(storeArea,"store");
	// Get rid of the iframe
	iframe.parentNode.removeChild(iframe);
	return this;
};

TiddlyWiki.prototype.updateTiddlers = function()
{
	this.tiddlersUpdated = true;
	this.forEachTiddler(function(title,tiddler) {
		tiddler.changed();
	});
};

// Return an array of tiddlers matching a search regular expression
TiddlyWiki.prototype.search = function(searchRegExp,sortField,excludeTag,match)
{
	var candidates = this.reverseLookup("tags",excludeTag,!!match);
	var results = [];
	for(var t=0; t<candidates.length; t++) {
		if((candidates[t].title.search(searchRegExp) != -1) || (candidates[t].text.search(searchRegExp) != -1))
			results.push(candidates[t]);
	}
	if(!sortField)
		sortField = "title";
	results.sort(function(a,b) {return a[sortField] < b[sortField] ? -1 : (a[sortField] == b[sortField] ? 0 : +1);});
	return results;
};

// Returns a list of all tags in use
//   excludeTag - if present, excludes tags that are themselves tagged with excludeTag
// Returns an array of arrays where [tag][0] is the name of the tag and [tag][1] is the number of occurances
TiddlyWiki.prototype.getTags = function(excludeTag)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		for(var g=0; g<tiddler.tags.length; g++) {
			var tag = tiddler.tags[g];
			var n = true;
			for(var c=0; c<results.length; c++) {
				if(results[c][0] == tag) {
					n = false;
					results[c][1]++;
				}
			}
			if(n && excludeTag) {
				var t = this.fetchTiddler(tag);
				if(t && t.isTagged(excludeTag))
					n = false;
			}
			if(n)
				results.push([tag,1]);
		}
	});
	results.sort(function(a,b) {return a[0].toLowerCase() < b[0].toLowerCase() ? -1 : (a[0].toLowerCase() == b[0].toLowerCase() ? 0 : +1);});
	return results;
};

// Return an array of the tiddlers that are tagged with a given tag
TiddlyWiki.prototype.getTaggedTiddlers = function(tag,sortField)
{
	return this.reverseLookup("tags",tag,true,sortField);
};

// Return an array of the tiddlers that link to a given tiddler
TiddlyWiki.prototype.getReferringTiddlers = function(title,unusedParameter,sortField)
{
	if(!this.tiddlersUpdated)
		this.updateTiddlers();
	return this.reverseLookup("links",title,true,sortField);
};

// Return an array of the tiddlers that do or do not have a specified entry in the specified storage array (ie, "links" or "tags")
// lookupMatch == true to match tiddlers, false to exclude tiddlers
TiddlyWiki.prototype.reverseLookup = function(lookupField,lookupValue,lookupMatch,sortField)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		var f = !lookupMatch;
		for(var lookup=0; lookup<tiddler[lookupField].length; lookup++) {
			if(tiddler[lookupField][lookup] == lookupValue)
				f = lookupMatch;
		}
		if(f)
			results.push(tiddler);
	});
	if(!sortField)
		sortField = "title";
	results.sort(function(a,b) {return a[sortField] < b[sortField] ? -1 : (a[sortField] == b[sortField] ? 0 : +1);});
	return results;
};

// Return the tiddlers as a sorted array
TiddlyWiki.prototype.getTiddlers = function(field,excludeTag)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		if(excludeTag == undefined || !tiddler.isTagged(excludeTag))
			results.push(tiddler);
	});
	if(field)
		results.sort(function(a,b) {return a[field] < b[field] ? -1 : (a[field] == b[field] ? 0 : +1);});
	return results;
};

// Return array of names of tiddlers that are referred to but not defined
TiddlyWiki.prototype.getMissingLinks = function(sortField)
{
	if(!this.tiddlersUpdated)
		this.updateTiddlers();
	var results = [];
	this.forEachTiddler(function (title,tiddler) {
		if(tiddler.isTagged("excludeMissing") || tiddler.isTagged("systemConfig"))
			return;
		for(var n=0; n<tiddler.links.length;n++) {
			var link = tiddler.links[n];
			if(this.fetchTiddler(link) == null && !this.isShadowTiddler(link))
				results.pushUnique(link);
		}
	});
	results.sort();
	return results;
};

// Return an array of names of tiddlers that are defined but not referred to
TiddlyWiki.prototype.getOrphans = function()
{
	var results = [];
	this.forEachTiddler(function (title,tiddler) {
		if(this.getReferringTiddlers(title).length == 0 && !tiddler.isTagged("excludeLists"))
			results.push(title);
	});
	results.sort();
	return results;
};

// Return an array of names of all the shadow tiddlers
TiddlyWiki.prototype.getShadowed = function()
{
	var results = [];
	for(var t in config.shadowTiddlers) {
		if(this.isShadowTiddler(t))
			results.push(t);
	}
	results.sort();
	return results;
};

// Return an array of tiddlers that have been touched since they were downloaded or created
TiddlyWiki.prototype.getTouched = function()
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		if(tiddler.isTouched())
			results.push(tiddler);
		});
	results.sort();
	return results;
};

// Resolves a Tiddler reference or tiddler title into a Tiddler object, or null if it doesn't exist
TiddlyWiki.prototype.resolveTiddler = function(tiddler)
{
	var t = (typeof tiddler == "string") ? this.getTiddler(tiddler) : tiddler;
	return t instanceof Tiddler ? t : null;
};

// Filter a list of tiddlers
TiddlyWiki.prototype.filterTiddlers = function(filter)
{
	var results = [];
	if(filter) {
		var tiddler;
		var re = /([^\s\[\]]+)|(?:\[([ \w]+)\[([^\]]+)\]\])|(?:\[\[([^\]]+)\]\])/mg;
		var match = re.exec(filter);
		while(match) {
			if(match[1] || match[4]) {
				var title = match[1] || match[4];
				tiddler = this.fetchTiddler(title);
				if(tiddler) {
					results.pushUnique(tiddler);
				} else if(this.isShadowTiddler(title)) {
					tiddler = new Tiddler();
					tiddler.set(title,this.getTiddlerText(title));
					results.pushUnique(tiddler);
				} else {
					results.pushUnique(new Tiddler(title));
				}
			} else if(match[2]) {
				switch(match[2]) {
					case "tag":
						var matched = this.getTaggedTiddlers(match[3]);
						for(var m = 0; m < matched.length; m++)
							results.pushUnique(matched[m]);
						break;
					case "sort":
						results = this.sortTiddlers(results,match[3]);
						break;
				}
			}
			match = re.exec(filter);
		}
	}
	return results;
};

// Sort a list of tiddlers
TiddlyWiki.prototype.sortTiddlers = function(tiddlers,field)
{
	var asc = +1;
	switch(field.substr(0,1)) {
	case "-":
		asc = -1;
		// Note: this fall-through is intentional
		/*jsl:fallthru*/
	case "+":
		field = field.substr(1);
		break;
	}
	if(TiddlyWiki.standardFieldAccess[field])
		tiddlers.sort(function(a,b) {return a[field] < b[field] ? -asc : (a[field] == b[field] ? 0 : asc);});
	else
		tiddlers.sort(function(a,b) {return a.fields[field] < b.fields[field] ? -asc : (a.fields[field] == b.fields[field] ? 0 : +asc);});
	return tiddlers;
};

// Returns true if path is a valid field name (path),
// i.e. a sequence of identifiers, separated by "."
TiddlyWiki.isValidFieldName = function(name)
{
	var match = /[a-zA-Z_]\w*(\.[a-zA-Z_]\w*)*/.exec(name);
	return match && (match[0] == name);
};

// Throws an exception when name is not a valid field name.
TiddlyWiki.checkFieldName = function(name)
{
	if(!TiddlyWiki.isValidFieldName(name))
		throw config.messages.invalidFieldName.format([name]);
};

function StringFieldAccess(n,readOnly)
{
	this.set = readOnly ?
			function(t,v) {if(v != t[n]) throw config.messages.fieldCannotBeChanged.format([n]);} :
			function(t,v) {if(v != t[n]) {t[n] = v; return true;}};
	this.get = function(t) {return t[n];};
}

function DateFieldAccess(n)
{
	this.set = function(t,v) {
		var d = v instanceof Date ? v : Date.convertFromYYYYMMDDHHMM(v);
		if(d != t[n]) {
			t[n] = d; return true;
		}
	};
	this.get = function(t) {return t[n].convertToYYYYMMDDHHMM();};
}

function LinksFieldAccess(n)
{
	this.set = function(t,v) {
		var s = (typeof v == "string") ? v.readBracketedList() : v;
		if(s.toString() != t[n].toString()) {
			t[n] = s; return true;
		}
	};
	this.get = function(t) {return String.encodeTiddlyLinkList(t[n]);};
}

TiddlyWiki.standardFieldAccess = {
	// The set functions return true when setting the data has changed the value.
	"title":    new StringFieldAccess("title",true),
	// Handle the "tiddler" field name as the title
	"tiddler":  new StringFieldAccess("title",true),
	"text":     new StringFieldAccess("text"),
	"modifier": new StringFieldAccess("modifier"),
	"modified": new DateFieldAccess("modified"),
	"creator":  new StringFieldAccess("creator"),
	"created":  new DateFieldAccess("created"),
	"tags":     new LinksFieldAccess("tags")
};

TiddlyWiki.isStandardField = function(name)
{
	return TiddlyWiki.standardFieldAccess[name] != undefined;
};

// Sets the value of the given field of the tiddler to the value.
// Setting an ExtendedField's value to null or undefined removes the field.
// Setting a namespace to undefined removes all fields of that namespace.
// The fieldName is case-insensitive.
// All values will be converted to a string value.
TiddlyWiki.prototype.setValue = function(tiddler,fieldName,value)
{
	TiddlyWiki.checkFieldName(fieldName);
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return;
	fieldName = fieldName.toLowerCase();
	var isRemove = (value === undefined) || (value === null);
	var accessor = TiddlyWiki.standardFieldAccess[fieldName];
	if(accessor) {
		if(isRemove)
			// don't remove StandardFields
			return;
		var h = TiddlyWiki.standardFieldAccess[fieldName];
		if(!h.set(t,value))
			return;
	} else {
		var oldValue = t.fields[fieldName];
		if(isRemove) {
			if(oldValue !== undefined) {
				// deletes a single field
				delete t.fields[fieldName];
			} else {
				// no concrete value is defined for the fieldName
				// so we guess this is a namespace path.
				// delete all fields in a namespace
				var re = new RegExp("^"+fieldName+"\\.");
				var dirty = false;
				for(var n in t.fields) {
					if(n.match(re)) {
						delete t.fields[n];
						dirty = true;
					}
				}
				if(!dirty)
					return;
			}
		} else {
			// the "normal" set case. value is defined (not null/undefined)
			// For convenience provide a nicer conversion Date->String
			value = value instanceof Date ? value.convertToYYYYMMDDHHMMSSMMM() : String(value);
			if(oldValue == value)
				return;
			t.fields[fieldName] = value;
		}
	}
	// When we are here the tiddler/store really was changed.
	this.notify(t.title,true);
	if(!fieldName.match(/^temp\./))
		this.setDirty(true);
};

// Returns the value of the given field of the tiddler.
// The fieldName is case-insensitive.
// Will only return String values (or undefined).
TiddlyWiki.prototype.getValue = function(tiddler,fieldName)
{
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return undefined;
	fieldName = fieldName.toLowerCase();
	var accessor = TiddlyWiki.standardFieldAccess[fieldName];
	if(accessor) {
		return accessor.get(t);
	}
	return t.fields[fieldName];
};

// Calls the callback function for every field in the tiddler.
// When callback function returns a non-false value the iteration stops
// and that value is returned.
// The order of the fields is not defined.
// @param callback a function(tiddler,fieldName,value).
TiddlyWiki.prototype.forEachField = function(tiddler,callback,onlyExtendedFields)
{
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return undefined;
	var n,result;
	for(n in t.fields) {
		result = callback(t,n,t.fields[n]);
		if(result)
			return result;
		}
	if(onlyExtendedFields)
		return undefined;
	for(n in TiddlyWiki.standardFieldAccess) {
		if(n == "tiddler")
			// even though the "title" field can also be referenced through the name "tiddler"
			// we only visit this field once.
			continue;
		result = callback(t,n,TiddlyWiki.standardFieldAccess[n].get(t));
		if(result)
			return result;
	}
	return undefined;
};

//--
//-- Story functions
//--

function Story(containerId,idPrefix)
{
	this.container = containerId;
	this.idPrefix = idPrefix;
	this.highlightRegExp = null;
	this.tiddlerId = function(title) {
		var id = this.idPrefix + title;
		return id==this.container ? this.idPrefix + "_" + title : id;
	};
	this.containerId = function() {
		return this.container;
	};
}

Story.prototype.getTiddler = function(title)
{
	return document.getElementById(this.tiddlerId(title));
};

Story.prototype.getContainer = function()
{
	return document.getElementById(this.containerId());
};

Story.prototype.forEachTiddler = function(fn)
{
	var place = this.getContainer();
	if(!place)
		return;
	var e = place.firstChild;
	while(e) {
		var n = e.nextSibling;
		var title = e.getAttribute("tiddler");
		fn.call(this,title,e);
		e = n;
	}
};

Story.prototype.displayDefaultTiddlers = function()
{
	this.displayTiddlers(null,store.filterTiddlers(store.getTiddlerText("DefaultTiddlers")));
};

Story.prototype.displayTiddlers = function(srcElement,titles,template,animate,unused,customFields,toggle)
{
	for(var t = titles.length-1;t>=0;t--)
		this.displayTiddler(srcElement,titles[t],template,animate,unused,customFields);
};

Story.prototype.displayTiddler = function(srcElement,tiddler,template,animate,unused,customFields,toggle,animationSrc)
{
	var title = (tiddler instanceof Tiddler) ? tiddler.title : tiddler;
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		if(toggle)
			this.closeTiddler(title,true);
		else
			this.refreshTiddler(title,template,false,customFields);
	} else {
		var place = this.getContainer();
		var before = this.positionTiddler(srcElement);
		tiddlerElem = this.createTiddler(place,before,title,template,customFields);
	}
	if(animationSrc && typeof animationSrc !== "string") {
		srcElement = animationSrc;
	}
	if(srcElement && typeof srcElement !== "string") {
		if(config.options.chkAnimate && (animate == undefined || animate == true) && anim && typeof Zoomer == "function" && typeof Scroller == "function")
			anim.startAnimating(new Zoomer(title,srcElement,tiddlerElem),new Scroller(tiddlerElem));
		else
			window.scrollTo(0,ensureVisible(tiddlerElem));
	}
	return tiddlerElem;
};

Story.prototype.positionTiddler = function(srcElement)
{
	var place = this.getContainer();
	var before = null;
	if(typeof srcElement == "string") {
		switch(srcElement) {
		case "top":
			before = place.firstChild;
			break;
		case "bottom":
			before = null;
			break;
		}
	} else {
		var after = this.findContainingTiddler(srcElement);
		if(after == null) {
			before = place.firstChild;
		} else if(after.nextSibling) {
			before = after.nextSibling;
			if(before.nodeType != 1)
				before = null;
		}
	}
	return before;
};

Story.prototype.createTiddler = function(place,before,title,template,customFields)
{
	var tiddlerElem = createTiddlyElement(null,"div",this.tiddlerId(title),"tiddler");
	tiddlerElem.setAttribute("refresh","tiddler");
	if(customFields)
		tiddlerElem.setAttribute("tiddlyFields",customFields);
	place.insertBefore(tiddlerElem,before);
	var defaultText = null;
	if(!store.tiddlerExists(title) && !store.isShadowTiddler(title))
		defaultText = this.loadMissingTiddler(title,customFields,tiddlerElem);
	this.refreshTiddler(title,template,false,customFields,defaultText);
	return tiddlerElem;
};

Story.prototype.loadMissingTiddler = function(title,fields,tiddlerElem)
{
	var getTiddlerCallback = function(context)
	{
		if(context.status) {
			var t = context.tiddler;
			if(!t.created)
				t.created = new Date();
			if(!t.modified)
				t.modified = t.created;
			store.saveTiddler(t.title,t.title,t.text,t.modifier,t.modified,t.tags,t.fields,true,t.created,t.creator);
			autoSaveChanges();
		} else {
			story.refreshTiddler(context.title,null,true);
		}
		context.adaptor.close();
		delete context.adaptor;
	};
	var tiddler = new Tiddler(title);
	tiddler.fields = typeof fields == "string" ? fields.decodeHashMap() : fields||{};
	var context = {serverType:tiddler.getServerType()};
	if(!context.serverType)
		return;
	context.host = tiddler.fields['server.host'];
	context.workspace = tiddler.fields['server.workspace'];
	var adaptor = new config.adaptors[context.serverType];
	adaptor.getTiddler(title,context,null,getTiddlerCallback);
	return config.messages.loadingMissingTiddler.format([title,context.serverType,context.host,context.workspace]);
};

Story.prototype.chooseTemplateForTiddler = function(title,template)
{
	if(!template)
		template = DEFAULT_VIEW_TEMPLATE;
	if(template == DEFAULT_VIEW_TEMPLATE || template == DEFAULT_EDIT_TEMPLATE)
		template = config.tiddlerTemplates[template];
	return template;
};

Story.prototype.getTemplateForTiddler = function(title,template,tiddler)
{
	return store.getRecursiveTiddlerText(template,null,10);
};

Story.prototype.refreshTiddler = function(title,template,force,customFields,defaultText)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		if(tiddlerElem.getAttribute("dirty") == "true" && !force)
			return tiddlerElem;
		template = this.chooseTemplateForTiddler(title,template);
		var currTemplate = tiddlerElem.getAttribute("template");
		if((template != currTemplate) || force) {
			var tiddler = store.getTiddler(title);
			if(!tiddler) {
				tiddler = new Tiddler();
				if(store.isShadowTiddler(title)) {
					var tags = [];
					tiddler.set(title,store.getTiddlerText(title),config.views.wikified.shadowModifier,version.date,tags,version.date);
				} else {
					var text = template=="EditTemplate" ?
								config.views.editor.defaultText.format([title]) :
								config.views.wikified.defaultText.format([title]);
					text = defaultText || text;
					var fields = customFields ? customFields.decodeHashMap() : null;
					tiddler.set(title,text,config.views.wikified.defaultModifier,version.date,[],version.date,fields);
				}
			}
			tiddlerElem.setAttribute("tags",tiddler.tags.join(" "));
			tiddlerElem.setAttribute("tiddler",title);
			tiddlerElem.setAttribute("template",template);
			tiddlerElem.onmouseover = this.onTiddlerMouseOver;
			tiddlerElem.onmouseout = this.onTiddlerMouseOut;
			tiddlerElem.ondblclick = this.onTiddlerDblClick;
			tiddlerElem[window.event?"onkeydown":"onkeypress"] = this.onTiddlerKeyPress;
			tiddlerElem.innerHTML = this.getTemplateForTiddler(title,template,tiddler);
			applyHtmlMacros(tiddlerElem,tiddler);
			if(store.getTaggedTiddlers(title).length > 0)
				addClass(tiddlerElem,"isTag");
			else
				removeClass(tiddlerElem,"isTag");
			if(store.tiddlerExists(title)) {
				removeClass(tiddlerElem,"shadow");
				removeClass(tiddlerElem,"missing");
			} else {
				addClass(tiddlerElem, store.isShadowTiddler(title) ? "shadow" : "missing");
			}
			if(customFields)
				this.addCustomFields(tiddlerElem,customFields);
			forceReflow();
		}
	}
	return tiddlerElem;
};

Story.prototype.addCustomFields = function(place,customFields)
{
	var fields = customFields.decodeHashMap();
	var w = createTiddlyElement(place,"div",null,"customFields");
	w.style.display = "none";
	for(var t in fields) {
		var e = document.createElement("input");
		e.setAttribute("type","text");
		e.setAttribute("value",fields[t]);
		w.appendChild(e);
		e.setAttribute("edit",t);
	}
};

Story.prototype.refreshAllTiddlers = function(force)
{
	var e = this.getContainer().firstChild;
	while(e) {
		var template = e.getAttribute("template");
		if(template && e.getAttribute("dirty") != "true") {
			this.refreshTiddler(e.getAttribute("tiddler"),force ? null : template,true);
		}
		e = e.nextSibling;
	}
};

Story.prototype.onTiddlerMouseOver = function(e)
{
	addClass(this, "selected");
};

Story.prototype.onTiddlerMouseOut = function(e)
{
	removeClass(this,"selected");
};

Story.prototype.onTiddlerDblClick = function(ev)
{
	var e = ev || window.event;
	var target = resolveTarget(e);
	if(target && target.nodeName.toLowerCase() != "input" && target.nodeName.toLowerCase() != "textarea") {
		if(document.selection && document.selection.empty)
			document.selection.empty();
		config.macros.toolbar.invokeCommand(this,"defaultCommand",e);
		e.cancelBubble = true;
		if(e.stopPropagation) e.stopPropagation();
		return true;
	}
	return false;
};

Story.prototype.onTiddlerKeyPress = function(ev)
{
	var e = ev || window.event;
	clearMessage();
	var consume = false;
	var title = this.getAttribute("tiddler");
	var target = resolveTarget(e);
	switch(e.keyCode) {
	case 9: // Tab
		if(config.options.chkInsertTabs && target.tagName.toLowerCase() == "textarea") {
			replaceSelection(target,String.fromCharCode(9));
			consume = true;
		}
		if(config.isOpera) {
			target.onblur = function() {
				this.focus();
				this.onblur = null;
			};
		}
		break;
	case 13: // Ctrl-Enter
	case 10: // Ctrl-Enter on IE PC
	case 77: // Ctrl-Enter is "M" on some platforms
		if(e.ctrlKey) {
			blurElement(this);
			config.macros.toolbar.invokeCommand(this,"defaultCommand",e);
			consume = true;
		}
		break;
	case 27: // Escape
		blurElement(this);
		config.macros.toolbar.invokeCommand(this,"cancelCommand",e);
		consume = true;
		break;
	}
	e.cancelBubble = consume;
	if(consume) {
		if(e.stopPropagation) e.stopPropagation(); // Stop Propagation
		e.returnValue = true; // Cancel The Event in IE
		if(e.preventDefault ) e.preventDefault(); // Cancel The Event in Moz
	}
	return !consume;
};

Story.prototype.getTiddlerField = function(title,field)
{
	var tiddlerElem = this.getTiddler(title);
	var e = null;
	if(tiddlerElem ) {
		var children = tiddlerElem.getElementsByTagName("*");
		for(var t=0; t<children.length; t++) {
			var c = children[t];
			if(c.tagName.toLowerCase() == "input" || c.tagName.toLowerCase() == "textarea") {
				if(!e)
					e = c;
				if(c.getAttribute("edit") == field)
					e = c;
			}
		}
	}
	return e;
};

Story.prototype.focusTiddler = function(title,field)
{
	var e = this.getTiddlerField(title,field);
	if(e) {
		e.focus();
		e.select();
	}
};

Story.prototype.blurTiddler = function(title)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem && tiddlerElem.focus && tiddlerElem.blur) {
		tiddlerElem.focus();
		tiddlerElem.blur();
	}
};

Story.prototype.setTiddlerField = function(title,tag,mode,field)
{
	var c = this.getTiddlerField(title,field);
	var tags = c.value.readBracketedList();
	tags.setItem(tag,mode);
	c.value = String.encodeTiddlyLinkList(tags);
};

Story.prototype.setTiddlerTag = function(title,tag,mode)
{
	this.setTiddlerField(title,tag,mode,"tags");
};

Story.prototype.closeTiddler = function(title,animate,unused)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		clearMessage();
		this.scrubTiddler(tiddlerElem);
		if(config.options.chkAnimate && animate && anim && typeof Slider == "function")
			anim.startAnimating(new Slider(tiddlerElem,false,null,"all"));
		else {
			removeNode(tiddlerElem);
			forceReflow();
		}
	}
};

Story.prototype.scrubTiddler = function(tiddlerElem)
{
	tiddlerElem.id = null;
};

Story.prototype.setDirty = function(title,dirty)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem)
		tiddlerElem.setAttribute("dirty",dirty ? "true" : "false");
};

Story.prototype.isDirty = function(title)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem)
		return tiddlerElem.getAttribute("dirty") == "true";
	return null;
};

Story.prototype.areAnyDirty = function()
{
	var r = false;
	this.forEachTiddler(function(title,element) {
		if(this.isDirty(title))
			r = true;
	});
	return r;
};

Story.prototype.closeAllTiddlers = function(exclude)
{
	clearMessage();
	this.forEachTiddler(function(title,element) {
		if((title != exclude) && element.getAttribute("dirty") != "true")
			this.closeTiddler(title);
	});
	window.scrollTo(0,ensureVisible(this.container));
};

Story.prototype.isEmpty = function()
{
	var place = this.getContainer();
	return place && place.firstChild == null;
};

Story.prototype.search = function(text,useCaseSensitive,useRegExp)
{
	this.closeAllTiddlers();
	highlightHack = new RegExp(useRegExp ? text : text.escapeRegExp(),useCaseSensitive ? "mg" : "img");
	var matches = store.search(highlightHack,"title","excludeSearch");
	this.displayTiddlers(null,matches);
	highlightHack = null;
	var q = useRegExp ? "/" : "'";
	if(matches.length > 0)
		displayMessage(config.macros.search.successMsg.format([matches.length.toString(),q + text + q]));
	else
		displayMessage(config.macros.search.failureMsg.format([q + text + q]));
};

Story.prototype.findContainingTiddler = function(e)
{
	while(e && !hasClass(e,"tiddler"))
		e = hasClass(e,"popup") ? Popup.stack[0].root : e.parentNode;
	return e;
};

Story.prototype.gatherSaveFields = function(e,fields)
{
	if(e && e.getAttribute) {
		var f = e.getAttribute("edit");
		if(f)
			fields[f] = e.value.replace(/\r/mg,"");
		if(e.hasChildNodes()) {
			var c = e.childNodes;
			for(var t=0; t<c.length; t++)
				this.gatherSaveFields(c[t],fields);
		}
	}
};

Story.prototype.hasChanges = function(title)
{
	var e = this.getTiddler(title);
	if(e) {
		var fields = {};
		this.gatherSaveFields(e,fields);
		if(store.fetchTiddler(title)) {
			for(var n in fields) {
				if(store.getValue(title,n) != fields[n]) //# tiddler changed
					return true;
			}
		} else {
			if(store.isShadowTiddler(title) && store.getShadowTiddlerText(title) == fields.text) { //# not checking for title or tags
				return false;
			} else { //# changed shadow or new tiddler
				return true;
			}
		}
	}
	return false;
};

Story.prototype.saveTiddler = function(title,minorUpdate)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		var fields = {};
		this.gatherSaveFields(tiddlerElem,fields);
		var newTitle = fields.title || title;
		if(!store.tiddlerExists(newTitle)) {
			newTitle = newTitle.trim();
			var creator = config.options.txtUserName;
		}
		if(store.tiddlerExists(newTitle) && newTitle != title) {
			if(!confirm(config.messages.overwriteWarning.format([newTitle.toString()])))
				return null;
		}
		if(newTitle != title)
			this.closeTiddler(newTitle,false);
		tiddlerElem.id = this.tiddlerId(newTitle);
		tiddlerElem.setAttribute("tiddler",newTitle);
		tiddlerElem.setAttribute("template",DEFAULT_VIEW_TEMPLATE);
		tiddlerElem.setAttribute("dirty","false");
		if(config.options.chkForceMinorUpdate)
			minorUpdate = !minorUpdate;
		if(!store.tiddlerExists(newTitle))
			minorUpdate = false;
		var newDate = new Date();
		if(store.tiddlerExists(title)) {
			var t = store.fetchTiddler(title);
			var extendedFields = t.fields;
			creator = t.creator;
		} else {
			extendedFields = merge({},config.defaultCustomFields);
		}
		for(var n in fields) {
			if(!TiddlyWiki.isStandardField(n))
				extendedFields[n] = fields[n];
		}
		var tiddler = store.saveTiddler(title,newTitle,fields.text,minorUpdate ? undefined : config.options.txtUserName,minorUpdate ? undefined : newDate,fields.tags,extendedFields,null,null,creator);
		autoSaveChanges(null,[tiddler]);
		return newTitle;
	}
	return null;
};

Story.prototype.permaView = function()
{
	var links = [];
	this.forEachTiddler(function(title,element) {
		links.push(String.encodeTiddlyLink(title));
	});
	var t = encodeURIComponent(links.join(" "));
	if(t == "")
		t = "#";
	if(window.location.hash != t)
		window.location.hash = t;
};

Story.prototype.switchTheme = function(theme)
{
	if(safeMode)
		return;

	var isAvailable = function(title) {
		var s = title ? title.indexOf(config.textPrimitives.sectionSeparator) : -1;
		if(s!=-1)
			title = title.substr(0,s);
		return store.tiddlerExists(title) || store.isShadowTiddler(title);
	};

	var getSlice = function(theme,slice) {
		var r;
		if(readOnly)
			r = store.getTiddlerSlice(theme,slice+"ReadOnly") || store.getTiddlerSlice(theme,"Web"+slice);
		r = r || store.getTiddlerSlice(theme,slice);
		if(r && r.indexOf(config.textPrimitives.sectionSeparator)==0)
			r = theme + r;
		return isAvailable(r) ? r : slice;
	};

	var replaceNotification = function(i,name,theme,slice) {
		var newName = getSlice(theme,slice);
		if(name!=newName && store.namedNotifications[i].name==name) {
			store.namedNotifications[i].name = newName;
			return newName;
		}
		return name;
	};

	var pt = config.refresherData.pageTemplate;
	var vi = DEFAULT_VIEW_TEMPLATE;
	var vt = config.tiddlerTemplates[vi];
	var ei = DEFAULT_EDIT_TEMPLATE;
	var et = config.tiddlerTemplates[ei];

	for(var i=0; i<config.notifyTiddlers.length; i++) {
		var name = config.notifyTiddlers[i].name;
		switch(name) {
		case "PageTemplate":
			config.refresherData.pageTemplate = replaceNotification(i,config.refresherData.pageTemplate,theme,name);
			break;
		case "StyleSheet":
			removeStyleSheet(config.refresherData.styleSheet);
			config.refresherData.styleSheet = replaceNotification(i,config.refresherData.styleSheet,theme,name);
			break;
		case "ColorPalette":
			config.refresherData.colorPalette = replaceNotification(i,config.refresherData.colorPalette,theme,name);
			break;
		default:
			break;
		}
	}
	config.tiddlerTemplates[vi] = getSlice(theme,"ViewTemplate");
	config.tiddlerTemplates[ei] = getSlice(theme,"EditTemplate");
	if(!startingUp) {
		if(config.refresherData.pageTemplate!=pt || config.tiddlerTemplates[vi]!=vt || config.tiddlerTemplates[ei]!=et) {
			refreshAll();
			this.refreshAllTiddlers(true);
		} else {
			setStylesheet(store.getRecursiveTiddlerText(config.refresherData.styleSheet,"",10),config.refreshers.styleSheet);
		}
		config.options.txtTheme = theme;
		saveOptionCookie("txtTheme");
	}
};

//--
//-- Backstage
//--

var backstage = {
	area: null,
	toolbar: null,
	button: null,
	showButton: null,
	hideButton: null,
	cloak: null,
	panel: null,
	panelBody: null,
	panelFooter: null,
	currTabName: null,
	currTabElem: null,
	content: null,

	init: function() {
		var cmb = config.messages.backstage;
		this.area = document.getElementById("backstageArea");
		this.toolbar = document.getElementById("backstageToolbar");
		this.button = document.getElementById("backstageButton");
		this.button.style.display = "block";
		var t = cmb.open.text + " " + glyph("bentArrowLeft");
		this.showButton = createTiddlyButton(this.button,t,cmb.open.tooltip,
						function(e) {backstage.show(); return false;},null,"backstageShow");
		t = glyph("bentArrowRight") + " " + cmb.close.text;
		this.hideButton = createTiddlyButton(this.button,t,cmb.close.tooltip,
						function(e) {backstage.hide(); return false;},null,"backstageHide");
		this.cloak = document.getElementById("backstageCloak");
		this.panel = document.getElementById("backstagePanel");
		this.panelFooter = createTiddlyElement(this.panel,"div",null,"backstagePanelFooter");
		this.panelBody = createTiddlyElement(this.panel,"div",null,"backstagePanelBody");
		this.cloak.onmousedown = function(e) {backstage.switchTab(null);};
		createTiddlyText(this.toolbar,cmb.prompt);
		for(t=0; t<config.backstageTasks.length; t++) {
			var taskName = config.backstageTasks[t];
			var task = config.tasks[taskName];
			var handler = task.action ? this.onClickCommand : this.onClickTab;
			var text = task.text + (task.action ? "" : glyph("downTriangle"));
			var btn = createTiddlyButton(this.toolbar,text,task.tooltip,handler,"backstageTab");
			addClass(btn,task.action ? "backstageAction" : "backstageTask");
			btn.setAttribute("task", taskName);
			}
		this.content = document.getElementById("contentWrapper");
		if(config.options.chkBackstage)
			this.show();
		else
			this.hide();
	},

	isVisible: function() {
		return this.area ? this.area.style.display == "block" : false;
	},

	show: function() {
		this.area.style.display = "block";
		if(anim && config.options.chkAnimate) {
			backstage.toolbar.style.left = findWindowWidth() + "px";
			var p = [{style: "left", start: findWindowWidth(), end: 0, template: "%0px"}];
			anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,p));
		} else {
			backstage.area.style.left = "0px";
		}
		jQuery(this.showButton).hide();
		jQuery(this.hideButton).show();
		config.options.chkBackstage = true;
		saveOptionCookie("chkBackstage");
		addClass(this.content,"backstageVisible");
	},

	hide: function() {
		if(this.currTabElem) {
			this.switchTab(null);
		} else {
			backstage.toolbar.style.left = "0px";
			if(anim && config.options.chkAnimate) {
				var p = [{style: "left", start: 0, end: findWindowWidth(), template: "%0px"}];
				var c = function(element,properties) {backstage.area.style.display = "none";};
				anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,p,c));
			} else {
				this.area.style.display = "none";
			}
			this.showButton.style.display = "block";
			this.hideButton.style.display = "none";
			config.options.chkBackstage = false;
			saveOptionCookie("chkBackstage");
			removeClass(this.content, "backstageVisible");
		}
	},

	onClickCommand: function(e) {
		var task = config.tasks[this.getAttribute("task")];
		if(task.action) {
			backstage.switchTab(null);
			task.action();
		}
		return false;
	},

	onClickTab: function(e) {
		backstage.switchTab(this.getAttribute("task"));
		return false;
	},

	// Switch to a given tab, or none if null is passed
	switchTab: function(tabName) {
		var tabElem = null;
		var e = this.toolbar.firstChild;
		while(e)
			{
			if(e.getAttribute && e.getAttribute("task") == tabName)
				tabElem = e;
			e = e.nextSibling;
			}
		if(tabName == backstage.currTabName) {
			backstage.hidePanel();
			return;
		}
		if(backstage.currTabElem) {
			removeClass(this.currTabElem, "backstageSelTab");
		}
		if(tabElem && tabName) {
			backstage.preparePanel();
			addClass(tabElem,"backstageSelTab");
			var task = config.tasks[tabName];
			wikify(task.content,backstage.panelBody,null,null);
			backstage.showPanel();
		} else if(backstage.currTabElem) {
			backstage.hidePanel();
		}
		backstage.currTabName = tabName;
		backstage.currTabElem = tabElem;
	},

	isPanelVisible: function() {
		return backstage.panel ? backstage.panel.style.display == "block" : false;
	},

	preparePanel: function() {
		backstage.cloak.style.height = findWindowHeight() + "px";
		backstage.cloak.style.display = "block";
		removeChildren(backstage.panelBody);
		return backstage.panelBody;
	},

	showPanel: function() {
		backstage.panel.style.display = "block";
		if(anim && config.options.chkAnimate) {
			backstage.panel.style.top = (-backstage.panel.offsetHeight) + "px";
			var p = [{style: "top", start: -backstage.panel.offsetHeight, end: 0, template: "%0px"}];
			anim.startAnimating(new Morpher(backstage.panel,config.animDuration,p),new Scroller(backstage.panel,false));
		} else {
			backstage.panel.style.top = "0px";
		}
		return backstage.panelBody;
	},

	hidePanel: function() {
		if(backstage.currTabElem)
			removeClass(backstage.currTabElem, "backstageSelTab");
		backstage.currTabElem = null;
		backstage.currTabName = null;
		if(anim && config.options.chkAnimate) {
			var p = [
				{style: "top", start: 0, end: -(backstage.panel.offsetHeight), template: "%0px"},
				{style: "display", atEnd: "none"}
			];
			var c = function(element,properties) {backstage.cloak.style.display = "none";};
			anim.startAnimating(new Morpher(backstage.panel,config.animDuration,p,c));
		} else {
			jQuery([backstage.panel,backstage.cloak]).hide();
		}
	}
};

config.macros.backstage = {};

config.macros.backstage.handler = function(place,macroName,params)
{
	var backstageTask = config.tasks[params[0]];
	if(backstageTask)
		createTiddlyButton(place,backstageTask.text,backstageTask.tooltip,function(e) {backstage.switchTab(params[0]); return false;});
};

//--
//-- ImportTiddlers macro
//--

config.macros.importTiddlers.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(readOnly) {
		createTiddlyElement(place,"div",null,"marked",this.readOnlyWarning);
		return;
	}
	var w = new Wizard();
	w.createWizard(place,this.wizardTitle);
	this.restart(w);
};

config.macros.importTiddlers.onCancel = function(e)
{
	var wizard = new Wizard(this);
	var place = wizard.clear();
	config.macros.importTiddlers.restart(wizard);
	return false;
};

config.macros.importTiddlers.onClose = function(e)
{
	backstage.hidePanel();
	return false;
};

config.macros.importTiddlers.restart = function(wizard)
{
	wizard.addStep(this.step1Title,this.step1Html);
	var s = wizard.getElement("selTypes");
	for(var t in config.adaptors) {
		var e = createTiddlyElement(s,"option",null,null,config.adaptors[t].serverLabel ? config.adaptors[t].serverLabel : t);
		e.value = t;
	}
	if(config.defaultAdaptor)
		s.value = config.defaultAdaptor;
	s = wizard.getElement("selFeeds");
	var feeds = this.getFeeds();
	for(t in feeds) {
		e = createTiddlyElement(s,"option",null,null,t);
		e.value = t;
	}
	wizard.setValue("feeds",feeds);
	s.onchange = config.macros.importTiddlers.onFeedChange;
	var fileInput = wizard.getElement("txtBrowse");
	fileInput.onchange = config.macros.importTiddlers.onBrowseChange;
	fileInput.onkeyup = config.macros.importTiddlers.onBrowseChange;
	wizard.setButtons([{caption: this.openLabel, tooltip: this.openPrompt, onClick: config.macros.importTiddlers.onOpen}]);
	wizard.formElem.action = "javascript:;";
	wizard.formElem.onsubmit = function() {
		if(!this.txtPath || this.txtPath.value.length) //# check for manually entered path in first step
			this.lastChild.firstChild.onclick();
	};
};

config.macros.importTiddlers.getFeeds = function()
{
	var feeds = {};
	var tagged = store.getTaggedTiddlers("systemServer","title");
	for(var t=0; t<tagged.length; t++) {
		var title = tagged[t].title;
		var serverType = store.getTiddlerSlice(title,"Type");
		if(!serverType)
			serverType = "file";
		feeds[title] = {title: title,
						url: store.getTiddlerSlice(title,"URL"),
						workspace: store.getTiddlerSlice(title,"Workspace"),
						workspaceList: store.getTiddlerSlice(title,"WorkspaceList"),
						tiddlerFilter: store.getTiddlerSlice(title,"TiddlerFilter"),
						serverType: serverType,
						description: store.getTiddlerSlice(title,"Description")};
	}
	return feeds;
};

config.macros.importTiddlers.onFeedChange = function(e)
{
	var wizard = new Wizard(this);
	var selTypes = wizard.getElement("selTypes");
	var fileInput = wizard.getElement("txtPath");
	var feeds = wizard.getValue("feeds");
	var f = feeds[this.value];
	if(f) {
		selTypes.value = f.serverType;
		fileInput.value = f.url;
		wizard.setValue("feedName",f.serverType);
		wizard.setValue("feedHost",f.url);
		wizard.setValue("feedWorkspace",f.workspace);
		wizard.setValue("feedWorkspaceList",f.workspaceList);
		wizard.setValue("feedTiddlerFilter",f.tiddlerFilter);
	}
	return false;
};

config.macros.importTiddlers.onBrowseChange = function(e)
{
	var wizard = new Wizard(this);
	var fileInput = wizard.getElement("txtPath");
	fileInput.value = config.macros.importTiddlers.getURLFromLocalPath(this.value);
	var serverType = wizard.getElement("selTypes");
	serverType.value = "file";
	return true;
};

config.macros.importTiddlers.getURLFromLocalPath = function(v)
{
	if(!v||!v.length)
		return v;
	v = v.replace(/\\/g,"/"); // use "/" for cross-platform consistency
	var u;
	var t = v.split(":");
	var p = t[1]||t[0]; // remove drive letter (if any)
	if (t[1] && (t[0]=="http"||t[0]=="https"||t[0]=="file")) {
		u = v;
	} else if(p.substr(0,1)=="/") {
		u = document.location.protocol + "//" + document.location.hostname + (t[1] ? "/" : "") + v;
	} else {
		var c = document.location.href.replace(/\\/g,"/");
		var pos = c.lastIndexOf("/");
		if (pos!=-1)
			c = c.substr(0,pos); // remove filename
		u = c + "/" + p;
	}
	return u;
};

config.macros.importTiddlers.onOpen = function(e)
{
	var wizard = new Wizard(this);
	var fileInput = wizard.getElement("txtPath");
	var url = fileInput.value;
	var serverType = wizard.getElement("selTypes").value || config.defaultAdaptor;
	var adaptor = new config.adaptors[serverType]();
	wizard.setValue("adaptor",adaptor);
	wizard.setValue("serverType",serverType);
	wizard.setValue("host",url);
	var ret = adaptor.openHost(url,null,wizard,config.macros.importTiddlers.onOpenHost);
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusOpenHost);
	return false;
};

config.macros.importTiddlers.onOpenHost = function(context,wizard)
{
	var adaptor = wizard.getValue("adaptor");
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onOpenHost: " + context.statusText);
	var ret = adaptor.getWorkspaceList(context,wizard,config.macros.importTiddlers.onGetWorkspaceList);
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusGetWorkspaceList);
};

config.macros.importTiddlers.onGetWorkspaceList = function(context,wizard)
{
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onGetWorkspaceList: " + context.statusText);
	wizard.setValue("context",context);
	var workspace = wizard.getValue("feedWorkspace");
	if(!workspace && context.workspaces.length==1)
		workspace = context.workspaces[0].title;
	if(workspace) {
		var ret = context.adaptor.openWorkspace(workspace,context,wizard,config.macros.importTiddlers.onOpenWorkspace);
		if(ret !== true)
			displayMessage(ret);
		wizard.setValue("workspace",workspace);
		wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusOpenWorkspace);
		return;
	}
	wizard.addStep(config.macros.importTiddlers.step2Title,config.macros.importTiddlers.step2Html);
	var s = wizard.getElement("selWorkspace");
	s.onchange = config.macros.importTiddlers.onWorkspaceChange;
	for(var t=0; t<context.workspaces.length; t++) {
		var e = createTiddlyElement(s,"option",null,null,context.workspaces[t].title);
		e.value = context.workspaces[t].title;
	}
	var workspaceList = wizard.getValue("feedWorkspaceList");
	if(workspaceList) {
		var list = workspaceList.parseParams("workspace",null,false,true);
		for(var n=1; n<list.length; n++) {
			if(context.workspaces.findByField("title",list[n].value) == null) {
				e = createTiddlyElement(s,"option",null,null,list[n].value);
				e.value = list[n].value;
			}
		}
	}
	if(workspace) {
		t = wizard.getElement("txtWorkspace");
		t.value = workspace;
	}
	wizard.setButtons([{caption: config.macros.importTiddlers.openLabel, tooltip: config.macros.importTiddlers.openPrompt, onClick: config.macros.importTiddlers.onChooseWorkspace}]);
};

config.macros.importTiddlers.onWorkspaceChange = function(e)
{
	var wizard = new Wizard(this);
	var t = wizard.getElement("txtWorkspace");
	t.value = this.value;
	this.selectedIndex = 0;
	return false;
};

config.macros.importTiddlers.onChooseWorkspace = function(e)
{
	var wizard = new Wizard(this);
	var adaptor = wizard.getValue("adaptor");
	var workspace = wizard.getElement("txtWorkspace").value;
	wizard.setValue("workspace",workspace);
	var context = wizard.getValue("context");
	var ret = adaptor.openWorkspace(workspace,context,wizard,config.macros.importTiddlers.onOpenWorkspace);
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusOpenWorkspace);
	return false;
};

config.macros.importTiddlers.onOpenWorkspace = function(context,wizard)
{
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onOpenWorkspace: " + context.statusText);
	var adaptor = wizard.getValue("adaptor");
	var ret = adaptor.getTiddlerList(context,wizard,config.macros.importTiddlers.onGetTiddlerList,wizard.getValue("feedTiddlerFilter"));
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusGetTiddlerList);
};

config.macros.importTiddlers.onGetTiddlerList = function(context,wizard)
{
	if(context.status !== true) {
		wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.errorGettingTiddlerList);
		return;
	}
	// Extract data for the listview
	var listedTiddlers = [];
	if(context.tiddlers) {
		for(var n=0; n<context.tiddlers.length; n++) {
			var tiddler = context.tiddlers[n];
			listedTiddlers.push({
				title: tiddler.title,
				modified: tiddler.modified,
				modifier: tiddler.modifier,
				text: tiddler.text ? wikifyPlainText(tiddler.text,100) : "",
				tags: tiddler.tags,
				size: tiddler.text ? tiddler.text.length : 0,
				tiddler: tiddler
			});
		}
	}
	listedTiddlers.sort(function(a,b) {return a.title < b.title ? -1 : (a.title == b.title ? 0 : +1);});
	// Display the listview
	wizard.addStep(config.macros.importTiddlers.step3Title,config.macros.importTiddlers.step3Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	var listView = ListView.create(listWrapper,listedTiddlers,config.macros.importTiddlers.listViewTemplate);
	wizard.setValue("listView",listView);
	wizard.setValue("context",context);
	var txtSaveTiddler = wizard.getElement("txtSaveTiddler");
	txtSaveTiddler.value = config.macros.importTiddlers.generateSystemServerName(wizard);
	wizard.setButtons([
			{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel},
			{caption: config.macros.importTiddlers.importLabel, tooltip: config.macros.importTiddlers.importPrompt, onClick: config.macros.importTiddlers.doImport}
		]);
};

config.macros.importTiddlers.generateSystemServerName = function(wizard)
{
	var serverType = wizard.getValue("serverType");
	var host = wizard.getValue("host");
	var workspace = wizard.getValue("workspace");
	var pattern = config.macros.importTiddlers[workspace ? "systemServerNamePattern" : "systemServerNamePatternNoWorkspace"];
	return pattern.format([serverType,host,workspace]);
};

config.macros.importTiddlers.saveServerTiddler = function(wizard)
{
	var txtSaveTiddler = wizard.getElement("txtSaveTiddler").value;
	if(store.tiddlerExists(txtSaveTiddler)) {
		if(!confirm(config.macros.importTiddlers.confirmOverwriteSaveTiddler.format([txtSaveTiddler])))
			return;
		store.suspendNotifications();
		store.removeTiddler(txtSaveTiddler);
		store.resumeNotifications();
	}
	var serverType = wizard.getValue("serverType");
	var host = wizard.getValue("host");
	var workspace = wizard.getValue("workspace");
	var text = config.macros.importTiddlers.serverSaveTemplate.format([serverType,host,workspace]);
	store.saveTiddler(txtSaveTiddler,txtSaveTiddler,text,config.macros.importTiddlers.serverSaveModifier,new Date(),["systemServer"]);
};

config.macros.importTiddlers.doImport = function(e)
{
	var wizard = new Wizard(this);
	if(wizard.getElement("chkSave").checked)
		config.macros.importTiddlers.saveServerTiddler(wizard);
	var chkSync = wizard.getElement("chkSync").checked;
	wizard.setValue("sync",chkSync);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	var adaptor = wizard.getValue("adaptor");
	var overwrite = [];
	var t;
	for(t=0; t<rowNames.length; t++) {
		if(store.tiddlerExists(rowNames[t]))
			overwrite.push(rowNames[t]);
	}
	if(overwrite.length > 0) {
		if(!confirm(config.macros.importTiddlers.confirmOverwriteText.format([overwrite.join(", ")])))
			return false;
	}
	wizard.addStep(config.macros.importTiddlers.step4Title.format([rowNames.length]),config.macros.importTiddlers.step4Html);
	for(t=0; t<rowNames.length; t++) {
		var link = document.createElement("div");
		createTiddlyLink(link,rowNames[t],true);
		var place = wizard.getElement("markReport");
		place.parentNode.insertBefore(link,place);
	}
	wizard.setValue("remainingImports",rowNames.length);
	wizard.setButtons([
			{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}
		],config.macros.importTiddlers.statusDoingImport);
	var wizardContext = wizard.getValue("context");
	var tiddlers = wizardContext ? wizardContext.tiddlers : [];
	for(t=0; t<rowNames.length; t++) {
		var context = {
			allowSynchronous:true,
			tiddler:tiddlers[tiddlers.findByField("title",rowNames[t])]
		};
		adaptor.getTiddler(rowNames[t],context,wizard,config.macros.importTiddlers.onGetTiddler);
	}
	return false;
};

config.macros.importTiddlers.onGetTiddler = function(context,wizard)
{
	if(!context.status)
		displayMessage("Error in importTiddlers.onGetTiddler: " + context.statusText);
	var tiddler = context.tiddler;
	store.suspendNotifications();
	store.saveTiddler(tiddler.title, tiddler.title, tiddler.text, tiddler.modifier, tiddler.modified, tiddler.tags, tiddler.fields, true, tiddler.created);
	if(!wizard.getValue("sync")) {
		store.setValue(tiddler.title,'server',null);
	}
	store.resumeNotifications();
	if(!context.isSynchronous)
		store.notify(tiddler.title,true);
	var remainingImports = wizard.getValue("remainingImports")-1;
	wizard.setValue("remainingImports",remainingImports);
	if(remainingImports == 0) {
		if(context.isSynchronous) {
			store.notifyAll();
			refreshDisplay();
		}
		wizard.setButtons([
				{caption: config.macros.importTiddlers.doneLabel, tooltip: config.macros.importTiddlers.donePrompt, onClick: config.macros.importTiddlers.onClose}
			],config.macros.importTiddlers.statusDoneImport);
		autoSaveChanges();
	}
};

//--
//-- Upgrade macro
//--

config.macros.upgrade.handler = function(place)
{
	var w = new Wizard();
	w.createWizard(place,this.wizardTitle);
	w.addStep(this.step1Title,this.step1Html.format([this.source,this.source]));
	w.setButtons([{caption: this.upgradeLabel, tooltip: this.upgradePrompt, onClick: this.onClickUpgrade}]);
};

config.macros.upgrade.onClickUpgrade = function(e)
{
	var me = config.macros.upgrade;
	var w = new Wizard(this);
	if(window.location.protocol != "file:") {
		alert(me.errorCantUpgrade);
		return false;
	}
	if(story.areAnyDirty() || store.isDirty()) {
		alert(me.errorNotSaved);
		return false;
	}
	var localPath = getLocalPath(document.location.toString());
	var backupPath = getBackupPath(localPath,me.backupExtension);
	w.setValue("backupPath",backupPath);
	w.setButtons([],me.statusPreparingBackup);
	var original = loadOriginal(localPath);
	w.setButtons([],me.statusSavingBackup);
	var backup = copyFile(backupPath,localPath);
	if(!backup)
		backup = saveFile(backupPath,original);
	if(!backup) {
		w.setButtons([],me.errorSavingBackup);
		alert(me.errorSavingBackup);
		return false;
	}
	w.setButtons([],me.statusLoadingCore);
	var load = loadRemoteFile(me.source,me.onLoadCore,w);
	if(typeof load == "string") {
		w.setButtons([],me.errorLoadingCore);
		alert(me.errorLoadingCore);
		return false;
	}
	return false;
};

config.macros.upgrade.onLoadCore = function(status,params,responseText,url,xhr)
{
	var me = config.macros.upgrade;
	var w = params;
	var errMsg;
	if(!status)
		errMsg = me.errorLoadingCore;
	var newVer = me.extractVersion(responseText);
	if(!newVer)
		errMsg = me.errorCoreFormat;
	if(errMsg) {
		w.setButtons([],errMsg);
		alert(errMsg);
		return;
	}
	var onStartUpgrade = function(e) {
		w.setButtons([],me.statusSavingCore);
		var localPath = getLocalPath(document.location.toString());
		saveFile(localPath,responseText);
		w.setButtons([],me.statusReloadingCore);
		var backupPath = w.getValue("backupPath");
		var newLoc = document.location.toString() + "?time=" + new Date().convertToYYYYMMDDHHMM() + "#upgrade:[[" + encodeURI(backupPath) + "]]";
		window.setTimeout(function () {window.location = newLoc;},10);
	};
	var step2 = [me.step2Html_downgrade,me.step2Html_restore,me.step2Html_upgrade][compareVersions(version,newVer) + 1];
	w.addStep(me.step2Title,step2.format([formatVersion(newVer),formatVersion(version)]));
	w.setButtons([{caption: me.startLabel, tooltip: me.startPrompt, onClick: onStartUpgrade},{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel}]);
};

config.macros.upgrade.onCancel = function(e)
{
	var me = config.macros.upgrade;
	var w = new Wizard(this);
	w.addStep(me.step3Title,me.step3Html);
	w.setButtons([]);
	return false;
};

config.macros.upgrade.extractVersion = function(upgradeFile)
{
	var re = /^var version = \{title: "([^"]+)", major: (\d+), minor: (\d+), revision: (\d+)(, beta: (\d+)){0,1}, date: new Date\("([^"]+)"\)/mg;
	var m = re.exec(upgradeFile);
	return  m ? {title: m[1], major: m[2], minor: m[3], revision: m[4], beta: m[6], date: new Date(m[7])} : null;
};

function upgradeFrom(path)
{
	var importStore = new TiddlyWiki();
	var tw = loadFile(path);
	if(window.netscape !== undefined)
		tw = convertUTF8ToUnicode(tw);
	importStore.importTiddlyWiki(tw);
	importStore.forEachTiddler(function(title,tiddler) {
		if(!store.getTiddler(title)) {
			store.addTiddler(tiddler);
		}
	});
	refreshDisplay();
	saveChanges(); //# To create appropriate Markup* sections
	alert(config.messages.upgradeDone.format([formatVersion()]));
	window.location = window.location.toString().substr(0,window.location.toString().lastIndexOf("?"));
}

//--
//-- Sync macro
//--

// Synchronisation handlers
config.syncers = {};

// Sync state.
var currSync = null;

// sync macro
config.macros.sync.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(!wikifier.isStatic)
		this.startSync(place);
};

config.macros.sync.cancelSync = function()
{
	currSync = null;
};

config.macros.sync.startSync = function(place)
{
	if(currSync)
		config.macros.sync.cancelSync();
	currSync = {};
	currSync.syncList = this.getSyncableTiddlers();
	currSync.syncTasks = this.createSyncTasks(currSync.syncList);
	this.preProcessSyncableTiddlers(currSync.syncList);
	var wizard = new Wizard();
	currSync.wizard = wizard;
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	currSync.listView = ListView.create(listWrapper,currSync.syncList,this.listViewTemplate);
	this.processSyncableTiddlers(currSync.syncList);
	wizard.setButtons([{caption: this.syncLabel, tooltip: this.syncPrompt, onClick: this.doSync}]);
};

config.macros.sync.getSyncableTiddlers = function()
{
	var list = [];
	store.forEachTiddler(function(title,tiddler) {
		var syncItem = {};
		syncItem.serverType = tiddler.getServerType();
		syncItem.serverHost = tiddler.fields['server.host'];
		if(syncItem.serverType && syncItem.serverHost) {
			syncItem.adaptor = new config.adaptors[syncItem.serverType];
			syncItem.serverWorkspace = tiddler.fields['server.workspace'];
			syncItem.tiddler = tiddler;
			syncItem.title = tiddler.title;
			syncItem.isTouched = tiddler.isTouched();
			syncItem.selected = syncItem.isTouched;
			syncItem.syncStatus = config.macros.sync.syncStatusList[syncItem.isTouched ? "changedLocally" : "none"];
			syncItem.status = syncItem.syncStatus.text;
			list.push(syncItem);
		}
		});
	list.sort(function(a,b) {return a.title < b.title ? -1 : (a.title == b.title ? 0 : +1);});
	return list;
};

config.macros.sync.preProcessSyncableTiddlers = function(syncList)
{
	for(var i=0; i<syncList.length; i++) {
		var si = syncList[i];
		si.serverUrl = si.adaptor.generateTiddlerInfo(si.tiddler).uri;
	}
};

config.macros.sync.processSyncableTiddlers = function(syncList)
{
	for(var i=0; i<syncList.length; i++) {
		var si = syncList[i];
		if(si.syncStatus.display)
			si.rowElement.style.display = si.syncStatus.display;
		if(si.syncStatus.className)
			si.rowElement.className = si.syncStatus.className;
	}
};

config.macros.sync.createSyncTasks = function(syncList)
{
	var syncTasks = [];
	for(var i=0; i<syncList.length; i++) {
		var si = syncList[i];
		var r = null;
		for(var j=0; j<syncTasks.length; j++) {
			var cst = syncTasks[j];
			if(si.serverType == cst.serverType && si.serverHost == cst.serverHost && si.serverWorkspace == cst.serverWorkspace)
				r = cst;
		}
		if(r) {
			si.syncTask = r;
			r.syncItems.push(si);
		} else {
			si.syncTask = this.createSyncTask(si);
			syncTasks.push(si.syncTask);
		}
	}
	return syncTasks;
};

config.macros.sync.createSyncTask = function(syncItem)
{
	var st = {};
	st.serverType = syncItem.serverType;
	st.serverHost = syncItem.serverHost;
	st.serverWorkspace = syncItem.serverWorkspace;
	st.syncItems = [syncItem];

	var openWorkspaceCallback = function(context,syncItems) {
		if(context.status) {
			context.adaptor.getTiddlerList(context,syncItems,getTiddlerListCallback);
			return true;
		}
		displayMessage(context.statusText);
		return false;
	};

	var getTiddlerListCallback = function(context,sycnItems) {
		if(!context.status) {
			displayMessage(context.statusText);
			return false;
		}
		syncItems = context.userParams;
		var tiddlers = context.tiddlers;
		for(var i=0; i<syncItems.length; i++) {
			var si = syncItems[i];
			var f = tiddlers.findByField("title",si.title);
			if(f !== null) {
				if(tiddlers[f].fields['server.page.revision'] > si.tiddler.fields['server.page.revision']) {
					si.syncStatus = config.macros.sync.syncStatusList[si.isTouched ? 'changedBoth' : 'changedServer'];
				}
			} else {
				si.syncStatus = config.macros.sync.syncStatusList.notFound;
			}
			config.macros.sync.updateSyncStatus(si);
		}
		return true;
	};
	var context = {host:st.serverHost,workspace:st.serverWorkspace};
	syncItem.adaptor.openHost(st.serverHost);
	syncItem.adaptor.openWorkspace(st.serverWorkspace,context,st.syncItems,openWorkspaceCallback);
	return st;
};

config.macros.sync.updateSyncStatus = function(syncItem)
{
	var e = syncItem.colElements["status"];
	removeChildren(e);
	createTiddlyText(e,syncItem.syncStatus.text);
	if(syncItem.syncStatus.display)
		syncItem.rowElement.style.display = syncItem.syncStatus.display;
	if(syncItem.syncStatus.className)
		syncItem.rowElement.className = syncItem.syncStatus.className;
};

config.macros.sync.doSync = function(e)
{
	var getTiddlerCallback = function(context,syncItem) {
		if(syncItem) {
			var tiddler = context.tiddler;
			store.saveTiddler(tiddler.title,tiddler.title,tiddler.text,tiddler.modifier,tiddler.modified,tiddler.tags,tiddler.fields,true,tiddler.created);
			syncItem.syncStatus = config.macros.sync.syncStatusList.gotFromServer;
			config.macros.sync.updateSyncStatus(syncItem);
		}
	};
	var putTiddlerCallback = function(context,syncItem) {
		if(syncItem) {
			store.resetTiddler(context.title);
			syncItem.syncStatus = config.macros.sync.syncStatusList.putToServer;
			config.macros.sync.updateSyncStatus(syncItem);
		}
	};

	var rowNames = ListView.getSelectedRows(currSync.listView);
	var sl = config.macros.sync.syncStatusList;
	for(var i=0; i<currSync.syncList.length; i++) {
		var si = currSync.syncList[i];
		if(rowNames.indexOf(si.title) != -1) {
			var errorMsg = "Error in doSync: ";
			try {
				var r = true;
				switch(si.syncStatus) {
				case sl.changedServer:
					r = si.adaptor.getTiddler(si.title,null,si,getTiddlerCallback);
					break;
				case sl.notFound:
				case sl.changedLocally:
				case sl.changedBoth:
					r = si.adaptor.putTiddler(si.tiddler,null,si,putTiddlerCallback);
					break;
				default:
					break;
				}
				if(!r)
					displayMessage(errorMsg + r);
			} catch(ex) {
				if(ex.name == "TypeError")
					displayMessage("sync operation unsupported: " + ex.message);
				else
					displayMessage(errorMsg + ex.message);
			}
		}
	}
	return false;
};

//--
//-- Manager UI for groups of tiddlers
//--

config.macros.plugins.handler = function(place,macroName,params,wikifier,paramString)
{
	var wizard = new Wizard();
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	listWrapper.setAttribute("refresh","macro");
	listWrapper.setAttribute("macroName","plugins");
	listWrapper.setAttribute("params",paramString);
	this.refresh(listWrapper,paramString);
};

config.macros.plugins.refresh = function(listWrapper,params)
{
	var wizard = new Wizard(listWrapper);
	var selectedRows = [];
	ListView.forEachSelector(listWrapper,function(e,rowName) {
			if(e.checked)
				selectedRows.push(e.getAttribute("rowName"));
		});
	removeChildren(listWrapper);
	params = params.parseParams("anon");
	var plugins = installedPlugins.slice(0);
	var t,tiddler,p;
	var configTiddlers = store.getTaggedTiddlers("systemConfig");
	for(t=0; t<configTiddlers.length; t++) {
		tiddler = configTiddlers[t];
		if(plugins.findByField("title",tiddler.title) == null) {
			p = getPluginInfo(tiddler);
			p.executed = false;
			p.log.splice(0,0,this.skippedText);
			plugins.push(p);
		}
	}
	for(t=0; t<plugins.length; t++) {
		p = plugins[t];
		p.size = p.tiddler.text ? p.tiddler.text.length : 0;
		p.forced = p.tiddler.isTagged("systemConfigForce");
		p.disabled = p.tiddler.isTagged("systemConfigDisable");
		p.Selected = selectedRows.indexOf(plugins[t].title) != -1;
	}
	if(plugins.length == 0) {
		createTiddlyElement(listWrapper,"em",null,null,this.noPluginText);
		wizard.setButtons([]);
	} else {
		var listView = ListView.create(listWrapper,plugins,this.listViewTemplate,this.onSelectCommand);
		wizard.setValue("listView",listView);
		wizard.setButtons([
				{caption: config.macros.plugins.removeLabel, tooltip: config.macros.plugins.removePrompt, onClick: config.macros.plugins.doRemoveTag},
				{caption: config.macros.plugins.deleteLabel, tooltip: config.macros.plugins.deletePrompt, onClick: config.macros.plugins.doDelete}
			]);
	}
};

config.macros.plugins.doRemoveTag = function(e)
{
	var wizard = new Wizard(this);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	if(rowNames.length == 0) {
		alert(config.messages.nothingSelected);
	} else {
		for(var t=0; t<rowNames.length; t++)
			store.setTiddlerTag(rowNames[t],false,"systemConfig");
	}
};

config.macros.plugins.doDelete = function(e)
{
	var wizard = new Wizard(this);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	if(rowNames.length == 0) {
		alert(config.messages.nothingSelected);
	} else {
		if(confirm(config.macros.plugins.confirmDeleteText.format([rowNames.join(", ")]))) {
			for(var t=0; t<rowNames.length; t++) {
				store.removeTiddler(rowNames[t]);
				story.closeTiddler(rowNames[t],true);
			}
		}
	}
};

//--
//-- Message area
//--

function getMessageDiv()
{
	var msgArea = document.getElementById("messageArea");
	if(!msgArea)
		return null;
	if(!msgArea.hasChildNodes())
		createTiddlyButton(createTiddlyElement(msgArea,"div",null,"messageToolbar"),
			config.messages.messageClose.text,
			config.messages.messageClose.tooltip,
			clearMessage);
	msgArea.style.display = "block";
	return createTiddlyElement(msgArea,"div");
}

function displayMessage(text,linkText)
{
	var e = getMessageDiv();
	if(!e) {
		alert(text);
		return;
	}
	if(linkText) {
		var link = createTiddlyElement(e,"a",null,null,text);
		link.href = linkText;
		link.target = "_blank";
	} else {
		e.appendChild(document.createTextNode(text));
	}
}

function clearMessage()
{
	var msgArea = document.getElementById("messageArea");
	if(msgArea) {
		removeChildren(msgArea);
		msgArea.style.display = "none";
	}
	return false;
}

//--
//-- Refresh mechanism
//--

config.notifyTiddlers = [
	{name: "StyleSheetLayout", notify: refreshStyles},
	{name: "StyleSheetColors", notify: refreshStyles},
	{name: "StyleSheet", notify: refreshStyles},
	{name: "StyleSheetPrint", notify: refreshStyles},
	{name: "PageTemplate", notify: refreshPageTemplate},
	{name: "SiteTitle", notify: refreshPageTitle},
	{name: "SiteSubtitle", notify: refreshPageTitle},
	{name: "WindowTitle", notify: refreshPageTitle},
	{name: "ColorPalette", notify: refreshColorPalette},
	{name: null, notify: refreshDisplay}
];

config.refreshers = {
	link: function(e,changeList)
		{
		var title = e.getAttribute("tiddlyLink");
		refreshTiddlyLink(e,title);
		return true;
		},

	tiddler: function(e,changeList)
		{
		var title = e.getAttribute("tiddler");
		var template = e.getAttribute("template");
		if(changeList && changeList.indexOf(title) != -1 && !story.isDirty(title))
			story.refreshTiddler(title,template,true);
		else
			refreshElements(e,changeList);
		return true;
		},

	content: function(e,changeList)
		{
		var title = e.getAttribute("tiddler");
		var force = e.getAttribute("force");
		var args = e.getAttribute("args");
		if(force != null || changeList == null || changeList.indexOf(title) != -1) {
			removeChildren(e);
			config.macros.tiddler.transclude(e,title,args);
			return true;
		} else
			return false;
		},

	macro: function(e,changeList)
		{
		var macro = e.getAttribute("macroName");
		var params = e.getAttribute("params");
		if(macro)
			macro = config.macros[macro];
		if(macro && macro.refresh)
			macro.refresh(e,params);
		return true;
		}
};

config.refresherData = {
	styleSheet: "StyleSheet",
	defaultStyleSheet: "StyleSheet",
	pageTemplate: "PageTemplate",
	defaultPageTemplate: "PageTemplate",
	colorPalette: "ColorPalette",
	defaultColorPalette: "ColorPalette"
};

function refreshElements(root,changeList)
{
	var nodes = root.childNodes;
	for(var c=0; c<nodes.length; c++) {
		var e = nodes[c], type = null;
		if(e.getAttribute && (e.tagName ? e.tagName != "IFRAME" : true))
			type = e.getAttribute("refresh");
		var refresher = config.refreshers[type];
		var refreshed = false;
		if(refresher != undefined)
			refreshed = refresher(e,changeList);
		if(e.hasChildNodes() && !refreshed)
			refreshElements(e,changeList);
	}
}

function applyHtmlMacros(root,tiddler)
{
	var e = root.firstChild;
	while(e) {
		var nextChild = e.nextSibling;
		if(e.getAttribute) {
			var macro = e.getAttribute("macro");
			if(macro) {
				e.removeAttribute("macro");
				var params = "";
				var p = macro.indexOf(" ");
				if(p != -1) {
					params = macro.substr(p+1);
					macro = macro.substr(0,p);
				}
				invokeMacro(e,macro,params,null,tiddler);
			}
		}
		if(e.hasChildNodes())
			applyHtmlMacros(e,tiddler);
		e = nextChild;
	}
}

function refreshPageTemplate(title)
{
	var stash = jQuery("<div/>").appendTo("body").hide()[0];
	var display = story.getContainer();
	var nodes,t;
	if(display) {
		nodes = display.childNodes;
		for(t=nodes.length-1; t>=0; t--)
			stash.appendChild(nodes[t]);
	}
	var wrapper = document.getElementById("contentWrapper");

	var isAvailable = function(title) {
		var s = title ? title.indexOf(config.textPrimitives.sectionSeparator) : -1;
		if(s!=-1)
			title = title.substr(0,s);
		return store.tiddlerExists(title) || store.isShadowTiddler(title);
	};
	if(!title || !isAvailable(title))
		title = config.refresherData.pageTemplate;
	if(!isAvailable(title))
		title = config.refresherData.defaultPageTemplate; //# this one is always avaialable
	wrapper.innerHTML = store.getRecursiveTiddlerText(title,null,10);
	applyHtmlMacros(wrapper);
	refreshElements(wrapper);
	display = story.getContainer();
	removeChildren(display);
	if(!display)
		display = createTiddlyElement(wrapper,"div",story.containerId());
	nodes = stash.childNodes;
	for(t=nodes.length-1; t>=0; t--)
		display.appendChild(nodes[t]);
	removeNode(stash);
}

function refreshDisplay(hint)
{
	if(typeof hint == "string")
		hint = [hint];
	var e = document.getElementById("contentWrapper");
	refreshElements(e,hint);
	if(backstage.isPanelVisible()) {
		e = document.getElementById("backstage");
		refreshElements(e,hint);
	}
}

function refreshPageTitle()
{
	document.title = getPageTitle();
}

function getPageTitle()
{
	return wikifyPlain("WindowTitle");
}

function refreshStyles(title,doc)
{
	setStylesheet(title == null ? "" : store.getRecursiveTiddlerText(title,"",10),title,doc || document);
}

function refreshColorPalette(title)
{
	if(!startingUp)
		refreshAll();
}

function refreshAll()
{
	refreshPageTemplate();
	refreshDisplay();
	refreshStyles("StyleSheetLayout");
	refreshStyles("StyleSheetColors");
	refreshStyles(config.refresherData.styleSheet);
	refreshStyles("StyleSheetPrint");
}

//--
//-- Options stuff
//--

config.optionHandlers = {
	'txt': {
		get: function(name) {return encodeCookie(config.options[name].toString());},
		set: function(name,value) {config.options[name] = decodeCookie(value);}
	},
	'chk': {
		get: function(name) {return config.options[name] ? "true" : "false";},
		set: function(name,value) {config.options[name] = value == "true";}
	}
};

function loadOptionsCookie()
{
	if(safeMode)
		return;
	var cookies = document.cookie.split(";");
	for(var c=0; c<cookies.length; c++) {
		var p = cookies[c].indexOf("=");
		if(p != -1) {
			var name = cookies[c].substr(0,p).trim();
			var value = cookies[c].substr(p+1).trim();
			var optType = name.substr(0,3);
			if(config.optionHandlers[optType] && config.optionHandlers[optType].set)
				config.optionHandlers[optType].set(name,value);
		}
	}
}

function saveOptionCookie(name)
{
	if(safeMode)
		return;
	var c = name + "=";
	var optType = name.substr(0,3);
	if(config.optionHandlers[optType] && config.optionHandlers[optType].get)
		c += config.optionHandlers[optType].get(name);
	c += "; expires=Fri, 1 Jan 2038 12:00:00 UTC; path=/";
	document.cookie = c;
}

function removeCookie(name)
{
	document.cookie = name + "=; expires=Thu, 01-Jan-1970 00:00:01 UTC; path=/;";
}

function encodeCookie(s)
{
	return escape(convertUnicodeToHtmlEntities(s));
}

function decodeCookie(s)
{
	s = unescape(s);
	var re = /&#[0-9]{1,5};/g;
	return s.replace(re,function($0) {return String.fromCharCode(eval($0.replace(/[&#;]/g,"")));});
}


config.macros.option.genericCreate = function(place,type,opt,className,desc)
{
	var typeInfo = config.macros.option.types[type];
	var c = document.createElement(typeInfo.elementType);
	if(typeInfo.typeValue)
		c.setAttribute("type",typeInfo.typeValue);
	c[typeInfo.eventName] = typeInfo.onChange;
	c.setAttribute("option",opt);
	c.className = className || typeInfo.className;
	if(config.optionsDesc[opt])
		c.setAttribute("title",config.optionsDesc[opt]);
	place.appendChild(c);
	if(desc != "no")
		createTiddlyText(place,config.optionsDesc[opt] || opt);
	c[typeInfo.valueField] = config.options[opt];
	return c;
};

config.macros.option.genericOnChange = function(e)
{
	var opt = this.getAttribute("option");
	if(opt) {
		var optType = opt.substr(0,3);
		var handler = config.macros.option.types[optType];
		if(handler.elementType && handler.valueField)
			config.macros.option.propagateOption(opt,handler.valueField,this[handler.valueField],handler.elementType,this);
	}
	return true;
};

config.macros.option.types = {
	'txt': {
		elementType: "input",
		valueField: "value",
		eventName: "onchange",
		className: "txtOptionInput",
		create: config.macros.option.genericCreate,
		onChange: config.macros.option.genericOnChange
	},
	'chk': {
		elementType: "input",
		valueField: "checked",
		eventName: "onclick",
		className: "chkOptionInput",
		typeValue: "checkbox",
		create: config.macros.option.genericCreate,
		onChange: config.macros.option.genericOnChange
	}
};

config.macros.option.propagateOption = function(opt,valueField,value,elementType,elem)
{
	config.options[opt] = value;
	saveOptionCookie(opt);
	var nodes = document.getElementsByTagName(elementType);
	for(var t=0; t<nodes.length; t++) {
		var optNode = nodes[t].getAttribute("option");
		if(opt == optNode && nodes[t]!=elem)
			nodes[t][valueField] = value;
	}
};

config.macros.option.handler = function(place,macroName,params,wikifier,paramString)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var opt = (params[1] && params[1].name == "anon") ? params[1].value : getParam(params,"name",null);
	var className = (params[2] && params[2].name == "anon") ? params[2].value : getParam(params,"class",null);
	var desc = getParam(params,"desc","no");
	var type = opt.substr(0,3);
	var h = config.macros.option.types[type];
	if(h && h.create)
		h.create(place,type,opt,className,desc);
};

config.macros.options.handler = function(place,macroName,params,wikifier,paramString)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var showUnknown = getParam(params,"showUnknown","no");
	var wizard = new Wizard();
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement("markList");
	var chkUnknown = wizard.getElement("chkUnknown");
	chkUnknown.checked = showUnknown == "yes";
	chkUnknown.onchange = this.onChangeUnknown;
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	wizard.setValue("listWrapper",listWrapper);
	this.refreshOptions(listWrapper,showUnknown == "yes");
};

config.macros.options.refreshOptions = function(listWrapper,showUnknown)
{
	var opts = [];
	for(var n in config.options) {
		var opt = {};
		opt.option = "";
		opt.name = n;
		opt.lowlight = !config.optionsDesc[n];
		opt.description = opt.lowlight ? this.unknownDescription : config.optionsDesc[n];
		if(!opt.lowlight || showUnknown)
			opts.push(opt);
	}
	opts.sort(function(a,b) {return a.name.substr(3) < b.name.substr(3) ? -1 : (a.name.substr(3) == b.name.substr(3) ? 0 : +1);});
	var listview = ListView.create(listWrapper,opts,this.listViewTemplate);
	for(n=0; n<opts.length; n++) {
		var type = opts[n].name.substr(0,3);
		var h = config.macros.option.types[type];
		if(h && h.create) {
			h.create(opts[n].colElements['option'],type,opts[n].name,null,"no");
		}
	}
};

config.macros.options.onChangeUnknown = function(e)
{
	var wizard = new Wizard(this);
	var listWrapper = wizard.getValue("listWrapper");
	removeChildren(listWrapper);
	config.macros.options.refreshOptions(listWrapper,this.checked);
	return false;
};

//--
//-- Saving
//--

var saveUsingSafari = false;

var startSaveArea = '<div id="' + 'storeArea">'; // Split up into two so that indexOf() of this source doesn't find it
var endSaveArea = '</d' + 'iv>';

// If there are unsaved changes, force the user to confirm before exitting
function confirmExit()
{
	hadConfirmExit = true;
	if((store && store.isDirty && store.isDirty()) || (story && story.areAnyDirty && story.areAnyDirty()))
		return config.messages.confirmExit;
}

// Give the user a chance to save changes before exitting
function checkUnsavedChanges()
{
	if(store && store.isDirty && store.isDirty() && window.hadConfirmExit === false) {
		if(confirm(config.messages.unsavedChangesWarning))
			saveChanges();
	}
}

function updateLanguageAttribute(s)
{
	if(config.locale) {
		var mRE = /(<html(?:.*?)?)(?: xml:lang\="([a-z]+)")?(?: lang\="([a-z]+)")?>/;
		var m = mRE.exec(s);
		if(m) {
			var t = m[1];
			if(m[2])
				t += ' xml:lang="' + config.locale + '"';
			if(m[3])
				t += ' lang="' + config.locale + '"';
			t += ">";
			s = s.substr(0,m.index) + t + s.substr(m.index+m[0].length);
		}
	}
	return s;
}

function updateMarkupBlock(s,blockName,tiddlerName)
{
	return s.replaceChunk(
			"<!--%0-START-->".format([blockName]),
			"<!--%0-END-->".format([blockName]),
			"\n" + convertUnicodeToFileFormat(store.getRecursiveTiddlerText(tiddlerName,"")) + "\n");
}

function updateOriginal(original,posDiv,localPath)
{
	if(!posDiv)
		posDiv = locateStoreArea(original);
	if(!posDiv) {
		alert(config.messages.invalidFileError.format([localPath]));
		return null;
	}
	var revised = original.substr(0,posDiv[0] + startSaveArea.length) + "\n" +
				convertUnicodeToFileFormat(store.allTiddlersAsHtml()) + "\n" +
				original.substr(posDiv[1]);
	var newSiteTitle = convertUnicodeToFileFormat(getPageTitle()).htmlEncode();
	revised = revised.replaceChunk("<title"+">","</title"+">"," " + newSiteTitle + " ");
	revised = updateLanguageAttribute(revised);
	revised = updateMarkupBlock(revised,"PRE-HEAD","MarkupPreHead");
	revised = updateMarkupBlock(revised,"POST-HEAD","MarkupPostHead");
	revised = updateMarkupBlock(revised,"PRE-BODY","MarkupPreBody");
	revised = updateMarkupBlock(revised,"POST-SCRIPT","MarkupPostBody");
	return revised;
}

function locateStoreArea(original)
{
	// Locate the storeArea div's
	var posOpeningDiv = original.indexOf(startSaveArea);
	var limitClosingDiv = original.indexOf("<"+"!--POST-STOREAREA--"+">");
	if(limitClosingDiv == -1)
		limitClosingDiv = original.indexOf("<"+"!--POST-BODY-START--"+">");
	var posClosingDiv = original.lastIndexOf(endSaveArea,limitClosingDiv == -1 ? original.length : limitClosingDiv);
	return (posOpeningDiv != -1 && posClosingDiv != -1) ? [posOpeningDiv,posClosingDiv] : null;
}

function autoSaveChanges(onlyIfDirty,tiddlers)
{
	if(config.options.chkAutoSave)
		saveChanges(onlyIfDirty,tiddlers);
}

function loadOriginal(localPath)
{
	return loadFile(localPath);
}

// Save this tiddlywiki with the pending changes
function saveChanges(onlyIfDirty,tiddlers)
{
	if(onlyIfDirty && !store.isDirty())
		return;
	clearMessage();
	var t0 = new Date();
	var originalPath = document.location.toString();
	if(originalPath.substr(0,5) != "file:") {
		alert(config.messages.notFileUrlError);
		if(store.tiddlerExists(config.messages.saveInstructions))
			story.displayTiddler(null,config.messages.saveInstructions);
		return;
	}
	var localPath = getLocalPath(originalPath);
	var original = loadOriginal(localPath);
	if(original == null) {
		alert(config.messages.cantSaveError);
		if(store.tiddlerExists(config.messages.saveInstructions))
			story.displayTiddler(null,config.messages.saveInstructions);
		return;
	}
	var posDiv = locateStoreArea(original);
	if(!posDiv) {
		alert(config.messages.invalidFileError.format([localPath]));
		return;
	}
	saveMain(localPath,original,posDiv);
	if(config.options.chkSaveBackups)
		saveBackup(localPath,original);
	if(config.options.chkSaveEmptyTemplate)
		saveEmpty(localPath,original,posDiv);
	if(config.options.chkGenerateAnRssFeed && saveRss instanceof Function)
		saveRss(localPath);
	if(config.options.chkDisplayInstrumentation)
		displayMessage("saveChanges " + (new Date()-t0) + " ms");
}

function saveMain(localPath,original,posDiv)
{
	var save;
	try {
		var revised = updateOriginal(original,posDiv,localPath);
		save = saveFile(localPath,revised);
	} catch (ex) {
		showException(ex);
	}
	if(save) {
		displayMessage(config.messages.mainSaved,"file://" + localPath);
		store.setDirty(false);
	} else {
		alert(config.messages.mainFailed);
	}
}

function saveBackup(localPath,original)
{
	var backupPath = getBackupPath(localPath);
	var backup = copyFile(backupPath,localPath);
	if(!backup)
		backup = saveFile(backupPath,original);
	if(backup)
		displayMessage(config.messages.backupSaved,"file://" + backupPath);
	else
		alert(config.messages.backupFailed);
}

function saveEmpty(localPath,original,posDiv)
{
	var emptyPath,p;
	if((p = localPath.lastIndexOf("/")) != -1)
		emptyPath = localPath.substr(0,p) + "/";
	else if((p = localPath.lastIndexOf("\\")) != -1)
		emptyPath = localPath.substr(0,p) + "\\";
	else
		emptyPath = localPath + ".";
	emptyPath += "empty.html";
	var empty = original.substr(0,posDiv[0] + startSaveArea.length) + original.substr(posDiv[1]);
	var emptySave = saveFile(emptyPath,empty);
	if(emptySave)
		displayMessage(config.messages.emptySaved,"file://" + emptyPath);
	else
		alert(config.messages.emptyFailed);
}

function getLocalPath(origPath)
{
	var originalPath = convertUriToUTF8(origPath,config.options.txtFileSystemCharSet);
	// Remove any location or query part of the URL
	var argPos = originalPath.indexOf("?");
	if(argPos != -1)
		originalPath = originalPath.substr(0,argPos);
	var hashPos = originalPath.indexOf("#");
	if(hashPos != -1)
		originalPath = originalPath.substr(0,hashPos);
	// Convert file://localhost/ to file:///
	if(originalPath.indexOf("file://localhost/") == 0)
		originalPath = "file://" + originalPath.substr(16);
	// Convert to a native file format
	var localPath;
	if(originalPath.charAt(9) == ":") // pc local file
		localPath = unescape(originalPath.substr(8)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file://///") == 0) // FireFox pc network file
		localPath = "\\\\" + unescape(originalPath.substr(10)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file:///") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(7));
	else if(originalPath.indexOf("file:/") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(5));
	else // pc network file
		localPath = "\\\\" + unescape(originalPath.substr(7)).replace(new RegExp("/","g"),"\\");
	return localPath;
}

function getBackupPath(localPath,title,extension)
{
	var slash = "\\";
	var dirPathPos = localPath.lastIndexOf("\\");
	if(dirPathPos == -1) {
		dirPathPos = localPath.lastIndexOf("/");
		slash = "/";
	}
	var backupFolder = config.options.txtBackupFolder;
	if(!backupFolder || backupFolder == "")
		backupFolder = ".";
	var backupPath = localPath.substr(0,dirPathPos) + slash + backupFolder + localPath.substr(dirPathPos);
	backupPath = backupPath.substr(0,backupPath.lastIndexOf(".")) + ".";
	if(title)
		backupPath += title.replace(/[\\\/\*\?\":<> ]/g,"_") + ".";
	backupPath += (new Date()).convertToYYYYMMDDHHMMSSMMM() + "." + (extension || "html");
	return backupPath;
}

//--
//-- RSS Saving
//--

function saveRss(localPath)
{
	var rssPath = localPath.substr(0,localPath.lastIndexOf(".")) + ".xml";
	if(saveFile(rssPath,convertUnicodeToFileFormat(generateRss())))
		displayMessage(config.messages.rssSaved,"file://" + rssPath);
	else
		alert(config.messages.rssFailed);
}

tiddlerToRssItem = function(tiddler,uri)
{
	var s = "<title" + ">" + tiddler.title.htmlEncode() + "</title" + ">\n";
	s += "<description>" + wikifyStatic(tiddler.text,null,tiddler).htmlEncode() + "</description>\n";
	for(var i=0; i<tiddler.tags.length; i++)
		s += "<category>" + tiddler.tags[i] + "</category>\n";
	s += "<link>" + uri + "#" + encodeURIComponent(String.encodeTiddlyLink(tiddler.title)) + "</link>\n";
	s +="<pubDate>" + tiddler.modified.toGMTString() + "</pubDate>\n";
	return s;
};

function generateRss()
{
	var s = [];
	var d = new Date();
	var u = store.getTiddlerText("SiteUrl");
	// Assemble the header
	s.push("<" + "?xml version=\"1.0\"?" + ">");
	s.push("<rss version=\"2.0\">");
	s.push("<channel>");
	s.push("<title" + ">" + wikifyPlain("SiteTitle").htmlEncode() + "</title" + ">");
	if(u)
		s.push("<link>" + u.htmlEncode() + "</link>");
	s.push("<description>" + wikifyPlain("SiteSubtitle").htmlEncode() + "</description>");
	s.push("<language>" + config.locale + "</language>");
	s.push("<copyright>Copyright " + d.getFullYear() + " " + config.options.txtUserName.htmlEncode() + "</copyright>");
	s.push("<pubDate>" + d.toGMTString() + "</pubDate>");
	s.push("<lastBuildDate>" + d.toGMTString() + "</lastBuildDate>");
	s.push("<docs>http://blogs.law.harvard.edu/tech/rss</docs>");
	s.push("<generator>TiddlyWiki " + formatVersion() + "</generator>");
	// The body
	var tiddlers = store.getTiddlers("modified","excludeLists");
	var n = config.numRssItems > tiddlers.length ? 0 : tiddlers.length-config.numRssItems;
	for(var i=tiddlers.length-1; i>=n; i--) {
		s.push("<item>\n" + tiddlerToRssItem(tiddlers[i],u) + "\n</item>");
	}
	// And footer
	s.push("</channel>");
	s.push("</rss>");
	// Save it all
	return s.join("\n");
}

//--
//-- Filesystem code
//--

function convertUTF8ToUnicode(u)
{
	return config.browser.isOpera || !window.netscape ? manualConvertUTF8ToUnicode(u) : mozConvertUTF8ToUnicode(u);
}

function manualConvertUTF8ToUnicode(utf)
{
	var uni = utf;
	var src = 0;
	var dst = 0;
	var b1, b2, b3;
	var c;
	while(src < utf.length) {
		b1 = utf.charCodeAt(src++);
		if(b1 < 0x80) {
			dst++;
		} else if(b1 < 0xE0) {
			b2 = utf.charCodeAt(src++);
			c = String.fromCharCode(((b1 & 0x1F) << 6) | (b2 & 0x3F));
			uni = uni.substring(0,dst++).concat(c,utf.substr(src));
		} else {
			b2 = utf.charCodeAt(src++);
			b3 = utf.charCodeAt(src++);
			c = String.fromCharCode(((b1 & 0xF) << 12) | ((b2 & 0x3F) << 6) | (b3 & 0x3F));
			uni = uni.substring(0,dst++).concat(c,utf.substr(src));
		}
	}
	return uni;
}

function mozConvertUTF8ToUnicode(u)
{
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
		converter.charset = "UTF-8";
	} catch(ex) {
		return manualConvertUTF8ToUnicode(u);
	} // fallback
	var s = converter.ConvertToUnicode(u);
	var fin = converter.Finish();
	return fin.length > 0 ? s+fin : s;
}

function convertUnicodeToFileFormat(s)
{
	return config.browser.isOpera || !window.netscape ? convertUnicodeToHtmlEntities(s) : mozConvertUnicodeToUTF8(s);
}

function convertUnicodeToHtmlEntities(s)
{
	var re = /[^\u0000-\u007F]/g;
	return s.replace(re,function($0) {return "&#" + $0.charCodeAt(0).toString() + ";";});
}

function convertUnicodeToUTF8(s)
{
// return convertUnicodeToFileFormat to allow plugin migration
	return convertUnicodeToFileFormat(s);
}

function manualConvertUnicodeToUTF8(s)
{
	return unescape(encodeURIComponent(s));
}

function mozConvertUnicodeToUTF8(s)
{
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
		converter.charset = "UTF-8";
	} catch(ex) {
		return manualConvertUnicodeToUTF8(s);
	} // fallback
	var u = converter.ConvertFromUnicode(s);
	var fin = converter.Finish();
	return fin.length > 0 ? u + fin : u;
}

function convertUriToUTF8(uri,charSet)
{
	if(window.netscape == undefined || charSet == undefined || charSet == "")
		return uri;
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/utf8converterservice;1"].getService(Components.interfaces.nsIUTF8ConverterService);
	} catch(ex) {
		return uri;
	}
	return converter.convertURISpecToUTF8(uri,charSet);
}

function copyFile(dest,source)
{
	return config.browser.isIE ? ieCopyFile(dest,source) : false;
}

function saveFile(fileUrl,content)
{
	var r = mozillaSaveFile(fileUrl,content);
	if(!r)
		r = ieSaveFile(fileUrl,content);
	if(!r)
		r = javaSaveFile(fileUrl,content);
	return r;
}

function loadFile(fileUrl)
{
	var r = mozillaLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = ieLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = javaLoadFile(fileUrl);
	return r;
}

function ieCreatePath(path)
{
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
	} catch(ex) {
		return null;
	}

	var pos = path.lastIndexOf("\\");
	if(pos==-1)
		pos = path.lastIndexOf("/");
	if(pos!=-1)
		path = path.substring(0,pos+1);

	var scan = [path];
	var parent = fso.GetParentFolderName(path);
	while(parent && !fso.FolderExists(parent)) {
		scan.push(parent);
		parent = fso.GetParentFolderName(parent);
	}

	for(i=scan.length-1;i>=0;i--) {
		if(!fso.FolderExists(scan[i])) {
			fso.CreateFolder(scan[i]);
		}
	}
	return true;
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function ieSaveFile(filePath,content)
{
	ieCreatePath(filePath);
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
	} catch(ex) {
		return null;
	}
	var file = fso.OpenTextFile(filePath,2,-1,0);
	file.Write(content);
	file.Close();
	return true;
}

// Returns null if it can't do it, false if there's an error, or a string of the content if successful
function ieLoadFile(filePath)
{
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		var file = fso.OpenTextFile(filePath,1);
		var content = file.ReadAll();
		file.Close();
	} catch(ex) {
		return null;
	}
	return content;
}

function ieCopyFile(dest,source)
{
	ieCreatePath(dest);
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		fso.GetFile(source).Copy(dest);
	} catch(ex) {
		return false;
	}
	return true;
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function mozillaSaveFile(filePath,content)
{
	if(window.Components) {
		try {
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			file.initWithPath(filePath);
			if(!file.exists())
				file.create(0,0664);
			var out = Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);
			out.init(file,0x20|0x02,00004,null);
			out.write(content,content.length);
			out.flush();
			out.close();
			return true;
		} catch(ex) {
			return false;
		}
	}
	return null;
}

// Returns null if it can't do it, false if there's an error, or a string of the content if successful
function mozillaLoadFile(filePath)
{
	if(window.Components) {
		try {
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			file.initWithPath(filePath);
			if(!file.exists())
				return null;
			var inputStream = Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);
			inputStream.init(file,0x01,00004,null);
			var sInputStream = Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream);
			sInputStream.init(inputStream);
			var contents = sInputStream.read(sInputStream.available());
			sInputStream.close();
			inputStream.close();
			return contents;
		} catch(ex) {
			return false;
		}
	}
	return null;
}

function javaUrlToFilename(url)
{
	var f = "//localhost";
	if(url.indexOf(f) == 0)
		return url.substring(f.length);
	var i = url.indexOf(":");
	return i > 0 ? url.substring(i-1) : url;
}

function javaSaveFile(filePath,content)
{
	try {
		if(document.applets["TiddlySaver"])
			return document.applets["TiddlySaver"].saveFile(javaUrlToFilename(filePath),"UTF-8",content);
	} catch(ex) {
	}
	try {
		var s = new java.io.PrintStream(new java.io.FileOutputStream(javaUrlToFilename(filePath)));
		s.print(content);
		s.close();
	} catch(ex) {
		return null;
	}
	return true;
}

function javaLoadFile(filePath)
{
	try {
		if(document.applets["TiddlySaver"])
			return String(document.applets["TiddlySaver"].loadFile(javaUrlToFilename(filePath),"UTF-8"));
	} catch(ex) {
	}
	var content = [];
	try {
		var r = new java.io.BufferedReader(new java.io.FileReader(javaUrlToFilename(filePath)));
		var line;
		while((line = r.readLine()) != null)
			content.push(new String(line));
		r.close();
	} catch(ex) {
		return null;
	}
	return content.join("\n");
}

//--
//-- Server adaptor base class
//--

function AdaptorBase()
{
	this.host = null;
	this.store = null;
	return this;
}

AdaptorBase.prototype.close = function()
{
	return true;
};

AdaptorBase.prototype.fullHostName = function(host)
{
	if(!host)
		return '';
	host = host.trim();
	if(!host.match(/:\/\//))
		host = 'http://' + host;
	if(host.substr(host.length-1) == '/')
		host = host.substr(0,host.length-1);
	return host;
};

AdaptorBase.minHostName = function(host)
{
	return host ? host.replace(/^http:\/\//,'').replace(/\/$/,'') : '';
};

AdaptorBase.prototype.setContext = function(context,userParams,callback)
{
	if(!context) context = {};
	context.userParams = userParams;
	if(callback) context.callback = callback;
	context.adaptor = this;
	if(!context.host)
		context.host = this.host;
	context.host = this.fullHostName(context.host);
	if(!context.workspace)
		context.workspace = this.workspace;
	return context;
};

// Open the specified host
AdaptorBase.prototype.openHost = function(host,context,userParams,callback)
{
	this.host = host;
	context = this.setContext(context,userParams,callback);
	context.status = true;
	if(callback)
		window.setTimeout(function() {context.callback(context,userParams);},10);
	return true;
};

// Open the specified workspace
AdaptorBase.prototype.openWorkspace = function(workspace,context,userParams,callback)
{
	this.workspace = workspace;
	context = this.setContext(context,userParams,callback);
	context.status = true;
	if(callback)
		window.setTimeout(function() {callback(context,userParams);},10);
	return true;
};

//--
//-- Server adaptor for talking to static TiddlyWiki files
//--

function FileAdaptor()
{
}

FileAdaptor.prototype = new AdaptorBase();

FileAdaptor.serverType = 'file';
FileAdaptor.serverLabel = 'TiddlyWiki';

FileAdaptor.loadTiddlyWikiCallback = function(status,context,responseText,url,xhr)
{
	context.status = status;
	if(!status) {
		context.statusText = "Error reading file";
	} else {
		context.adaptor.store = new TiddlyWiki();
		if(!context.adaptor.store.importTiddlyWiki(responseText)) {
			context.statusText = config.messages.invalidFileError.format([url]);
			context.status = false;
		}
	}
	context.complete(context,context.userParams);
};

// Get the list of workspaces on a given server
FileAdaptor.prototype.getWorkspaceList = function(context,userParams,callback)
{
	context = this.setContext(context,userParams,callback);
	context.workspaces = [{title:"(default)"}];
	context.status = true;
	if(callback)
		window.setTimeout(function() {callback(context,userParams);},10);
	return true;
};

// Gets the list of tiddlers within a given workspace
FileAdaptor.prototype.getTiddlerList = function(context,userParams,callback,filter)
{
	context = this.setContext(context,userParams,callback);
	if(!context.filter)
		context.filter = filter;
	context.complete = FileAdaptor.getTiddlerListComplete;
	if(this.store) {
		var ret = context.complete(context,context.userParams);
	} else {
		ret = loadRemoteFile(context.host,FileAdaptor.loadTiddlyWikiCallback,context);
		if(typeof ret != "string")
			ret = true;
	}
	return ret;
};

FileAdaptor.getTiddlerListComplete = function(context,userParams)
{
	if(context.status) {
		if(context.filter) {
			context.tiddlers = context.adaptor.store.filterTiddlers(context.filter);
		} else {
			context.tiddlers = [];
			context.adaptor.store.forEachTiddler(function(title,tiddler) {context.tiddlers.push(tiddler);});
		}
		for(var i=0; i<context.tiddlers.length; i++) {
			context.tiddlers[i].fields['server.type'] = FileAdaptor.serverType;
			context.tiddlers[i].fields['server.host'] = AdaptorBase.minHostName(context.host);
			context.tiddlers[i].fields['server.page.revision'] = context.tiddlers[i].modified.convertToYYYYMMDDHHMM();
		}
		context.status = true;
	}
	if(context.callback) {
		window.setTimeout(function() {context.callback(context,userParams);},10);
	}
	return true;
};

FileAdaptor.prototype.generateTiddlerInfo = function(tiddler)
{
	var info = {};
	info.uri = tiddler.fields['server.host'] + "#" + tiddler.title;
	return info;
};

// Retrieve a tiddler from a given workspace on a given server
FileAdaptor.prototype.getTiddler = function(title,context,userParams,callback)
{
	context = this.setContext(context,userParams,callback);
	context.title = title;
	context.complete = FileAdaptor.getTiddlerComplete;
	return context.adaptor.store ?
		context.complete(context,context.userParams) :
		loadRemoteFile(context.host,FileAdaptor.loadTiddlyWikiCallback,context);
};

FileAdaptor.getTiddlerComplete = function(context,userParams)
{
	var t = context.adaptor.store.fetchTiddler(context.title);
	if(t) {
		t.fields['server.type'] = FileAdaptor.serverType;
		t.fields['server.host'] = AdaptorBase.minHostName(context.host);
		t.fields['server.page.revision'] = t.modified.convertToYYYYMMDDHHMM();
		context.tiddler = t;
		context.status = true;
	} else { //# tiddler does not exist in document
		context.status = false;
	}
	if(context.allowSynchronous) {
		context.isSynchronous = true;
		context.callback(context,userParams);
	} else {
		window.setTimeout(function() {context.callback(context,userParams);},10);
	}
	return true;
};

FileAdaptor.prototype.close = function()
{
	delete this.store;
	this.store = null;
};

config.adaptors[FileAdaptor.serverType] = FileAdaptor;

config.defaultAdaptor = FileAdaptor.serverType;

//--
//-- HTTP request code
//--

function ajaxReq(args)
{
	if(window.Components && window.netscape && window.netscape.security && document.location.protocol.indexOf("http") == -1)
		window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
	return jQuery.ajax(args);
}

//--
//-- TiddlyWiki-specific utility functions
//--

// Returns TiddlyWiki version string
function formatVersion(v)
{
	v = v || version;
	return v.major + "." + v.minor + "." + v.revision +
		(v.alpha ? " (alpha " + v.alpha + ")" : "") +
		(v.beta ? " (beta " + v.beta + ")" : "");
}

function compareVersions(v1,v2)
{
	var a = ["major","minor","revision"];
	for(var i = 0; i<a.length; i++) {
		var x1 = v1[a[i]] || 0;
		var x2 = v2[a[i]] || 0;
		if(x1<x2)
			return 1;
		if(x1>x2)
			return -1;
	}
	x1 = v1.beta || 9999;
	x2 = v2.beta || 9999;
	if(x1<x2)
		return 1;
	return x1 > x2 ? -1 : 0;
}

function createTiddlyButton(parent,text,tooltip,action,className,id,accessKey,attribs)
{
	var btn = document.createElement("a");
	if(action) {
		btn.onclick = action;
		btn.setAttribute("href","javascript:;");
	}
	if(tooltip)
		btn.setAttribute("title",tooltip);
	if(text)
		btn.appendChild(document.createTextNode(text));
	btn.className = className || "button";
	if(id)
		btn.id = id;
	if(attribs) {
		for(var i in attribs) {
			btn.setAttribute(i,attribs[i]);
		}
	}
	if(parent)
		parent.appendChild(btn);
	if(accessKey)
		btn.setAttribute("accessKey",accessKey);
	return btn;
}

function createTiddlyLink(place,title,includeText,className,isStatic,linkedFromTiddler,noToggle)
{
	var text = includeText ? title : null;
	var i = getTiddlyLinkInfo(title,className);
	var btn = isStatic ? createExternalLink(place,store.getTiddlerText("SiteUrl",null) + "#" + title) : createTiddlyButton(place,text,i.subTitle,onClickTiddlerLink,i.classes);
	if(isStatic)
		btn.className += ' ' + className;
	btn.setAttribute("refresh","link");
	btn.setAttribute("tiddlyLink",title);
	if(noToggle)
		btn.setAttribute("noToggle","true");
	if(linkedFromTiddler) {
		var fields = linkedFromTiddler.getInheritedFields();
		if(fields)
			btn.setAttribute("tiddlyFields",fields);
	}
	return btn;
}

function refreshTiddlyLink(e,title)
{
	var i = getTiddlyLinkInfo(title,e.className);
	e.className = i.classes;
	e.title = i.subTitle;
}

function getTiddlyLinkInfo(title,currClasses)
{
	var classes = currClasses ? currClasses.split(" ") : [];
	classes.pushUnique("tiddlyLink");
	var tiddler = store.fetchTiddler(title);
	var subTitle;
	if(tiddler) {
		subTitle = tiddler.getSubtitle();
		classes.pushUnique("tiddlyLinkExisting");
		classes.remove("tiddlyLinkNonExisting");
		classes.remove("shadow");
	} else {
		classes.remove("tiddlyLinkExisting");
		classes.pushUnique("tiddlyLinkNonExisting");
		if(store.isShadowTiddler(title)) {
			subTitle = config.messages.shadowedTiddlerToolTip.format([title]);
			classes.pushUnique("shadow");
		} else {
			subTitle = config.messages.undefinedTiddlerToolTip.format([title]);
			classes.remove("shadow");
		}
	}
	if(typeof config.annotations[title]=="string")
		subTitle = config.annotations[title];
	return {classes: classes.join(" "),subTitle: subTitle};
}

function createExternalLink(place,url,label)
{
	var link = document.createElement("a");
	link.className = "externalLink";
	link.href = url;
	link.title = config.messages.externalLinkTooltip.format([url]);
	if(config.options.chkOpenInNewWindow)
		link.target = "_blank";
	place.appendChild(link);
	if(label)
		createTiddlyText(link, label);
	return link;
}

// Event handler for clicking on a tiddly link
function onClickTiddlerLink(ev)
{
	var e = ev || window.event;
	var target = resolveTarget(e);
	var link = target;
	var title = null;
	var fields = null;
	var noToggle = null;
	do {
		title = link.getAttribute("tiddlyLink");
		fields = link.getAttribute("tiddlyFields");
		noToggle = link.getAttribute("noToggle");
		link = link.parentNode;
	} while(title == null && link != null);
	if(!store.isShadowTiddler(title)) {
		var f = fields ? fields.decodeHashMap() : {};
		fields = String.encodeHashMap(merge(f,config.defaultCustomFields,true));
	}
	if(title) {
		var toggling = e.metaKey || e.ctrlKey;
		if(config.options.chkToggleLinks)
			toggling = !toggling;
		if(noToggle)
			toggling = false;
		if(store.getTiddler(title))
			fields = null;
		story.displayTiddler(target,title,null,true,null,fields,toggling);
	}
	clearMessage();
	return false;
}

// Create a button for a tag with a popup listing all the tiddlers that it tags
function createTagButton(place,tag,excludeTiddler,title,tooltip)
{
	var btn = createTiddlyButton(place,title||tag,(tooltip||config.views.wikified.tag.tooltip).format([tag]),onClickTag);
	btn.setAttribute("tag",tag);
	if(excludeTiddler)
		btn.setAttribute("tiddler",excludeTiddler);
	return btn;
}

// Event handler for clicking on a tiddler tag
function onClickTag(ev)
{
	var e = ev || window.event;
	var popup = Popup.create(this);
	addClass(popup,"taggedTiddlerList");
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(popup && tag) {
		var tagged = tag.indexOf("[")==-1 ? store.getTaggedTiddlers(tag) : store.filterTiddlers(tag);
		var sortby = this.getAttribute("sortby");
		if(sortby&&sortby.length) {
			store.sortTiddlers(tagged,sortby);
		}
		var titles = [];
		var li,r;
		for(r=0;r<tagged.length;r++) {
			if(tagged[r].title != title)
				titles.push(tagged[r].title);
		}
		var lingo = config.views.wikified.tag;
		if(titles.length > 0) {
			var openAll = createTiddlyButton(createTiddlyElement(popup,"li"),lingo.openAllText.format([tag]),lingo.openAllTooltip,onClickTagOpenAll);
			openAll.setAttribute("tag",tag);
			openAll.setAttribute("sortby",sortby);
			createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
			for(r=0; r<titles.length; r++) {
				createTiddlyLink(createTiddlyElement(popup,"li"),titles[r],true);
			}
		} else {
			createTiddlyElement(popup,"li",null,"disabled",lingo.popupNone.format([tag]));
		}
		createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
		var h = createTiddlyLink(createTiddlyElement(popup,"li"),tag,false);
		createTiddlyText(h,lingo.openTag.format([tag]));
	}
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
}

// Event handler for 'open all' on a tiddler popup
function onClickTagOpenAll(ev)
{
	var tiddlers = store.getTaggedTiddlers(this.getAttribute("tag"));
	var sortby = this.getAttribute("sortby");
	if(sortby&&sortby.length) {
		store.sortTiddlers(tiddlers,sortby);
	}
	story.displayTiddlers(this,tiddlers);
	return false;
}

function onClickError(ev)
{
	var e = ev || window.event;
	var popup = Popup.create(this);
	var lines = this.getAttribute("errorText").split("\n");
	for(var t=0; t<lines.length; t++)
		createTiddlyElement(popup,"li",null,null,lines[t]);
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
}

function createTiddlyDropDown(place,onchange,options,defaultValue)
{
	var sel = createTiddlyElement(place,"select");
	sel.onchange = onchange;
	for(var t=0; t<options.length; t++) {
		var e = createTiddlyElement(sel,"option",null,null,options[t].caption);
		e.value = options[t].name;
		if(options[t].name == defaultValue)
			e.selected = true;
	}
	return sel;
}

function createTiddlyPopup(place,caption,tooltip,tiddler)
{
	if(tiddler.text) {
		createTiddlyLink(place,caption,true);
		var btn = createTiddlyButton(place,glyph("downArrow"),tooltip,onClickTiddlyPopup,"tiddlerPopupButton");
		btn.tiddler = tiddler;
	} else {
		createTiddlyText(place,caption);
	}
}

function onClickTiddlyPopup(ev)
{
	var e = ev || window.event;
	var tiddler = this.tiddler;
	if(tiddler.text) {
		var popup = Popup.create(this,"div","popupTiddler");
		wikify(tiddler.text,popup,null,tiddler);
		Popup.show();
	}
	if(e) e.cancelBubble = true;
	if(e && e.stopPropagation) e.stopPropagation();
	return false;
}

function createTiddlyError(place,title,text)
{
	var btn = createTiddlyButton(place,title,null,onClickError,"errorButton");
	if(text) btn.setAttribute("errorText",text);
}

function merge(dst,src,preserveExisting)
{
	for(var i in src) {
		if(!preserveExisting || dst[i] === undefined)
			dst[i] = src[i];
	}
	return dst;
}

// Returns a string containing the description of an exception, optionally prepended by a message
function exceptionText(e,message)
{
	var s = e.description || e.toString();
	return message ? "%0:\n%1".format([message,s]) : s;
}

// Displays an alert of an exception description with optional message
function showException(e,message)
{
	alert(exceptionText(e,message));
}

function alertAndThrow(m)
{
	alert(m);
	throw(m);
}

function glyph(name)
{
	var g = config.glyphs;
	var b = g.currBrowser;
	if(b == null) {
		b = 0;
		while(!g.browsers[b]() && b < g.browsers.length-1)
			b++;
		g.currBrowser = b;
	}
	if(!g.codes[name])
		return "";
	return g.codes[name][b];
}

if(!window.console) {
	console = {tiddlywiki:true,log:function(message) {displayMessage(message);}};
}

//-
//- Animation engine
//-

function Animator()
{
	this.running = 0; // Incremented at start of each animation, decremented afterwards. If zero, the interval timer is disabled
	this.timerID = 0; // ID of the timer used for animating
	this.animations = []; // List of animations in progress
	return this;
}

// Start animation engine
Animator.prototype.startAnimating = function() //# Variable number of arguments
{
	for(var t=0; t<arguments.length; t++)
		this.animations.push(arguments[t]);
	if(this.running == 0) {
		var me = this;
		this.timerID = window.setInterval(function() {me.doAnimate(me);},10);
	}
	this.running += arguments.length;
};

// Perform an animation engine tick, calling each of the known animation modules
Animator.prototype.doAnimate = function(me)
{
	var a = 0;
	while(a < me.animations.length) {
		var animation = me.animations[a];
		if(animation.tick()) {
			a++;
		} else {
			me.animations.splice(a,1);
			if(--me.running == 0)
				window.clearInterval(me.timerID);
		}
	}
};

Animator.slowInSlowOut = function(progress)
{
	return(1-((Math.cos(progress * Math.PI)+1)/2));
};

//--
//-- Morpher animation
//--

// Animate a set of properties of an element
function Morpher(element,duration,properties,callback)
{
	this.element = element;
	this.duration = duration;
	this.properties = properties;
	this.startTime = new Date();
	this.endTime = Number(this.startTime) + duration;
	this.callback = callback;
	this.tick();
	return this;
}

Morpher.prototype.assignStyle = function(element,style,value)
{
	switch(style) {
	case "-tw-vertScroll":
		window.scrollTo(findScrollX(),value);
		break;
	case "-tw-horizScroll":
		window.scrollTo(value,findScrollY());
		break;
	default:
		element.style[style] = value;
		break;
	}
};

Morpher.prototype.stop = function()
{
	for(var t=0; t<this.properties.length; t++) {
		var p = this.properties[t];
		if(p.atEnd !== undefined) {
			this.assignStyle(this.element,p.style,p.atEnd);
		}
	}
	if(this.callback)
		this.callback(this.element,this.properties);
};

Morpher.prototype.tick = function()
{
	var currTime = Number(new Date());
	var progress = Animator.slowInSlowOut(Math.min(1,(currTime-this.startTime)/this.duration));
	for(var t=0; t<this.properties.length; t++) {
		var p = this.properties[t];
		if(p.start !== undefined && p.end !== undefined) {
			var template = p.template || "%0";
			switch(p.format) {
			case undefined:
			case "style":
				var v = p.start + (p.end-p.start) * progress;
				this.assignStyle(this.element,p.style,template.format([v]));
				break;
			case "color":
				break;
			}
		}
	}
	if(currTime >= this.endTime) {
		this.stop();
		return false;
	}
	return true;
};

//--
//-- Zoomer animation
//--

function Zoomer(text,startElement,targetElement,unused)
{
	var e = createTiddlyElement(document.body,"div",null,"zoomer");
	createTiddlyElement(e,"div",null,null,text);
	var winWidth = findWindowWidth();
	var winHeight = findWindowHeight();
	var p = [
		{style: 'left', start: findPosX(startElement), end: findPosX(targetElement), template: '%0px'},
		{style: 'top', start: findPosY(startElement), end: findPosY(targetElement), template: '%0px'},
		{style: 'width', start: Math.min(startElement.scrollWidth,winWidth), end: Math.min(targetElement.scrollWidth,winWidth), template: '%0px', atEnd: 'auto'},
		{style: 'height', start: Math.min(startElement.scrollHeight,winHeight), end: Math.min(targetElement.scrollHeight,winHeight), template: '%0px', atEnd: 'auto'},
		{style: 'fontSize', start: 8, end: 24, template: '%0pt'}
	];
	var c = function(element,properties) {removeNode(element);};
	return new Morpher(e,config.animDuration,p,c);
}

//--
//-- Scroller animation
//--

function Scroller(targetElement)
{
	var p = [{style: '-tw-vertScroll', start: findScrollY(), end: ensureVisible(targetElement)}];
	return new Morpher(targetElement,config.animDuration,p);
}

//--
//-- Slider animation
//--

// deleteMode - "none", "all" [delete target element and it's children], [only] "children" [but not the target element]
function Slider(element,opening,unused,deleteMode)
{
	element.style.overflow = 'hidden';
	if(opening)
		element.style.height = '0px'; // Resolves a Firefox flashing bug
	element.style.display = 'block';
	var left = findPosX(element);
	var width = element.scrollWidth;
	var height = element.scrollHeight;
	var winWidth = findWindowWidth();
	var p = [];
	var c = null;
	if(opening) {
		p.push({style: 'height', start: 0, end: height, template: '%0px', atEnd: 'auto'});
		p.push({style: 'opacity', start: 0, end: 1, template: '%0'});
		p.push({style: 'filter', start: 0, end: 100, template: 'alpha(opacity:%0)'});
	} else {
		p.push({style: 'height', start: height, end: 0, template: '%0px'});
		p.push({style: 'display', atEnd: 'none'});
		p.push({style: 'opacity', start: 1, end: 0, template: '%0'});
		p.push({style: 'filter', start: 100, end: 0, template: 'alpha(opacity:%0)'});
		switch(deleteMode) {
		case "all":
			c = function(element,properties) {removeNode(element);};
			break;
		case "children":
			c = function(element,properties) {removeChildren(element);};
			break;
		}
	}
	return new Morpher(element,config.animDuration,p,c);
}

//--
//-- Popup menu
//--

var Popup = {
	stack: [] // Array of objects with members root: and popup:
	};

Popup.create = function(root,elem,className)
{
	var stackPosition = this.find(root,"popup");
	Popup.remove(stackPosition+1);
	var popup = createTiddlyElement(document.body,elem || "ol","popup",className || "popup");
	popup.stackPosition = stackPosition;
	Popup.stack.push({root: root, popup: popup});
	return popup;
};

Popup.onDocumentClick = function(ev)
{
	var e = ev || window.event;
	if(e.eventPhase == undefined)
		Popup.remove();
	else if(e.eventPhase == Event.BUBBLING_PHASE || e.eventPhase == Event.AT_TARGET)
		Popup.remove();
	return true;
};

Popup.show = function(valign,halign,offset)
{
	var curr = Popup.stack[Popup.stack.length-1];
	this.place(curr.root,curr.popup,valign,halign,offset);
	addClass(curr.root,"highlight");
	if(config.options.chkAnimate && anim && typeof Scroller == "function")
		anim.startAnimating(new Scroller(curr.popup));
	else
		window.scrollTo(0,ensureVisible(curr.popup));
};

Popup.place = function(root,popup,valign,halign,offset)
{
	if(!offset)
		var offset = {x:0,y:0};
	if(popup.stackPosition >= 0 && !valign && !halign) {
		offset.x = offset.x + root.offsetWidth;
	} else {
		offset.x = (halign == "right") ? offset.x + root.offsetWidth : offset.x;
		offset.y = (valign == "top") ? offset.y : offset.y + root.offsetHeight;
	}
	var rootLeft = findPosX(root);
	var rootTop = findPosY(root);
	var popupLeft = rootLeft + offset.x;
	var popupTop = rootTop + offset.y;
	var winWidth = findWindowWidth();
	if(popup.offsetWidth > winWidth*0.75)
		popup.style.width = winWidth*0.75 + "px";
	var popupWidth = popup.offsetWidth;
	var scrollWidth = winWidth - document.body.offsetWidth;
	if(popupLeft + popupWidth > winWidth - scrollWidth - 1) {
		if(halign == "right")
			popupLeft = popupLeft - root.offsetWidth - popupWidth;
		else
			popupLeft = winWidth - popupWidth - scrollWidth - 1;
	}
	popup.style.left = popupLeft + "px";
	popup.style.top = popupTop + "px";
	popup.style.display = "block";
};

Popup.find = function(e)
{
	var pos = -1;
	for (var t=this.stack.length-1; t>=0; t--) {
		if(isDescendant(e,this.stack[t].popup))
			pos = t;
	}
	return pos;
};

Popup.remove = function(pos)
{
	if(!pos) var pos = 0;
	if(Popup.stack.length > pos) {
		Popup.removeFrom(pos);
	}
};

Popup.removeFrom = function(from)
{
	for(var t=Popup.stack.length-1; t>=from; t--) {
		var p = Popup.stack[t];
		removeClass(p.root,"highlight");
		removeNode(p.popup);
	}
	Popup.stack = Popup.stack.slice(0,from);
};

//--
//-- Wizard support
//--

function Wizard(elem)
{
	if(elem) {
		this.formElem = findRelated(elem,"wizard","className");
		this.bodyElem = findRelated(this.formElem.firstChild,"wizardBody","className","nextSibling");
		this.footElem = findRelated(this.formElem.firstChild,"wizardFooter","className","nextSibling");
	} else {
		this.formElem = null;
		this.bodyElem = null;
		this.footElem = null;
	}
}

Wizard.prototype.setValue = function(name,value)
{
	if(this.formElem)
		this.formElem[name] = value;
};

Wizard.prototype.getValue = function(name)
{
	return this.formElem ? this.formElem[name] : null;
};

Wizard.prototype.createWizard = function(place,title)
{
	this.formElem = createTiddlyElement(place,"form",null,"wizard");
	createTiddlyElement(this.formElem,"h1",null,null,title);
	this.bodyElem = createTiddlyElement(this.formElem,"div",null,"wizardBody");
	this.footElem = createTiddlyElement(this.formElem,"div",null,"wizardFooter");
};

Wizard.prototype.clear = function()
{
	removeChildren(this.bodyElem);
};

Wizard.prototype.setButtons = function(buttonInfo,status)
{
	removeChildren(this.footElem);
	for(var t=0; t<buttonInfo.length; t++) {
		createTiddlyButton(this.footElem,buttonInfo[t].caption,buttonInfo[t].tooltip,buttonInfo[t].onClick);
		insertSpacer(this.footElem);
		}
	if(typeof status == "string") {
		createTiddlyElement(this.footElem,"span",null,"status",status);
	}
};

Wizard.prototype.addStep = function(stepTitle,html)
{
	removeChildren(this.bodyElem);
	var w = createTiddlyElement(this.bodyElem,"div");
	createTiddlyElement(w,"h2",null,null,stepTitle);
	var step = createTiddlyElement(w,"div",null,"wizardStep");
	step.innerHTML = html;
	applyHtmlMacros(step,tiddler);
};

Wizard.prototype.getElement = function(name)
{
	return this.formElem.elements[name];
};

//--
//-- ListView gadget
//--

var ListView = {};

// Create a listview
ListView.create = function(place,listObject,listTemplate,callback,className)
{
	var table = createTiddlyElement(place,"table",null,className || "listView twtable");
	var thead = createTiddlyElement(table,"thead");
	var r = createTiddlyElement(thead,"tr");
	for(var t=0; t<listTemplate.columns.length; t++) {
		var columnTemplate = listTemplate.columns[t];
		var c = createTiddlyElement(r,"th");
		var colType = ListView.columnTypes[columnTemplate.type];
		if(colType && colType.createHeader) {
			colType.createHeader(c,columnTemplate,t);
			if(columnTemplate.className)
				addClass(c,columnTemplate.className);
		}
	}
	var tbody = createTiddlyElement(table,"tbody");
	for(var rc=0; rc<listObject.length; rc++) {
		var rowObject = listObject[rc];
		r = createTiddlyElement(tbody,"tr");
		for(c=0; c<listTemplate.rowClasses.length; c++) {
			if(rowObject[listTemplate.rowClasses[c].field])
				addClass(r,listTemplate.rowClasses[c].className);
		}
		rowObject.rowElement = r;
		rowObject.colElements = {};
		for(var cc=0; cc<listTemplate.columns.length; cc++) {
			c = createTiddlyElement(r,"td");
			columnTemplate = listTemplate.columns[cc];
			var field = columnTemplate.field;
			colType = ListView.columnTypes[columnTemplate.type];
			if(colType && colType.createItem) {
				colType.createItem(c,rowObject,field,columnTemplate,cc,rc);
				if(columnTemplate.className)
					addClass(c,columnTemplate.className);
			}
			rowObject.colElements[field] = c;
		}
	}
	if(callback && listTemplate.actions)
		createTiddlyDropDown(place,ListView.getCommandHandler(callback),listTemplate.actions);
	if(callback && listTemplate.buttons) {
		for(t=0; t<listTemplate.buttons.length; t++) {
			var a = listTemplate.buttons[t];
			if(a && a.name != "")
				createTiddlyButton(place,a.caption,null,ListView.getCommandHandler(callback,a.name,a.allowEmptySelection));
		}
	}
	return table;
};

ListView.getCommandHandler = function(callback,name,allowEmptySelection)
{
	return function(e) {
		var view = findRelated(this,"TABLE",null,"previousSibling");
		var tiddlers = [];
		ListView.forEachSelector(view,function(e,rowName) {
					if(e.checked)
						tiddlers.push(rowName);
					});
		if(tiddlers.length == 0 && !allowEmptySelection) {
			alert(config.messages.nothingSelected);
		} else {
			if(this.nodeName.toLowerCase() == "select") {
				callback(view,this.value,tiddlers);
				this.selectedIndex = 0;
			} else {
				callback(view,name,tiddlers);
			}
		}
	};
};

// Invoke a callback for each selector checkbox in the listview
ListView.forEachSelector = function(view,callback)
{
	var checkboxes = view.getElementsByTagName("input");
	var hadOne = false;
	for(var t=0; t<checkboxes.length; t++) {
		var cb = checkboxes[t];
		if(cb.getAttribute("type") == "checkbox") {
			var rn = cb.getAttribute("rowName");
			if(rn) {
				callback(cb,rn);
				hadOne = true;
			}
		}
	}
	return hadOne;
};

ListView.getSelectedRows = function(view)
{
	var rowNames = [];
	ListView.forEachSelector(view,function(e,rowName) {
				if(e.checked)
					rowNames.push(rowName);
				});
	return rowNames;
};

ListView.columnTypes = {};

ListView.columnTypes.String = {
	createHeader: function(place,columnTemplate,col)
		{
			createTiddlyText(place,columnTemplate.title);
		},
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				createTiddlyText(place,v);
		}
};

ListView.columnTypes.WikiText = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				wikify(v,place,null,null);
		}
};

ListView.columnTypes.Tiddler = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined && v.title)
				createTiddlyPopup(place,v.title,config.messages.listView.tiddlerTooltip,v);
		}
};

ListView.columnTypes.Size = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				var t = 0;
				while(t<config.messages.sizeTemplates.length-1 && v<config.messages.sizeTemplates[t].unit)
					t++;
				createTiddlyText(place,config.messages.sizeTemplates[t].template.format([Math.round(v/config.messages.sizeTemplates[t].unit)]));
			}
		}
};

ListView.columnTypes.Link = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			var c = columnTemplate.text;
			if(v != undefined)
				createExternalLink(place,v,c || v);
		}
};

ListView.columnTypes.Date = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				createTiddlyText(place,v.formatString(columnTemplate.dateFormat));
		}
};

ListView.columnTypes.StringList = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				for(var t=0; t<v.length; t++) {
					createTiddlyText(place,v[t]);
					createTiddlyElement(place,"br");
				}
			}
		}
};

ListView.columnTypes.Selector = {
	createHeader: function(place,columnTemplate,col)
		{
			createTiddlyCheckbox(place,null,false,this.onHeaderChange);
		},
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var e = createTiddlyCheckbox(place,null,listObject[field],null);
			e.setAttribute("rowName",listObject[columnTemplate.rowName]);
		},
	onHeaderChange: function(e)
		{
			var state = this.checked;
			var view = findRelated(this,"TABLE");
			if(!view)
				return;
			ListView.forEachSelector(view,function(e,rowName) {
								e.checked = state;
							});
		}
};

ListView.columnTypes.Tags = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var tags = listObject[field];
			createTiddlyText(place,String.encodeTiddlyLinkList(tags));
		}
};

ListView.columnTypes.Boolean = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			if(listObject[field] == true)
				createTiddlyText(place,columnTemplate.trueText);
			if(listObject[field] == false)
				createTiddlyText(place,columnTemplate.falseText);
		}
};

ListView.columnTypes.TagCheckbox = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var e = createTiddlyCheckbox(place,null,listObject[field],this.onChange);
			e.setAttribute("tiddler",listObject.title);
			e.setAttribute("tag",columnTemplate.tag);
		},
	onChange : function(e)
		{
			var tag = this.getAttribute("tag");
			var tiddler = this.getAttribute("tiddler");
			store.setTiddlerTag(tiddler,this.checked,tag);
		}
};

ListView.columnTypes.TiddlerLink = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				var link = createTiddlyLink(place,listObject[columnTemplate.tiddlerLink],false,null);
				createTiddlyText(link,listObject[field]);
			}
		}
};

//--
//-- Augmented methods for the JavaScript Number(), Array(), String() and Date() objects
//--

// Clamp a number to a range
Number.prototype.clamp = function(min,max)
{
	var c = this;
	if(c < min)
		c = min;
	if(c > max)
		c = max;
	return Number(c);
};

// Add indexOf function if browser does not support it
if(!Array.indexOf) {
Array.prototype.indexOf = function(item,from)
{
	if(!from)
		from = 0;
	for(var i=from; i<this.length; i++) {
		if(this[i] === item)
			return i;
	}
	return -1;
};}

// Find an entry in a given field of the members of an array
Array.prototype.findByField = function(field,value)
{
	for(var t=0; t<this.length; t++) {
		if(this[t][field] === value)
			return t;
	}
	return null;
};

// Return whether an entry exists in an array
Array.prototype.contains = function(item)
{
	return this.indexOf(item) != -1;
};

// Adds, removes or toggles a particular value within an array
//  value - value to add
//  mode - +1 to add value, -1 to remove value, 0 to toggle it
Array.prototype.setItem = function(value,mode)
{
	var p = this.indexOf(value);
	if(mode == 0)
		mode = (p == -1) ? +1 : -1;
	if(mode == +1) {
		if(p == -1)
			this.push(value);
	} else if(mode == -1) {
		if(p != -1)
			this.splice(p,1);
	}
};

// Return whether one of a list of values exists in an array
Array.prototype.containsAny = function(items)
{
	for(var i=0; i<items.length; i++) {
		if(this.indexOf(items[i]) != -1)
			return true;
	}
	return false;
};

// Return whether all of a list of values exists in an array
Array.prototype.containsAll = function(items)
{
	for(var i = 0; i<items.length; i++) {
		if(this.indexOf(items[i]) == -1)
			return false;
	}
	return true;
};

// Push a new value into an array only if it is not already present in the array. If the optional unique parameter is false, it reverts to a normal push
Array.prototype.pushUnique = function(item,unique)
{
	if(unique === false) {
		this.push(item);
	} else {
		if(this.indexOf(item) == -1)
			this.push(item);
	}
};

Array.prototype.remove = function(item)
{
	var p = this.indexOf(item);
	if(p != -1)
		this.splice(p,1);
};

if(!Array.prototype.map) {
Array.prototype.map = function(fn,thisObj)
{
	var scope = thisObj || window;
	var a = [];
	for(var i=0, j=this.length; i < j; ++i) {
		a.push(fn.call(scope,this[i],i,this));
	}
	return a;
};}

// Get characters from the right end of a string
String.prototype.right = function(n)
{
	return n < this.length ? this.slice(this.length-n) : this;
};

// Trim whitespace from both ends of a string
String.prototype.trim = function()
{
	return this.replace(/^\s*|\s*$/g,"");
};

// Convert a string from a CSS style property name to a JavaScript style name ("background-color" -> "backgroundColor")
String.prototype.unDash = function()
{
	var s = this.split("-");
	if(s.length > 1) {
		for(var t=1; t<s.length; t++)
			s[t] = s[t].substr(0,1).toUpperCase() + s[t].substr(1);
	}
	return s.join("");
};

// Substitute substrings from an array into a format string that includes '%1'-type specifiers
String.prototype.format = function(substrings)
{
	var subRegExp = /(?:%(\d+))/mg;
	var currPos = 0;
	var r = [];
	do {
		var match = subRegExp.exec(this);
		if(match && match[1]) {
			if(match.index > currPos)
				r.push(this.substring(currPos,match.index));
			r.push(substrings[parseInt(match[1])]);
			currPos = subRegExp.lastIndex;
		}
	} while(match);
	if(currPos < this.length)
		r.push(this.substring(currPos,this.length));
	return r.join("");
};

// Escape any special RegExp characters with that character preceded by a backslash
String.prototype.escapeRegExp = function()
{
	var s = "\\^$*+?()=!|,{}[].";
	var c = this;
	for(var t=0; t<s.length; t++)
		c = c.replace(new RegExp("\\" + s.substr(t,1),"g"),"\\" + s.substr(t,1));
	return c;
};

// Convert "\" to "\s", newlines to "\n" (and remove carriage returns)
String.prototype.escapeLineBreaks = function()
{
	return this.replace(/\\/mg,"\\s").replace(/\n/mg,"\\n").replace(/\r/mg,"");
};

// Convert "\n" to newlines, "\b" to " ", "\s" to "\" (and remove carriage returns)
String.prototype.unescapeLineBreaks = function()
{
	return this.replace(/\\n/mg,"\n").replace(/\\b/mg," ").replace(/\\s/mg,"\\").replace(/\r/mg,"");
};

// Convert & to "&amp;", < to "&lt;", > to "&gt;" and " to "&quot;"
String.prototype.htmlEncode = function()
{
	return this.replace(/&/mg,"&amp;").replace(/</mg,"&lt;").replace(/>/mg,"&gt;").replace(/\"/mg,"&quot;");
};

// Convert "&amp;" to &, "&lt;" to <, "&gt;" to > and "&quot;" to "
String.prototype.htmlDecode = function()
{
	return this.replace(/&lt;/mg,"<").replace(/&gt;/mg,">").replace(/&quot;/mg,"\"").replace(/&amp;/mg,"&");
};

// Parse a space-separated string of name:value parameters
// The result is an array of objects:
//   result[0] = object with a member for each parameter name, value of that member being an array of values
//   result[1..n] = one object for each parameter, with 'name' and 'value' members
String.prototype.parseParams = function(defaultName,defaultValue,allowEval,noNames,cascadeDefaults)
{
	var parseToken = function(match,p) {
		var n;
		if(match[p]) // Double quoted
			n = match[p];
		else if(match[p+1]) // Single quoted
			n = match[p+1];
		else if(match[p+2]) // Double-square-bracket quoted
			n = match[p+2];
		else if(match[p+3]) // Double-brace quoted
			try {
				n = match[p+3];
				if(allowEval)
					n = window.eval(n);
			} catch(ex) {
				throw "Unable to evaluate {{" + match[p+3] + "}}: " + exceptionText(ex);
			}
		else if(match[p+4]) // Unquoted
			n = match[p+4];
		else if(match[p+5]) // empty quote
			n = "";
		return n;
	};
	var r = [{}];
	var dblQuote = "(?:\"((?:(?:\\\\\")|[^\"])+)\")";
	var sngQuote = "(?:'((?:(?:\\\\\')|[^'])+)')";
	var dblSquare = "(?:\\[\\[((?:\\s|\\S)*?)\\]\\])";
	var dblBrace = "(?:\\{\\{((?:\\s|\\S)*?)\\}\\})";
	var unQuoted = noNames ? "([^\"'\\s]\\S*)" : "([^\"':\\s][^\\s:]*)";
	var emptyQuote = "((?:\"\")|(?:''))";
	var skipSpace = "(?:\\s*)";
	var token = "(?:" + dblQuote + "|" + sngQuote + "|" + dblSquare + "|" + dblBrace + "|" + unQuoted + "|" + emptyQuote + ")";
	var re = noNames ? new RegExp(token,"mg") : new RegExp(skipSpace + token + skipSpace + "(?:(\\:)" + skipSpace + token + ")?","mg");
	var params = [];
	do {
		var match = re.exec(this);
		if(match) {
			var n = parseToken(match,1);
			if(noNames) {
				r.push({name:"",value:n});
			} else {
				var v = parseToken(match,8);
				if(v == null && defaultName) {
					v = n;
					n = defaultName;
				} else if(v == null && defaultValue) {
					v = defaultValue;
				}
				r.push({name:n,value:v});
				if(cascadeDefaults) {
					defaultName = n;
					defaultValue = v;
				}
			}
		}
	} while(match);
	// Summarise parameters into first element
	for(var t=1; t<r.length; t++) {
		if(r[0][r[t].name])
			r[0][r[t].name].push(r[t].value);
		else
			r[0][r[t].name] = [r[t].value];
	}
	return r;
};

// Process a string list of macro parameters into an array. Parameters can be quoted with "", '',
// [[]], {{ }} or left unquoted (and therefore space-separated). Double-braces {{}} results in
// an *evaluated* parameter: e.g. {{config.options.txtUserName}} results in the current user's name.
String.prototype.readMacroParams = function()
{
	var p = this.parseParams("list",null,true,true);
	var n = [];
	for(var t=1; t<p.length; t++)
		n.push(p[t].value);
	return n;
};

// Process a string list of unique tiddler names into an array. Tiddler names that have spaces in them must be [[bracketed]]
String.prototype.readBracketedList = function(unique)
{
	var p = this.parseParams("list",null,false,true);
	var n = [];
	for(var t=1; t<p.length; t++) {
		if(p[t].value)
			n.pushUnique(p[t].value,unique);
	}
	return n;
};

// Returns array with start and end index of chunk between given start and end marker, or undefined.
String.prototype.getChunkRange = function(start,end)
{
	var s = this.indexOf(start);
	if(s != -1) {
		s += start.length;
		var e = this.indexOf(end,s);
		if(e != -1)
			return [s,e];
	}
};

// Replace a chunk of a string given start and end markers
String.prototype.replaceChunk = function(start,end,sub)
{
	var r = this.getChunkRange(start,end);
	return r ? this.substring(0,r[0]) + sub + this.substring(r[1]) : this;
};

// Returns a chunk of a string between start and end markers, or undefined
String.prototype.getChunk = function(start,end)
{
	var r = this.getChunkRange(start,end);
	if(r)
		return this.substring(r[0],r[1]);
};


// Static method to bracket a string with double square brackets if it contains a space
String.encodeTiddlyLink = function(title)
{
	return title.indexOf(" ") == -1 ? title : "[[" + title + "]]";
};

// Static method to encodeTiddlyLink for every item in an array and join them with spaces
String.encodeTiddlyLinkList = function(list)
{
	if(list) {
		var results = [];
		for(var t=0; t<list.length; t++)
			results.push(String.encodeTiddlyLink(list[t]));
		return results.join(" ");
	} else {
		return "";
	}
};

// Convert a string as a sequence of name:"value" pairs into a hashmap
String.prototype.decodeHashMap = function()
{
	var fields = this.parseParams("anon","",false);
	var r = {};
	for(var t=1; t<fields.length; t++)
		r[fields[t].name] = fields[t].value;
	return r;
};

// Static method to encode a hashmap into a name:"value"... string
String.encodeHashMap = function(hashmap)
{
	var r = [];
	for(var t in hashmap)
		r.push(t + ':"' + hashmap[t] + '"');
	return r.join(" ");
};

// Static method to left-pad a string with 0s to a certain width
String.zeroPad = function(n,d)
{
	var s = n.toString();
	if(s.length < d)
		s = "000000000000000000000000000".substr(0,d-s.length) + s;
	return s;
};

String.prototype.startsWith = function(prefix)
{
	return !prefix || this.substring(0,prefix.length) == prefix;
};

// Returns the first value of the given named parameter.
function getParam(params,name,defaultValue)
{
	if(!params)
		return defaultValue;
	var p = params[0][name];
	return p ? p[0] : defaultValue;
}

// Returns the first value of the given boolean named parameter.
function getFlag(params,name,defaultValue)
{
	return !!getParam(params,name,defaultValue);
}

// Substitute date components into a string
Date.prototype.formatString = function(template)
{
	var t = template.replace(/0hh12/g,String.zeroPad(this.getHours12(),2));
	t = t.replace(/hh12/g,this.getHours12());
	t = t.replace(/0hh/g,String.zeroPad(this.getHours(),2));
	t = t.replace(/hh/g,this.getHours());
	t = t.replace(/mmm/g,config.messages.dates.shortMonths[this.getMonth()]);
	t = t.replace(/0mm/g,String.zeroPad(this.getMinutes(),2));
	t = t.replace(/mm/g,this.getMinutes());
	t = t.replace(/0ss/g,String.zeroPad(this.getSeconds(),2));
	t = t.replace(/ss/g,this.getSeconds());
	t = t.replace(/[ap]m/g,this.getAmPm().toLowerCase());
	t = t.replace(/[AP]M/g,this.getAmPm().toUpperCase());
	t = t.replace(/wYYYY/g,this.getYearForWeekNo());
	t = t.replace(/wYY/g,String.zeroPad(this.getYearForWeekNo()-2000,2));
	t = t.replace(/YYYY/g,this.getFullYear());
	t = t.replace(/YY/g,String.zeroPad(this.getFullYear()-2000,2));
	t = t.replace(/MMM/g,config.messages.dates.months[this.getMonth()]);
	t = t.replace(/0MM/g,String.zeroPad(this.getMonth()+1,2));
	t = t.replace(/MM/g,this.getMonth()+1);
	t = t.replace(/0WW/g,String.zeroPad(this.getWeek(),2));
	t = t.replace(/WW/g,this.getWeek());
	t = t.replace(/DDD/g,config.messages.dates.days[this.getDay()]);
	t = t.replace(/ddd/g,config.messages.dates.shortDays[this.getDay()]);
	t = t.replace(/0DD/g,String.zeroPad(this.getDate(),2));
	t = t.replace(/DDth/g,this.getDate()+this.daySuffix());
	t = t.replace(/DD/g,this.getDate());
	var tz = this.getTimezoneOffset();
	var atz = Math.abs(tz);
	t = t.replace(/TZD/g,(tz < 0 ? '+' : '-') + String.zeroPad(Math.floor(atz / 60),2) + ':' + String.zeroPad(atz % 60,2));
	t = t.replace(/\\/g,"");
	return t;
};

Date.prototype.getWeek = function()
{
	var dt = new Date(this.getTime());
	var d = dt.getDay();
	if(d==0) d=7;// JavaScript Sun=0, ISO Sun=7
	dt.setTime(dt.getTime()+(4-d)*86400000);// shift day to Thurs of same week to calculate weekNo
	var n = Math.floor((dt.getTime()-new Date(dt.getFullYear(),0,1)+3600000)/86400000);
	return Math.floor(n/7)+1;
};

Date.prototype.getYearForWeekNo = function()
{
	var dt = new Date(this.getTime());
	var d = dt.getDay();
	if(d==0) d=7;// JavaScript Sun=0, ISO Sun=7
	dt.setTime(dt.getTime()+(4-d)*86400000);// shift day to Thurs of same week
	return dt.getFullYear();
};

Date.prototype.getHours12 = function()
{
	var h = this.getHours();
	return h > 12 ? h-12 : ( h > 0 ? h : 12 );
};

Date.prototype.getAmPm = function()
{
	return this.getHours() >= 12 ? config.messages.dates.pm : config.messages.dates.am;
};

Date.prototype.daySuffix = function()
{
	return config.messages.dates.daySuffixes[this.getDate()-1];
};

// Convert a date to local YYYYMMDDHHMM string format
Date.prototype.convertToLocalYYYYMMDDHHMM = function()
{
	return this.getFullYear() + String.zeroPad(this.getMonth()+1,2) + String.zeroPad(this.getDate(),2) + String.zeroPad(this.getHours(),2) + String.zeroPad(this.getMinutes(),2);
};

// Convert a date to UTC YYYYMMDDHHMM string format
Date.prototype.convertToYYYYMMDDHHMM = function()
{
	return this.getUTCFullYear() + String.zeroPad(this.getUTCMonth()+1,2) + String.zeroPad(this.getUTCDate(),2) + String.zeroPad(this.getUTCHours(),2) + String.zeroPad(this.getUTCMinutes(),2);
};

// Convert a date to UTC YYYYMMDD.HHMMSSMMM string format
Date.prototype.convertToYYYYMMDDHHMMSSMMM = function()
{
	return this.getUTCFullYear() + String.zeroPad(this.getUTCMonth()+1,2) + String.zeroPad(this.getUTCDate(),2) + "." + String.zeroPad(this.getUTCHours(),2) + String.zeroPad(this.getUTCMinutes(),2) + String.zeroPad(this.getUTCSeconds(),2) + String.zeroPad(this.getUTCMilliseconds(),3) +"0";
};

// Static method to create a date from a UTC YYYYMMDDHHMM format string
Date.convertFromYYYYMMDDHHMM = function(d)
{
	d = d?d.replace(/[^0-9]/g, ""):""; 
	return Date.convertFromYYYYMMDDHHMMSSMMM(d.substr(0,12));
};

// Static method to create a date from a UTC YYYYMMDDHHMMSSMMM format string
Date.convertFromYYYYMMDDHHMMSSMMM = function(d)
{
	d = d ? d.replace(/[^0-9]/g, "") : "";
	return new Date(Date.UTC(parseInt(d.substr(0,4),10),
			parseInt(d.substr(4,2),10)-1,
			parseInt(d.substr(6,2),10),
			parseInt(d.substr(8,2)||"00",10),
			parseInt(d.substr(10,2)||"00",10),
			parseInt(d.substr(12,2)||"00",10),
			parseInt(d.substr(14,3)||"000",10)));
};

//--
//-- RGB colour object
//--

// Construct an RGB colour object from a '#rrggbb', '#rgb' or 'rgb(n,n,n)' string or from separate r,g,b values
function RGB(r,g,b)
{
	this.r = 0;
	this.g = 0;
	this.b = 0;
	if(typeof r == "string") {
		if(r.substr(0,1) == "#") {
			if(r.length == 7) {
				this.r = parseInt(r.substr(1,2),16)/255;
				this.g = parseInt(r.substr(3,2),16)/255;
				this.b = parseInt(r.substr(5,2),16)/255;
			} else {
				this.r = parseInt(r.substr(1,1),16)/15;
				this.g = parseInt(r.substr(2,1),16)/15;
				this.b = parseInt(r.substr(3,1),16)/15;
			}
		} else {
			var rgbPattern = /rgb\s*\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/;
			var c = r.match(rgbPattern);
			if(c) {
				this.r = parseInt(c[1],10)/255;
				this.g = parseInt(c[2],10)/255;
				this.b = parseInt(c[3],10)/255;
			}
		}
	} else {
		this.r = r;
		this.g = g;
		this.b = b;
	}
	return this;
}

// Mixes this colour with another in a specified proportion
// c = other colour to mix
// f = 0..1 where 0 is this colour and 1 is the new colour
// Returns an RGB object
RGB.prototype.mix = function(c,f)
{
	return new RGB(this.r + (c.r-this.r) * f,this.g + (c.g-this.g) * f,this.b + (c.b-this.b) * f);
};

// Return an rgb colour as a #rrggbb format hex string
RGB.prototype.toString = function()
{
	return "#" + ("0" + Math.floor(this.r.clamp(0,1) * 255).toString(16)).right(2) +
				 ("0" + Math.floor(this.g.clamp(0,1) * 255).toString(16)).right(2) +
				 ("0" + Math.floor(this.b.clamp(0,1) * 255).toString(16)).right(2);
};

//--
//-- DOM utilities - many derived from www.quirksmode.org
//--

// Resolve the target object of an event
function resolveTarget(e)
{
	var obj;
	if(e.target)
		obj = e.target;
	else if(e.srcElement)
		obj = e.srcElement;
	if(obj.nodeType == 3) // defeat Safari bug
		obj = obj.parentNode;
	return obj;
}

function drawGradient(place,horiz,locolors,hicolors)
{
	if(!hicolors)
		hicolors = locolors;
	for(var t=0; t<= 100; t+=2) {
		var bar = document.createElement("div");
		place.appendChild(bar);
		bar.style.position = "absolute";
		bar.style.left = horiz ? t + "%" : 0;
		bar.style.top = horiz ? 0 : t + "%";
		bar.style.width = horiz ? (101-t) + "%" : "100%";
		bar.style.height = horiz ? "100%" : (101-t) + "%";
		bar.style.zIndex = -1;
		var p = t/100*(locolors.length-1);
		var hc = hicolors[Math.floor(p)];
		if(typeof hc == "string")
			hc = new RGB(hc);
		var lc = locolors[Math.ceil(p)];
		if(typeof lc == "string")
			lc = new RGB(lc);
		bar.style.backgroundColor = hc.mix(lc,p-Math.floor(p)).toString();
	}
}

function createTiddlyText(parent,text)
{
	return parent.appendChild(document.createTextNode(text));
}

function createTiddlyCheckbox(parent,caption,checked,onChange)
{
	var cb = document.createElement("input");
	cb.setAttribute("type","checkbox");
	cb.onclick = onChange;
	parent.appendChild(cb);
	cb.checked = checked;
	cb.className = "chkOptionInput";
	if(caption)
		wikify(caption,parent);
	return cb;
}

function createTiddlyElement(parent,element,id,className,text,attribs)
{
	var e = document.createElement(element);
	if(className != null)
		e.className = className;
	if(id != null)
		e.setAttribute("id",id);
	if(text != null)
		e.appendChild(document.createTextNode(text));
	if(attribs) {
		for(var n in attribs) {
			e.setAttribute(n,attribs[n]);
		}
	}
	if(parent != null)
		parent.appendChild(e);
	return e;
}

function addEvent(obj,type,fn)
{
	if(obj.attachEvent) {
		obj["e"+type+fn] = fn;
		obj[type+fn] = function(){obj["e"+type+fn](window.event);};
		obj.attachEvent("on"+type,obj[type+fn]);
	} else {
		obj.addEventListener(type,fn,false);
	}
}

function removeEvent(obj,type,fn)
{
	if(obj.detachEvent) {
		obj.detachEvent("on"+type,obj[type+fn]);
		obj[type+fn] = null;
	} else {
		obj.removeEventListener(type,fn,false);
	}
}


// Find the closest relative with a given property value (property defaults to tagName, relative defaults to parentNode)
function findRelated(e,value,name,relative)
{
	name = name || "tagName";
	relative = relative || "parentNode";
	if(name == "className") {
		while(e && !hasClass(e,value)) {
			e = e[relative];
		}
	} else {
		while(e && e[name] != value) {
			e = e[relative];
		}
	}
	return e;
}

// Get the scroll position for window.scrollTo necessary to scroll a given element into view
function ensureVisible(e)
{
	var posTop = findPosY(e);
	var posBot = posTop + e.offsetHeight;
	var winTop = findScrollY();
	var winHeight = findWindowHeight();
	var winBot = winTop + winHeight;
	if(posTop < winTop) {
		return posTop;
	} else if(posBot > winBot) {
		if(e.offsetHeight < winHeight)
			return posTop - (winHeight - e.offsetHeight);
		else
			return posTop;
	} else {
		return winTop;
	}
}

// Get the current width of the display window
function findWindowWidth()
{
	return window.innerWidth || document.documentElement.clientWidth;
}

// Get the current height of the display window
function findWindowHeight()
{
	return window.innerHeight || document.documentElement.clientHeight;
}

// Get the current horizontal page scroll position
function findScrollX()
{
	return window.scrollX || document.documentElement.scrollLeft;
}

// Get the current vertical page scroll position
function findScrollY()
{
	return window.scrollY || document.documentElement.scrollTop;
}

function findPosX(obj)
{
	var curleft = 0;
	while(obj.offsetParent) {
		curleft += obj.offsetLeft;
		obj = obj.offsetParent;
	}
	return curleft;
}

function findPosY(obj)
{
	var curtop = 0;
	while(obj.offsetParent) {
		curtop += obj.offsetTop;
		obj = obj.offsetParent;
	}
	return curtop;
}

// Blur a particular element
function blurElement(e)
{
	if(e && e.focus && e.blur) {
		e.focus();
		e.blur();
	}
}

// Create a non-breaking space
function insertSpacer(place)
{
	var e = document.createTextNode(String.fromCharCode(160));
	if(place)
		place.appendChild(e);
	return e;
}

// Force the browser to do a document reflow when needed to workaround browser bugs
function forceReflow()
{
	if(config.browser.isGecko) {
		setStylesheet("body {top:0px;margin-top:0px;}","forceReflow");
		setTimeout(function() {setStylesheet("","forceReflow");},1);
	}
}

// Replace the current selection of a textarea or text input and scroll it into view
function replaceSelection(e,text)
{
	if(e.setSelectionRange) {
		var oldpos = e.selectionStart;
		var isRange = e.selectionEnd > e.selectionStart;
		e.value = e.value.substr(0,e.selectionStart) + text + e.value.substr(e.selectionEnd);
		e.setSelectionRange(isRange ? oldpos : oldpos + text.length,oldpos + text.length);
		var linecount = e.value.split("\n").length;
		var thisline = e.value.substr(0,e.selectionStart).split("\n").length-1;
		e.scrollTop = Math.floor((thisline - e.rows / 2) * e.scrollHeight / linecount);
	} else if(document.selection) {
		var range = document.selection.createRange();
		if(range.parentElement() == e) {
			var isCollapsed = range.text == "";
			range.text = text;
			if(!isCollapsed) {
				range.moveStart("character", -text.length);
				range.select();
			}
		}
	}
}

// Returns the text of the given (text) node, possibly merging subsequent text nodes
function getNodeText(e)
{
	var t = "";
	while(e && e.nodeName == "#text") {
		t += e.nodeValue;
		e = e.nextSibling;
	}
	return t;
}

// Returns true if the element e has a given ancestor element
function isDescendant(e,ancestor)
{
	while(e) {
		if(e === ancestor)
			return true;
		e = e.parentNode;
	}
	return false;
}


// deprecate the following...

// Prevent an event from bubbling
function stopEvent(e)
{
	var ev = e || window.event;
	ev.cancelBubble = true;
	if(ev.stopPropagation) ev.stopPropagation();
	return false;
}

// Remove any event handlers or non-primitve custom attributes
function scrubNode(e)
{
	if(!config.browser.isIE)
		return;
	var att = e.attributes;
	if(att) {
		for(var t=0; t<att.length; t++) {
			var n = att[t].name;
			if(n !== "style" && (typeof e[n] === "function" || (typeof e[n] === "object" && e[n] != null))) {
				try {
					e[n] = null;
				} catch(ex) {
				}
			}
		}
	}
	var c = e.firstChild;
	while(c) {
		scrubNode(c);
		c = c.nextSibling;
	}
}

function addClass(e,className)
{
	jQuery(e).addClass(className);
}

function removeClass(e,className)
{
	jQuery(e).removeClass(className);
}

function hasClass(e,className)
{
	return jQuery(e).hasClass(className);
}

// Remove all children of a node
function removeChildren(e)
{
	jQuery(e).empty();
}

// Return the content of an element as plain text with no formatting
function getPlainText(e)
{
	return jQuery(e).text();
}

// Remove a node and all it's children
function removeNode(e)
{
	jQuery(e).remove();
}

//--
//-- LoaderBase and SaverBase
//--

function LoaderBase() {}

LoaderBase.prototype.loadTiddler = function(store,node,tiddlers)
{
	var title = this.getTitle(store,node);
	if(safeMode && store.isShadowTiddler(title))
		return;
	if(title) {
		var tiddler = store.createTiddler(title);
		this.internalizeTiddler(store,tiddler,title,node);
		tiddlers.push(tiddler);
	}
};

LoaderBase.prototype.loadTiddlers = function(store,nodes)
{
	var tiddlers = [];
	for(var t = 0; t < nodes.length; t++) {
		try {
			this.loadTiddler(store,nodes[t],tiddlers);
		} catch(ex) {
			showException(ex,config.messages.tiddlerLoadError.format([this.getTitle(store,nodes[t])]));
		}
	}
	return tiddlers;
};

function SaverBase() {}

SaverBase.prototype.externalize = function(store)
{
	var results = [];
	var tiddlers = store.getTiddlers("title");
	for(var t = 0; t < tiddlers.length; t++) {
		if(!tiddlers[t].doNotSave())
			results.push(this.externalizeTiddler(store, tiddlers[t]));
	}
	return results.join("\n");
};

//--
//-- TW21Loader (inherits from LoaderBase)
//--

function TW21Loader() {}

TW21Loader.prototype = new LoaderBase();

TW21Loader.prototype.getTitle = function(store,node)
{
	var title = null;
	if(node.getAttribute) {
		title = node.getAttribute("title");
		if(!title)
			title = node.getAttribute("tiddler");
	}
	if(!title && node.id) {
		var lenPrefix = store.idPrefix.length;
		if(node.id.substr(0,lenPrefix) == store.idPrefix)
			title = node.id.substr(lenPrefix);
	}
	return title;
};

TW21Loader.prototype.internalizeTiddler = function(store,tiddler,title,node)
{
	var e = node.firstChild;
	var text = null;
	if(node.getAttribute("tiddler")) {
		text = getNodeText(e).unescapeLineBreaks();
	} else {
		while(e.nodeName!="PRE" && e.nodeName!="pre") {
			e = e.nextSibling;
		}
		text = e.innerHTML.replace(/\r/mg,"").htmlDecode();
	}
	var creator = node.getAttribute("creator");
	var modifier = node.getAttribute("modifier");
	var c = node.getAttribute("created");
	var m = node.getAttribute("modified");
	var created = c ? Date.convertFromYYYYMMDDHHMM(c) : version.date;
	var modified = m ? Date.convertFromYYYYMMDDHHMM(m) : created;
	var tags = node.getAttribute("tags");
	var fields = {};
	var attrs = node.attributes;
	for(var i = attrs.length-1; i >= 0; i--) {
		var name = attrs[i].name;
		if(attrs[i].specified && !TiddlyWiki.isStandardField(name)) {
			fields[name] = attrs[i].value.unescapeLineBreaks();
		}
	}
	tiddler.assign(title,text,modifier,modified,tags,created,fields,creator);
	return tiddler;
};

//--
//-- TW21Saver (inherits from SaverBase)
//--

function TW21Saver() {}

TW21Saver.prototype = new SaverBase();

TW21Saver.prototype.externalizeTiddler = function(store,tiddler)
{
	try {
		var extendedAttributes = "";
		var usePre = config.options.chkUsePreForStorage;
		store.forEachField(tiddler,
			function(tiddler,fieldName,value) {
				// don't store stuff from the temp namespace
				if(typeof value != "string")
					value = "";
				if(!fieldName.match(/^temp\./))
					extendedAttributes += ' %0="%1"'.format([fieldName,value.escapeLineBreaks().htmlEncode()]);
			},true);
		var created = tiddler.created;
		var modified = tiddler.modified;
		var attributes = tiddler.creator ? ' creator="' + tiddler.creator.htmlEncode() + '"' : "";
		attributes += tiddler.modifier ? ' modifier="' + tiddler.modifier.htmlEncode() + '"' : "";
		attributes += (usePre && created == version.date) ? "" :' created="' + created.convertToYYYYMMDDHHMM() + '"';
		attributes += (usePre && modified == created) ? "" : ' modified="' + modified.convertToYYYYMMDDHHMM() +'"';
		var tags = tiddler.getTags();
		if(!usePre || tags)
			attributes += ' tags="' + tags.htmlEncode() + '"';
		return ('<div %0="%1"%2%3>%4</'+'div>').format([
				usePre ? "title" : "tiddler",
				tiddler.title.htmlEncode(),
				attributes,
				extendedAttributes,
				usePre ? "\n<pre>" + tiddler.text.htmlEncode() + "</pre>\n" : tiddler.text.escapeLineBreaks().htmlEncode()
			]);
	} catch (ex) {
		throw exceptionText(ex,config.messages.tiddlerSaveError.format([tiddler.title]));
	}
};

//]]>
</script>
<script id="jsdeprecatedArea" type="text/javascript">
//<![CDATA[
//--
//-- Deprecated Crypto functions and associated conversion routines.
//-- Use the jQuery.encoding functions directly instead.
//--

// Crypto 'namespace'
function Crypto() {}

// Convert a string to an array of big-endian 32-bit words
Crypto.strToBe32s = function(str)
{
	return jQuery.encoding.strToBe32s(str);
};

// Convert an array of big-endian 32-bit words to a string
Crypto.be32sToStr = function(be)
{
	return jQuery.encoding.be32sToStr(be);
};

// Convert an array of big-endian 32-bit words to a hex string
Crypto.be32sToHex = function(be)
{
	return jQuery.encoding.be32sToHex(be);
};

// Return, in hex, the SHA-1 hash of a string
Crypto.hexSha1Str = function(str)
{
	return jQuery.encoding.digests.hexSha1Str(str);
};

// Return the SHA-1 hash of a string
Crypto.sha1Str = function(str)
{
	return jQuery.encoding.digests.sha1Str(str);
};

// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
Crypto.sha1 = function(x,blen)
{
	return jQuery.encoding.digests.sha1(x,blen);
};

//--
//-- Deprecated DOM utilities
//--

// @Deprecated: Use jQuery.stylesheet instead
function setStylesheet(s,id,doc)
{
	jQuery.twStylesheet(s,{ id: id, doc: doc });
}

// @Deprecated: Use jQuery.stylesheet.remove instead
function removeStyleSheet(id)
{
	jQuery.twStylesheet.remove({ id: id });
}
//--
//-- Deprecated HTTP request code
//-- Use the jQuery ajax functions directly instead
//--

function loadRemoteFile(url,callback,params)
{
	return httpReq("GET",url,callback,params);
}

function doHttp(type,url,data,contentType,username,password,callback,params,headers,allowCache)
{
	return httpReq(type,url,callback,params,headers,data,contentType,username,password,allowCache);
}

function httpReq(type,url,callback,params,headers,data,contentType,username,password,allowCache)
{
	var options = {
		type:type,
		url:url,
		processData:false,
		data:data,
		cache:!!allowCache,
		beforeSend: function(xhr) {
			for(var i in headers)
				xhr.setRequestHeader(i,headers[i]);
			xhr.setRequestHeader("X-Requested-With", "TiddlyWiki " + formatVersion());
		}
	};

	if(callback) {
		options.complete = function(xhr,textStatus) {
			if(jQuery.httpSuccess(xhr))
				callback(true,params,xhr.responseText,url,xhr);
			else
				callback(false,params,null,url,xhr);
		};
	}
	if(contentType)
		options.contentType = contentType;
	if(username)
		options.username = username;
	if(password)
		options.password = password;
	if(window.Components && window.netscape && window.netscape.security && document.location.protocol.indexOf("http") == -1)
		window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
	return jQuery.ajax(options);
}

//--
//-- Deprecated String functions
//--

// @Deprecated: no direct replacement, since not used in core code
String.prototype.toJSONString = function()
{
	// Convert a string to it's JSON representation by encoding control characters, double quotes and backslash. See json.org
	var m = {
		'\b': '\\b',
		'\f': '\\f',
		'\n': '\\n',
		'\r': '\\r',
		'\t': '\\t',
		'"' : '\\"',
		'\\': '\\\\'
		};
	var replaceFn = function(a,b) {
		var c = m[b];
		if(c)
			return c;
		c = b.charCodeAt();
		return '\\u00' + Math.floor(c / 16).toString(16) + (c % 16).toString(16);
		};
	if(/["\\\x00-\x1f]/.test(this))
		return '"' + this.replace(/([\x00-\x1f\\"])/g,replaceFn) + '"';
	return '"' + this + '"';
};

//--
//-- Deprecated Tiddler code
//--

// @Deprecated: Use tiddlerToRssItem(tiddler,uri) instead
Tiddler.prototype.toRssItem = function(uri)
{
	return tiddlerToRssItem(this,uri);
};

// @Deprecated: Use "<item>\n" + tiddlerToRssItem(tiddler,uri)  + "\n</item>" instead
Tiddler.prototype.saveToRss = function(uri)
{
	return "<item>\n" + tiddlerToRssItem(this,uri) + "\n</item>";
};

// @Deprecated: Use jQuery.encoding.digests.hexSha1Str instead
Tiddler.prototype.generateFingerprint = function()
{
	return "0x" + Crypto.hexSha1Str(this.text);
};

//]]>
</script>
<script id="jslibArea" type="text/javascript">
//<![CDATA[
/*!
 * jQuery JavaScript Library v1.4.2
 * http://jquery.com/
 *
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2010, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Sat Feb 13 22:33:48 2010 -0500
 */
(function(A,w){function ma(){if(!c.isReady){try{s.documentElement.doScroll("left")}catch(a){setTimeout(ma,1);return}c.ready()}}function Qa(a,b){b.src?c.ajax({url:b.src,async:false,dataType:"script"}):c.globalEval(b.text||b.textContent||b.innerHTML||"");b.parentNode&&b.parentNode.removeChild(b)}function X(a,b,d,f,e,j){var i=a.length;if(typeof b==="object"){for(var o in b)X(a,o,b[o],f,e,d);return a}if(d!==w){f=!j&&f&&c.isFunction(d);for(o=0;o<i;o++)e(a[o],b,f?d.call(a[o],o,e(a[o],b)):d,j);return a}return i?
e(a[0],b):w}function J(){return(new Date).getTime()}function Y(){return false}function Z(){return true}function na(a,b,d){d[0].type=a;return c.event.handle.apply(b,d)}function oa(a){var b,d=[],f=[],e=arguments,j,i,o,k,n,r;i=c.data(this,"events");if(!(a.liveFired===this||!i||!i.live||a.button&&a.type==="click")){a.liveFired=this;var u=i.live.slice(0);for(k=0;k<u.length;k++){i=u[k];i.origType.replace(O,"")===a.type?f.push(i.selector):u.splice(k--,1)}j=c(a.target).closest(f,a.currentTarget);n=0;for(r=
j.length;n<r;n++)for(k=0;k<u.length;k++){i=u[k];if(j[n].selector===i.selector){o=j[n].elem;f=null;if(i.preType==="mouseenter"||i.preType==="mouseleave")f=c(a.relatedTarget).closest(i.selector)[0];if(!f||f!==o)d.push({elem:o,handleObj:i})}}n=0;for(r=d.length;n<r;n++){j=d[n];a.currentTarget=j.elem;a.data=j.handleObj.data;a.handleObj=j.handleObj;if(j.handleObj.origHandler.apply(j.elem,e)===false){b=false;break}}return b}}function pa(a,b){return"live."+(a&&a!=="*"?a+".":"")+b.replace(/\./g,"`").replace(/ /g,
"&")}function qa(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function ra(a,b){var d=0;b.each(function(){if(this.nodeName===(a[d]&&a[d].nodeName)){var f=c.data(a[d++]),e=c.data(this,f);if(f=f&&f.events){delete e.handle;e.events={};for(var j in f)for(var i in f[j])c.event.add(this,j,f[j][i],f[j][i].data)}}})}function sa(a,b,d){var f,e,j;b=b&&b[0]?b[0].ownerDocument||b[0]:s;if(a.length===1&&typeof a[0]==="string"&&a[0].length<512&&b===s&&!ta.test(a[0])&&(c.support.checkClone||!ua.test(a[0]))){e=
true;if(j=c.fragments[a[0]])if(j!==1)f=j}if(!f){f=b.createDocumentFragment();c.clean(a,b,f,d)}if(e)c.fragments[a[0]]=j?f:1;return{fragment:f,cacheable:e}}function K(a,b){var d={};c.each(va.concat.apply([],va.slice(0,b)),function(){d[this]=a});return d}function wa(a){return"scrollTo"in a&&a.document?a:a.nodeType===9?a.defaultView||a.parentWindow:false}var c=function(a,b){return new c.fn.init(a,b)},Ra=A.jQuery,Sa=A.$,s=A.document,T,Ta=/^[^<]*(<[\w\W]+>)[^>]*$|^#([\w-]+)$/,Ua=/^.[^:#\[\.,]*$/,Va=/\S/,
Wa=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,Xa=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,P=navigator.userAgent,xa=false,Q=[],L,$=Object.prototype.toString,aa=Object.prototype.hasOwnProperty,ba=Array.prototype.push,R=Array.prototype.slice,ya=Array.prototype.indexOf;c.fn=c.prototype={init:function(a,b){var d,f;if(!a)return this;if(a.nodeType){this.context=this[0]=a;this.length=1;return this}if(a==="body"&&!b){this.context=s;this[0]=s.body;this.selector="body";this.length=1;return this}if(typeof a==="string")if((d=Ta.exec(a))&&
(d[1]||!b))if(d[1]){f=b?b.ownerDocument||b:s;if(a=Xa.exec(a))if(c.isPlainObject(b)){a=[s.createElement(a[1])];c.fn.attr.call(a,b,true)}else a=[f.createElement(a[1])];else{a=sa([d[1]],[f]);a=(a.cacheable?a.fragment.cloneNode(true):a.fragment).childNodes}return c.merge(this,a)}else{if(b=s.getElementById(d[2])){if(b.id!==d[2])return T.find(a);this.length=1;this[0]=b}this.context=s;this.selector=a;return this}else if(!b&&/^\w+$/.test(a)){this.selector=a;this.context=s;a=s.getElementsByTagName(a);return c.merge(this,
a)}else return!b||b.jquery?(b||T).find(a):c(b).find(a);else if(c.isFunction(a))return T.ready(a);if(a.selector!==w){this.selector=a.selector;this.context=a.context}return c.makeArray(a,this)},selector:"",jquery:"1.4.2",length:0,size:function(){return this.length},toArray:function(){return R.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this.slice(a)[0]:this[a]},pushStack:function(a,b,d){var f=c();c.isArray(a)?ba.apply(f,a):c.merge(f,a);f.prevObject=this;f.context=this.context;if(b===
"find")f.selector=this.selector+(this.selector?" ":"")+d;else if(b)f.selector=this.selector+"."+b+"("+d+")";return f},each:function(a,b){return c.each(this,a,b)},ready:function(a){c.bindReady();if(c.isReady)a.call(s,c);else Q&&Q.push(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(R.apply(this,arguments),"slice",R.call(arguments).join(","))},map:function(a){return this.pushStack(c.map(this,
function(b,d){return a.call(b,d,b)}))},end:function(){return this.prevObject||c(null)},push:ba,sort:[].sort,splice:[].splice};c.fn.init.prototype=c.fn;c.extend=c.fn.extend=function(){var a=arguments[0]||{},b=1,d=arguments.length,f=false,e,j,i,o;if(typeof a==="boolean"){f=a;a=arguments[1]||{};b=2}if(typeof a!=="object"&&!c.isFunction(a))a={};if(d===b){a=this;--b}for(;b<d;b++)if((e=arguments[b])!=null)for(j in e){i=a[j];o=e[j];if(a!==o)if(f&&o&&(c.isPlainObject(o)||c.isArray(o))){i=i&&(c.isPlainObject(i)||
c.isArray(i))?i:c.isArray(o)?[]:{};a[j]=c.extend(f,i,o)}else if(o!==w)a[j]=o}return a};c.extend({noConflict:function(a){A.$=Sa;if(a)A.jQuery=Ra;return c},isReady:false,ready:function(){if(!c.isReady){if(!s.body)return setTimeout(c.ready,13);c.isReady=true;if(Q){for(var a,b=0;a=Q[b++];)a.call(s,c);Q=null}c.fn.triggerHandler&&c(s).triggerHandler("ready")}},bindReady:function(){if(!xa){xa=true;if(s.readyState==="complete")return c.ready();if(s.addEventListener){s.addEventListener("DOMContentLoaded",
L,false);A.addEventListener("load",c.ready,false)}else if(s.attachEvent){s.attachEvent("onreadystatechange",L);A.attachEvent("onload",c.ready);var a=false;try{a=A.frameElement==null}catch(b){}s.documentElement.doScroll&&a&&ma()}}},isFunction:function(a){return $.call(a)==="[object Function]"},isArray:function(a){return $.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||$.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return false;if(a.constructor&&!aa.call(a,"constructor")&&!aa.call(a.constructor.prototype,
"isPrototypeOf"))return false;var b;for(b in a);return b===w||aa.call(a,b)},isEmptyObject:function(a){for(var b in a)return false;return true},error:function(a){throw a;},parseJSON:function(a){if(typeof a!=="string"||!a)return null;a=c.trim(a);if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return A.JSON&&A.JSON.parse?A.JSON.parse(a):(new Function("return "+
a))();else c.error("Invalid JSON: "+a)},noop:function(){},globalEval:function(a){if(a&&Va.test(a)){var b=s.getElementsByTagName("head")[0]||s.documentElement,d=s.createElement("script");d.type="text/javascript";if(c.support.scriptEval)d.appendChild(s.createTextNode(a));else d.text=a;b.insertBefore(d,b.firstChild);b.removeChild(d)}},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,b,d){var f,e=0,j=a.length,i=j===w||c.isFunction(a);if(d)if(i)for(f in a){if(b.apply(a[f],
d)===false)break}else for(;e<j;){if(b.apply(a[e++],d)===false)break}else if(i)for(f in a){if(b.call(a[f],f,a[f])===false)break}else for(d=a[0];e<j&&b.call(d,e,d)!==false;d=a[++e]);return a},trim:function(a){return(a||"").replace(Wa,"")},makeArray:function(a,b){b=b||[];if(a!=null)a.length==null||typeof a==="string"||c.isFunction(a)||typeof a!=="function"&&a.setInterval?ba.call(b,a):c.merge(b,a);return b},inArray:function(a,b){if(b.indexOf)return b.indexOf(a);for(var d=0,f=b.length;d<f;d++)if(b[d]===
a)return d;return-1},merge:function(a,b){var d=a.length,f=0;if(typeof b.length==="number")for(var e=b.length;f<e;f++)a[d++]=b[f];else for(;b[f]!==w;)a[d++]=b[f++];a.length=d;return a},grep:function(a,b,d){for(var f=[],e=0,j=a.length;e<j;e++)!d!==!b(a[e],e)&&f.push(a[e]);return f},map:function(a,b,d){for(var f=[],e,j=0,i=a.length;j<i;j++){e=b(a[j],j,d);if(e!=null)f[f.length]=e}return f.concat.apply([],f)},guid:1,proxy:function(a,b,d){if(arguments.length===2)if(typeof b==="string"){d=a;a=d[b];b=w}else if(b&&
!c.isFunction(b)){d=b;b=w}if(!b&&a)b=function(){return a.apply(d||this,arguments)};if(a)b.guid=a.guid=a.guid||b.guid||c.guid++;return b},uaMatch:function(a){a=a.toLowerCase();a=/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||!/compatible/.test(a)&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},browser:{}});P=c.uaMatch(P);if(P.browser){c.browser[P.browser]=true;c.browser.version=P.version}if(c.browser.webkit)c.browser.safari=
true;if(ya)c.inArray=function(a,b){return ya.call(b,a)};T=c(s);if(s.addEventListener)L=function(){s.removeEventListener("DOMContentLoaded",L,false);c.ready()};else if(s.attachEvent)L=function(){if(s.readyState==="complete"){s.detachEvent("onreadystatechange",L);c.ready()}};(function(){c.support={};var a=s.documentElement,b=s.createElement("script"),d=s.createElement("div"),f="script"+J();d.style.display="none";d.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";
var e=d.getElementsByTagName("*"),j=d.getElementsByTagName("a")[0];if(!(!e||!e.length||!j)){c.support={leadingWhitespace:d.firstChild.nodeType===3,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/red/.test(j.getAttribute("style")),hrefNormalized:j.getAttribute("href")==="/a",opacity:/^0.55$/.test(j.style.opacity),cssFloat:!!j.style.cssFloat,checkOn:d.getElementsByTagName("input")[0].value==="on",optSelected:s.createElement("select").appendChild(s.createElement("option")).selected,
parentNode:d.removeChild(d.appendChild(s.createElement("div"))).parentNode===null,deleteExpando:true,checkClone:false,scriptEval:false,noCloneEvent:true,boxModel:null};b.type="text/javascript";try{b.appendChild(s.createTextNode("window."+f+"=1;"))}catch(i){}a.insertBefore(b,a.firstChild);if(A[f]){c.support.scriptEval=true;delete A[f]}try{delete b.test}catch(o){c.support.deleteExpando=false}a.removeChild(b);if(d.attachEvent&&d.fireEvent){d.attachEvent("onclick",function k(){c.support.noCloneEvent=
false;d.detachEvent("onclick",k)});d.cloneNode(true).fireEvent("onclick")}d=s.createElement("div");d.innerHTML="<input type='radio' name='radiotest' checked='checked'/>";a=s.createDocumentFragment();a.appendChild(d.firstChild);c.support.checkClone=a.cloneNode(true).cloneNode(true).lastChild.checked;c(function(){var k=s.createElement("div");k.style.width=k.style.paddingLeft="1px";s.body.appendChild(k);c.boxModel=c.support.boxModel=k.offsetWidth===2;s.body.removeChild(k).style.display="none"});a=function(k){var n=
s.createElement("div");k="on"+k;var r=k in n;if(!r){n.setAttribute(k,"return;");r=typeof n[k]==="function"}return r};c.support.submitBubbles=a("submit");c.support.changeBubbles=a("change");a=b=d=e=j=null}})();c.props={"for":"htmlFor","class":"className",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",frameborder:"frameBorder"};var G="jQuery"+J(),Ya=0,za={};c.extend({cache:{},expando:G,noData:{embed:true,object:true,
applet:true},data:function(a,b,d){if(!(a.nodeName&&c.noData[a.nodeName.toLowerCase()])){a=a==A?za:a;var f=a[G],e=c.cache;if(!f&&typeof b==="string"&&d===w)return null;f||(f=++Ya);if(typeof b==="object"){a[G]=f;e[f]=c.extend(true,{},b)}else if(!e[f]){a[G]=f;e[f]={}}a=e[f];if(d!==w)a[b]=d;return typeof b==="string"?a[b]:a}},removeData:function(a,b){if(!(a.nodeName&&c.noData[a.nodeName.toLowerCase()])){a=a==A?za:a;var d=a[G],f=c.cache,e=f[d];if(b){if(e){delete e[b];c.isEmptyObject(e)&&c.removeData(a)}}else{if(c.support.deleteExpando)delete a[c.expando];
else a.removeAttribute&&a.removeAttribute(c.expando);delete f[d]}}}});c.fn.extend({data:function(a,b){if(typeof a==="undefined"&&this.length)return c.data(this[0]);else if(typeof a==="object")return this.each(function(){c.data(this,a)});var d=a.split(".");d[1]=d[1]?"."+d[1]:"";if(b===w){var f=this.triggerHandler("getData"+d[1]+"!",[d[0]]);if(f===w&&this.length)f=c.data(this[0],a);return f===w&&d[1]?this.data(d[0]):f}else return this.trigger("setData"+d[1]+"!",[d[0],b]).each(function(){c.data(this,
a,b)})},removeData:function(a){return this.each(function(){c.removeData(this,a)})}});c.extend({queue:function(a,b,d){if(a){b=(b||"fx")+"queue";var f=c.data(a,b);if(!d)return f||[];if(!f||c.isArray(d))f=c.data(a,b,c.makeArray(d));else f.push(d);return f}},dequeue:function(a,b){b=b||"fx";var d=c.queue(a,b),f=d.shift();if(f==="inprogress")f=d.shift();if(f){b==="fx"&&d.unshift("inprogress");f.call(a,function(){c.dequeue(a,b)})}}});c.fn.extend({queue:function(a,b){if(typeof a!=="string"){b=a;a="fx"}if(b===
w)return c.queue(this[0],a);return this.each(function(){var d=c.queue(this,a,b);a==="fx"&&d[0]!=="inprogress"&&c.dequeue(this,a)})},dequeue:function(a){return this.each(function(){c.dequeue(this,a)})},delay:function(a,b){a=c.fx?c.fx.speeds[a]||a:a;b=b||"fx";return this.queue(b,function(){var d=this;setTimeout(function(){c.dequeue(d,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])}});var Aa=/[\n\t]/g,ca=/\s+/,Za=/\r/g,$a=/href|src|style/,ab=/(button|input)/i,bb=/(button|input|object|select|textarea)/i,
cb=/^(a|area)$/i,Ba=/radio|checkbox/;c.fn.extend({attr:function(a,b){return X(this,a,b,true,c.attr)},removeAttr:function(a){return this.each(function(){c.attr(this,a,"");this.nodeType===1&&this.removeAttribute(a)})},addClass:function(a){if(c.isFunction(a))return this.each(function(n){var r=c(this);r.addClass(a.call(this,n,r.attr("class")))});if(a&&typeof a==="string")for(var b=(a||"").split(ca),d=0,f=this.length;d<f;d++){var e=this[d];if(e.nodeType===1)if(e.className){for(var j=" "+e.className+" ",
i=e.className,o=0,k=b.length;o<k;o++)if(j.indexOf(" "+b[o]+" ")<0)i+=" "+b[o];e.className=c.trim(i)}else e.className=a}return this},removeClass:function(a){if(c.isFunction(a))return this.each(function(k){var n=c(this);n.removeClass(a.call(this,k,n.attr("class")))});if(a&&typeof a==="string"||a===w)for(var b=(a||"").split(ca),d=0,f=this.length;d<f;d++){var e=this[d];if(e.nodeType===1&&e.className)if(a){for(var j=(" "+e.className+" ").replace(Aa," "),i=0,o=b.length;i<o;i++)j=j.replace(" "+b[i]+" ",
" ");e.className=c.trim(j)}else e.className=""}return this},toggleClass:function(a,b){var d=typeof a,f=typeof b==="boolean";if(c.isFunction(a))return this.each(function(e){var j=c(this);j.toggleClass(a.call(this,e,j.attr("class"),b),b)});return this.each(function(){if(d==="string")for(var e,j=0,i=c(this),o=b,k=a.split(ca);e=k[j++];){o=f?o:!i.hasClass(e);i[o?"addClass":"removeClass"](e)}else if(d==="undefined"||d==="boolean"){this.className&&c.data(this,"__className__",this.className);this.className=
this.className||a===false?"":c.data(this,"__className__")||""}})},hasClass:function(a){a=" "+a+" ";for(var b=0,d=this.length;b<d;b++)if((" "+this[b].className+" ").replace(Aa," ").indexOf(a)>-1)return true;return false},val:function(a){if(a===w){var b=this[0];if(b){if(c.nodeName(b,"option"))return(b.attributes.value||{}).specified?b.value:b.text;if(c.nodeName(b,"select")){var d=b.selectedIndex,f=[],e=b.options;b=b.type==="select-one";if(d<0)return null;var j=b?d:0;for(d=b?d+1:e.length;j<d;j++){var i=
e[j];if(i.selected){a=c(i).val();if(b)return a;f.push(a)}}return f}if(Ba.test(b.type)&&!c.support.checkOn)return b.getAttribute("value")===null?"on":b.value;return(b.value||"").replace(Za,"")}return w}var o=c.isFunction(a);return this.each(function(k){var n=c(this),r=a;if(this.nodeType===1){if(o)r=a.call(this,k,n.val());if(typeof r==="number")r+="";if(c.isArray(r)&&Ba.test(this.type))this.checked=c.inArray(n.val(),r)>=0;else if(c.nodeName(this,"select")){var u=c.makeArray(r);c("option",this).each(function(){this.selected=
c.inArray(c(this).val(),u)>=0});if(!u.length)this.selectedIndex=-1}else this.value=r}})}});c.extend({attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(a,b,d,f){if(!a||a.nodeType===3||a.nodeType===8)return w;if(f&&b in c.attrFn)return c(a)[b](d);f=a.nodeType!==1||!c.isXMLDoc(a);var e=d!==w;b=f&&c.props[b]||b;if(a.nodeType===1){var j=$a.test(b);if(b in a&&f&&!j){if(e){b==="type"&&ab.test(a.nodeName)&&a.parentNode&&c.error("type property can't be changed");
a[b]=d}if(c.nodeName(a,"form")&&a.getAttributeNode(b))return a.getAttributeNode(b).nodeValue;if(b==="tabIndex")return(b=a.getAttributeNode("tabIndex"))&&b.specified?b.value:bb.test(a.nodeName)||cb.test(a.nodeName)&&a.href?0:w;return a[b]}if(!c.support.style&&f&&b==="style"){if(e)a.style.cssText=""+d;return a.style.cssText}e&&a.setAttribute(b,""+d);a=!c.support.hrefNormalized&&f&&j?a.getAttribute(b,2):a.getAttribute(b);return a===null?w:a}return c.style(a,b,d)}});var O=/\.(.*)$/,db=function(a){return a.replace(/[^\w\s\.\|`]/g,
function(b){return"\\"+b})};c.event={add:function(a,b,d,f){if(!(a.nodeType===3||a.nodeType===8)){if(a.setInterval&&a!==A&&!a.frameElement)a=A;var e,j;if(d.handler){e=d;d=e.handler}if(!d.guid)d.guid=c.guid++;if(j=c.data(a)){var i=j.events=j.events||{},o=j.handle;if(!o)j.handle=o=function(){return typeof c!=="undefined"&&!c.event.triggered?c.event.handle.apply(o.elem,arguments):w};o.elem=a;b=b.split(" ");for(var k,n=0,r;k=b[n++];){j=e?c.extend({},e):{handler:d,data:f};if(k.indexOf(".")>-1){r=k.split(".");
k=r.shift();j.namespace=r.slice(0).sort().join(".")}else{r=[];j.namespace=""}j.type=k;j.guid=d.guid;var u=i[k],z=c.event.special[k]||{};if(!u){u=i[k]=[];if(!z.setup||z.setup.call(a,f,r,o)===false)if(a.addEventListener)a.addEventListener(k,o,false);else a.attachEvent&&a.attachEvent("on"+k,o)}if(z.add){z.add.call(a,j);if(!j.handler.guid)j.handler.guid=d.guid}u.push(j);c.event.global[k]=true}a=null}}},global:{},remove:function(a,b,d,f){if(!(a.nodeType===3||a.nodeType===8)){var e,j=0,i,o,k,n,r,u,z=c.data(a),
C=z&&z.events;if(z&&C){if(b&&b.type){d=b.handler;b=b.type}if(!b||typeof b==="string"&&b.charAt(0)==="."){b=b||"";for(e in C)c.event.remove(a,e+b)}else{for(b=b.split(" ");e=b[j++];){n=e;i=e.indexOf(".")<0;o=[];if(!i){o=e.split(".");e=o.shift();k=new RegExp("(^|\\.)"+c.map(o.slice(0).sort(),db).join("\\.(?:.*\\.)?")+"(\\.|$)")}if(r=C[e])if(d){n=c.event.special[e]||{};for(B=f||0;B<r.length;B++){u=r[B];if(d.guid===u.guid){if(i||k.test(u.namespace)){f==null&&r.splice(B--,1);n.remove&&n.remove.call(a,u)}if(f!=
null)break}}if(r.length===0||f!=null&&r.length===1){if(!n.teardown||n.teardown.call(a,o)===false)Ca(a,e,z.handle);delete C[e]}}else for(var B=0;B<r.length;B++){u=r[B];if(i||k.test(u.namespace)){c.event.remove(a,n,u.handler,B);r.splice(B--,1)}}}if(c.isEmptyObject(C)){if(b=z.handle)b.elem=null;delete z.events;delete z.handle;c.isEmptyObject(z)&&c.removeData(a)}}}}},trigger:function(a,b,d,f){var e=a.type||a;if(!f){a=typeof a==="object"?a[G]?a:c.extend(c.Event(e),a):c.Event(e);if(e.indexOf("!")>=0){a.type=
e=e.slice(0,-1);a.exclusive=true}if(!d){a.stopPropagation();c.event.global[e]&&c.each(c.cache,function(){this.events&&this.events[e]&&c.event.trigger(a,b,this.handle.elem)})}if(!d||d.nodeType===3||d.nodeType===8)return w;a.result=w;a.target=d;b=c.makeArray(b);b.unshift(a)}a.currentTarget=d;(f=c.data(d,"handle"))&&f.apply(d,b);f=d.parentNode||d.ownerDocument;try{if(!(d&&d.nodeName&&c.noData[d.nodeName.toLowerCase()]))if(d["on"+e]&&d["on"+e].apply(d,b)===false)a.result=false}catch(j){}if(!a.isPropagationStopped()&&
f)c.event.trigger(a,b,f,true);else if(!a.isDefaultPrevented()){f=a.target;var i,o=c.nodeName(f,"a")&&e==="click",k=c.event.special[e]||{};if((!k._default||k._default.call(d,a)===false)&&!o&&!(f&&f.nodeName&&c.noData[f.nodeName.toLowerCase()])){try{if(f[e]){if(i=f["on"+e])f["on"+e]=null;c.event.triggered=true;f[e]()}}catch(n){}if(i)f["on"+e]=i;c.event.triggered=false}}},handle:function(a){var b,d,f,e;a=arguments[0]=c.event.fix(a||A.event);a.currentTarget=this;b=a.type.indexOf(".")<0&&!a.exclusive;
if(!b){d=a.type.split(".");a.type=d.shift();f=new RegExp("(^|\\.)"+d.slice(0).sort().join("\\.(?:.*\\.)?")+"(\\.|$)")}e=c.data(this,"events");d=e[a.type];if(e&&d){d=d.slice(0);e=0;for(var j=d.length;e<j;e++){var i=d[e];if(b||f.test(i.namespace)){a.handler=i.handler;a.data=i.data;a.handleObj=i;i=i.handler.apply(this,arguments);if(i!==w){a.result=i;if(i===false){a.preventDefault();a.stopPropagation()}}if(a.isImmediatePropagationStopped())break}}}return a.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),
fix:function(a){if(a[G])return a;var b=a;a=c.Event(b);for(var d=this.props.length,f;d;){f=this.props[--d];a[f]=b[f]}if(!a.target)a.target=a.srcElement||s;if(a.target.nodeType===3)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;if(a.pageX==null&&a.clientX!=null){b=s.documentElement;d=s.body;a.pageX=a.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||
d&&d.scrollTop||0)-(b&&b.clientTop||d&&d.clientTop||0)}if(!a.which&&(a.charCode||a.charCode===0?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button!==w)a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;return a},guid:1E8,proxy:c.proxy,special:{ready:{setup:c.bindReady,teardown:c.noop},live:{add:function(a){c.event.add(this,a.origType,c.extend({},a,{handler:oa}))},remove:function(a){var b=true,d=a.origType.replace(O,"");c.each(c.data(this,
"events").live||[],function(){if(d===this.origType.replace(O,""))return b=false});b&&c.event.remove(this,a.origType,oa)}},beforeunload:{setup:function(a,b,d){if(this.setInterval)this.onbeforeunload=d;return false},teardown:function(a,b){if(this.onbeforeunload===b)this.onbeforeunload=null}}}};var Ca=s.removeEventListener?function(a,b,d){a.removeEventListener(b,d,false)}:function(a,b,d){a.detachEvent("on"+b,d)};c.Event=function(a){if(!this.preventDefault)return new c.Event(a);if(a&&a.type){this.originalEvent=
a;this.type=a.type}else this.type=a;this.timeStamp=J();this[G]=true};c.Event.prototype={preventDefault:function(){this.isDefaultPrevented=Z;var a=this.originalEvent;if(a){a.preventDefault&&a.preventDefault();a.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=Z;var a=this.originalEvent;if(a){a.stopPropagation&&a.stopPropagation();a.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Z;this.stopPropagation()},isDefaultPrevented:Y,isPropagationStopped:Y,
isImmediatePropagationStopped:Y};var Da=function(a){var b=a.relatedTarget;try{for(;b&&b!==this;)b=b.parentNode;if(b!==this){a.type=a.data;c.event.handle.apply(this,arguments)}}catch(d){}},Ea=function(a){a.type=a.data;c.event.handle.apply(this,arguments)};c.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){c.event.special[a]={setup:function(d){c.event.add(this,b,d&&d.selector?Ea:Da,a)},teardown:function(d){c.event.remove(this,b,d&&d.selector?Ea:Da)}}});if(!c.support.submitBubbles)c.event.special.submit=
{setup:function(){if(this.nodeName.toLowerCase()!=="form"){c.event.add(this,"click.specialSubmit",function(a){var b=a.target,d=b.type;if((d==="submit"||d==="image")&&c(b).closest("form").length)return na("submit",this,arguments)});c.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,d=b.type;if((d==="text"||d==="password")&&c(b).closest("form").length&&a.keyCode===13)return na("submit",this,arguments)})}else return false},teardown:function(){c.event.remove(this,".specialSubmit")}};
if(!c.support.changeBubbles){var da=/textarea|input|select/i,ea,Fa=function(a){var b=a.type,d=a.value;if(b==="radio"||b==="checkbox")d=a.checked;else if(b==="select-multiple")d=a.selectedIndex>-1?c.map(a.options,function(f){return f.selected}).join("-"):"";else if(a.nodeName.toLowerCase()==="select")d=a.selectedIndex;return d},fa=function(a,b){var d=a.target,f,e;if(!(!da.test(d.nodeName)||d.readOnly)){f=c.data(d,"_change_data");e=Fa(d);if(a.type!=="focusout"||d.type!=="radio")c.data(d,"_change_data",
e);if(!(f===w||e===f))if(f!=null||e){a.type="change";return c.event.trigger(a,b,d)}}};c.event.special.change={filters:{focusout:fa,click:function(a){var b=a.target,d=b.type;if(d==="radio"||d==="checkbox"||b.nodeName.toLowerCase()==="select")return fa.call(this,a)},keydown:function(a){var b=a.target,d=b.type;if(a.keyCode===13&&b.nodeName.toLowerCase()!=="textarea"||a.keyCode===32&&(d==="checkbox"||d==="radio")||d==="select-multiple")return fa.call(this,a)},beforeactivate:function(a){a=a.target;c.data(a,
"_change_data",Fa(a))}},setup:function(){if(this.type==="file")return false;for(var a in ea)c.event.add(this,a+".specialChange",ea[a]);return da.test(this.nodeName)},teardown:function(){c.event.remove(this,".specialChange");return da.test(this.nodeName)}};ea=c.event.special.change.filters}s.addEventListener&&c.each({focus:"focusin",blur:"focusout"},function(a,b){function d(f){f=c.event.fix(f);f.type=b;return c.event.handle.call(this,f)}c.event.special[b]={setup:function(){this.addEventListener(a,
d,true)},teardown:function(){this.removeEventListener(a,d,true)}}});c.each(["bind","one"],function(a,b){c.fn[b]=function(d,f,e){if(typeof d==="object"){for(var j in d)this[b](j,f,d[j],e);return this}if(c.isFunction(f)){e=f;f=w}var i=b==="one"?c.proxy(e,function(k){c(this).unbind(k,i);return e.apply(this,arguments)}):e;if(d==="unload"&&b!=="one")this.one(d,f,e);else{j=0;for(var o=this.length;j<o;j++)c.event.add(this[j],d,i,f)}return this}});c.fn.extend({unbind:function(a,b){if(typeof a==="object"&&
!a.preventDefault)for(var d in a)this.unbind(d,a[d]);else{d=0;for(var f=this.length;d<f;d++)c.event.remove(this[d],a,b)}return this},delegate:function(a,b,d,f){return this.live(b,d,f,a)},undelegate:function(a,b,d){return arguments.length===0?this.unbind("live"):this.die(b,null,d,a)},trigger:function(a,b){return this.each(function(){c.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0]){a=c.Event(a);a.preventDefault();a.stopPropagation();c.event.trigger(a,b,this[0]);return a.result}},
toggle:function(a){for(var b=arguments,d=1;d<b.length;)c.proxy(a,b[d++]);return this.click(c.proxy(a,function(f){var e=(c.data(this,"lastToggle"+a.guid)||0)%d;c.data(this,"lastToggle"+a.guid,e+1);f.preventDefault();return b[e].apply(this,arguments)||false}))},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var Ga={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};c.each(["live","die"],function(a,b){c.fn[b]=function(d,f,e,j){var i,o=0,k,n,r=j||this.selector,
u=j?this:c(this.context);if(c.isFunction(f)){e=f;f=w}for(d=(d||"").split(" ");(i=d[o++])!=null;){j=O.exec(i);k="";if(j){k=j[0];i=i.replace(O,"")}if(i==="hover")d.push("mouseenter"+k,"mouseleave"+k);else{n=i;if(i==="focus"||i==="blur"){d.push(Ga[i]+k);i+=k}else i=(Ga[i]||i)+k;b==="live"?u.each(function(){c.event.add(this,pa(i,r),{data:f,selector:r,handler:e,origType:i,origHandler:e,preType:n})}):u.unbind(pa(i,r),e)}}return this}});c.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),
function(a,b){c.fn[b]=function(d){return d?this.bind(b,d):this.trigger(b)};if(c.attrFn)c.attrFn[b]=true});A.attachEvent&&!A.addEventListener&&A.attachEvent("onunload",function(){for(var a in c.cache)if(c.cache[a].handle)try{c.event.remove(c.cache[a].handle.elem)}catch(b){}});(function(){function a(g){for(var h="",l,m=0;g[m];m++){l=g[m];if(l.nodeType===3||l.nodeType===4)h+=l.nodeValue;else if(l.nodeType!==8)h+=a(l.childNodes)}return h}function b(g,h,l,m,q,p){q=0;for(var v=m.length;q<v;q++){var t=m[q];
if(t){t=t[g];for(var y=false;t;){if(t.sizcache===l){y=m[t.sizset];break}if(t.nodeType===1&&!p){t.sizcache=l;t.sizset=q}if(t.nodeName.toLowerCase()===h){y=t;break}t=t[g]}m[q]=y}}}function d(g,h,l,m,q,p){q=0;for(var v=m.length;q<v;q++){var t=m[q];if(t){t=t[g];for(var y=false;t;){if(t.sizcache===l){y=m[t.sizset];break}if(t.nodeType===1){if(!p){t.sizcache=l;t.sizset=q}if(typeof h!=="string"){if(t===h){y=true;break}}else if(k.filter(h,[t]).length>0){y=t;break}}t=t[g]}m[q]=y}}}var f=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,
e=0,j=Object.prototype.toString,i=false,o=true;[0,0].sort(function(){o=false;return 0});var k=function(g,h,l,m){l=l||[];var q=h=h||s;if(h.nodeType!==1&&h.nodeType!==9)return[];if(!g||typeof g!=="string")return l;for(var p=[],v,t,y,S,H=true,M=x(h),I=g;(f.exec(""),v=f.exec(I))!==null;){I=v[3];p.push(v[1]);if(v[2]){S=v[3];break}}if(p.length>1&&r.exec(g))if(p.length===2&&n.relative[p[0]])t=ga(p[0]+p[1],h);else for(t=n.relative[p[0]]?[h]:k(p.shift(),h);p.length;){g=p.shift();if(n.relative[g])g+=p.shift();
t=ga(g,t)}else{if(!m&&p.length>1&&h.nodeType===9&&!M&&n.match.ID.test(p[0])&&!n.match.ID.test(p[p.length-1])){v=k.find(p.shift(),h,M);h=v.expr?k.filter(v.expr,v.set)[0]:v.set[0]}if(h){v=m?{expr:p.pop(),set:z(m)}:k.find(p.pop(),p.length===1&&(p[0]==="~"||p[0]==="+")&&h.parentNode?h.parentNode:h,M);t=v.expr?k.filter(v.expr,v.set):v.set;if(p.length>0)y=z(t);else H=false;for(;p.length;){var D=p.pop();v=D;if(n.relative[D])v=p.pop();else D="";if(v==null)v=h;n.relative[D](y,v,M)}}else y=[]}y||(y=t);y||k.error(D||
g);if(j.call(y)==="[object Array]")if(H)if(h&&h.nodeType===1)for(g=0;y[g]!=null;g++){if(y[g]&&(y[g]===true||y[g].nodeType===1&&E(h,y[g])))l.push(t[g])}else for(g=0;y[g]!=null;g++)y[g]&&y[g].nodeType===1&&l.push(t[g]);else l.push.apply(l,y);else z(y,l);if(S){k(S,q,l,m);k.uniqueSort(l)}return l};k.uniqueSort=function(g){if(B){i=o;g.sort(B);if(i)for(var h=1;h<g.length;h++)g[h]===g[h-1]&&g.splice(h--,1)}return g};k.matches=function(g,h){return k(g,null,null,h)};k.find=function(g,h,l){var m,q;if(!g)return[];
for(var p=0,v=n.order.length;p<v;p++){var t=n.order[p];if(q=n.leftMatch[t].exec(g)){var y=q[1];q.splice(1,1);if(y.substr(y.length-1)!=="\\"){q[1]=(q[1]||"").replace(/\\/g,"");m=n.find[t](q,h,l);if(m!=null){g=g.replace(n.match[t],"");break}}}}m||(m=h.getElementsByTagName("*"));return{set:m,expr:g}};k.filter=function(g,h,l,m){for(var q=g,p=[],v=h,t,y,S=h&&h[0]&&x(h[0]);g&&h.length;){for(var H in n.filter)if((t=n.leftMatch[H].exec(g))!=null&&t[2]){var M=n.filter[H],I,D;D=t[1];y=false;t.splice(1,1);if(D.substr(D.length-
1)!=="\\"){if(v===p)p=[];if(n.preFilter[H])if(t=n.preFilter[H](t,v,l,p,m,S)){if(t===true)continue}else y=I=true;if(t)for(var U=0;(D=v[U])!=null;U++)if(D){I=M(D,t,U,v);var Ha=m^!!I;if(l&&I!=null)if(Ha)y=true;else v[U]=false;else if(Ha){p.push(D);y=true}}if(I!==w){l||(v=p);g=g.replace(n.match[H],"");if(!y)return[];break}}}if(g===q)if(y==null)k.error(g);else break;q=g}return v};k.error=function(g){throw"Syntax error, unrecognized expression: "+g;};var n=k.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,
CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(g){return g.getAttribute("href")}},
relative:{"+":function(g,h){var l=typeof h==="string",m=l&&!/\W/.test(h);l=l&&!m;if(m)h=h.toLowerCase();m=0;for(var q=g.length,p;m<q;m++)if(p=g[m]){for(;(p=p.previousSibling)&&p.nodeType!==1;);g[m]=l||p&&p.nodeName.toLowerCase()===h?p||false:p===h}l&&k.filter(h,g,true)},">":function(g,h){var l=typeof h==="string";if(l&&!/\W/.test(h)){h=h.toLowerCase();for(var m=0,q=g.length;m<q;m++){var p=g[m];if(p){l=p.parentNode;g[m]=l.nodeName.toLowerCase()===h?l:false}}}else{m=0;for(q=g.length;m<q;m++)if(p=g[m])g[m]=
l?p.parentNode:p.parentNode===h;l&&k.filter(h,g,true)}},"":function(g,h,l){var m=e++,q=d;if(typeof h==="string"&&!/\W/.test(h)){var p=h=h.toLowerCase();q=b}q("parentNode",h,m,g,p,l)},"~":function(g,h,l){var m=e++,q=d;if(typeof h==="string"&&!/\W/.test(h)){var p=h=h.toLowerCase();q=b}q("previousSibling",h,m,g,p,l)}},find:{ID:function(g,h,l){if(typeof h.getElementById!=="undefined"&&!l)return(g=h.getElementById(g[1]))?[g]:[]},NAME:function(g,h){if(typeof h.getElementsByName!=="undefined"){var l=[];
h=h.getElementsByName(g[1]);for(var m=0,q=h.length;m<q;m++)h[m].getAttribute("name")===g[1]&&l.push(h[m]);return l.length===0?null:l}},TAG:function(g,h){return h.getElementsByTagName(g[1])}},preFilter:{CLASS:function(g,h,l,m,q,p){g=" "+g[1].replace(/\\/g,"")+" ";if(p)return g;p=0;for(var v;(v=h[p])!=null;p++)if(v)if(q^(v.className&&(" "+v.className+" ").replace(/[\t\n]/g," ").indexOf(g)>=0))l||m.push(v);else if(l)h[p]=false;return false},ID:function(g){return g[1].replace(/\\/g,"")},TAG:function(g){return g[1].toLowerCase()},
CHILD:function(g){if(g[1]==="nth"){var h=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(g[2]==="even"&&"2n"||g[2]==="odd"&&"2n+1"||!/\D/.test(g[2])&&"0n+"+g[2]||g[2]);g[2]=h[1]+(h[2]||1)-0;g[3]=h[3]-0}g[0]=e++;return g},ATTR:function(g,h,l,m,q,p){h=g[1].replace(/\\/g,"");if(!p&&n.attrMap[h])g[1]=n.attrMap[h];if(g[2]==="~=")g[4]=" "+g[4]+" ";return g},PSEUDO:function(g,h,l,m,q){if(g[1]==="not")if((f.exec(g[3])||"").length>1||/^\w/.test(g[3]))g[3]=k(g[3],null,null,h);else{g=k.filter(g[3],h,l,true^q);l||m.push.apply(m,
g);return false}else if(n.match.POS.test(g[0])||n.match.CHILD.test(g[0]))return true;return g},POS:function(g){g.unshift(true);return g}},filters:{enabled:function(g){return g.disabled===false&&g.type!=="hidden"},disabled:function(g){return g.disabled===true},checked:function(g){return g.checked===true},selected:function(g){return g.selected===true},parent:function(g){return!!g.firstChild},empty:function(g){return!g.firstChild},has:function(g,h,l){return!!k(l[3],g).length},header:function(g){return/h\d/i.test(g.nodeName)},
text:function(g){return"text"===g.type},radio:function(g){return"radio"===g.type},checkbox:function(g){return"checkbox"===g.type},file:function(g){return"file"===g.type},password:function(g){return"password"===g.type},submit:function(g){return"submit"===g.type},image:function(g){return"image"===g.type},reset:function(g){return"reset"===g.type},button:function(g){return"button"===g.type||g.nodeName.toLowerCase()==="button"},input:function(g){return/input|select|textarea|button/i.test(g.nodeName)}},
setFilters:{first:function(g,h){return h===0},last:function(g,h,l,m){return h===m.length-1},even:function(g,h){return h%2===0},odd:function(g,h){return h%2===1},lt:function(g,h,l){return h<l[3]-0},gt:function(g,h,l){return h>l[3]-0},nth:function(g,h,l){return l[3]-0===h},eq:function(g,h,l){return l[3]-0===h}},filter:{PSEUDO:function(g,h,l,m){var q=h[1],p=n.filters[q];if(p)return p(g,l,h,m);else if(q==="contains")return(g.textContent||g.innerText||a([g])||"").indexOf(h[3])>=0;else if(q==="not"){h=
h[3];l=0;for(m=h.length;l<m;l++)if(h[l]===g)return false;return true}else k.error("Syntax error, unrecognized expression: "+q)},CHILD:function(g,h){var l=h[1],m=g;switch(l){case "only":case "first":for(;m=m.previousSibling;)if(m.nodeType===1)return false;if(l==="first")return true;m=g;case "last":for(;m=m.nextSibling;)if(m.nodeType===1)return false;return true;case "nth":l=h[2];var q=h[3];if(l===1&&q===0)return true;h=h[0];var p=g.parentNode;if(p&&(p.sizcache!==h||!g.nodeIndex)){var v=0;for(m=p.firstChild;m;m=
m.nextSibling)if(m.nodeType===1)m.nodeIndex=++v;p.sizcache=h}g=g.nodeIndex-q;return l===0?g===0:g%l===0&&g/l>=0}},ID:function(g,h){return g.nodeType===1&&g.getAttribute("id")===h},TAG:function(g,h){return h==="*"&&g.nodeType===1||g.nodeName.toLowerCase()===h},CLASS:function(g,h){return(" "+(g.className||g.getAttribute("class"))+" ").indexOf(h)>-1},ATTR:function(g,h){var l=h[1];g=n.attrHandle[l]?n.attrHandle[l](g):g[l]!=null?g[l]:g.getAttribute(l);l=g+"";var m=h[2];h=h[4];return g==null?m==="!=":m===
"="?l===h:m==="*="?l.indexOf(h)>=0:m==="~="?(" "+l+" ").indexOf(h)>=0:!h?l&&g!==false:m==="!="?l!==h:m==="^="?l.indexOf(h)===0:m==="$="?l.substr(l.length-h.length)===h:m==="|="?l===h||l.substr(0,h.length+1)===h+"-":false},POS:function(g,h,l,m){var q=n.setFilters[h[2]];if(q)return q(g,l,h,m)}}},r=n.match.POS;for(var u in n.match){n.match[u]=new RegExp(n.match[u].source+/(?![^\[]*\])(?![^\(]*\))/.source);n.leftMatch[u]=new RegExp(/(^(?:.|\r|\n)*?)/.source+n.match[u].source.replace(/\\(\d+)/g,function(g,
h){return"\\"+(h-0+1)}))}var z=function(g,h){g=Array.prototype.slice.call(g,0);if(h){h.push.apply(h,g);return h}return g};try{Array.prototype.slice.call(s.documentElement.childNodes,0)}catch(C){z=function(g,h){h=h||[];if(j.call(g)==="[object Array]")Array.prototype.push.apply(h,g);else if(typeof g.length==="number")for(var l=0,m=g.length;l<m;l++)h.push(g[l]);else for(l=0;g[l];l++)h.push(g[l]);return h}}var B;if(s.documentElement.compareDocumentPosition)B=function(g,h){if(!g.compareDocumentPosition||
!h.compareDocumentPosition){if(g==h)i=true;return g.compareDocumentPosition?-1:1}g=g.compareDocumentPosition(h)&4?-1:g===h?0:1;if(g===0)i=true;return g};else if("sourceIndex"in s.documentElement)B=function(g,h){if(!g.sourceIndex||!h.sourceIndex){if(g==h)i=true;return g.sourceIndex?-1:1}g=g.sourceIndex-h.sourceIndex;if(g===0)i=true;return g};else if(s.createRange)B=function(g,h){if(!g.ownerDocument||!h.ownerDocument){if(g==h)i=true;return g.ownerDocument?-1:1}var l=g.ownerDocument.createRange(),m=
h.ownerDocument.createRange();l.setStart(g,0);l.setEnd(g,0);m.setStart(h,0);m.setEnd(h,0);g=l.compareBoundaryPoints(Range.START_TO_END,m);if(g===0)i=true;return g};(function(){var g=s.createElement("div"),h="script"+(new Date).getTime();g.innerHTML="<a name='"+h+"'/>";var l=s.documentElement;l.insertBefore(g,l.firstChild);if(s.getElementById(h)){n.find.ID=function(m,q,p){if(typeof q.getElementById!=="undefined"&&!p)return(q=q.getElementById(m[1]))?q.id===m[1]||typeof q.getAttributeNode!=="undefined"&&
q.getAttributeNode("id").nodeValue===m[1]?[q]:w:[]};n.filter.ID=function(m,q){var p=typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id");return m.nodeType===1&&p&&p.nodeValue===q}}l.removeChild(g);l=g=null})();(function(){var g=s.createElement("div");g.appendChild(s.createComment(""));if(g.getElementsByTagName("*").length>0)n.find.TAG=function(h,l){l=l.getElementsByTagName(h[1]);if(h[1]==="*"){h=[];for(var m=0;l[m];m++)l[m].nodeType===1&&h.push(l[m]);l=h}return l};g.innerHTML="<a href='#'></a>";
if(g.firstChild&&typeof g.firstChild.getAttribute!=="undefined"&&g.firstChild.getAttribute("href")!=="#")n.attrHandle.href=function(h){return h.getAttribute("href",2)};g=null})();s.querySelectorAll&&function(){var g=k,h=s.createElement("div");h.innerHTML="<p class='TEST'></p>";if(!(h.querySelectorAll&&h.querySelectorAll(".TEST").length===0)){k=function(m,q,p,v){q=q||s;if(!v&&q.nodeType===9&&!x(q))try{return z(q.querySelectorAll(m),p)}catch(t){}return g(m,q,p,v)};for(var l in g)k[l]=g[l];h=null}}();
(function(){var g=s.createElement("div");g.innerHTML="<div class='test e'></div><div class='test'></div>";if(!(!g.getElementsByClassName||g.getElementsByClassName("e").length===0)){g.lastChild.className="e";if(g.getElementsByClassName("e").length!==1){n.order.splice(1,0,"CLASS");n.find.CLASS=function(h,l,m){if(typeof l.getElementsByClassName!=="undefined"&&!m)return l.getElementsByClassName(h[1])};g=null}}})();var E=s.compareDocumentPosition?function(g,h){return!!(g.compareDocumentPosition(h)&16)}:
function(g,h){return g!==h&&(g.contains?g.contains(h):true)},x=function(g){return(g=(g?g.ownerDocument||g:0).documentElement)?g.nodeName!=="HTML":false},ga=function(g,h){var l=[],m="",q;for(h=h.nodeType?[h]:h;q=n.match.PSEUDO.exec(g);){m+=q[0];g=g.replace(n.match.PSEUDO,"")}g=n.relative[g]?g+"*":g;q=0;for(var p=h.length;q<p;q++)k(g,h[q],l);return k.filter(m,l)};c.find=k;c.expr=k.selectors;c.expr[":"]=c.expr.filters;c.unique=k.uniqueSort;c.text=a;c.isXMLDoc=x;c.contains=E})();var eb=/Until$/,fb=/^(?:parents|prevUntil|prevAll)/,
gb=/,/;R=Array.prototype.slice;var Ia=function(a,b,d){if(c.isFunction(b))return c.grep(a,function(e,j){return!!b.call(e,j,e)===d});else if(b.nodeType)return c.grep(a,function(e){return e===b===d});else if(typeof b==="string"){var f=c.grep(a,function(e){return e.nodeType===1});if(Ua.test(b))return c.filter(b,f,!d);else b=c.filter(b,f)}return c.grep(a,function(e){return c.inArray(e,b)>=0===d})};c.fn.extend({find:function(a){for(var b=this.pushStack("","find",a),d=0,f=0,e=this.length;f<e;f++){d=b.length;
c.find(a,this[f],b);if(f>0)for(var j=d;j<b.length;j++)for(var i=0;i<d;i++)if(b[i]===b[j]){b.splice(j--,1);break}}return b},has:function(a){var b=c(a);return this.filter(function(){for(var d=0,f=b.length;d<f;d++)if(c.contains(this,b[d]))return true})},not:function(a){return this.pushStack(Ia(this,a,false),"not",a)},filter:function(a){return this.pushStack(Ia(this,a,true),"filter",a)},is:function(a){return!!a&&c.filter(a,this).length>0},closest:function(a,b){if(c.isArray(a)){var d=[],f=this[0],e,j=
{},i;if(f&&a.length){e=0;for(var o=a.length;e<o;e++){i=a[e];j[i]||(j[i]=c.expr.match.POS.test(i)?c(i,b||this.context):i)}for(;f&&f.ownerDocument&&f!==b;){for(i in j){e=j[i];if(e.jquery?e.index(f)>-1:c(f).is(e)){d.push({selector:i,elem:f});delete j[i]}}f=f.parentNode}}return d}var k=c.expr.match.POS.test(a)?c(a,b||this.context):null;return this.map(function(n,r){for(;r&&r.ownerDocument&&r!==b;){if(k?k.index(r)>-1:c(r).is(a))return r;r=r.parentNode}return null})},index:function(a){if(!a||typeof a===
"string")return c.inArray(this[0],a?c(a):this.parent().children());return c.inArray(a.jquery?a[0]:a,this)},add:function(a,b){a=typeof a==="string"?c(a,b||this.context):c.makeArray(a);b=c.merge(this.get(),a);return this.pushStack(qa(a[0])||qa(b[0])?b:c.unique(b))},andSelf:function(){return this.add(this.prevObject)}});c.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},parents:function(a){return c.dir(a,"parentNode")},parentsUntil:function(a,b,d){return c.dir(a,"parentNode",
d)},next:function(a){return c.nth(a,2,"nextSibling")},prev:function(a){return c.nth(a,2,"previousSibling")},nextAll:function(a){return c.dir(a,"nextSibling")},prevAll:function(a){return c.dir(a,"previousSibling")},nextUntil:function(a,b,d){return c.dir(a,"nextSibling",d)},prevUntil:function(a,b,d){return c.dir(a,"previousSibling",d)},siblings:function(a){return c.sibling(a.parentNode.firstChild,a)},children:function(a){return c.sibling(a.firstChild)},contents:function(a){return c.nodeName(a,"iframe")?
a.contentDocument||a.contentWindow.document:c.makeArray(a.childNodes)}},function(a,b){c.fn[a]=function(d,f){var e=c.map(this,b,d);eb.test(a)||(f=d);if(f&&typeof f==="string")e=c.filter(f,e);e=this.length>1?c.unique(e):e;if((this.length>1||gb.test(f))&&fb.test(a))e=e.reverse();return this.pushStack(e,a,R.call(arguments).join(","))}});c.extend({filter:function(a,b,d){if(d)a=":not("+a+")";return c.find.matches(a,b)},dir:function(a,b,d){var f=[];for(a=a[b];a&&a.nodeType!==9&&(d===w||a.nodeType!==1||!c(a).is(d));){a.nodeType===
1&&f.push(a);a=a[b]}return f},nth:function(a,b,d){b=b||1;for(var f=0;a;a=a[d])if(a.nodeType===1&&++f===b)break;return a},sibling:function(a,b){for(var d=[];a;a=a.nextSibling)a.nodeType===1&&a!==b&&d.push(a);return d}});var Ja=/ jQuery\d+="(?:\d+|null)"/g,V=/^\s+/,Ka=/(<([\w:]+)[^>]*?)\/>/g,hb=/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i,La=/<([\w:]+)/,ib=/<tbody/i,jb=/<|&#?\w+;/,ta=/<script|<object|<embed|<option|<style/i,ua=/checked\s*(?:[^=]|=\s*.checked.)/i,Ma=function(a,b,d){return hb.test(d)?
a:b+"></"+d+">"},F={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};F.optgroup=F.option;F.tbody=F.tfoot=F.colgroup=F.caption=F.thead;F.th=F.td;if(!c.support.htmlSerialize)F._default=[1,"div<div>","</div>"];c.fn.extend({text:function(a){if(c.isFunction(a))return this.each(function(b){var d=
c(this);d.text(a.call(this,b,d.text()))});if(typeof a!=="object"&&a!==w)return this.empty().append((this[0]&&this[0].ownerDocument||s).createTextNode(a));return c.text(this)},wrapAll:function(a){if(c.isFunction(a))return this.each(function(d){c(this).wrapAll(a.call(this,d))});if(this[0]){var b=c(a,this[0].ownerDocument).eq(0).clone(true);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var d=this;d.firstChild&&d.firstChild.nodeType===1;)d=d.firstChild;return d}).append(this)}return this},
wrapInner:function(a){if(c.isFunction(a))return this.each(function(b){c(this).wrapInner(a.call(this,b))});return this.each(function(){var b=c(this),d=b.contents();d.length?d.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){c(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){c.nodeName(this,"body")||c(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.appendChild(a)})},
prepend:function(){return this.domManip(arguments,true,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,this)});else if(arguments.length){var a=c(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(b){this.parentNode.insertBefore(b,
this.nextSibling)});else if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,c(arguments[0]).toArray());return a}},remove:function(a,b){for(var d=0,f;(f=this[d])!=null;d++)if(!a||c.filter(a,[f]).length){if(!b&&f.nodeType===1){c.cleanData(f.getElementsByTagName("*"));c.cleanData([f])}f.parentNode&&f.parentNode.removeChild(f)}return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++)for(b.nodeType===1&&c.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);
return this},clone:function(a){var b=this.map(function(){if(!c.support.noCloneEvent&&!c.isXMLDoc(this)){var d=this.outerHTML,f=this.ownerDocument;if(!d){d=f.createElement("div");d.appendChild(this.cloneNode(true));d=d.innerHTML}return c.clean([d.replace(Ja,"").replace(/=([^="'>\s]+\/)>/g,'="$1">').replace(V,"")],f)[0]}else return this.cloneNode(true)});if(a===true){ra(this,b);ra(this.find("*"),b.find("*"))}return b},html:function(a){if(a===w)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(Ja,
""):null;else if(typeof a==="string"&&!ta.test(a)&&(c.support.leadingWhitespace||!V.test(a))&&!F[(La.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Ka,Ma);try{for(var b=0,d=this.length;b<d;b++)if(this[b].nodeType===1){c.cleanData(this[b].getElementsByTagName("*"));this[b].innerHTML=a}}catch(f){this.empty().append(a)}}else c.isFunction(a)?this.each(function(e){var j=c(this),i=j.html();j.empty().append(function(){return a.call(this,e,i)})}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&
this[0].parentNode){if(c.isFunction(a))return this.each(function(b){var d=c(this),f=d.html();d.replaceWith(a.call(this,b,f))});if(typeof a!=="string")a=c(a).detach();return this.each(function(){var b=this.nextSibling,d=this.parentNode;c(this).remove();b?c(b).before(a):c(d).append(a)})}else return this.pushStack(c(c.isFunction(a)?a():a),"replaceWith",a)},detach:function(a){return this.remove(a,true)},domManip:function(a,b,d){function f(u){return c.nodeName(u,"table")?u.getElementsByTagName("tbody")[0]||
u.appendChild(u.ownerDocument.createElement("tbody")):u}var e,j,i=a[0],o=[],k;if(!c.support.checkClone&&arguments.length===3&&typeof i==="string"&&ua.test(i))return this.each(function(){c(this).domManip(a,b,d,true)});if(c.isFunction(i))return this.each(function(u){var z=c(this);a[0]=i.call(this,u,b?z.html():w);z.domManip(a,b,d)});if(this[0]){e=i&&i.parentNode;e=c.support.parentNode&&e&&e.nodeType===11&&e.childNodes.length===this.length?{fragment:e}:sa(a,this,o);k=e.fragment;if(j=k.childNodes.length===
1?(k=k.firstChild):k.firstChild){b=b&&c.nodeName(j,"tr");for(var n=0,r=this.length;n<r;n++)d.call(b?f(this[n],j):this[n],n>0||e.cacheable||this.length>1?k.cloneNode(true):k)}o.length&&c.each(o,Qa)}return this}});c.fragments={};c.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){c.fn[a]=function(d){var f=[];d=c(d);var e=this.length===1&&this[0].parentNode;if(e&&e.nodeType===11&&e.childNodes.length===1&&d.length===1){d[b](this[0]);
return this}else{e=0;for(var j=d.length;e<j;e++){var i=(e>0?this.clone(true):this).get();c.fn[b].apply(c(d[e]),i);f=f.concat(i)}return this.pushStack(f,a,d.selector)}}});c.extend({clean:function(a,b,d,f){b=b||s;if(typeof b.createElement==="undefined")b=b.ownerDocument||b[0]&&b[0].ownerDocument||s;for(var e=[],j=0,i;(i=a[j])!=null;j++){if(typeof i==="number")i+="";if(i){if(typeof i==="string"&&!jb.test(i))i=b.createTextNode(i);else if(typeof i==="string"){i=i.replace(Ka,Ma);var o=(La.exec(i)||["",
""])[1].toLowerCase(),k=F[o]||F._default,n=k[0],r=b.createElement("div");for(r.innerHTML=k[1]+i+k[2];n--;)r=r.lastChild;if(!c.support.tbody){n=ib.test(i);o=o==="table"&&!n?r.firstChild&&r.firstChild.childNodes:k[1]==="<table>"&&!n?r.childNodes:[];for(k=o.length-1;k>=0;--k)c.nodeName(o[k],"tbody")&&!o[k].childNodes.length&&o[k].parentNode.removeChild(o[k])}!c.support.leadingWhitespace&&V.test(i)&&r.insertBefore(b.createTextNode(V.exec(i)[0]),r.firstChild);i=r.childNodes}if(i.nodeType)e.push(i);else e=
c.merge(e,i)}}if(d)for(j=0;e[j];j++)if(f&&c.nodeName(e[j],"script")&&(!e[j].type||e[j].type.toLowerCase()==="text/javascript"))f.push(e[j].parentNode?e[j].parentNode.removeChild(e[j]):e[j]);else{e[j].nodeType===1&&e.splice.apply(e,[j+1,0].concat(c.makeArray(e[j].getElementsByTagName("script"))));d.appendChild(e[j])}return e},cleanData:function(a){for(var b,d,f=c.cache,e=c.event.special,j=c.support.deleteExpando,i=0,o;(o=a[i])!=null;i++)if(d=o[c.expando]){b=f[d];if(b.events)for(var k in b.events)e[k]?
c.event.remove(o,k):Ca(o,k,b.handle);if(j)delete o[c.expando];else o.removeAttribute&&o.removeAttribute(c.expando);delete f[d]}}});var kb=/z-?index|font-?weight|opacity|zoom|line-?height/i,Na=/alpha\([^)]*\)/,Oa=/opacity=([^)]*)/,ha=/float/i,ia=/-([a-z])/ig,lb=/([A-Z])/g,mb=/^-?\d+(?:px)?$/i,nb=/^-?\d/,ob={position:"absolute",visibility:"hidden",display:"block"},pb=["Left","Right"],qb=["Top","Bottom"],rb=s.defaultView&&s.defaultView.getComputedStyle,Pa=c.support.cssFloat?"cssFloat":"styleFloat",ja=
function(a,b){return b.toUpperCase()};c.fn.css=function(a,b){return X(this,a,b,true,function(d,f,e){if(e===w)return c.curCSS(d,f);if(typeof e==="number"&&!kb.test(f))e+="px";c.style(d,f,e)})};c.extend({style:function(a,b,d){if(!a||a.nodeType===3||a.nodeType===8)return w;if((b==="width"||b==="height")&&parseFloat(d)<0)d=w;var f=a.style||a,e=d!==w;if(!c.support.opacity&&b==="opacity"){if(e){f.zoom=1;b=parseInt(d,10)+""==="NaN"?"":"alpha(opacity="+d*100+")";a=f.filter||c.curCSS(a,"filter")||"";f.filter=
Na.test(a)?a.replace(Na,b):b}return f.filter&&f.filter.indexOf("opacity=")>=0?parseFloat(Oa.exec(f.filter)[1])/100+"":""}if(ha.test(b))b=Pa;b=b.replace(ia,ja);if(e)f[b]=d;return f[b]},css:function(a,b,d,f){if(b==="width"||b==="height"){var e,j=b==="width"?pb:qb;function i(){e=b==="width"?a.offsetWidth:a.offsetHeight;f!=="border"&&c.each(j,function(){f||(e-=parseFloat(c.curCSS(a,"padding"+this,true))||0);if(f==="margin")e+=parseFloat(c.curCSS(a,"margin"+this,true))||0;else e-=parseFloat(c.curCSS(a,
"border"+this+"Width",true))||0})}a.offsetWidth!==0?i():c.swap(a,ob,i);return Math.max(0,Math.round(e))}return c.curCSS(a,b,d)},curCSS:function(a,b,d){var f,e=a.style;if(!c.support.opacity&&b==="opacity"&&a.currentStyle){f=Oa.test(a.currentStyle.filter||"")?parseFloat(RegExp.$1)/100+"":"";return f===""?"1":f}if(ha.test(b))b=Pa;if(!d&&e&&e[b])f=e[b];else if(rb){if(ha.test(b))b="float";b=b.replace(lb,"-$1").toLowerCase();e=a.ownerDocument.defaultView;if(!e)return null;if(a=e.getComputedStyle(a,null))f=
a.getPropertyValue(b);if(b==="opacity"&&f==="")f="1"}else if(a.currentStyle){d=b.replace(ia,ja);f=a.currentStyle[b]||a.currentStyle[d];if(!mb.test(f)&&nb.test(f)){b=e.left;var j=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;e.left=d==="fontSize"?"1em":f||0;f=e.pixelLeft+"px";e.left=b;a.runtimeStyle.left=j}}return f},swap:function(a,b,d){var f={};for(var e in b){f[e]=a.style[e];a.style[e]=b[e]}d.call(a);for(e in b)a.style[e]=f[e]}});if(c.expr&&c.expr.filters){c.expr.filters.hidden=function(a){var b=
a.offsetWidth,d=a.offsetHeight,f=a.nodeName.toLowerCase()==="tr";return b===0&&d===0&&!f?true:b>0&&d>0&&!f?false:c.curCSS(a,"display")==="none"};c.expr.filters.visible=function(a){return!c.expr.filters.hidden(a)}}var sb=J(),tb=/<script(.|\s)*?\/script>/gi,ub=/select|textarea/i,vb=/color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i,N=/=\?(&|$)/,ka=/\?/,wb=/(\?|&)_=.*?(&|$)/,xb=/^(\w+:)?\/\/([^\/?#]+)/,yb=/%20/g,zb=c.fn.load;c.fn.extend({load:function(a,b,d){if(typeof a!==
"string")return zb.call(this,a);else if(!this.length)return this;var f=a.indexOf(" ");if(f>=0){var e=a.slice(f,a.length);a=a.slice(0,f)}f="GET";if(b)if(c.isFunction(b)){d=b;b=null}else if(typeof b==="object"){b=c.param(b,c.ajaxSettings.traditional);f="POST"}var j=this;c.ajax({url:a,type:f,dataType:"html",data:b,complete:function(i,o){if(o==="success"||o==="notmodified")j.html(e?c("<div />").append(i.responseText.replace(tb,"")).find(e):i.responseText);d&&j.each(d,[i.responseText,o,i])}});return this},
serialize:function(){return c.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?c.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ub.test(this.nodeName)||vb.test(this.type))}).map(function(a,b){a=c(this).val();return a==null?null:c.isArray(a)?c.map(a,function(d){return{name:b.name,value:d}}):{name:b.name,value:a}}).get()}});c.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),
function(a,b){c.fn[b]=function(d){return this.bind(b,d)}});c.extend({get:function(a,b,d,f){if(c.isFunction(b)){f=f||d;d=b;b=null}return c.ajax({type:"GET",url:a,data:b,success:d,dataType:f})},getScript:function(a,b){return c.get(a,null,b,"script")},getJSON:function(a,b,d){return c.get(a,b,d,"json")},post:function(a,b,d,f){if(c.isFunction(b)){f=f||d;d=b;b={}}return c.ajax({type:"POST",url:a,data:b,success:d,dataType:f})},ajaxSetup:function(a){c.extend(c.ajaxSettings,a)},ajaxSettings:{url:location.href,
global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:A.XMLHttpRequest&&(A.location.protocol!=="file:"||!A.ActiveXObject)?function(){return new A.XMLHttpRequest}:function(){try{return new A.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},etag:{},ajax:function(a){function b(){e.success&&
e.success.call(k,o,i,x);e.global&&f("ajaxSuccess",[x,e])}function d(){e.complete&&e.complete.call(k,x,i);e.global&&f("ajaxComplete",[x,e]);e.global&&!--c.active&&c.event.trigger("ajaxStop")}function f(q,p){(e.context?c(e.context):c.event).trigger(q,p)}var e=c.extend(true,{},c.ajaxSettings,a),j,i,o,k=a&&a.context||e,n=e.type.toUpperCase();if(e.data&&e.processData&&typeof e.data!=="string")e.data=c.param(e.data,e.traditional);if(e.dataType==="jsonp"){if(n==="GET")N.test(e.url)||(e.url+=(ka.test(e.url)?
"&":"?")+(e.jsonp||"callback")+"=?");else if(!e.data||!N.test(e.data))e.data=(e.data?e.data+"&":"")+(e.jsonp||"callback")+"=?";e.dataType="json"}if(e.dataType==="json"&&(e.data&&N.test(e.data)||N.test(e.url))){j=e.jsonpCallback||"jsonp"+sb++;if(e.data)e.data=(e.data+"").replace(N,"="+j+"$1");e.url=e.url.replace(N,"="+j+"$1");e.dataType="script";A[j]=A[j]||function(q){o=q;b();d();A[j]=w;try{delete A[j]}catch(p){}z&&z.removeChild(C)}}if(e.dataType==="script"&&e.cache===null)e.cache=false;if(e.cache===
false&&n==="GET"){var r=J(),u=e.url.replace(wb,"$1_="+r+"$2");e.url=u+(u===e.url?(ka.test(e.url)?"&":"?")+"_="+r:"")}if(e.data&&n==="GET")e.url+=(ka.test(e.url)?"&":"?")+e.data;e.global&&!c.active++&&c.event.trigger("ajaxStart");r=(r=xb.exec(e.url))&&(r[1]&&r[1]!==location.protocol||r[2]!==location.host);if(e.dataType==="script"&&n==="GET"&&r){var z=s.getElementsByTagName("head")[0]||s.documentElement,C=s.createElement("script");C.src=e.url;if(e.scriptCharset)C.charset=e.scriptCharset;if(!j){var B=
false;C.onload=C.onreadystatechange=function(){if(!B&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){B=true;b();d();C.onload=C.onreadystatechange=null;z&&C.parentNode&&z.removeChild(C)}}}z.insertBefore(C,z.firstChild);return w}var E=false,x=e.xhr();if(x){e.username?x.open(n,e.url,e.async,e.username,e.password):x.open(n,e.url,e.async);try{if(e.data||a&&a.contentType)x.setRequestHeader("Content-Type",e.contentType);if(e.ifModified){c.lastModified[e.url]&&x.setRequestHeader("If-Modified-Since",
c.lastModified[e.url]);c.etag[e.url]&&x.setRequestHeader("If-None-Match",c.etag[e.url])}r||x.setRequestHeader("X-Requested-With","XMLHttpRequest");x.setRequestHeader("Accept",e.dataType&&e.accepts[e.dataType]?e.accepts[e.dataType]+", */*":e.accepts._default)}catch(ga){}if(e.beforeSend&&e.beforeSend.call(k,x,e)===false){e.global&&!--c.active&&c.event.trigger("ajaxStop");x.abort();return false}e.global&&f("ajaxSend",[x,e]);var g=x.onreadystatechange=function(q){if(!x||x.readyState===0||q==="abort"){E||
d();E=true;if(x)x.onreadystatechange=c.noop}else if(!E&&x&&(x.readyState===4||q==="timeout")){E=true;x.onreadystatechange=c.noop;i=q==="timeout"?"timeout":!c.httpSuccess(x)?"error":e.ifModified&&c.httpNotModified(x,e.url)?"notmodified":"success";var p;if(i==="success")try{o=c.httpData(x,e.dataType,e)}catch(v){i="parsererror";p=v}if(i==="success"||i==="notmodified")j||b();else c.handleError(e,x,i,p);d();q==="timeout"&&x.abort();if(e.async)x=null}};try{var h=x.abort;x.abort=function(){x&&h.call(x);
g("abort")}}catch(l){}e.async&&e.timeout>0&&setTimeout(function(){x&&!E&&g("timeout")},e.timeout);try{x.send(n==="POST"||n==="PUT"||n==="DELETE"?e.data:null)}catch(m){c.handleError(e,x,null,m);d()}e.async||g();return x}},handleError:function(a,b,d,f){if(a.error)a.error.call(a.context||a,b,d,f);if(a.global)(a.context?c(a.context):c.event).trigger("ajaxError",[b,a,f])},active:0,httpSuccess:function(a){try{return!a.status&&location.protocol==="file:"||a.status>=200&&a.status<300||a.status===304||a.status===
1223||a.status===0}catch(b){}return false},httpNotModified:function(a,b){var d=a.getResponseHeader("Last-Modified"),f=a.getResponseHeader("Etag");if(d)c.lastModified[b]=d;if(f)c.etag[b]=f;return a.status===304||a.status===0},httpData:function(a,b,d){var f=a.getResponseHeader("content-type")||"",e=b==="xml"||!b&&f.indexOf("xml")>=0;a=e?a.responseXML:a.responseText;e&&a.documentElement.nodeName==="parsererror"&&c.error("parsererror");if(d&&d.dataFilter)a=d.dataFilter(a,b);if(typeof a==="string")if(b===
"json"||!b&&f.indexOf("json")>=0)a=c.parseJSON(a);else if(b==="script"||!b&&f.indexOf("javascript")>=0)c.globalEval(a);return a},param:function(a,b){function d(i,o){if(c.isArray(o))c.each(o,function(k,n){b||/\[\]$/.test(i)?f(i,n):d(i+"["+(typeof n==="object"||c.isArray(n)?k:"")+"]",n)});else!b&&o!=null&&typeof o==="object"?c.each(o,function(k,n){d(i+"["+k+"]",n)}):f(i,o)}function f(i,o){o=c.isFunction(o)?o():o;e[e.length]=encodeURIComponent(i)+"="+encodeURIComponent(o)}var e=[];if(b===w)b=c.ajaxSettings.traditional;
if(c.isArray(a)||a.jquery)c.each(a,function(){f(this.name,this.value)});else for(var j in a)d(j,a[j]);return e.join("&").replace(yb,"+")}});var la={},Ab=/toggle|show|hide/,Bb=/^([+-]=)?([\d+-.]+)(.*)$/,W,va=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];c.fn.extend({show:function(a,b){if(a||a===0)return this.animate(K("show",3),a,b);else{a=0;for(b=this.length;a<b;a++){var d=c.data(this[a],"olddisplay");
this[a].style.display=d||"";if(c.css(this[a],"display")==="none"){d=this[a].nodeName;var f;if(la[d])f=la[d];else{var e=c("<"+d+" />").appendTo("body");f=e.css("display");if(f==="none")f="block";e.remove();la[d]=f}c.data(this[a],"olddisplay",f)}}a=0;for(b=this.length;a<b;a++)this[a].style.display=c.data(this[a],"olddisplay")||"";return this}},hide:function(a,b){if(a||a===0)return this.animate(K("hide",3),a,b);else{a=0;for(b=this.length;a<b;a++){var d=c.data(this[a],"olddisplay");!d&&d!=="none"&&c.data(this[a],
"olddisplay",c.css(this[a],"display"))}a=0;for(b=this.length;a<b;a++)this[a].style.display="none";return this}},_toggle:c.fn.toggle,toggle:function(a,b){var d=typeof a==="boolean";if(c.isFunction(a)&&c.isFunction(b))this._toggle.apply(this,arguments);else a==null||d?this.each(function(){var f=d?a:c(this).is(":hidden");c(this)[f?"show":"hide"]()}):this.animate(K("toggle",3),a,b);return this},fadeTo:function(a,b,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,d)},
animate:function(a,b,d,f){var e=c.speed(b,d,f);if(c.isEmptyObject(a))return this.each(e.complete);return this[e.queue===false?"each":"queue"](function(){var j=c.extend({},e),i,o=this.nodeType===1&&c(this).is(":hidden"),k=this;for(i in a){var n=i.replace(ia,ja);if(i!==n){a[n]=a[i];delete a[i];i=n}if(a[i]==="hide"&&o||a[i]==="show"&&!o)return j.complete.call(this);if((i==="height"||i==="width")&&this.style){j.display=c.css(this,"display");j.overflow=this.style.overflow}if(c.isArray(a[i])){(j.specialEasing=
j.specialEasing||{})[i]=a[i][1];a[i]=a[i][0]}}if(j.overflow!=null)this.style.overflow="hidden";j.curAnim=c.extend({},a);c.each(a,function(r,u){var z=new c.fx(k,j,r);if(Ab.test(u))z[u==="toggle"?o?"show":"hide":u](a);else{var C=Bb.exec(u),B=z.cur(true)||0;if(C){u=parseFloat(C[2]);var E=C[3]||"px";if(E!=="px"){k.style[r]=(u||1)+E;B=(u||1)/z.cur(true)*B;k.style[r]=B+E}if(C[1])u=(C[1]==="-="?-1:1)*u+B;z.custom(B,u,E)}else z.custom(B,u,"")}});return true})},stop:function(a,b){var d=c.timers;a&&this.queue([]);
this.each(function(){for(var f=d.length-1;f>=0;f--)if(d[f].elem===this){b&&d[f](true);d.splice(f,1)}});b||this.dequeue();return this}});c.each({slideDown:K("show",1),slideUp:K("hide",1),slideToggle:K("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(a,b){c.fn[a]=function(d,f){return this.animate(b,d,f)}});c.extend({speed:function(a,b,d){var f=a&&typeof a==="object"?a:{complete:d||!d&&b||c.isFunction(a)&&a,duration:a,easing:d&&b||b&&!c.isFunction(b)&&b};f.duration=c.fx.off?0:typeof f.duration===
"number"?f.duration:c.fx.speeds[f.duration]||c.fx.speeds._default;f.old=f.complete;f.complete=function(){f.queue!==false&&c(this).dequeue();c.isFunction(f.old)&&f.old.call(this)};return f},easing:{linear:function(a,b,d,f){return d+f*a},swing:function(a,b,d,f){return(-Math.cos(a*Math.PI)/2+0.5)*f+d}},timers:[],fx:function(a,b,d){this.options=b;this.elem=a;this.prop=d;if(!b.orig)b.orig={}}});c.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(c.fx.step[this.prop]||
c.fx.step._default)(this);if((this.prop==="height"||this.prop==="width")&&this.elem.style)this.elem.style.display="block"},cur:function(a){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];return(a=parseFloat(c.css(this.elem,this.prop,a)))&&a>-10000?a:parseFloat(c.curCSS(this.elem,this.prop))||0},custom:function(a,b,d){function f(j){return e.step(j)}this.startTime=J();this.start=a;this.end=b;this.unit=d||this.unit||"px";this.now=this.start;
this.pos=this.state=0;var e=this;f.elem=this.elem;if(f()&&c.timers.push(f)&&!W)W=setInterval(c.fx.tick,13)},show:function(){this.options.orig[this.prop]=c.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());c(this.elem).show()},hide:function(){this.options.orig[this.prop]=c.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(a){var b=J(),d=true;if(a||b>=this.options.duration+this.startTime){this.now=
this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;for(var f in this.options.curAnim)if(this.options.curAnim[f]!==true)d=false;if(d){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;a=c.data(this.elem,"olddisplay");this.elem.style.display=a?a:this.options.display;if(c.css(this.elem,"display")==="none")this.elem.style.display="block"}this.options.hide&&c(this.elem).hide();if(this.options.hide||this.options.show)for(var e in this.options.curAnim)c.style(this.elem,
e,this.options.orig[e]);this.options.complete.call(this.elem)}return false}else{e=b-this.startTime;this.state=e/this.options.duration;a=this.options.easing||(c.easing.swing?"swing":"linear");this.pos=c.easing[this.options.specialEasing&&this.options.specialEasing[this.prop]||a](this.state,e,0,1,this.options.duration);this.now=this.start+(this.end-this.start)*this.pos;this.update()}return true}};c.extend(c.fx,{tick:function(){for(var a=c.timers,b=0;b<a.length;b++)a[b]()||a.splice(b--,1);a.length||
c.fx.stop()},stop:function(){clearInterval(W);W=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){c.style(a.elem,"opacity",a.now)},_default:function(a){if(a.elem.style&&a.elem.style[a.prop]!=null)a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit;else a.elem[a.prop]=a.now}}});if(c.expr&&c.expr.filters)c.expr.filters.animated=function(a){return c.grep(c.timers,function(b){return a===b.elem}).length};c.fn.offset="getBoundingClientRect"in s.documentElement?
function(a){var b=this[0];if(a)return this.each(function(e){c.offset.setOffset(this,a,e)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return c.offset.bodyOffset(b);var d=b.getBoundingClientRect(),f=b.ownerDocument;b=f.body;f=f.documentElement;return{top:d.top+(self.pageYOffset||c.support.boxModel&&f.scrollTop||b.scrollTop)-(f.clientTop||b.clientTop||0),left:d.left+(self.pageXOffset||c.support.boxModel&&f.scrollLeft||b.scrollLeft)-(f.clientLeft||b.clientLeft||0)}}:function(a){var b=
this[0];if(a)return this.each(function(r){c.offset.setOffset(this,a,r)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return c.offset.bodyOffset(b);c.offset.initialize();var d=b.offsetParent,f=b,e=b.ownerDocument,j,i=e.documentElement,o=e.body;f=(e=e.defaultView)?e.getComputedStyle(b,null):b.currentStyle;for(var k=b.offsetTop,n=b.offsetLeft;(b=b.parentNode)&&b!==o&&b!==i;){if(c.offset.supportsFixedPosition&&f.position==="fixed")break;j=e?e.getComputedStyle(b,null):b.currentStyle;
k-=b.scrollTop;n-=b.scrollLeft;if(b===d){k+=b.offsetTop;n+=b.offsetLeft;if(c.offset.doesNotAddBorder&&!(c.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(b.nodeName))){k+=parseFloat(j.borderTopWidth)||0;n+=parseFloat(j.borderLeftWidth)||0}f=d;d=b.offsetParent}if(c.offset.subtractsBorderForOverflowNotVisible&&j.overflow!=="visible"){k+=parseFloat(j.borderTopWidth)||0;n+=parseFloat(j.borderLeftWidth)||0}f=j}if(f.position==="relative"||f.position==="static"){k+=o.offsetTop;n+=o.offsetLeft}if(c.offset.supportsFixedPosition&&
f.position==="fixed"){k+=Math.max(i.scrollTop,o.scrollTop);n+=Math.max(i.scrollLeft,o.scrollLeft)}return{top:k,left:n}};c.offset={initialize:function(){var a=s.body,b=s.createElement("div"),d,f,e,j=parseFloat(c.curCSS(a,"marginTop",true))||0;c.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";
a.insertBefore(b,a.firstChild);d=b.firstChild;f=d.firstChild;e=d.nextSibling.firstChild.firstChild;this.doesNotAddBorder=f.offsetTop!==5;this.doesAddBorderForTableAndCells=e.offsetTop===5;f.style.position="fixed";f.style.top="20px";this.supportsFixedPosition=f.offsetTop===20||f.offsetTop===15;f.style.position=f.style.top="";d.style.overflow="hidden";d.style.position="relative";this.subtractsBorderForOverflowNotVisible=f.offsetTop===-5;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==j;a.removeChild(b);
c.offset.initialize=c.noop},bodyOffset:function(a){var b=a.offsetTop,d=a.offsetLeft;c.offset.initialize();if(c.offset.doesNotIncludeMarginInBodyOffset){b+=parseFloat(c.curCSS(a,"marginTop",true))||0;d+=parseFloat(c.curCSS(a,"marginLeft",true))||0}return{top:b,left:d}},setOffset:function(a,b,d){if(/static/.test(c.curCSS(a,"position")))a.style.position="relative";var f=c(a),e=f.offset(),j=parseInt(c.curCSS(a,"top",true),10)||0,i=parseInt(c.curCSS(a,"left",true),10)||0;if(c.isFunction(b))b=b.call(a,
d,e);d={top:b.top-e.top+j,left:b.left-e.left+i};"using"in b?b.using.call(a,d):f.css(d)}};c.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),d=this.offset(),f=/^body|html$/i.test(b[0].nodeName)?{top:0,left:0}:b.offset();d.top-=parseFloat(c.curCSS(a,"marginTop",true))||0;d.left-=parseFloat(c.curCSS(a,"marginLeft",true))||0;f.top+=parseFloat(c.curCSS(b[0],"borderTopWidth",true))||0;f.left+=parseFloat(c.curCSS(b[0],"borderLeftWidth",true))||0;return{top:d.top-
f.top,left:d.left-f.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||s.body;a&&!/^body|html$/i.test(a.nodeName)&&c.css(a,"position")==="static";)a=a.offsetParent;return a})}});c.each(["Left","Top"],function(a,b){var d="scroll"+b;c.fn[d]=function(f){var e=this[0],j;if(!e)return null;if(f!==w)return this.each(function(){if(j=wa(this))j.scrollTo(!a?f:c(j).scrollLeft(),a?f:c(j).scrollTop());else this[d]=f});else return(j=wa(e))?"pageXOffset"in j?j[a?"pageYOffset":
"pageXOffset"]:c.support.boxModel&&j.document.documentElement[d]||j.document.body[d]:e[d]}});c.each(["Height","Width"],function(a,b){var d=b.toLowerCase();c.fn["inner"+b]=function(){return this[0]?c.css(this[0],d,false,"padding"):null};c.fn["outer"+b]=function(f){return this[0]?c.css(this[0],d,false,f?"margin":"border"):null};c.fn[d]=function(f){var e=this[0];if(!e)return f==null?null:this;if(c.isFunction(f))return this.each(function(j){var i=c(this);i[d](f.call(this,j,i[d]()))});return"scrollTo"in
e&&e.document?e.document.compatMode==="CSS1Compat"&&e.document.documentElement["client"+b]||e.document.body["client"+b]:e.nodeType===9?Math.max(e.documentElement["client"+b],e.body["scroll"+b],e.documentElement["scroll"+b],e.body["offset"+b],e.documentElement["offset"+b]):f===w?c.css(e,d):this.css(d,typeof f==="string"?f:f+"px")}});A.jQuery=A.$=c})(window);

//]]>
</script>
<script id="jqueryArea" type="text/javascript">
//<![CDATA[
/*
jQuery.encoding.digests.sha1.js

SHA-1 digest and associated utility functions

Copyright (c) UnaMesa Association 2009

Dual licensed under the MIT and GPL licenses:
  http://www.opensource.org/licenses/mit-license.php
  http://www.gnu.org/licenses/gpl.html
*/

(function($) {

if(!$.encoding)
	$.encoding = {};
	$.extend($.encoding,{
		strToBe32s: function(str) {
			// Convert a string to an array of big-endian 32-bit words
			var be=[];
			var len=Math.floor(str.length/4);
			var i, j;
			for(i=0, j=0; i<len; i++, j+=4) {
				be[i]=((str.charCodeAt(j)&0xff) << 24)|((str.charCodeAt(j+1)&0xff) << 16)|((str.charCodeAt(j+2)&0xff) << 8)|(str.charCodeAt(j+3)&0xff);
			}
			while(j<str.length) {
				be[j>>2] |= (str.charCodeAt(j)&0xff)<<(24-(j*8)%32);
				j++;
			}
			return be;
		},
		be32sToStr: function(be) {
			// Convert an array of big-endian 32-bit words to a string
			var str='';
			for(var i=0;i<be.length*32;i+=8) {
				str += String.fromCharCode((be[i>>5]>>>(24-i%32)) & 0xff);
			}
			return str;
		},
		be32sToHex: function(be) {
			// Convert an array of big-endian 32-bit words to a hex string
			var hex='0123456789ABCDEF';
			var str='';
			for(var i=0;i<be.length*4;i++) {
				str += hex.charAt((be[i>>2]>>((3-i%4)*8+4))&0xF) + hex.charAt((be[i>>2]>>((3-i%4)*8))&0xF);
			}
			return str;
		}
	});
})(jQuery);


(function($) {

if(!$.encoding.digests)
	$.encoding.digests = {};
	$.extend($.encoding.digests,{
		hexSha1Str: function(str) {
			// Return, in hex, the SHA-1 hash of a string
			return $.encoding.be32sToHex($.encoding.digests.sha1Str(str));
		},
		sha1Str: function(str) {
			// Return the SHA-1 hash of a string
			return sha1($.encoding.strToBe32s(str),str.length);
		},
		sha1: function(x,blen) {
			// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
			return sha1($.encoding.strToBe32s(str),str.length);
		}
	});

	// Private functions.
	function sha1(x,blen) {
		// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
		function add32(a,b) {
			// Add 32-bit integers, wrapping at 32 bits
			// Uses 16-bit operations internally to work around bugs in some JavaScript interpreters.
			var lsw=(a&0xFFFF)+(b&0xFFFF);
			var msw=(a>>16)+(b>>16)+(lsw>>16);
			return (msw<<16)|(lsw&0xFFFF);
		}
		function AA(a,b,c,d,e) {
			// Cryptographic round helper function. Add five 32-bit integers, wrapping at 32 bits, second parameter is rotated left 5 bits before the addition
			// Uses 16-bit operations internally to work around bugs in some JavaScript interpreters.
			b=(b>>>27)|(b<<5);
			var lsw=(a&0xFFFF)+(b&0xFFFF)+(c&0xFFFF)+(d&0xFFFF)+(e&0xFFFF);
			var msw=(a>>16)+(b>>16)+(c>>16)+(d>>16)+(e>>16)+(lsw>>16);
			return (msw<<16)|(lsw&0xFFFF);
		}
		function RR(w,j) {
			// Cryptographic round helper function.
			var n=w[j-3]^w[j-8]^w[j-14]^w[j-16];
			return (n>>>31)|(n<<1);
		}

		var len=blen*8;
		x[len>>5] |= 0x80 << (24-len%32);
		x[((len+64>>9)<<4)+15]=len;
		var w=new Array(80);

		var k1=0x5A827999;
		var k2=0x6ED9EBA1;
		var k3=0x8F1BBCDC;
		var k4=0xCA62C1D6;

		var h0=0x67452301;
		var h1=0xEFCDAB89;
		var h2=0x98BADCFE;
		var h3=0x10325476;
		var h4=0xC3D2E1F0;

		for(var i=0;i<x.length;i+=16) {
			var j=0;
			var t;
			var a=h0;
			var b=h1;
			var c=h2;
			var d=h3;
			var e=h4;
			while(j<16) {
				w[j]=x[i+j];
				t=AA(e,a,d^(b&(c^d)),w[j],k1);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<20) {
				w[j]=RR(w,j);
				t=AA(e,a,d^(b&(c^d)),w[j],k1);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<40) {
				w[j]=RR(w,j);
				t=AA(e,a,b^c^d,w[j],k2);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<60) {
				w[j]=RR(w,j);
				t=AA(e,a,(b&c)|(d&(b|c)),w[j],k3);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<80) {
				w[j]=RR(w,j);
				t=AA(e,a,b^c^d,w[j],k4);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			h0=add32(h0,a);
			h1=add32(h1,b);
			h2=add32(h2,c);
			h3=add32(h3,d);
			h4=add32(h4,e);
		}
		return [h0,h1,h2,h3,h4];
	}
})(jQuery);
/*
jQuery.twStylesheet.js

jQuery plugin to dynamically insert CSS rules into a document

Usage:
  jQuery.twStylesheet applies style definitions
  jQuery.twStylesheet.remove neutralizes style definitions

Copyright (c) UnaMesa Association 2009

Triple licensed under the BSD, MIT and GPL licenses:
  http://www.opensource.org/licenses/bsd-license.php
  http://www.opensource.org/licenses/mit-license.php
  http://www.gnu.org/licenses/gpl.html
*/

(function($) {

var defaultId = "customStyleSheet"; // XXX: rename to dynamicStyleSheet?

// Add or replace a style sheet
// css argument is a string of CSS rule sets
// options.id is an optional name identifying the style sheet
// options.doc is an optional document reference
// N.B.: Uses DOM methods instead of jQuery to ensure cross-browser comaptibility.
$.twStylesheet = function(css, options) {
	options = options || {};
	var id = options.id || defaultId;
	var doc = options.doc || document;
	var el = doc.getElementById(id);
	if(doc.createStyleSheet) { // IE-specific handling
		if(el) {
			el.parentNode.removeChild(el);
		}
		doc.getElementsByTagName("head")[0].insertAdjacentHTML("beforeEnd",
			"&nbsp;<style id='" + id + "'>" + css + "</style>"); // fails without &nbsp;
	} else { // modern browsers
		if(el) {
			el.replaceChild(doc.createTextNode(css), el.firstChild);
		} else {
			el = doc.createElement("style");
			el.type = "text/css";
			el.id = id;
			el.appendChild(doc.createTextNode(css));
			doc.getElementsByTagName("head")[0].appendChild(el);
		}
	}
};

// Remove existing style sheet
// options.id is an optional name identifying the style sheet
// options.doc is an optional document reference
$.twStylesheet.remove = function(options) {
	options = options || {};
	var id = options.id || defaultId;
	var doc = options.doc || document;
	var el = doc.getElementById(id);
	if(el) {
		el.parentNode.removeChild(el);
	}
};

})(jQuery);
//]]>
</script>
<script type="text/javascript">
//<![CDATA[
if(useJavaSaver)
	document.write("<applet style='position:absolute;left:-1px' name='TiddlySaver' code='TiddlySaver.class' archive='TiddlySaver.jar' width='1' height='1'></applet>");
//]]>
</script>
<!--POST-SCRIPT-START-->

<!--POST-SCRIPT-END-->
</body>
</html>
